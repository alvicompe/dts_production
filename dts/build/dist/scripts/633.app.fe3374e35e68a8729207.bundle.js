(self.webpackChunkdts_hytera=self.webpackChunkdts_hytera||[]).push([[633],{61242:(e,t,i)=>{"use strict";i.d(t,{a:()=>v});var n=i(85893),s=i(41120),o=i(52663),a=i(66083),l=i(29525),r=i(66856),d=i(95477),c=i(282);const u=(0,s.Z)({disabledPadding:{padding:0,textAlign:"center"}}),v=({open:e,handleClose:t,handleConfirm:i,title:s,children:v,maxWidth:m="lg",disabled:h=!1,loading:g})=>{const j=u();return(0,n.jsxs)(o.Z,Object.assign({open:e,onClose:t,maxWidth:m},{children:[(0,n.jsx)(a.Z,Object.assign({className:j.disabledPadding},{children:s}),void 0),(0,n.jsx)(l.Z,{children:v},void 0),(0,n.jsx)(r.Z,{children:g?(0,n.jsx)(d.Z,{style:{width:"30px",height:"30px"}},void 0):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Z,Object.assign({size:"small",color:"primary",onClick:t},{children:"Cancel"}),void 0),i&&(0,n.jsx)(c.Z,Object.assign({disabled:h,variant:"outlined",size:"small",color:"secondary",onClick:i,autoFocus:!0},{children:"Confirm"}),void 0)]},void 0)},void 0)]}),void 0)}},10646:(e,t,i)=>{"use strict";i.d(t,{l:()=>n});const n=e=>[`${e.getFullYear()}-${`0${e.getMonth()+1}`.substr(-2)}-${`0${e.getDate()}`.substr(-2)}`]},88093:(e,t,i)=>{"use strict";i.d(t,{R:()=>n});const n=()=>{var e=new Date;return e.getHours(),[e.getHours()>=0&&e.getHours()<7?new Date(e.getTime()-864e5):e]}},990:(e,t,i)=>{"use strict";i.d(t,{M:()=>s});var n=i(67294);const s=e=>{const[t,i]=(0,n.useState)(e);return[t,e=>{i(Object.assign(Object.assign({},t),{[e.target.name]:e.target.value}))},()=>{i(e)},i]}},15635:(e,t,i)=>{"use strict";i.d(t,{r:()=>o});var n=i(67294),s=i(95090);const o=e=>{const[t,i]=(0,n.useState)(!1);return(0,n.useEffect)((()=>(e===s.JD.DONE||e===s.JD.UNKNOWN||e===s.JD.ERROR?i(!1):i(!0),()=>{i(!1)})),[e]),[t]}},84519:(e,t,i)=>{"use strict";i.r(t),i.d(t,{HourmeterView:()=>lt,default:()=>rt});var n=i(85893),s=i(41749),o=i(10046),a=i(67294),l=i(73855),r=i(12207),d=i(74046),c=i(61242),u=i(60702),v=i(44562);const m=({error:e,index:t})=>{const[i,s]=a.useState(!0),[o,l]=a.useState({vertical:"bottom",horizontal:"right"}),{vertical:r,horizontal:d}=o,c=(e,t)=>{"clickaway"!==t&&s(!1)};return(0,n.jsx)(u.Z,Object.assign({anchorOrigin:{vertical:r,horizontal:d},open:i,onClose:c,style:{marginBottom:60*t+"px"}},{children:(0,n.jsx)(v.Z,Object.assign({style:{marginTop:".5rem"},onClose:c,severity:"error"},{children:(0,n.jsx)("strong",{children:e.message},void 0)}),void 0)}),void 0)},h=({error:e})=>{const[t,i]=a.useState({open:!0,vertical:"bottom",horizontal:"right"}),{vertical:s,horizontal:o,open:l}=t,r=()=>{i(Object.assign(Object.assign({},t),{open:!1}))};return(0,n.jsx)(u.Z,Object.assign({open:!0,anchorOrigin:{vertical:s,horizontal:o}},{children:(0,n.jsx)("div",{children:null==e?void 0:e.map(((e,t)=>(0,n.jsx)(m,{error:e,handleClose:r,index:t},e.deviceId)))},void 0)}),void 0)};var g=i(92284),j=i(73914),f=i(57850),x=i(59693),b=i(93584);function E(e){return e.type||e.mode}const O=(0,f.Z)(),p=(0,j.Z)((e=>{E(e.palette);const t=t=>"dark"===E(e.palette)?(0,x._j)(t,.1):(0,x.$n)(t,.1);return{root:{"& .Mui-error.negative":{backgroundColor:"#CCFFFF",color:"#1a3e72",fontWeight:"600"},"& .Mui-error.positive":{backgroundColor:"rgba(157, 255, 118, 0.49)",color:"#1a3e72",fontWeight:"600"},"& .super-app-theme--false":{backgroundColor:(i="rgb(255, 48, 83)","dark"===E(e.palette)?(0,x._j)(i,.1):(0,x.$n)(i,.5)),"&:hover":{backgroundColor:t(e.palette.error.main)}},"& .MuiDataGrid-row":{"&:hover":{backgroundColor:t(`${b.sb}`)},"& .Mui-selected":{"&:hover":{backgroundColor:t(`${b.sb}`)}}}}};var i}),{defaultTheme:O});var S=i(868),T=i(17812),N=i(86010),y=i(52303),C=i(80024),Z=i(99050),w=i(85639),k=i(79192),A=i(67774),I=i(18973);const L=()=>{const{eventList:e}=(0,l.C)(I.yJ),t=(0,l.T)(),[i,n]=a.useState([]);return(0,a.useEffect)((()=>{n([{id:"NONE",name:"NONE",event:""},...e])}),[e]),(0,a.useEffect)((()=>{t((0,A.TU)())}),[]),[i]},D=(e,t)=>{const i=(0,l.T)();return[(n="NONE")=>{t(null),console.log("option",n),i(e("NONE"===n?{columnField:"statusEvent",operatorValue:"startsWith",value:""}:{columnField:"statusEvent",operatorValue:"startsWith",value:n}))}]};function F(){const[e]=L(),[t,i]=a.useState(null),s=Boolean(t),[o]=D(d.V,i);return(0,n.jsxs)("div",{children:[(0,n.jsx)(T.Z,Object.assign({style:{padding:"0px",margin:"0px"},"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:e=>{i(e.currentTarget)}},{children:(0,n.jsx)(k.Z,{},void 0)}),void 0),(0,n.jsx)(Z.Z,Object.assign({id:"long-menu",anchorEl:t,keepMounted:!0,open:s,onClose:()=>o("NONE"),PaperProps:{style:{maxHeight:216,width:"20ch"}}},{children:e.map((e=>(0,n.jsx)(w.Z,Object.assign({onClick:()=>o(e.event.toString())},{children:e.name}),e.name)))}),void 0)]},void 0)}const H=(e,t,i,s)=>[Object.assign(Object.assign({},g.mf9),{width:60,renderHeader:e=>(0,n.jsx)(S.ZP,Object.assign({title:"Select all"},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex",padding:"0px",margin:"0px"}},{children:[(0,n.jsx)(g.KOw,Object.assign({},e),void 0),(0,n.jsx)(F,{},void 0)]}),void 0)}),void 0)}),{field:"excavator",headerName:"Excavator",hideSortIcons:!0},{field:"shift",headerName:"shift",hideSortIcons:!0,width:60},{field:"statusEvent",headerName:"statusEvent",type:"string",hide:!0},{field:"status",headerName:"Status",width:100,hideSortIcons:!0,renderCell:({row:e})=>(0,n.jsx)(S.ZP,Object.assign({title:e.status},{children:(0,n.jsx)("p",{children:e.status},void 0)}),void 0)},{field:"hmtStart",headerName:"Hourmeter",editable:!1,type:"number",hideSortIcons:!0},{field:"hourmeterCurrent",headerName:"hourmeter Current",editable:!s,hideSortIcons:!0,type:"number"},{field:"hourmeterFinal",headerName:"hourmeter Final",editable:!0,type:"number",hideSortIcons:!0,cellClassName:e=>(0,N.Z)("Mui-error",{positive:e.value>0,negative:e.value<=0||0===e.value})},{field:"adjustment",headerName:"adjustment",type:"number",hideSortIcons:!0},{field:"Opciones",headerName:"Opc",hideSortIcons:!0,minWidth:110,renderCell:({row:s})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.ZP,Object.assign({onClick:()=>{t(s),e(!0)},title:"Add timeline"},{children:(0,n.jsx)(T.Z,Object.assign({size:"small"},{children:(0,n.jsx)(C.Z,{color:"primary",fontSize:"small"},void 0)}),void 0)}),void 0),(0,n.jsx)(S.ZP,Object.assign({onClick:()=>{t(s),i(!0)},title:"View Timeline"},{children:(0,n.jsx)(T.Z,Object.assign({size:"small"},{children:(0,n.jsx)(y.Z,{htmlColor:"Green",fontSize:"small"},void 0)}),void 0)}),void 0)]},void 0)}],M=(e,t)=>{const[i,n]=(0,a.useState)([{field:e,sort:t}]);return{sortModel:i,handleModelGrid:e=>{0!=e.length?e[0].field!=i[0].field||e[0].sort!=i[0].sort?n(e):console.log("else"):"desc"==i[0].sort?n([Object.assign(Object.assign({},i[0]),{sort:"asc"})]):n([Object.assign(Object.assign({},i[0]),{sort:"desc"})])}}};var P,_;!function(e){e[e.UNKNOWN_STATE_EVENT=0]="UNKNOWN_STATE_EVENT",e[e.MA=1]="MA",e[e.NOP=2]="NOP",e[e.DOP=3]="DOP",e[e.OP=4]="OP"}(P||(P={})),function(e){e[e.UNKNOWN_SHIFT=0]="UNKNOWN_SHIFT",e[e.NIGHT=1]="NIGHT",e[e.DAY=2]="DAY",e[e.BOTH=3]="BOTH"}(_||(_={}));var R=i(95090);const $=(e,t)=>{const[i,n]=(0,a.useState)([]);return(0,a.useEffect)((()=>{t===R.JD.DONE?n(null==e?void 0:e.map((e=>{var t,i,n,s,o,a,l,r,d,c,u,v,m,h,g,j;return Object.assign(Object.assign({},e),{id:e.deviceId,excavator:e.deviceAlias,status:` ${(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.name)?null===(s=null===(n=e.eventState)||void 0===n?void 0:n.event)||void 0===s?void 0:s.name.substring(0,3):""}  ${(null===(o=e.eventState)||void 0===o?void 0:o.name)?` - ${null===(a=e.eventState)||void 0===a?void 0:a.name.toString().toLowerCase()}`:""}`,statusEvent:null===(r=null===(l=e.eventState)||void 0===l?void 0:l.event)||void 0===r?void 0:r.event,hmtStart:null===(d=e.hystoryShiftList[0])||void 0===d?void 0:d.initialHourmeter.toFixed(2),hourmeterCurrent:null===(c=e.hystoryShiftList.at(-1))||void 0===c?void 0:c.initialHourmeter.toFixed(2),shift:_[null===(u=e.currentTimeline)||void 0===u?void 0:u.shift],date:new Date(1e3*(null===(m=null===(v=e.currentTimeline)||void 0===v?void 0:v.shiftDate)||void 0===m?void 0:m.seconds)).toLocaleDateString(),adjustment:(null===(h=e.currentTimeline)||void 0===h?void 0:h.adjustment)?e.currentTimeline.adjustment:0,statusAdjustment:!!(null===(g=e.currentTimeline)||void 0===g?void 0:g.status)&&(null===(j=e.currentTimeline)||void 0===j?void 0:j.status)})}))):n([])}),[e,t]),[i]};var U=i(78479),W=i(85343),V=i(88093),z=i(10646),K=i(56731);const J=()=>{const[e]=(0,V.R)(),[t]=(0,z.l)(e),i=`${t}T00:00`;return[{shift:K.Shift.UNKNOWN_SHIFT,date:i}]},B=e=>e>0,G=(e,t,i,n,s,o)=>{Object.keys(e).forEach((t=>{var i=B(e[t].hourmeterFinal.value);e[t].hourmeterFinal=Object.assign(Object.assign({},e[t].hourmeterFinal),{error:!i})})),console.log("updatedModelxdxd",e),n(Object.assign(Object.assign(Object.assign({},i),s),e));var a=!1;for(var[l,r]of Object.entries(t))void 0===e[l].hourmeterFinal.value&&(a=!0);a||e&&o(s),console.log("hourmeterFinal",i)},Y=(e,t,i)=>{const n=(0,l.T)();Object.keys(e).length>=2?(t({}),n(i({}))):(Object.keys(e).forEach((t=>{if(e[t].hourmeterCurrent){var i=B(e[t].hourmeterCurrent.value);e[t].hourmeterCurrent=Object.assign(Object.assign({},e[t].hourmeterCurrent),{error:!i})}})),t(e),n(i(e)))};let X;const q=({setOpen:e,setTimelineCurrent:t,setOpenTimeline:i})=>{const s=p(),o=(0,l.T)(),{statusTimeslineExcavator:r,filterDataGrid:c,isEditableRows:u,timeslineExcavator:v}=(0,l.C)(d.tH),[m]=$(v.currentTimelineList,r),{sortModel:h,handleModelGrid:j}=M("excavator","asc"),[f,x]=(0,U._)("hourmeterExcavator",null),[b]=J(),[E,O]=(0,a.useState)(!0),[S,T]=(0,a.useState)(Object.assign({},f));return(0,a.useEffect)((()=>{setTimeout((()=>{T(Object.assign({},f))}),3e3)}),[]),(0,a.useEffect)((()=>{o((0,d.WZ)(S))}),[S]),(0,a.useEffect)((()=>{r===R.JD.DONE&&(o((0,d.hV)()),o((0,d.OE)()))}),[m]),(0,a.useEffect)((()=>{r===R.JD.DONE||r===R.JD.ERROR?O(!1):O(!0)}),[r]),(0,n.jsx)("div",Object.assign({style:{height:"1113px",overflowY:"scroll",display:"flex",flexDirection:"column"}},{children:(0,n.jsx)(g._$r,{className:s.root,rowHeight:30,rows:m,columns:H(e,t,i,u),density:"compact",checkboxSelection:!0,disableSelectionOnClick:!0,onSelectionModelChange:e=>(e=>{const t=new Set(e),i=m.filter((e=>t.has(e.id.toString())));o((0,d.Xm)(i))})(e),disableColumnMenu:!0,sortModel:h,editRowsModel:S,onEditRowsModelChange:e=>(e=>{var t="";for(var[i,n]of Object.entries(e))Object.keys(n).length<=1&&Object.keys(n).forEach((e=>{t=e}));var s=Object.assign({},e);switch(t){case"hourmeterCurrent":T(Object.assign(Object.assign({},S),s)),o((0,d.Jo)(s));break;case"hmtStart":Y(s,T,d.Yb);break;case"hourmeterFinal":clearTimeout(X),G(s,e,f,T,S,x);var a=!1;for(var[l,n]of Object.entries(e))void 0===s[l].hourmeterFinal.value&&(a=!0);a||s&&m[0].currentTimeline.shift!=W.Shift.UNKNOWN_SHIFT&&(X=setTimeout((()=>{o((0,d.pC)()),setTimeout((()=>{o((0,d.pW)(b))}),100)}),2e3));break;default:console.log("case default")}})(e),filterModel:{items:[c]},getRowClassName:e=>`super-app-theme--${e.row.statusAdjustment}`},void 0)}),void 0)};var Q=i(8286),ee=i(66977),te=i(990),ie=i(49032),ne=i(41120),se=i(35117),oe=i(64436),ae=i(96019),le=i(67162),re=i(30553),de=i(40074),ce=i(81395),ue=i(89452);const ve=({setEventState:e,event:t})=>{const[i,s,o,r]=(0,te.M)({status:ie.EnumEvent.UNKNOWN_STATE_EVENT}),{eventStateList:d,statusEventStateList:c}=(0,l.C)(I.eG),u=(0,l.T)();return(0,a.useEffect)((()=>{if(t.toString()===ie.EnumEvent.OPERATIONAL.toString()){if(c===R.JD.DONE){const t=d[0];e(Object.assign(Object.assign({},t),{id:"",name:"",eventState:0,event:t.event}))}}else{const t=d.find((e=>e.eventState.toString()===i.status.toString()));e(t)}}),[i.status]),(0,a.useEffect)((()=>{u((0,ue.Gy)(t))}),[t]),(0,a.useEffect)((()=>{e({id:"",name:"",eventState:0,event:{id:"",name:"",event:0}})}),[]),(0,a.useEffect)((()=>{if(c===R.JD.DONE&&t.toString()===ie.EnumEvent.OPERATIONAL.toString()){const t=d[0];e(Object.assign(Object.assign({},t),{id:"",name:"",eventState:0,event:t.event}))}}),[c]),(0,a.useEffect)((()=>{o()}),[t]),t.toString()===ie.EnumEvent.OPERATIONAL.toString()?null:(0,n.jsxs)(oe.Z,Object.assign({component:"fieldset"},{children:[(0,n.jsx)(ae.Z,Object.assign({component:"legend"},{children:P[t]}),void 0),(0,n.jsx)(le.Z,Object.assign({defaultValue:"female","aria-label":"hourmeter",name:"customized-radios"},{children:null==d?void 0:d.map((e=>(0,n.jsx)(re.Z,{value:e.eventState,control:(0,n.jsx)(de.Z,{checked:i.status===e.eventState.toString(),icon:(0,n.jsx)(ce.Z,{},void 0),checkedIcon:(0,n.jsx)(ce.Z,{},void 0),name:"status",onClick:()=>{},onChange:s,disabled:e.event.event.toString()===ie.EnumEvent.OPERATIONAL.toString()},void 0),label:e.name},e.id)))}),void 0)]}),void 0)},me=(0,ne.Z)((e=>(0,se.Z)({container:{display:"flex",flexDirection:"column",flexWrap:"wrap",fontFamily:"inherit"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),paddingBottom:"10px",width:100}}))),he=({value:e,label:t})=>{const i=me(),o=(0,l.T)(),d=new Date,c=`0${d.getHours()}`,u=`0${d.getMinutes()}`,[v,m]=(0,a.useState)({hoursStart:`${c.slice(-2)}:${u.slice(-2)}`,status:e,substatus:{id:"",name:"",eventState:ie.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:ie.EnumEvent.UNKNOWN_STATE_EVENT}}}),[h,g]=(0,a.useState)({id:"",name:"",eventState:ie.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:ie.EnumEvent.UNKNOWN_STATE_EVENT}});console.log(v),(0,a.useEffect)((()=>{o((0,r.gS)(Object.assign({},v)))}),[v]),(0,a.useEffect)((()=>()=>{o((0,r.XH)())}),[]),(0,a.useEffect)((()=>{m(Object.assign(Object.assign({},v),{substatus:h}))}),[h]);const{hoursStart:j}=v;return(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:1},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsx)("form",Object.assign({className:i.container,noValidate:!0},{children:(0,n.jsx)(Q.Z,{id:"date",label:"HOUR START",type:"time",name:"hoursStart",value:j,onChange:e=>{m(Object.assign(Object.assign({},v),{[e.target.name]:e.target.value}))},className:i.textField,InputLabelProps:{shrink:!0,required:!0}},void 0)}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsx)(ve,{setEventState:g,event:v.status},void 0)}),void 0)]}),void 0)};var ge=i(282);const je=({rowsTimelines:e,setOpenEvent:t,setevent:i})=>{const s=(0,l.T)(),{eventList:o}=(0,l.C)(I.yJ),[r,d]=a.useState(null),[c]=(e=>{const[t,i]=(0,a.useState)(!0),[n,s]=(0,a.useState)(!0),[o,l]=(0,a.useState)(!0);(0,a.useEffect)((()=>{d()&&(i(!1),s(!0),l(!1)),u()&&(i(!1),s(!1),l(!1)),r()&&(i(!0),s(!1),l(!1)),c()&&(i(!1),s(!1),l(!0)),0==u()&&0==r()&&0==c()&&0==d()&&(i(!0),s(!0),l(!0))}),[e]);const r=()=>0!==e.length&&e.every((e=>{var t,i;return(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===ie.EnumEvent.NO_OPERATIONAL})),d=()=>0!==e.length&&e.every((e=>{var t,i;return(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===ie.EnumEvent.OPERATIONAL})),c=()=>0!==e.length&&e.every((e=>{var t,i;return(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===ie.EnumEvent.OPERATIONAL_DELAY})),u=()=>0!==e.length&&e.every((e=>{var t,i;return void 0===(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)}));return[e=>{var i=!1;return e===ie.EnumEvent.OPERATIONAL_DELAY&&(i=o),e===ie.EnumEvent.OPERATIONAL&&(i=n),e===ie.EnumEvent.NO_OPERATIONAL&&(i=t),e===ie.EnumEvent.MAINTENANCE&&(i=!0),i}]})(e);return(0,a.useEffect)((()=>{s((0,A.TU)())}),[]),(0,n.jsxs)("div",{children:[(0,n.jsx)(ge.Z,Object.assign({"aria-controls":"simple-menu","aria-haspopup":"true",onClick:e=>{d(e.currentTarget)},color:"primary",size:"small",variant:"outlined"},{children:"Go to"}),void 0),(0,n.jsx)(Z.Z,Object.assign({id:"simple-menu",anchorEl:r,keepMounted:!0,open:Boolean(r),onClose:()=>{d(null)}},{children:o.map((e=>(0,n.jsx)(w.Z,Object.assign({disabled:c(null==e?void 0:e.event),onClick:()=>(e=>{t(!0),i(e)})(null==e?void 0:e.event),color:"primary"},{children:e.name}),e.id)))}),void 0)]},void 0)};var fe=i(97480),xe=i(71267),be=i(69798);const Ee=({shift:e,date:t})=>{const i=new Date(t).toLocaleDateString(),s=(new Date).toLocaleDateString();return(0,n.jsxs)("div",{children:[(0,n.jsx)(xe.Z,{icon:(0,n.jsx)(fe.Z,{},void 0),label:e,clickable:!0,color:"secondary",deleteIcon:(0,n.jsx)(fe.Z,{},void 0),variant:"outlined"},void 0),(0,n.jsx)(xe.Z,{icon:(0,n.jsx)(be.Z,{},void 0),label:t,clickable:!0,color:`${i===s}`?"secondary":"primary",deleteIcon:(0,n.jsx)(be.Z,{},void 0),variant:"outlined"},void 0)]},void 0)};var Oe=i(15635);const pe=()=>{var e,t;const{rowsTimeline:i,hourmeterStart:u,timeslineExcavator:v,statusTimeslineExcavator:m,statusCreateTimelineTruckListExcavator:h}=(0,l.C)(d.tH),g=(0,l.T)(),[j]=(0,V.R)(),{formValuesBtn:f}=(0,l.C)(r.k3),[x]=(0,z.l)(j),[b,E]=(0,a.useState)(!1),[O,p]=(0,a.useState)(ie.EnumEvent.UNKNOWN_STATE_EVENT),[S]=$(v.currentTimelineList,m),[T,N]=(0,a.useState)(!1),[y]=(0,Oe.r)(h);console.log("rowsTimelineex",i);const[C,Z]=(0,te.M)({columnField:"excavator",operatorValue:"contains",value:""}),{value:w}=C;return(0,a.useEffect)((()=>{g((0,d.V)(C))}),[w]),(0,a.useEffect)((()=>{var e,t;(null===(t=null===(e=f.substatus)||void 0===e?void 0:e.event)||void 0===t?void 0:t.id)?N(!1):N(!0)}),[f]),(0,n.jsxs)(s.Z,Object.assign({container:!0,justifyContent:"flex-start",spacing:1,style:{paddingBottom:"20px"},alignItems:"center"},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,style:{width:"20%"}},{children:(0,n.jsxs)(o.Z,Object.assign({sx:{display:"flex",alignItems:"flex-end"}},{children:[(0,n.jsx)(ee.Z,{},void 0),(0,n.jsx)(Q.Z,{id:"input-with-sx",label:"Search ",variant:"standard",name:"value",onChange:Z,fullWidth:!0},void 0)]}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(je,{rowsTimelines:i,setevent:p,setOpenEvent:E},void 0)}),void 0),(0,n.jsx)(s.Z,{item:!0},void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(Ee,{shift:null===(e=S[0])||void 0===e?void 0:e.shift,date:null===(t=S[0])||void 0===t?void 0:t.date},void 0)}),void 0),(0,n.jsx)(c.a,Object.assign({open:b,handleClose:()=>{E(!1)},handleConfirm:()=>{return e=void 0,t=void 0,n=function*(){yield g((0,d.vd)()),!y&&E(!1);const e={shift:0,date:`${x}T00:00`};yield g((0,d.pW)(e))},new((i=void 0)||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}));var e,t,i,n},title:`Excavator to ${P[O]}  `,disabled:T,loading:y},{children:(0,n.jsx)(he,{value:O},void 0)}),void 0)]}),void 0)};var Se=i(94491);const Te=(0,ne.Z)((()=>(0,se.Z)({line:{width:"100%",minWidth:"100px",height:"1px",border:"0",backgroundColor:"rgba(191,128,11,1)",padding:"1px",margin:"5px"},container:{display:"flex",alignItems:"center"},timeline:{display:"flex",flexWrap:"wrap",flexDirection:"column",WebkitUserSelect:"none"},span:{display:"flex",alignSelf:"start",WebkitUserSelect:"none"}}))),Ne=({icon:e})=>{const t=Te();return(0,n.jsxs)("div",Object.assign({className:t.container},{children:[e||(0,n.jsx)(Se.Z,{htmlColor:"#F2BB13"},void 0),(0,n.jsx)(s.Z,{className:t.line},void 0)]}),void 0)},ye=(0,a.createContext)({}),{Provider:Ce}=ye,Ze=({children:e,data:t,setData:i})=>{const s=Te();return(0,n.jsx)(Ce,Object.assign({value:{data:t}},{children:(0,n.jsx)("div",Object.assign({className:s.timeline,onClick:()=>{i()}},{children:e}),void 0)}),void 0)};var we=i(22318);const ke=({title:e})=>{const t=Te();return(0,n.jsx)("div",Object.assign({className:t.span},{children:(0,n.jsx)(we.Z,Object.assign({variant:"button",display:"block",gutterBottom:!0},{children:e}),void 0)}),void 0)},Ae=({title:e,subTitle:t})=>{var i;const{data:s}=(0,a.useContext)(ye);return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)(we.Z,Object.assign({style:{fontSize:".7rem",fontWeight:700,padding:"0 2rem"},variant:"h6",component:"h6"},{children:e||(null===(i=null==s?void 0:s.title)||void 0===i?void 0:i.toString().toLowerCase())}),void 0),(0,n.jsx)("span",Object.assign({style:{color:"rgba(0, 0, 0, 0.54)",padding:"0 2rem"}},{children:t}),void 0)]},void 0)};var Ie=i(28428),Le=i(10150);const De=(0,j.Z)((e=>(0,Le.Z)({container:{display:"flex",flexDirection:"column",flexWrap:"wrap",fontFamily:"inherit"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),paddingBottom:"10px",width:100}})));var Fe=i(95477);const He=e=>{var{loading:t,text:i}=e,s=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["loading","text"]);return(0,n.jsx)(ge.Z,Object.assign({},s,{disabled:t},{children:t?(0,n.jsx)(Fe.Z,{style:{width:"20px",height:"20px"}},void 0):i}),void 0)};const Me=({currentTimeline:e,updateTimeline:t,startDeleteTimeline:i,setFormUpdateTimeline:s,handleGetTimeline:o,loading:r})=>{var d,c,u,v,m;const h=De(),g=(0,l.T)(),j=new Date(1e3*(null===(d=t.initialTime)||void 0===d?void 0:d.seconds)),f=new Date(1e3*(null===(c=t.finalTime)||void 0===c?void 0:c.seconds)),x=`0${j.getHours()}`,b=`0${j.getMinutes()}`,E=`0${f.getHours()}`,O=`0${f.getMinutes()}`,p=`${x.slice(-2)}:${b.slice(-2)}`,S=`${E.slice(-2)}:${O.slice(-2)}`,[T,N]=(0,a.useState)(Object.assign(Object.assign({},t),{initialHourmeter:null===(u=t.initialHourmeter)||void 0===u?void 0:u.toFixed(2),time:p})),[y,C]=(0,a.useState)(!1),[Z,w]=(0,a.useState)(!1);(0,a.useEffect)((()=>{(null==e?void 0:e.hystoryShiftList.at(-1).id)===t.id&&C(!0),(null==e?void 0:e.hystoryShiftList.at(0).id)===t.id&&C(!1)}),[t]),(0,a.useEffect)((()=>{(null==e?void 0:e.hystoryShiftList.at(0).id)===t.id&&w(!0)}),[t]);const k=e=>{N(Object.assign(Object.assign({},T),{[e.target.name]:e.target.value}))},{initialHourmeter:A}=T;return(0,a.useEffect)((()=>(g(s(Object.assign({},T))),()=>{})),[T]),console.log("formUpadateTimeline",T),(0,a.useEffect)((()=>()=>{g(s({})),N({})}),[]),(0,n.jsxs)("div",{children:[(0,n.jsxs)("form",Object.assign({className:h.container,noValidate:!0},{children:[(0,n.jsx)(Q.Z,{id:"date",label:"HOUR",type:"time",name:"time",defaultValue:p,disabled:Z,onChange:k,className:h.textField,InputLabelProps:{shrink:!0,required:!0}},void 0),(0,n.jsx)(Q.Z,{id:"date",label:"HOUR",type:"time",name:"timeEnd",defaultValue:S,disabled:!0,className:h.textField,InputLabelProps:{shrink:!0,required:!0}},void 0),(0,n.jsx)(Q.Z,{id:"date",label:"INITIAL HOURMETER",type:"number",name:"initialHourmeter",disabled:(null===(v=null==t?void 0:t.initialEventState)||void 0===v?void 0:v.event.event.toString())!=ie.EnumEvent.MAINTENANCE.toString(),defaultValue:A,onChange:k,className:h.textField,InputLabelProps:{shrink:!0}},void 0),(0,n.jsx)(Q.Z,{id:"date",label:"END HOURMETER ",type:"number",name:"initialHourmeter",disabled:!0,defaultValue:null===(m=t.finalHourmeter)||void 0===m?void 0:m.toFixed(2),className:h.textField,InputLabelProps:{shrink:!0}},void 0)]}),void 0),y&&(0,n.jsx)(He,{variant:"contained",onClick:()=>{return e=void 0,t=void 0,s=function*(){yield g(i()),yield o()},new((n=void 0)||(n=Promise))((function(i,o){function a(e){try{r(s.next(e))}catch(e){o(e)}}function l(e){try{r(s.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}r((s=s.apply(e,t||[])).next())}));var e,t,n,s},style:{background:"rgb(154, 0, 54)",color:"white",width:"100%"},startIcon:(0,n.jsx)(Ie.Z,{},void 0),loading:r,text:"Delete"},void 0)]},void 0)};var Pe=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const _e=({setClose:e})=>{var t,i;const{statusTimeslineExcavator:o,currentTimeline:r,updateTimeline:u,statusUpdateTimelineExcavator:v}=(0,l.C)(d.tH),m=(0,l.T)(),[h,g]=(0,a.useState)(!1),[j]=J(),[f]=(0,Oe.r)(v),x=(0,a.useCallback)((()=>{g(!1),m((0,d.zX)({}))}),[]),b=(0,a.useCallback)((()=>Pe(void 0,void 0,void 0,(function*(){yield m((0,d.NT)()),m((0,d.zX)({})),o===R.JD.DONE&&(g(!1),e(!1)),yield m((0,d.pW)(j))}))),[]),E=(0,a.useCallback)((()=>Pe(void 0,void 0,void 0,(function*(){m((0,d.zX)({})),o===R.JD.DONE&&(g(!1),e(!1)),yield m((0,d.pW)(j))}))),[]);return(0,n.jsxs)(s.Z,Object.assign({container:!0,alignItems:"flex-end"},{children:[null==r?void 0:r.hystoryShiftList.map((e=>{var t,i,s,o,a,l,r;let c=new Date(1e3*(null===(t=e.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString();return(0,n.jsxs)(Ze,Object.assign({data:e,setData:()=>(e=>{m((0,d.zX)(e)),g(!0)})(e)},{children:[(0,n.jsx)(Ae,{title:(null===(s=null===(i=e.initialEventState)||void 0===i?void 0:i.event)||void 0===s?void 0:s.name)?null===(a=null===(o=e.initialEventState)||void 0===o?void 0:o.event)||void 0===a?void 0:a.name:"",subTitle:(null===(l=e.initialEventState)||void 0===l?void 0:l.name)?null===(r=e.initialEventState)||void 0===r?void 0:r.name.toString().toLowerCase():""},void 0),(0,n.jsx)(Ne,{},void 0),(0,n.jsx)(ke,{title:c.toLocaleString().split(" ")[1].substring(0,c.split(" ")[1].length-3)},void 0)]}),e.id+Math.random())})),(0,n.jsx)(c.a,Object.assign({open:h,handleClose:x,handleConfirm:b,title:`Update Timeline ${new Date(1e3*(null===(t=u.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString().split(" ")[1].substring(0,new Date(1e3*(null===(i=u.initialTime)||void 0===i?void 0:i.seconds)).toLocaleString().split(" ")[1].length-3)}`,loading:f},{children:(0,n.jsx)(Me,{currentTimeline:r,updateTimeline:u,startDeleteTimeline:d.T1,setFormUpdateTimeline:d.mP,handleGetTimeline:E},void 0)}),void 0)]}),void 0)},Re=(e,t)=>{const i=Number.parseFloat(e)+Number.parseFloat(t);return Number.parseFloat(i.toFixed(2))},$e=({setstateform:e,isDisabled:t,setisManto:i,handleIsManto:s})=>{const{eventList:o}=(0,l.C)(I.yJ),r=(0,l.T)(),[d,c]=(0,a.useState)({status:ie.EnumEvent.UNKNOWN_STATE_EVENT,Substatus:{id:"",name:"",eventState:0,event:{id:"",name:"",event:0}}}),u=e=>{d.status!=ie.EnumEvent.MAINTENANCE?c(Object.assign(Object.assign({},d),{[e.target.name]:e.target.value})):c(Object.assign(Object.assign({},d),{[e.target.name]:e.target.value}))},v=()=>{c(Object.assign(Object.assign({},d),{Substatus:{id:"",name:"",eventState:0,event:{id:"",name:"",event:0}}})),i(!1)},[m]=(e=>{const[t,i]=(0,a.useState)(!0),[n,s]=(0,a.useState)(!0),[o,l]=(0,a.useState)(!0),[r,d]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{e.toString()===ie.EnumEvent.OPERATIONAL.toString()&&(i(!1),l(!1),d(!1),s(!0)),e.toString()===ie.EnumEvent.UNKNOWN_STATE_EVENT.toString()&&(i(!1),s(!1),l(!1),d(!1)),e.toString()===ie.EnumEvent.NO_OPERATIONAL.toString()&&(d(!1),s(!1),l(!1),i(!0)),e.toString()===ie.EnumEvent.OPERATIONAL_DELAY.toString()&&(s(!1),l(!0),i(!0),d(!0)),e.toString()===ie.EnumEvent.MAINTENANCE.toString()&&(i(!1),s(!1),l(!0),d(!0))}),[e]),[e=>{var i=!1;return e===ie.EnumEvent.OPERATIONAL_DELAY&&(i=o),e===ie.EnumEvent.OPERATIONAL&&(i=n),e===ie.EnumEvent.NO_OPERATIONAL&&(i=t),e===ie.EnumEvent.MAINTENANCE&&(i=r),i}]})(t);return(0,a.useEffect)((()=>{e(d)}),[d]),(0,a.useEffect)((()=>{r((0,A.TU)())}),[]),(0,n.jsxs)(oe.Z,Object.assign({component:"fieldset"},{children:[(0,n.jsx)(ae.Z,Object.assign({component:"legend"},{children:"choice"}),void 0),(0,n.jsx)(le.Z,Object.assign({defaultValue:"female","aria-label":"hourmeter",name:"customized-radios"},{children:null==o?void 0:o.map((e=>(null==e?void 0:e.event.toString())===ie.EnumEvent.MAINTENANCE.toString()?(0,n.jsx)(re.Z,{value:null==e?void 0:e.event,control:(0,n.jsx)(de.Z,{icon:(0,n.jsx)(ce.Z,{},void 0),checkedIcon:(0,n.jsx)(ce.Z,{},void 0),name:"status",onClick:()=>s(),onChange:u,checked:d.status.toString()===(null==e?void 0:e.event.toString()),disabled:m(null==e?void 0:e.event)},void 0),label:null==e?void 0:e.name},null==e?void 0:e.id):(0,n.jsx)(re.Z,{value:null==e?void 0:e.event,onClick:v,control:(0,n.jsx)(de.Z,{icon:(0,n.jsx)(ce.Z,{},void 0),checkedIcon:(0,n.jsx)(ce.Z,{},void 0),name:"status",checked:d.status.toString()===(null==e?void 0:e.event.toString()),disabled:m(null==e?void 0:e.event),onClick:v,onChange:u},void 0),label:null==e?void 0:e.name},null==e?void 0:e.id)))}),void 0)]}),void 0)},Ue=({currentTimeline:e})=>{var t,i,o,d,c;const u=De(),v=(0,l.T)(),[m,h]=(0,a.useState)(0),[g,j]=(0,a.useState)(!1),f=new Date,x=`0${f.getHours()}`,b=`0${f.getMinutes()}`,[E,O]=(0,a.useState)({time:`${x.slice(-2)}:${b.slice(-2)}`,hourmeterEnd:0===(null==e?void 0:e.hystoryShiftList.length)?0:null===(t=null==e?void 0:e.hystoryShiftList)||void 0===t?void 0:t.at(-1).initialHourmeter.toFixed(1),htm:0,status:ie.EnumEvent.UNKNOWN_STATE_EVENT,Substatus:{id:"",name:"",eventState:ie.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:ie.EnumEvent.UNKNOWN_STATE_EVENT}},currentTimeline:e}),[p]=(0,z.l)(new Date),S=(null===(o=null===(i=null==e?void 0:e.eventState)||void 0===i?void 0:i.event)||void 0===o?void 0:o.event)?null===(c=null===(d=null==e?void 0:e.eventState)||void 0===d?void 0:d.event)||void 0===c?void 0:c.event:ie.EnumEvent.UNKNOWN_STATE_EVENT,{time:T,hourmeterEnd:N}=E,y=function(e,t){var i,n;if(0===(null==t?void 0:t.hystoryShiftList.length))return 0;{const o=null===(i=null==t?void 0:t.hystoryShiftList)||void 0===i?void 0:i.at(-1),a=new Date(e),l=new Date(1e3*(null===(n=null==o?void 0:o.initialTime)||void 0===n?void 0:n.seconds));var s=(a.getTime()-l.getTime())/1e3;return 1/60*Math.ceil(s/60)}}(`${p}T${T}`,e),[C,Z]=(0,a.useState)({id:"",name:"",eventState:0,event:{id:"",name:"",event:0}}),[w,k]=(0,a.useState)({}),A=e=>{E.status!=ie.EnumEvent.MAINTENANCE?O(Object.assign(Object.assign({},E),{[e.target.name]:e.target.value})):O(Object.assign(Object.assign({},E),{[e.target.name]:e.target.value}))};return(0,a.useEffect)((()=>(v((0,r.$6)(E)),()=>{})),[E]),console.log("form",E),(0,a.useEffect)((()=>(h(Re(N,y)),()=>{v((0,r.J$)())})),[]),(0,a.useEffect)((()=>{var t,i;(null==e?void 0:e.state.toString())===ie.EnumEvent.UNKNOWN_STATE_EVENT.toString()?h(N):(null===(i=null===(t=null==e?void 0:e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event.toString())===ie.EnumEvent.NO_OPERATIONAL.toString()?h(null==e?void 0:e.hourmeterCurrent):h(Re(N,y)),E.status!=ie.EnumEvent.MAINTENANCE&&O(Object.assign(Object.assign({},E),{htm:m}))}),[T]),(0,a.useEffect)((()=>{O(Object.assign(Object.assign({},E),{Substatus:Object.assign({},C)}))}),[C]),(0,a.useEffect)((()=>{O(Object.assign(Object.assign({},E),w))}),[w]),(0,a.useEffect)((()=>{setTimeout((()=>{O(Object.assign(Object.assign({},E),{htm:m}))}),100)}),[m]),(0,n.jsxs)("div",{children:[(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:1},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:12},{children:(0,n.jsxs)("form",Object.assign({className:u.container,noValidate:!0},{children:[(0,n.jsx)(Q.Z,{id:"date",label:"HOUR",type:"time",name:"time",value:T,onChange:A,className:u.textField,InputLabelProps:{shrink:!0,required:!0}},void 0),(0,n.jsx)(Q.Z,{id:"date",label:"HOURMETER",type:"number",disabled:!0,name:"hourmeterCalculated",value:m,onChange:A,className:u.textField,InputLabelProps:{shrink:!0}},void 0),(S===ie.EnumEvent.MAINTENANCE||g)&&(0,n.jsx)(Q.Z,{autoFocus:!0,id:"date",label:"HOURMETER Start",type:"number",name:"htm",defaultValue:m,onChange:A,className:u.textField,InputLabelProps:{shrink:!0,required:!0}},void 0)]}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:12},{children:(0,n.jsx)($e,{setstateform:k,isDisabled:S,setisManto:j,handleIsManto:e=>{j(!0),O(Object.assign(Object.assign({},E),{htm:m,status:ie.EnumEvent.MAINTENANCE,Substatus:{id:"",name:"",eventState:ie.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:ie.EnumEvent.UNKNOWN_STATE_EVENT}}}))}},void 0)}),void 0)]}),void 0),(0,n.jsx)(s.Z,Object.assign({container:!0,spacing:2},{children:!!E.status&&(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,sm:12,xs:12},{children:(0,n.jsx)(ve,{setEventState:Z,event:E.status},void 0)}),void 0)}),void 0)]},void 0)},We=e=>{const[t,i]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{var t,n;e.status&&(null===(n=null===(t=e.Substatus)||void 0===t?void 0:t.event)||void 0===n?void 0:n.id)?i(!1):i(!0)}),[e.status,e.Substatus]),[t]};var Ve=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const ze=()=>{const e=(0,l.T)(),{timelineErrorList:t,currentTimeline:i,statusCreateTimelineExcavator:u}=(0,l.C)(d.tH),{formValues:v}=(0,l.C)(r.k3),[m]=J(),[g,j]=(0,a.useState)(!1),[f,x]=(0,a.useState)(!1),[b]=We(v),[E,O]=(0,a.useState)([]),[p]=(0,Oe.r)(u),S=(0,a.useCallback)((()=>{j(!1),x(!1)}),[]);return(0,a.useEffect)((()=>(e((0,d.pW)(m)),()=>{})),[]),(0,a.useEffect)((()=>{e((0,d.gc)(E))}),[E]),(0,n.jsxs)(o.Z,Object.assign({m:2,p:.5,style:{height:"100%"}},{children:[(0,n.jsx)(s.Z,{children:(0,n.jsx)(pe,{},void 0)},void 0),(0,n.jsx)(s.Z,Object.assign({container:!0,style:{height:"100%"}},{children:(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,sm:12,xs:12},{children:(0,n.jsx)(q,{setOpen:j,setTimelineCurrent:O,setOpenTimeline:x},void 0)}),void 0)}),void 0),(0,n.jsx)(c.a,Object.assign({open:g,handleClose:S,handleConfirm:()=>Ve(void 0,void 0,void 0,(function*(){yield e((0,d.SN)()),!p&&j(!1),yield function(){return Ve(this,void 0,void 0,(function*(){yield e((0,d.pW)(m))}))}()})),title:`Excavator  ${E.deviceAlias}  `,disabled:b,loading:p},{children:(0,n.jsx)(Ue,{currentTimeline:i},void 0)}),void 0),(0,n.jsx)(c.a,Object.assign({open:f,handleClose:S,title:`Timeline to  ${E.deviceAlias} `,disabled:b},{children:(0,n.jsx)(_e,{setClose:x},void 0)}),void 0),!(null==t?void 0:t.success)&&(0,n.jsx)(h,{error:null==t?void 0:t.errorsList},void 0)]}),void 0)};var Ke=i(19225),Je=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const Be=({setClose:e})=>{var t,i;const{status:o,currentTimeline:r,updateTimeline:d,statusUpdateTimeline:u,statusDeleteTimeline:v}=(0,l.C)(Ke.rf),m=(0,l.T)(),[h,g]=(0,a.useState)(!1),[j]=(0,V.R)(),[f]=(0,z.l)(j),[x]=(0,Oe.r)(u),[b]=(0,Oe.r)(v),[E]=J(),O=(0,a.useCallback)((()=>{g(!1),m((0,Ke.Uy)({}))}),[]),p=(0,a.useCallback)((()=>Je(void 0,void 0,void 0,(function*(){yield m((0,Ke.ft)()),m((0,Ke.Uy)({})),!1===x&&(g(!1),e(!1),yield m((0,Ke.mA)(E)))}))),[]),S=(0,a.useCallback)((()=>Je(void 0,void 0,void 0,(function*(){yield m((0,Ke.Uy)({})),!1===b&&(g(!1),e(!1),yield m((0,Ke.mA)(E)))}))),[]);return(0,n.jsxs)(s.Z,Object.assign({container:!0,alignItems:"flex-end"},{children:[null==r?void 0:r.hystoryShiftList.map((e=>{var t,i,s,o,a,l,r;let d=new Date(1e3*(null===(t=e.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString();return(0,n.jsxs)(Ze,Object.assign({data:e,setData:()=>(e=>{m((0,Ke.Uy)(e)),g(!0)})(e)},{children:[(0,n.jsx)(Ae,{title:(null===(s=null===(i=null==e?void 0:e.initialEventState)||void 0===i?void 0:i.event)||void 0===s?void 0:s.name)?null===(a=null===(o=null==e?void 0:e.initialEventState)||void 0===o?void 0:o.event)||void 0===a?void 0:a.name:null,subTitle:(null===(l=null==e?void 0:e.initialEventState)||void 0===l?void 0:l.name)?`${null===(r=null==e?void 0:e.initialEventState)||void 0===r?void 0:r.name.toString().toLowerCase()}`:""},void 0),(0,n.jsx)(Ne,{},void 0),(0,n.jsx)(ke,{title:d.toLocaleString().split(" ")[1].substring(0,d.split(" ")[1].length-3)},void 0)]}),e.id+Math.random())})),(0,n.jsx)(c.a,Object.assign({open:h,handleClose:O,handleConfirm:p,title:`Update  ${new Date(1e3*(null===(t=d.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString().split(" ")[1].substring(0,new Date(1e3*(null===(i=d.initialTime)||void 0===i?void 0:i.seconds)).toLocaleString().split(" ")[1].length-3)}`,loading:x},{children:(0,n.jsx)(Me,{currentTimeline:r,updateTimeline:d,startDeleteTimeline:Ke.a8,setFormUpdateTimeline:Ke.Zp,handleGetTimeline:S,loading:b},void 0)}),void 0)]}),void 0)},Ge=(e,t)=>{const[i,n]=(0,a.useState)([]);return(0,a.useEffect)((()=>{t===R.JD.DONE?n(null==e?void 0:e.map((e=>{var t,i,n,s,o,a,l,r,d,c,u,v,m,h,g,j;return Object.assign(Object.assign({},e),{id:e.deviceId,truck:e.deviceAlias,status:`${(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.name)?null===(s=null===(n=e.eventState)||void 0===n?void 0:n.event)||void 0===s?void 0:s.name.substring(0,3):""}  ${(null===(o=e.eventState)||void 0===o?void 0:o.name)?` - ${null===(a=e.eventState)||void 0===a?void 0:a.name.toString().toLowerCase()}`:""}`,statusEvent:null===(r=null===(l=e.eventState)||void 0===l?void 0:l.event)||void 0===r?void 0:r.event,hmtStart:null===(d=e.hystoryShiftList[0])||void 0===d?void 0:d.initialHourmeter.toFixed(2),hourmeterCurrent:null===(c=e.hystoryShiftList.at(-1))||void 0===c?void 0:c.initialHourmeter.toFixed(2),shift:_[null===(u=e.currentTimeline)||void 0===u?void 0:u.shift],date:new Date(1e3*(null===(m=null===(v=e.currentTimeline)||void 0===v?void 0:v.shiftDate)||void 0===m?void 0:m.seconds)).toLocaleDateString(),adjustment:(null===(h=e.currentTimeline)||void 0===h?void 0:h.adjustment)?e.currentTimeline.adjustment:0,statusAdjustment:!!(null===(g=e.currentTimeline)||void 0===g?void 0:g.status)&&(null===(j=e.currentTimeline)||void 0===j?void 0:j.status)})}))):n([])}),[e,t]),[i]};var Ye=i(53375);const Xe=()=>{const{timesline:e,rowsEditModelHourmeterTruck:t,isCheckFinalizeTruck:i}=(0,l.C)(Ke.rf),{timeslineExcavator:s,rowsEditModelHourmeterExcavator:o,isCheckFinalizeExcavator:r}=(0,l.C)(d.tH),{currentTimelineList:c}=e,u=(0,l.T)(),[v,m]=(0,a.useState)(!0),[h]=(0,V.R)();return(0,a.useEffect)((()=>{c.some((e=>{var t;return!1===(null===(t=e.currentTimeline)||void 0===t?void 0:t.status)}))||s.currentTimelineList.some((e=>{var t;return!1===(null===(t=e.currentTimeline)||void 0===t?void 0:t.status)}))?m(!0):c.length===(null==t?void 0:t.length)&&s.currentTimelineList.length===(null==o?void 0:o.length)?m(!1):m(!0)}),[c,t,o,s]),(0,n.jsx)(ge.Z,Object.assign({onClick:()=>{return e=void 0,t=void 0,n=function*(){yield u((0,Ke.nx)()),yield u((0,d.Qc)()),window.localStorage.removeItem("hourmeterTruck"),window.localStorage.removeItem("hourmeterExcavator"),u((0,Ke.zq)()),u((0,d.jF)()),location.reload()},new((i=void 0)||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}));var e,t,i,n},disabled:v,startIcon:(0,n.jsx)(Ye.Z,{},void 0),variant:"outlined",color:"primary",size:"small"},{children:"Close Shift"}),void 0)};const qe=()=>{var e,t;const{rowsTimeline:i,timesline:d,status:u,statusCreateTimelineTruckListtruck:v}=(0,l.C)(Ke.rf),{formValuesBtn:m}=(0,l.C)(r.k3),h=(0,l.T)(),[g]=(0,V.R)(),[j]=Ge(d.currentTimelineList,u),[f]=(0,z.l)(g),[x,b]=(0,a.useState)(!1),[E,O]=(0,a.useState)(ie.EnumEvent.UNKNOWN_STATE_EVENT),[p,S]=(0,a.useState)(!1),[T]=(0,Oe.r)(v),[N,y]=(0,te.M)({columnField:"truck",operatorValue:"contains",value:""}),{value:C}=N;return(0,a.useEffect)((()=>{h((0,Ke.V)(N))}),[C]),(0,a.useEffect)((()=>{var e,t;(null===(t=null===(e=m.substatus)||void 0===e?void 0:e.event)||void 0===t?void 0:t.id)?S(!1):S(!0)}),[m]),(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:1,justifyContent:"flex-start",style:{paddingBottom:"20px"},alignItems:"center"},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,style:{width:"20%"}},{children:(0,n.jsxs)(o.Z,Object.assign({sx:{display:"flex",alignItems:"flex-end"}},{children:[(0,n.jsx)(ee.Z,{},void 0),(0,n.jsx)(Q.Z,{id:"input-with-sx",label:"Search ",variant:"standard",name:"value",onChange:y,fullWidth:!0},void 0)]}),void 0)}),void 0),(0,n.jsx)(je,{rowsTimelines:i,setevent:O,setOpenEvent:b},void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(Xe,{},void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(Ee,{shift:null===(e=j[0])||void 0===e?void 0:e.shift,date:null===(t=j[0])||void 0===t?void 0:t.date},void 0)}),void 0),(0,n.jsx)(c.a,Object.assign({open:x,handleClose:()=>{b(!1)},handleConfirm:()=>{return e=void 0,t=void 0,n=function*(){yield h((0,Ke._C)()),!T&&b(!1);const e={shift:0,date:`${f}T00:00`};yield h((0,Ke.mA)(e))},new((i=void 0)||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}));var e,t,i,n},title:`Truck to ${P[E]}  `,disabled:p,loading:T},{children:(0,n.jsx)(he,{value:E},void 0)}),void 0)]}),void 0)};function Qe(){const[e]=L(),[t,i]=a.useState(null),s=Boolean(t),[o]=D(Ke.V,i);return(0,n.jsxs)("div",{children:[(0,n.jsx)(T.Z,Object.assign({style:{padding:"0px",margin:"0px"},"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:e=>{i(e.currentTarget)}},{children:(0,n.jsx)(k.Z,{},void 0)}),void 0),(0,n.jsx)(Z.Z,Object.assign({id:"long-menu",anchorEl:t,keepMounted:!0,open:s,onClose:()=>o("NONE"),PaperProps:{style:{maxHeight:216,width:"20ch"}}},{children:e.map((e=>(0,n.jsx)(w.Z,Object.assign({onClick:()=>o(e.event.toString())},{children:e.name}),e.name)))}),void 0)]},void 0)}const et=(e,t,i,s)=>[Object.assign(Object.assign({},g.mf9),{width:60,renderHeader:e=>(0,n.jsx)(S.ZP,Object.assign({title:"Select all"},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex",padding:"0px",margin:"0px"}},{children:[(0,n.jsx)(g.KOw,Object.assign({},e),void 0),(0,n.jsx)(Qe,{},void 0)]}),void 0)}),void 0)}),{field:"truck",headerName:"Truck",hideSortIcons:!0},{field:"shift",headerName:"shift",hideSortIcons:!0,width:60},{field:"statusEvent",headerName:"statusEvent",type:"string",hide:!0},{field:"status",headerName:"Status",width:100,hideSortIcons:!0,renderCell:({row:e})=>(0,n.jsx)(S.ZP,Object.assign({title:e.status},{children:(0,n.jsx)("p",{children:e.status},void 0)}),void 0)},{field:"hmtStart",headerName:"Hourmeter",editable:!1,type:"number",hideSortIcons:!0},{field:"hourmeterCurrent",headerName:"hourmeter Current",editable:!s,type:"number",hideSortIcons:!0},{field:"hourmeterFinal",headerName:"hourmeter Final",editable:!0,type:"number",hideSortIcons:!0,cellClassName:e=>(0,N.Z)("Mui-error",{positive:e.value>0,negative:e.value<=0||0===e.value})},{field:"adjustment",headerName:"adjustment",type:"number",hideSortIcons:!0},{field:"Opciones",headerName:"Opc",minWidth:110,hideSortIcons:!0,renderCell:({row:s})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.ZP,Object.assign({onClick:()=>{t(s),e(!0)},title:"Add timeline"},{children:(0,n.jsx)(T.Z,Object.assign({size:"small"},{children:(0,n.jsx)(C.Z,{color:"primary",fontSize:"small"},void 0)}),void 0)}),void 0),(0,n.jsx)(S.ZP,Object.assign({onClick:()=>{t(s),i(!0)},title:"View Timeline"},{children:(0,n.jsx)(T.Z,Object.assign({size:"small"},{children:(0,n.jsx)(y.Z,{htmlColor:"Green",fontSize:"small"},void 0)}),void 0)}),void 0)]},void 0)}];let tt;const it=a.memo((({setOpen:e,setTimelineCurrent:t,setOpenTimeline:i})=>{const s=p(),o=(0,l.T)(),{status:r,filterDataGrid:d,statusUpdateInitialHourmeterTimeline:c,isEditableRows:u,timesline:v}=(0,l.C)(Ke.rf),[m]=Ge(v.currentTimelineList,r),[h,j]=(0,U._)("hourmeterTruck",null),[f,x]=(0,a.useState)(!0),[b,E]=a.useState([]),{sortModel:O}=M("truck","asc"),[S]=J(),[T,N]=(0,a.useState)(Object.assign({},h));return(0,a.useEffect)((()=>{setTimeout((()=>{N(Object.assign({},h))}),3e3)}),[]),(0,a.useEffect)((()=>{o((0,Ke.H3)(T))}),[T]),(0,a.useEffect)((()=>{R.JD.DONE,N({})}),[c]),(0,a.useEffect)((()=>{r===R.JD.DONE||r===R.JD.ERROR?x(!1):x(!0)}),[r]),(0,a.useEffect)((()=>()=>{o((0,Ke.gI)())}),[]),(0,n.jsx)("div",Object.assign({style:{height:"1150px",overflowY:"scroll",display:"flex",flexDirection:"column"}},{children:(0,n.jsx)(g._$r,{className:s.root,rowHeight:30,rows:m,columns:et(e,t,i,u),density:"compact",checkboxSelection:!0,disableSelectionOnClick:!0,sortModel:O,onSelectionModelChange:e=>(e=>{const t=new Set(e),i=m.filter((e=>t.has(e.id.toString())));o((0,Ke.Xm)(i))})(e),disableColumnMenu:!0,editRowsModel:T,onEditRowsModelChange:e=>(e=>{var t="";for(var[i,n]of Object.entries(e))Object.keys(n).length<=1&&Object.keys(n).forEach((e=>{t=e}));var s=Object.assign({},e);switch(t){case"hourmeterCurrent":N(Object.assign(Object.assign({},T),s));break;case"hmtStart":Y(s,N,Ke.SZ);break;case"hourmeterFinal":clearTimeout(tt),G(s,e,h,N,T,j);var a=!1;for(var[l,n]of Object.entries(e))void 0===s[l].hourmeterFinal.value&&(a=!0);a||s&&m[0].currentTimeline.shift!=K.Shift.UNKNOWN_SHIFT&&(tt=setTimeout((()=>{o((0,Ke.tj)()),setTimeout((()=>{o((0,Ke.mA)(S))}),100)}),2e3));break;default:console.log("case default")}})(e),filterModel:{items:[d]},getRowClassName:e=>`super-app-theme--${e.row.statusAdjustment}`},void 0)}),void 0)}));var nt=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const st=()=>{const e=(0,l.T)(),{status:t,timelineErrorList:i,currentTimeline:d,statusCreateTimeline:u}=(0,l.C)(Ke.rf),{formValues:v}=(0,l.C)(r.k3),[m]=J(),[g,j]=(0,a.useState)(!1),[f,x]=(0,a.useState)(!1),[b]=We(v),[E,O]=(0,a.useState)([]),[p]=(0,Oe.r)(u),S=(0,a.useCallback)((()=>{j(!1),x(!1)}),[]);return(0,a.useEffect)((()=>(e((0,Ke.mA)(m)),()=>{e((0,Ke.gI)())})),[]),(0,a.useEffect)((()=>{e((0,Ke.jO)(E))}),[E]),(0,n.jsxs)(o.Z,Object.assign({m:2,p:.5,style:{height:"100%"}},{children:[(0,n.jsx)(s.Z,{children:(0,n.jsx)(qe,{},void 0)},void 0),(0,n.jsx)(s.Z,Object.assign({container:!0,style:{height:"100%"}},{children:(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,sm:12,xs:12},{children:(0,n.jsx)(it,{setOpen:j,setTimelineCurrent:O,setOpenTimeline:x},void 0)}),void 0)}),void 0),(0,n.jsx)(c.a,Object.assign({open:g,handleClose:S,handleConfirm:()=>nt(void 0,void 0,void 0,(function*(){yield e((0,Ke.Sp)()),!p&&j(!1),yield function(){return nt(this,void 0,void 0,(function*(){yield e((0,Ke.mA)(m))}))}()})),title:`Truck  ${E.truck}  `,disabled:b,loading:p},{children:(0,n.jsx)(Ue,{currentTimeline:d},void 0)}),void 0),(0,n.jsx)(c.a,Object.assign({open:f,handleClose:S,title:`Timeline to  ${E.truck} `,disabled:b,maxWidth:"lg"},{children:(0,n.jsx)(Be,{setClose:x},void 0)}),void 0),t===R.JD.DONE&&!(null==i?void 0:i.success)&&(0,n.jsx)(h,{error:null==i?void 0:i.errorsList},void 0)]}),void 0)},ot=()=>(0,n.jsx)("div",{children:(0,n.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:7},{children:(0,n.jsx)(st,{},void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:5},{children:(0,n.jsx)(ze,{},void 0)}),void 0)]}),void 0)},void 0);var at=i(16281);const lt=()=>(0,n.jsxs)("div",{children:[(0,n.jsx)(at.h,{title:"Hourmeter",notificationPannel:!0},void 0),(0,n.jsx)(ot,{},void 0)]},void 0),rt=lt},16281:(e,t,i)=>{"use strict";i.d(t,{h:()=>p});var n=i(85893),s=i(45258),o=i(28358),a=i(282),l=i(22318),r=i(43471),d=i(5977),c=i(55517),u=i(17812),v=i(96617),m=i(73637),h=i(79895),g=i(16575),j=i(51972),f=i(67294),x=i(73855),b=i(45855);const E=({title:e,content:t})=>(0,n.jsxs)("div",{children:[(0,n.jsxs)(l.Z,Object.assign({variant:"subtitle1"},{children:[(0,n.jsx)(g.Z,{style:{fontSize:"14px",marginRight:"4px"}},void 0),e]}),void 0),(0,n.jsx)(l.Z,Object.assign({variant:"body1"},{children:t}),void 0),(0,n.jsx)(c.Z,{},void 0)]},void 0),O=({})=>{var e,t,i;const[s,o]=(0,f.useState)(null),[a,r]=(0,f.useState)(!1),{notificationsHeader:d}=(0,x.C)(b.Af),c=(0,x.T)();(0,f.useEffect)((()=>{c((0,b.pK)())}),[]);const g=a&&Boolean(s)?"transition-popper":void 0;return console.log("notificationsHeader.notificationsList",d.notificationsList),(0,n.jsxs)("div",Object.assign({style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",width:"8%",marginRight:"4px"}},{children:[(0,n.jsx)(u.Z,Object.assign({color:(null===(e=d.notificationsList)||void 0===e?void 0:e.length)>0?"primary":"inherit",onClick:e=>{o(e.currentTarget),r((e=>!e))},size:"small"},{children:(0,n.jsxs)("div",Object.assign({style:{margin:"4px"}},{children:[(0,n.jsx)(l.Z,Object.assign({variant:"subtitle2",style:{color:"white",zIndex:1,position:"absolute",justifyContent:"right",marginLeft:"18px"}},{children:(null===(t=d.notificationsList)||void 0===t?void 0:t.length)>0?null===(i=d.notificationsList)||void 0===i?void 0:i.length:""}),void 0),(0,n.jsx)(j.Z,{},void 0)]}),void 0)}),void 0),(0,n.jsx)("div",Object.assign({style:{zIndex:1}},{children:(0,n.jsx)(v.Z,Object.assign({id:g,open:a,anchorEl:s,transition:!0,style:{zIndex:3}},{children:({TransitionProps:e})=>{var t,i,s;return(0,n.jsx)(m.Z,Object.assign({},e,{timeout:350},{children:(0,n.jsxs)(h.Z,Object.assign({elevation:3,style:{width:"300px",height:(null===(t=d.notificationsList)||void 0===t?void 0:t.length)>10?"87vh":"100%",padding:"8px",overflow:"scroll"}},{children:[(!d.notificationsList||0===(null===(i=d.notificationsList)||void 0===i?void 0:i.length))&&(0,n.jsx)(n.Fragment,{children:"Not Have a new Notification"},void 0),null===(s=d.notificationsList)||void 0===s?void 0:s.map(((e,t)=>(0,n.jsx)(E,{title:e.title,content:e.message},t)))]}),void 0)}),void 0)}}),void 0)}),void 0)]}),void 0)},p=({title:e,positionContainer:t,notificationPannel:i})=>{const c=t||"sticky",u=(0,d.k6)();return(0,n.jsx)(s.Z,Object.assign({position:c,color:"secondary",style:{display:"flex"},elevation:0},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex"}},{children:[(0,n.jsxs)(o.Z,Object.assign({variant:"dense",style:{width:"90%"}},{children:[(0,n.jsx)(a.Z,{size:"small",startIcon:(0,n.jsx)(r.Z,{color:"action",style:{color:"#fff"}},void 0),onClick:()=>{u.goBack()}},void 0),(0,n.jsx)(l.Z,Object.assign({variant:"h6"},{children:e}),void 0)]}),void 0),i&&(0,n.jsx)(O,{},void 0)]}),void 0)}),void 0)}},85343:(e,t,i)=>{var n=i(33019),s=Function("return this")();n.exportSymbol("proto.pb.Shift",null,s),proto.pb.Shift={UNKNOWN_SHIFT:0,NIGHT:1,DAY:2,BOTH:3},n.object.extend(t,proto.pb)}}]);