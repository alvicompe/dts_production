(self.webpackChunkdts_hytera=self.webpackChunkdts_hytera||[]).push([[408],{2499:(e,t,i)=>{e.exports=i.p+"322f531ddb14529b83bd73182d28de44.png"},7126:(e,t,i)=>{e.exports=i.p+"89f059a2790e391b484a369a3b9f92fb.png"},9091:(e,t,i)=>{e.exports=i.p+"20557549695e4a02b8f5e299c9687642.png"},9800:(e,t,i)=>{"use strict";i.d(t,{H:()=>a});const a=e=>{e.current.loadImage(i(9091),(function(t,i){if(t)throw t;e.current.addImage("truck_nav",i)})),e.current.loadImage(i(2499),(function(t,i){if(t)throw t;e.current.addImage("excavator_nav",i)})),e.current.loadImage(i(7126),(function(t,i){if(t)throw t;e.current.addImage("pickup_nav",i)}))}},6886:(e,t,i)=>{"use strict";i.d(t,{N:()=>n});var a=i(5893),o=i(7294);const n=({excavatorListClass:e,excavatorList:t})=>((0,o.useEffect)((()=>{e.addToMap()}),[]),(0,o.useEffect)((()=>{e.updateInMap()}),[t]),(0,a.jsx)(a.Fragment,{},void 0))},2837:(e,t,i)=>{"use strict";i.d(t,{b:()=>s});var a=i(5893),o=i(7294),n=i(6777);const s=({truckListClass:e,truckList:t})=>(n.ET,(0,o.useEffect)((()=>{e.addToMap()}),[]),(0,o.useEffect)((()=>{e.updateInMap()}),[t]),(0,a.jsx)(a.Fragment,{},void 0))},4248:(e,t,i)=>{"use strict";i.d(t,{f:()=>n});var a=i(7294),o=i(2573);const n=({polygonList:e,idSource:t,idLayer:i,idSourceCentroid:n,idLayerCentroid:s,map:r,haveCentroid:l,onClickFeature:c})=>((0,a.useEffect)((()=>{const a=new o.z(e,r,t,i,n,s,c,l);return a.addToMap(),()=>{a.removeOfMap()}}),[e]),null)},1242:(e,t,i)=>{"use strict";i.d(t,{a:()=>d});var a=i(5893),o=i(2663),n=i(6083),s=i(9525),r=i(6856),l=i(282),c=i(8715);const d=({open:e,handleClose:t,handleConfirm:i,title:d,message:u})=>(0,a.jsxs)(o.Z,Object.assign({open:e,onClose:t,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},{children:[(0,a.jsx)(n.Z,{children:d},void 0),(0,a.jsx)(s.Z,{children:(0,a.jsx)(c.Z,Object.assign({severity:"warning"},{children:u}),void 0)},void 0),(0,a.jsxs)(r.Z,{children:[(0,a.jsx)(l.Z,Object.assign({color:"primary",onClick:t},{children:"Cancelar"}),void 0),(0,a.jsx)(l.Z,Object.assign({color:"secondary",onClick:i,autoFocus:!0},{children:"Confirmar"}),void 0)]},void 0)]}),void 0)},4250:(e,t,i)=>{"use strict";i.d(t,{Z:()=>u});var a=i(5893),o=i(7294),n=i(1120),s=i(7623),r=i(8920),l=i(6211),c=i(3758);const d=(0,n.Z)((e=>(0,s.Z)({fab:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2),zIndex:2}})));function u({actionClick:e,Icon:t,visible:i,disabled:n,right:s,color:u,keyAction:p}){const v=d(),g=(0,r.Z)();(0,o.useEffect)((()=>{const t=t=>{console.log(t.key),t.key!==(null==p?void 0:p.toUpperCase())&&t.key!==(null==p?void 0:p.toLocaleLowerCase())&&t.key!==p||e()};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}}),[]);const m={enter:g.transitions.duration.enteringScreen,exit:g.transitions.duration.leavingScreen};return(0,a.jsx)(l.Z,Object.assign({in:i,timeout:m,unmountOnExit:!0},{children:(0,a.jsx)(c.Z,Object.assign({disabled:n,onClick:e,className:v.fab,style:{right:s},size:"small",color:u||"primary"},{children:(0,a.jsx)(t,{},void 0)}),void 0)}),void 0)}},8101:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var a=i(5893),o=i(7294),n=i(4880);const s=i(6158);s.accessToken=n.c3;const r=({dragRotate:e,map:t,pitch:i,bearing:n,mapContainer:r,lng:l,lat:c,zoom:d,setLoad:u,style:p,height:v})=>((0,o.useEffect)((()=>{console.log("map.current",t.current,n),t.current||(r&&(t.current=new s.Map({container:r.current,style:p,center:[l,c],pitch:i,bearing:n,zoom:d,maxBounds:[[-78.2747922,-7.6626779],[-78.1305246,-7.5534415]],antialias:!0,dragRotate:e})),console.log("inianco"))}),[t,r]),(0,o.useEffect)((()=>{t.current&&(t.current.addControl(new s.FullscreenControl,"bottom-left"),t.current.addControl(new s.NavigationControl,"bottom-left"),t.current.on("move",(()=>{})),t.current.on("load",(()=>{t.current&&u(!0)})))}),[t]),(0,o.useEffect)((()=>{t.current&&t.current.setBearing(n)}),[n]),(0,a.jsx)("div",{ref:r,style:{flex:1,height:v||"100vh",width:"100%"},className:"map-container"},void 0))},3570:(e,t,i)=>{"use strict";i.d(t,{v:()=>c});var a=i(5893),o=i(7812),n=i(6837),s=i(9544),r=i(7215);const l=(0,i(3914).Z)((()=>({subHeader:{lineHeight:0,background:"#fff",paddingLeft:0,display:"flex",marginTop:8,borderRadius:4,borderBottomStyle:"groove"}}))),c=({useOpen:e,title:t})=>{const i=l(),[c,d]=e,u=(0,a.jsx)(o.Z,Object.assign({size:"small"},{children:c?(0,a.jsx)(s.Z,{fontSize:"small"},void 0):(0,a.jsx)(r.Z,{fontSize:"small"},void 0)}),void 0);return(0,a.jsx)(n.Z,Object.assign({disableGutters:!0,onClick:()=>{d((e=>!e))},component:"span",className:i.subHeader},{children:(0,a.jsxs)("div",Object.assign({style:{display:"flex",alignItems:"center"}},{children:[(0,a.jsx)("span",Object.assign({style:{marginLeft:4}},{children:t}),void 0),(0,a.jsx)("div",Object.assign({style:{marginLeft:8}},{children:u}),void 0)]}),void 0)}),void 0)}},5738:(e,t,i)=>{"use strict";i.d(t,{E:()=>O,m:()=>S});var a=i(5893),o=i(7294),n=i(1120),s=i(9895),r=i(1749),l=i(1423),c=i(2318),d=i(2822),u=i(998),p=i(5757),v=i(5517),g=i(3570),m=i(4096),h=i(8479),j=i(5090),x=i(465),b=i(3855),y=i(3054),f=i(6217),C=i(9299);const O="80vh",L=(0,n.Z)((e=>({root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},nested:{marginLeft:e.spacing(1),marginBottom:0},root_unload:{display:"flex"},tabs:{borderRight:`1px solid ${e.palette.divider}`},tab:{minWidth:10,padding:1,paddingTop:8,paddingBottom:8},buttonTab:{writingMode:"vertical-rl"}})));function k(e){const{children:t,value:i,index:o}=e,n=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(i[a[o]]=e[a[o]])}return i}(e,["children","value","index"]);return(0,a.jsx)("div",Object.assign({role:"tabpanel",hidden:i!==o,id:`vertical-tabpanel-${o}`,"aria-labelledby":`vertical-tab-${o}`,style:{flex:1,height:"auto",boxShadow:"inset 0px -2px 10px 0px rgb(17 16 10 / 56%)",margin:8,borderRadius:4}},n,{children:i===o&&t}),void 0)}function Z(e){return{id:`vertical-tab-${e}`,"aria-controls":`vertical-tabpanel-${e}`}}const S=()=>{const{selectedUploadList:e}=(0,b.C)(y.nx),{polygonList:t,stockCellList:i,state:n}=(0,b.C)(y.WD),S=(0,b.T)(),w=L(),[T,E]=(0,o.useState)([]),[I,$]=(0,o.useState)([]),[D,N]=(0,h._)("index_tab_load_operation",0),R=(0,o.useState)(!1);(0,o.useEffect)((()=>{n===C.jR.DONE&&(E(t.filter((e=>e.state!==j.p$.FINISHED))),$(i.filter((e=>e.state!==j.p$.FINISHED))))}),[n]);const z=(0,o.useCallback)((e=>{if(e){const{value:i}=e.target,a=i?i.toUpperCase():"";E(t.filter((e=>{const t=e.material?e.material.type:"";return e.name.toUpperCase().includes(a)||e.nameProject.toUpperCase().includes(a)||t.includes(a)})))}}),[t]),_=(0,o.useCallback)((e=>{if(e){const{value:t}=e.target,a=t?t.toUpperCase():"";$(i.filter((e=>e.name.toUpperCase().includes(a))))}}),[i]),A=(0,o.useCallback)((()=>{E(t)}),[t]),F=(0,o.useCallback)((()=>{$(i)}),[i]),P=(0,o.useCallback)((t=>!!e.find((e=>e.id===t.id))),[e]);return(0,a.jsx)(s.Z,Object.assign({elevation:4,style:{flex:1}},{children:(0,a.jsxs)(r.Z,Object.assign({container:!0},{children:[(0,a.jsxs)(m.Z,Object.assign({orientation:"vertical",variant:"scrollable",value:D,indicatorColor:"primary",textColor:"primary",onChange:(e,t)=>{N(t)},"aria-label":"Vertical tabs",className:w.tabs},{children:[(0,a.jsx)(l.Z,Object.assign({className:w.tab,label:(0,a.jsx)(c.Z,Object.assign({variant:"caption",className:w.buttonTab},{children:"TAJO"}),void 0)},Z(0)),void 0),(0,a.jsx)(l.Z,Object.assign({className:w.tab,label:(0,a.jsx)(c.Z,Object.assign({variant:"caption",className:w.buttonTab},{children:"STOCKs"}),void 0)},Z(1)),void 0)]}),void 0),(0,a.jsx)(k,Object.assign({value:D,index:0},{children:(0,a.jsxs)(d.Z,Object.assign({dense:!0,disablePadding:!0,style:{width:"100%",paddingLeft:4,overflowY:"scroll",paddingBottom:32,height:O},subheader:(0,a.jsx)(g.v,{title:"Carguío",useOpen:R},void 0)},{children:[R[0]&&(0,a.jsx)(x.V,{functionFilter:z,functionCancel:A,placeholder:"Buscar por polígono"},void 0),T.map((e=>(0,a.jsxs)(o.Fragment,{children:[(0,a.jsx)(u.Z,Object.assign({selected:P(e),button:!0,dense:!0,onClick:()=>{return t=e,void S((0,f.qn)(Object.assign(Object.assign({},t),{type:j.NZ.PIT})));var t}},{children:(0,a.jsx)(p.Z,{primary:`${e.nameProject} - ${e.name} `,secondary:e.material?`Material ${e.material.type}`:"Material not found"},void 0)}),void 0),(0,a.jsx)(v.Z,{},void 0)]},e.id)))]}),void 0)}),void 0),(0,a.jsx)(k,Object.assign({value:D,index:1},{children:(0,a.jsxs)(d.Z,Object.assign({dense:!0,style:{width:"100%",paddingLeft:4,overflowY:"scroll"},subheader:(0,a.jsx)(g.v,{title:"Carguío",useOpen:R},void 0)},{children:[R[0]&&(0,a.jsx)(x.V,{functionFilter:_,functionCancel:F},void 0),I.map((e=>(0,a.jsx)(u.Z,Object.assign({selected:P(e),button:!0,dense:!0,onClick:()=>{return t=e,void S((0,f.qn)(Object.assign(Object.assign({},t),{type:j.NZ.STOCK})));var t}},{children:(0,a.jsx)(p.Z,{primary:e.name},void 0)}),e.id)))]}),void 0)}),void 0)]}),void 0)}),void 0)}},461:(e,t,i)=>{"use strict";i.d(t,{K:()=>y});var a=i(5893),o=i(5517),n=i(2822),s=i(7294),r=i(3855),l=i(8693),c=i(465),d=i(3570),u=i(1120),p=i(998),v=i(553),g=i(3258),m=i(5757),h=i(5090);const j=(0,u.Z)((e=>({disabledSpacing:{margin:0,padding:0,width:"100%"},checkbox:{"& .MuiCheckbox-root":{margin:0,padding:0,paddingLeft:8}}}))),x=s.memo((({truck:e,checked:t,trucksSelect:i,setTrucksSelect:o,disableWithOperation:n,handleonchangeTruck:s})=>{const r=j(),l=e.state>=0?h.SS[e.state]:"Sin conex...",c=e.operationList&&e.operationList.length>0?e.operationList[0].excavator.deviceAlias:"";return(0,a.jsx)(p.Z,Object.assign({button:!0,dense:!0,className:r.disabledSpacing,disabled:!!n&&!!c},{children:(0,a.jsx)(v.Z,{className:r.checkbox,onChange:()=>{const t=i.findIndex((t=>e.deviceId===t.deviceId));-1===t?i.push(e):i.splice(t,1),o(JSON.parse(JSON.stringify(i)))},control:(0,a.jsx)(g.Z,{onClick:()=>s(e),size:"small",checked:t,inputProps:{style:{padding:0}}},void 0),label:(0,a.jsx)(m.Z,{primary:`${e.deviceAlias} ${c?` ➜ ${c}`:""} (${l})`},void 0)},void 0)}),void 0)}));var b=i(5738);const y=s.memo((({trucksSelect:e,setTrucksSelect:t,handleonchangeTruck:i,disableWithOperation:u})=>{const p=(0,s.useState)(),{truckInfoList:v}=(0,r.C)(l.ej),[g,m]=(0,s.useState)([]),[h,j]=(0,s.useState)("");(0,s.useEffect)((()=>{m(v.filter((e=>e.deviceAlias.toLowerCase().includes(h.toLowerCase()))))}),[v]);const y=(0,s.useCallback)((e=>{if(e){const t=e.target?e.target.value.toUpperCase():"";m(v.filter((e=>e.deviceAlias.toUpperCase().includes(t)))),j(t)}}),[v]),f=(0,s.useCallback)((()=>{m(v),j("")}),[v]);return(0,a.jsxs)(n.Z,Object.assign({dense:!0,subheader:(0,a.jsx)(d.v,{title:"Trucks",useOpen:p},void 0),style:{width:"100%",paddingLeft:4,height:b.E,overflowY:"scroll",boxShadow:"inset 0px -2px 10px 0px rgb(17 16 10 / 56%)",margin:8,borderRadius:4}},{children:[p[0]&&(0,a.jsx)(c.V,{functionFilter:y,functionCancel:f},void 0),g.map((n=>{return(0,a.jsxs)(s.Fragment,{children:[(0,a.jsx)(x,{handleonchangeTruck:i,disableWithOperation:u,checked:(r=n,!!e.find((e=>r.deviceId===e.deviceId))),trucksSelect:e,setTrucksSelect:t,truck:n},void 0),(0,a.jsx)(o.Z,{},void 0)]},n.deviceId);var r}))]}),void 0)}))},4276:(e,t,i)=>{"use strict";i.d(t,{c:()=>a});class a{constructor(e,t,i,a,o,n){this.unitsList=e,this.map=t,this.idSource=i,this.idLayer=a,this.iconImagen=o,this.offsetY=-2.1,this.fontSize=9,this.onClickElement=n}getInMap(){return this.map.getSource(this.idSource)}generateFeatures(){return this.unitsList.map((e=>{const{latitude:t,longitude:i,direction:a}=e.sensor,o=e.deviceAlias.split("-"),n=o.length>1&&""!==o[1].trim()?`${o[0].substr(0,1)}${o[1].substr(-2)}`:e.deviceAlias;return{type:"Feature",geometry:{type:"Point",coordinates:[i,t]},properties:{deviceId:e.deviceId,rotate:a,name:`${n}`,rotation:-180+a,offsetdata:[0,0]}}}))}addToMap(){!this.getInMap()&&this.unitsList.length>0&&(this.map.addSource(this.idSource,{type:"geojson",data:{type:"FeatureCollection",features:this.generateFeatures()}}),this.map.addLayer({id:this.idLayer,type:"symbol",source:this.idSource,layout:{"icon-image":this.iconImagen,"icon-size":.08,"icon-ignore-placement":!0,"icon-allow-overlap":!0,"icon-rotate":["get","rotate"]}}),this.map.addLayer({id:`LABEL_${this.idLayer}`,type:"symbol",source:this.idSource,layout:{"text-field":["get","name"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":this.fontSize,"text-rotate":["get","rotation"],"text-offset":["get","offsetdata"],"text-allow-overlap":!0},paint:{"text-color":"#fff","text-halo-color":"#00296b","text-halo-width":4}}),this.map.on("click",this.idLayer,(e=>{this.onClickElement&&this.onClickElement(e)})),this.map.on("mouseenter",this.idLayer,(()=>{this.map.getCanvas().style.cursor="pointer"})),this.map.on("mouseleave",this.idLayer,(()=>{this.map.getCanvas().style.cursor=""})))}updateInMap(){const e=this.getInMap();e?e.setData({type:"FeatureCollection",features:this.generateFeatures()}):this.addToMap()}removeOfMap(){this.getInMap()&&(this.map.removeLayer(this.idLayer),this.map.removeLayer(`LABEL_${this.idLayer}`),this.map.removeSource(this.idSource))}}},2573:(e,t,i)=>{"use strict";i.d(t,{z:()=>o});var a=i(5573);class o{constructor(e,t,i,a,o,n,s,r){this.polygonList=e,this.map=t,this.idSource=i,this.idLayer=a,this.idSourceCentroid=o,this.idLayerCentroid=n,this.fontSize=9,this.onClickElement=s,this.haveCentroid=r}getInMap(){return this.map.getSource(this.idSource)}getCenterInMap(){return this.map.getSource(this.idSourceCentroid)}generateCentroids(){return this.polygonList.map((e=>{var t,i,a;if(!e.centroid)return{type:"Feature",geometry:{type:"Point",coordinates:[0,0]},properties:{}};const{latitude:o,longitude:n}=e.centroid;return{type:"Feature",geometry:{type:"Point",coordinates:[n,o]},properties:{name:`${e.name}${e.material?`-${e.material.type}`:""}`,points_polygonTajo:e.pointList.map((e=>[e.longitude,e.latitude])),name_polygon:e.name,name_material:null===(t=e.material)||void 0===t?void 0:t.type,id_polygonTajo:e.id,agTajo:e.ag,agcnTajo:e.agcn,alteTajo:e.alte,asTajo:e.as,auTajo:e.au,auchTajo:e.auch,altitudeTajo:e.altitude,descripcionTajo:"",heightTajo:e.height,litoTajo:e.litio,materialTajo:null===(i=e.material)||void 0===i?void 0:i.type,namePolTajo:e.name,nameProjectTajo:e.nameProject,onzasTajo:e.onzas,orezonetTajo:e.orezonet,ptaucnTajo:e.ptaucn,sTajo:e.s,tonnesTajo:e.tonnes,volumeTajo:e.volume,nameDme:`${e.name}`,points_polygonDme:e.pointList.map((e=>[e.longitude,e.latitude])),id_polygonDme:e.id,tonnesDme:e.tonnes,volumeDme:e.volume,namePad:`${e.name}`,id_Pad:`${e.id}_pad`,points_Pad:e.pointList.map((e=>[e.longitude,e.latitude])),tonnesPad:e.tonnes,volumePad:e.volume,nameStock:`${e.name}`,id_polygonStock:e.id,points_polygonStock:e.pointList.map((e=>[e.longitude,e.latitude])),materialStock:null===(a=e.material)||void 0===a?void 0:a.type,altitudeStock:e.altitude,volumeStock:e.volume}}}))}generateFeatures(){return this.polygonList.map((e=>({type:"Feature",properties:{color:a.O[e.color]?a.O[e.color].hex:e.color,out_color:"blue",opacity:this.haveCentroid?1:.2,opacity_border:1},geometry:{type:"Polygon",coordinates:[e.pointList.map((e=>[e.longitude,e.latitude,e.altitude]))]}})))}addToMap(){!this.getInMap()&&this.polygonList.length>0?(console.log("this.generateFeatures()",this.generateFeatures()),this.map.getSource(this.idSource)||this.map.addSource(this.idSource,{type:"geojson",data:{type:"FeatureCollection",features:this.generateFeatures()}}),this.map.getLayer(this.idLayer)||this.map.addLayer({id:this.idLayer,type:"fill",source:this.idSource,paint:{"fill-color":["get","color"],"fill-outline-color":["get","out_color"],"fill-opacity":["get","opacity"]}}),this.map.getLayer(`BORDER_${this.idLayer}`)||this.map.addLayer({id:`BORDER_${this.idLayer}`,type:"line",source:this.idSource,paint:{"line-color":["get","out_color"],"line-width":2,"line-opacity":["get","opacity_border"]},filter:["==","$type","Polygon"]}),this.haveCentroid&&(this.map.getSource(this.idSourceCentroid)||this.map.addSource(this.idSourceCentroid,{type:"geojson",data:{type:"FeatureCollection",features:this.generateCentroids()}}),this.map.getLayer(this.idLayerCentroid)||this.map.addLayer({id:this.idLayerCentroid,type:"symbol",source:this.idSourceCentroid,layout:{"text-field":["get","name"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":this.fontSize},paint:{"text-color":"#00296b","text-halo-color":"#f8f7ff","text-halo-width":2}})),this.map.on("click",this.idLayerCentroid,(e=>{this.onClickElement&&this.onClickElement(e)})),this.map.on("mouseenter",this.idLayerCentroid,(()=>{this.map.getCanvas().style.cursor="pointer"})),this.map.on("mouseleave",this.idLayerCentroid,(()=>{this.map.getCanvas().style.cursor=""}))):this.getInMap()&&this.updateInMap()}updateInMap(){const e=this.getInMap();e?e.setData({type:"FeatureCollection",features:this.generateFeatures()}):this.addToMap()}removeOfMap(){this.getInMap()&&(this.map.removeLayer(this.idLayer),this.map.removeLayer(`BORDER_${this.idLayer}`),this.map.removeSource(this.idSource),this.getCenterInMap()&&(this.map.removeLayer(this.idLayerCentroid),this.map.removeSource(this.idSourceCentroid)))}}},2780:(e,t,i)=>{"use strict";i.d(t,{We:()=>n,Uk:()=>s,wg:()=>r});var a=i(5501),o=function(e,t,i,a){return new(i||(i=Promise))((function(o,n){function s(e){try{l(a.next(e))}catch(e){n(e)}}function r(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,r)}l((a=a.apply(e,t||[])).next())}))};const n=(e,t)=>o(void 0,void 0,void 0,(function*(){return yield(0,a.g$)(t,e)})),s=(e,t,i,n,s)=>o(void 0,void 0,void 0,(function*(){i(!0);const o=yield(0,a.e1)(e,t);console.log("responseAssigment",o),i(!1),n((e=>!e)),s(void 0);let r="";o.truckErrorList.length>0&&o.truckErrorList.forEach((e=>{const t=1===e.state?"CARGANDO":"A DESCARGA";r+=` ${e.truckError.deviceAlias}=> ${t},`})),""!==r&&alert(`Las siguientes unidades no han podido ser reasignadas: ${r}`)})),r=e=>o(void 0,void 0,void 0,(function*(){const t=yield(0,a.zY)(e);console.log("finalizeOperationEvent",t);let i="";return t.truckErrorList.length>0&&t.truckErrorList.forEach((e=>{const t=1===e.state?"CARGANDO":"A DESCARGA";i+=` ${e.truckError.deviceAlias} => ${t},`})),i}))},8850:(e,t,i)=>{"use strict";i.d(t,{h:()=>d});var a=i(5893),o=i(5258),n=i(8358),s=i(282),r=i(2318),l=i(3471),c=i(5977);const d=({title:e})=>{const t=(0,c.k6)();return(0,a.jsx)(o.Z,Object.assign({position:"sticky",color:"secondary"},{children:(0,a.jsxs)(n.Z,{children:[(0,a.jsx)(s.Z,{size:"small",startIcon:(0,a.jsx)(l.Z,{color:"action",style:{color:"#fff"}},void 0),onClick:()=>{t.goBack()}},void 0),(0,a.jsx)(r.Z,Object.assign({variant:"h6"},{children:e}),void 0)]},void 0)}),void 0)}},8341:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>ue});var a=i(5893),o=i(7294),n=i(46),s=i(1749),r=i(5477),l=i(282),c=i(9895),d=i(1120),u=i(1423),p=i(2318),v=i(4096),g=i(2822),m=i(3570),h=i(998),j=i(5757);const x=(0,d.Z)((e=>({disablePadding:{padding:0,margin:0,flex:1},nested:{margin:0,padding:0,marginLeft:e.spacing(2.5),flex:1}}))),b=({primary:e,Icon:t,isSubItem:i,isSelect:n,onClick:s})=>{(0,o.useEffect)((()=>()=>{}),[]);const r=x();return(0,a.jsxs)(h.Z,Object.assign({selected:n,onClick:s,dense:!0,button:!0,className:i?r.nested:r.disablePadding},{children:[t&&(0,a.jsx)(t,{fontSize:"small"},void 0),(0,a.jsx)(j.Z,{className:r.disablePadding,primary:e},void 0)]}),void 0)};var y=i(465),f=i(3855),C=i(3054),O=i(5090),L=i(6217);const k=({p:e})=>{const{selectedDownloadList:t}=(0,f.C)(C.nx),i=(0,f.T)(),n=(0,o.useCallback)((e=>!!t.find((t=>t.id===e.id))),[t]);return(0,a.jsx)(b,{primary:`Celda - ${e.name?e.name:"SIN NOM"}`,onClick:()=>{return t=e,void i((0,L.Ru)(Object.assign(Object.assign({},t),{type:O.NZ.PAD})));var t},isSelect:n(e)},void 0)},Z=({padCells:e})=>{const t=(0,o.useState)(!1),[i]=t,n=e.map((e=>(0,a.jsx)(k,Object.assign({},{p:e}),e.id)));return(0,a.jsxs)(g.Z,Object.assign({dense:!0,style:{width:"100%",paddingLeft:4,maxHeight:"75vh",overflowY:"scroll"},subheader:(0,a.jsx)(m.v,{title:"Descarga",useOpen:t},void 0)},{children:[i&&(0,a.jsx)(y.V,{functionCancel:()=>{},functionFilter:()=>{}},void 0),n]}),void 0)},S=({p:e})=>{const{selectedDownloadList:t}=(0,f.C)(C.nx),i=(0,f.T)(),n=(0,o.useCallback)((e=>!!t.find((t=>t.id===e.id))),[t]);return(0,a.jsx)(b,{primary:`Celda - ${e.name?e.name:"SIN NOM"}`,onClick:()=>{return t=e,void i((0,L.Ru)(Object.assign(Object.assign({},t),{type:O.NZ.STOCK})));var t},isSelect:n(e)},void 0)},w=({stockCells:e})=>{const t=(0,o.useState)(!1),[i]=t,n=e.map((e=>(0,a.jsx)(S,Object.assign({},{p:e}),e.id)));return(0,a.jsxs)(g.Z,Object.assign({dense:!0,style:{width:"100%",paddingLeft:4,maxHeight:"75vh",overflowY:"scroll"},subheader:(0,a.jsx)(m.v,{title:"Descarga",useOpen:t},void 0)},{children:[i&&(0,a.jsx)(y.V,{functionCancel:()=>{},functionFilter:()=>{}},void 0),n]}),void 0)};var T=i(8479);const E=({p:e})=>{const{selectedDownloadList:t}=(0,f.C)(C.nx),i=(0,f.T)(),n=(0,o.useCallback)((e=>!!t.find((t=>t.id===e.id))),[t]);return(0,a.jsx)(b,{primary:`${e.name?e.name:"SIN NOM"}`,onClick:()=>{return t=e,void i((0,L.Ru)(Object.assign(Object.assign({},t),{type:O.NZ.DME})));var t},isSelect:n(e)},void 0)},I=({dmeCells:e})=>{const t=(0,o.useState)(!1),[i]=t,n=e.map((e=>(0,a.jsx)(E,Object.assign({},{p:e}),e.id)));return(0,a.jsxs)(g.Z,Object.assign({dense:!0,style:{width:"100%",paddingLeft:4,maxHeight:"75vh",overflowY:"scroll"},subheader:(0,a.jsx)(m.v,{title:"Descarga",useOpen:t},void 0)},{children:[i&&(0,a.jsx)(y.V,{functionCancel:()=>{},functionFilter:()=>{}},void 0),n]}),void 0)};const $=(0,d.Z)((e=>({nested:{marginLeft:e.spacing(1),marginBottom:0},root_unload:{display:"flex"},tabs:{borderRight:`1px solid ${e.palette.divider}`},tab:{minWidth:10,padding:1,paddingTop:8,paddingBottom:8},buttonTab:{writingMode:"vertical-rl"}})));function D(e){const{children:t,value:i,index:o}=e,n=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(i[a[o]]=e[a[o]])}return i}(e,["children","value","index"]);return(0,a.jsx)("div",Object.assign({role:"tabpanel",hidden:i!==o,id:`vertical-tabpanel-${o}`,"aria-labelledby":`vertical-tab-${o}`,style:{flex:1}},n,{children:i===o&&t}),void 0)}function N(e){return{id:`vertical-tab-${e}`,"aria-controls":`vertical-tabpanel-${e}`}}const R=({value:e,handleChange:t})=>{const i=$();return(0,a.jsxs)(v.Z,Object.assign({orientation:"vertical",variant:"scrollable",value:e,indicatorColor:"primary",textColor:"primary",onChange:t,"aria-label":"Vertical tabs",className:i.tabs},{children:[(0,a.jsx)(u.Z,Object.assign({className:i.tab,label:(0,a.jsx)(p.Z,Object.assign({variant:"caption",className:i.buttonTab},{children:"PAD"}),void 0)},N(0)),void 0),(0,a.jsx)(u.Z,Object.assign({className:i.tab,label:(0,a.jsx)(p.Z,Object.assign({variant:"caption",className:i.buttonTab},{children:"DME"}),void 0)},N(1)),void 0),(0,a.jsx)(u.Z,Object.assign({className:i.tab,label:(0,a.jsx)(p.Z,Object.assign({variant:"caption",className:i.buttonTab},{children:"STOCKs"}),void 0)},N(2)),void 0)]}),void 0)},z=()=>{const{padCellList:e,dmeCellList:t,stockCellList:i}=(0,f.C)(C.WD),o=$(),[n,r]=(0,T._)("index_tab_unload_operation",0);return(0,a.jsx)(c.Z,Object.assign({elevation:4,style:{width:"100%"}},{children:(0,a.jsxs)(s.Z,Object.assign({container:!0,className:o.root_unload},{children:[(0,a.jsx)(R,Object.assign({},{value:n,handleChange:(e,t)=>{r(t)}}),void 0),(0,a.jsx)(D,Object.assign({value:n,index:0},{children:(0,a.jsx)(Z,{padCells:e.filter((e=>e.state!==O.p$.FINISHED))},void 0)}),void 0),(0,a.jsx)(D,Object.assign({value:n,index:1},{children:(0,a.jsx)(I,{dmeCells:t.filter((e=>e.state!==O.p$.FINISHED))},void 0)}),void 0),(0,a.jsx)(D,Object.assign({value:n,index:2},{children:(0,a.jsx)(w,{stockCells:i.filter((e=>e.state!==O.p$.FINISHED))},void 0)}),void 0)]}),void 0)}),void 0)};var _=i(5738),A=i(461);const F=(0,d.Z)((e=>({root:{flex:1}}))),P=()=>{const e=(0,f.T)(),t=F(),[i,n]=(0,o.useState)([]);return(0,a.jsx)(c.Z,Object.assign({className:t.root,elevation:4,style:{flex:1}},{children:(0,a.jsx)(s.Z,Object.assign({container:!0,direction:"row"},{children:(0,a.jsx)(A.K,{handleonchangeTruck:t=>{e((0,L.Db)(t))},setTrucksSelect:n,trucksSelect:i,disableWithOperation:!0},void 0)}),void 0)}),void 0)};var M=i(4436),W=i(2541),U=i(553),V=i(74),B=i(5517),H=i(2198);const K=(0,d.Z)((e=>({root:{flex:1},list:{maxHeight:"75vh",paddingLeft:e.spacing(1),marginLeft:e.spacing(1),overflowY:"scroll",marginBottom:e.spacing(2)}}))),Y=()=>{const e=(0,o.useState)(!1),{excavatorInfoList:t}=(0,f.C)(H.kW),i=(0,f.T)(),[n,s]=(0,o.useState)([]);(0,o.useEffect)((()=>{s(t)}),[t]);const r=K();return(0,a.jsx)(c.Z,Object.assign({elevation:4,style:{width:"100%"}},{children:(0,a.jsx)(g.Z,Object.assign({className:r.list,dense:!0,disablePadding:!0,subheader:(0,a.jsx)(m.v,{title:"Palas",useOpen:e},void 0)},{children:(0,a.jsx)(h.Z,Object.assign({dense:!0,disableGutters:!0},{children:(0,a.jsx)(M.Z,Object.assign({size:"small",fullWidth:!0,component:"fieldset"},{children:(0,a.jsx)(W.Z,Object.assign({"aria-label":"gender",name:"radio-buttons-group"},{children:n.map((e=>(0,a.jsxs)(o.Fragment,{children:[(0,a.jsx)(U.Z,{value:e.id,control:(0,a.jsx)(V.Z,{size:"small"},void 0),onClick:()=>(e=>{i((0,L.Zh)(e))})(e),label:(0,a.jsx)(p.Z,Object.assign({component:"span",variant:"body2"},{children:e.deviceAlias}),void 0)},void 0),(0,a.jsx)(B.Z,{},void 0)]},e.deviceId)))}),void 0)}),void 0)}),void 0)}),void 0)}),void 0)};var G=i(5501),q=i(8101),J=i(4248),X=i(4276),Q=i(8693),ee=i(2837),te=i(6886),ie=i(9800);const ae=({map:e})=>{const{excavatorInfoList:t}=(0,f.C)(H.kW),{truckInfoList:i}=(0,f.C)(Q.ej),n=(0,o.useMemo)((()=>{const t=i.filter((e=>e.sensor)),o=new X.c(t,e.current,"TRUCK_LIST_SOURCE","TRUCK_LIST_LAYER","truck_nav");return(0,a.jsx)(ee.b,{truckList:t,truckListClass:o},void 0)}),[i]),s=(0,o.useMemo)((()=>{const i=t.filter((e=>e.sensor)),o=new X.c(i,e.current,"EXCAVATOR_LIST_SOURCE","EXCAVATOR_LIST_LAYER","excavator_nav");return(0,a.jsx)(te.N,{excavatorList:i,excavatorListClass:o},void 0)}),[t]);return(0,a.jsxs)(a.Fragment,{children:[n,s]},void 0)},oe=()=>{const e=(0,o.useRef)(null),t=(0,o.useRef)(null),{selectedUploadList:i,selectedDownloadList:n}=(0,f.C)(C.nx);(0,o.useEffect)((()=>()=>{e.current=null}),[]);const[s,r]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{s&&(0,ie.H)(e)}),[s]),(0,a.jsxs)(a.Fragment,{children:[s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(J.f,Object.assign({},{polygonList:i,map:e.current,idSource:"UPLOAD_SOURCE",idLayer:"UPLOAD_LAYER",idSourceCentroid:"CENTROID_UPLOAD_SOURCE",idLayerCentroid:"CENTROID_UPLOAD_LAYER",haveCentroid:!0}),void 0),(0,a.jsx)(J.f,Object.assign({},{polygonList:n,map:e.current,idSource:"DOWNLOAD_SOURCE",idLayer:"DOWNLOAD_LAYER",idSourceCentroid:"CENTROID_DOWNLOAD_SOURCE",idLayerCentroid:"CENTROID_DOWNLOAD_LAYER",haveCentroid:!0,onClickFeature:()=>{}}),void 0),(0,a.jsx)(ae,{map:e},void 0)]},void 0),(0,a.jsx)(q.Z,Object.assign({map:e,dragRotate:!1,style:"mapbox://styles/dispatchgat/ckqqsfc2y46bo17sf1y29zwnj",mapContainer:t,bearing:0,pitch:15,height:"90vh"},{lat:-7.6163,lng:-78.196,zoom:14,setLoad:r}),void 0)]},void 0)},ne=(0,i(5209).Z)(o.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");var se=i(5977),re=i(2672);const le=()=>{const[e,t]=(0,o.useState)(!1),i=(0,se.k6)(),c=(0,f.T)(),{selectedExcavator:d,selectedTruckList:u,selectedUploadList:p,selectedDownloadList:v}=(0,f.C)(C.nx);return(0,a.jsx)(n.Z,Object.assign({padding:1},{children:(0,a.jsx)(s.Z,Object.assign({container:!0,justifyContent:"flex-end",alignItems:"center",alignContent:"center"},{children:e?(0,a.jsx)(r.Z,{},void 0):(0,a.jsx)(l.Z,Object.assign({variant:"outlined",onClick:()=>{d.length<=0?c((0,re.L8)({msg:"Debe seleccionar una excavadora",open:!0,severity:"warning"})):p.length>0&&v.length>0?(t(!0),(0,G.pg)(p,v,u,d,[]).then((e=>{(0,re.L8)({msg:"Done!!",open:!0,severity:"success"}),i.replace("/operation"),c((0,L.nw)()),t(!1)})).catch((e=>{console.log(e),t(!1),c((0,re.L8)({msg:`Error al guardar: posiblemente las unidades ya estan en otra operación: ${e.message}`,open:!0,severity:"warning"}))}))):c((0,re.L8)({msg:"Debe seleccionar un Carguío y descarga",open:!0,severity:"warning"}))},color:"primary",size:"small",startIcon:(0,a.jsx)(ne,{fontSize:"small"},void 0)},{children:"Guardar"}),void 0)}),void 0)}),void 0)},ce=()=>(0,a.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,a.jsxs)(c.Z,{children:[(0,a.jsxs)(s.Z,Object.assign({container:!0,style:{padding:4,flex:1}},{children:[(0,a.jsx)(_.m,{},void 0),(0,a.jsxs)(s.Z,Object.assign({container:!0,alignContent:"flex-start",style:{flex:1,marginLeft:8,marginRight:8,gap:8}},{children:[(0,a.jsx)(z,{},void 0),(0,a.jsx)(Y,{},void 0)]}),void 0),(0,a.jsx)(P,{},void 0)]}),void 0),(0,a.jsx)(le,{},void 0)]},void 0),(0,a.jsx)(oe,{},void 0)]}),void 0);var de=i(8850);function ue(){return(0,a.jsxs)("div",{children:[(0,a.jsx)(de.h,{title:"Create Operation"},void 0),(0,a.jsx)(ce,{},void 0)]},void 0)}},2749:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>ce});var a=i(5893),o=i(7294),n=i(5977),s=i(9895),r=i(998),l=i(1749),c=i(5757),d=i(1860),u=i(6037),p=i(2822),v=i(5209);const g=(0,v.Z)(o.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess"),m=(0,v.Z)(o.createElement("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");var h=i(1920);const j=({value:e,cy:t})=>{var i,o,n,s;switch(e){case h.u6.PAD:return(0,a.jsx)(c.Z,{primary:`Descarga: ${h.WW[t.download.type]} -  ${null===(i=t.download.pad.cellList[0])||void 0===i?void 0:i.name}`},void 0);case h.u6.DME:return(0,a.jsx)(c.Z,{primary:`Descarga: ${h.WW[t.download.type]} -  ${null===(o=t.download.dme.cellList[0])||void 0===o?void 0:o.name}`},void 0);case h.u6.PIT:return(0,a.jsx)(c.Z,{primary:`Descarga: ${h.WW[t.download.type]} -  ${null===(n=t.download.pit.cellList[0])||void 0===n?void 0:n.name}`},void 0);case h.u6.STOCK:return(0,a.jsx)(c.Z,{primary:`Descarga: ${h.WW[t.download.type]} -  ${null===(s=t.download.stock.cellList[0])||void 0===s?void 0:s.name}`},void 0);default:return(0,a.jsx)(a.Fragment,{},void 0)}},x=({value:e,cy:t})=>{switch(e){case h.u6.PAD:return(0,a.jsx)(c.Z,{primary:`Carga: ${h.WW[t.upload.type]} -  ${t.upload.pad.projectList[0].name}-${t.upload.pad.projectList[0].polygonList[0].name}`},void 0);case h.u6.DME:return(0,a.jsx)(c.Z,{primary:`Carga: ${t.upload.dme.projectList[0].name} - ${t.upload.dme.projectList[0].polygonList[0].name}`},void 0);case h.u6.PIT:return(0,a.jsx)(c.Z,{primary:`Carga: ${h.WW[t.upload.type]} -  ${t.upload.pit.projectList[0].name}- ${t.upload.pit.projectList[0].polygonList[0].name}`},void 0);case h.u6.STOCK:return(0,a.jsx)(c.Z,{primary:`Carga: ${h.WW[t.upload.type]} -  ${t.upload.stock.projectList[0].name}-${t.upload.stock.projectList[0].polygonList[0].name}`},void 0);default:return(0,a.jsx)(a.Fragment,{children:"node"},void 0)}},b=()=>(0,a.jsx)(s.Z,Object.assign({elevation:1,style:{marginBottom:4}},{children:(0,a.jsx)(r.Z,Object.assign({dense:!0,disableGutters:!0,selected:!0,button:!0},{children:(0,a.jsxs)(l.Z,Object.assign({justifyContent:"space-between",container:!0},{children:[(0,a.jsx)(c.Z,{primary:"TRUCK"},void 0),(0,a.jsx)(c.Z,{primary:"INICIO"},void 0),(0,a.jsx)(c.Z,{primary:"DESCARGA"},void 0),(0,a.jsx)(c.Z,{primary:"FIN"},void 0)]}),void 0)}),void 0)}),void 0),y=o.memo((({cy:e,index:t})=>{var i,n,v;const[h,b]=(0,o.useState)(!1),y=()=>{b(!h)},f=e.startTime?new Date(1e3*(null===(i=e.startTime)||void 0===i?void 0:i.seconds)).toLocaleString():"NO REG",C=e.downloadArrivalTime?new Date(1e3*(null===(n=e.downloadArrivalTime)||void 0===n?void 0:n.seconds)).toLocaleString():"NO REG. ",O=e.endTime?new Date(1e3*(null===(v=e.endTime)||void 0===v?void 0:v.seconds)).toLocaleString():"NO REG. ";return(0,a.jsxs)(s.Z,Object.assign({elevation:1,style:{marginBottom:4},id:e.id},{children:[(0,a.jsxs)(r.Z,Object.assign({dense:!0,disableGutters:!0,selected:!0,button:!0,onClick:y},{children:[(0,a.jsxs)(l.Z,Object.assign({justifyContent:"space-between",container:!0},{children:[(0,a.jsx)(c.Z,{primary:`${t}.${e.truck.deviceAlias} `},void 0),(0,a.jsx)(c.Z,{primary:f},void 0),(0,a.jsx)(c.Z,{primary:C},void 0),(0,a.jsx)(c.Z,{primary:O},void 0)]}),void 0),(0,a.jsx)(d.Z,Object.assign({onClick:y},{children:(0,a.jsx)(l.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:h?(0,a.jsx)(g,{fontSize:"small",onClick:y},void 0):(0,a.jsx)(m,{fontSize:"small",onClick:y},void 0)}),void 0)}),void 0)]}),void 0),(0,a.jsx)(u.Z,Object.assign({in:h,style:{paddingLeft:10}},{children:(0,a.jsxs)(p.Z,Object.assign({dense:!0,disablePadding:!0},{children:[(0,a.jsx)(r.Z,{children:(0,a.jsx)((()=>{let t="";return e.upload.pit&&(t="pit"),e.upload.stock&&(t="stock"),(0,a.jsx)(x,{value:t,cy:e},void 0)}),{},void 0)},void 0),(0,a.jsx)(r.Z,{children:(0,a.jsx)((()=>{let t="";return e.download.dme&&(t="dme"),e.download.pad&&(t="pad"),e.download.stock&&(t="stock"),(0,a.jsx)(j,{value:t,cy:e},void 0)}),{},void 0)},void 0),(0,a.jsx)(r.Z,{children:(0,a.jsx)(c.Z,{primary:`Pala: ${e.excavator.deviceAlias} `},void 0)},void 0),(0,a.jsx)(r.Z,{children:(0,a.jsx)(c.Z,{primary:`Camion: ${e.truck.deviceAlias} `},void 0)},void 0)]}),void 0)}),void 0)]}),e.id)}));var f=i(6019),C=i(2930),O=i(7462),L=i(5987),k=(i(5697),i(6010));const Z=(0,v.Z)(o.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");var S=i(4670),w=i(9693),T=i(3834),E=i(3871),I=i(4720);function $(e){return"Backspace"===e.key||"Delete"===e.key}var D=o.forwardRef((function(e,t){var i=e.avatar,a=e.classes,n=e.className,s=e.clickable,r=e.color,l=void 0===r?"default":r,c=e.component,d=e.deleteIcon,u=e.disabled,p=void 0!==u&&u,v=e.icon,g=e.label,m=e.onClick,h=e.onDelete,j=e.onKeyDown,x=e.onKeyUp,b=e.size,y=void 0===b?"medium":b,f=e.variant,C=void 0===f?"default":f,S=(0,L.Z)(e,["avatar","classes","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant"]),w=o.useRef(null),D=(0,T.Z)(w,t),N=function(e){e.stopPropagation(),h&&h(e)},R=!(!1===s||!m)||s,z="small"===y,_=c||(R?I.Z:"div"),A=_===I.Z?{component:"div"}:{},F=null;if(h){var P=(0,k.Z)("default"!==l&&("default"===C?a["deleteIconColor".concat((0,E.Z)(l))]:a["deleteIconOutlinedColor".concat((0,E.Z)(l))]),z&&a.deleteIconSmall);F=d&&o.isValidElement(d)?o.cloneElement(d,{className:(0,k.Z)(d.props.className,a.deleteIcon,P),onClick:N}):o.createElement(Z,{className:(0,k.Z)(a.deleteIcon,P),onClick:N})}var M=null;i&&o.isValidElement(i)&&(M=o.cloneElement(i,{className:(0,k.Z)(a.avatar,i.props.className,z&&a.avatarSmall,"default"!==l&&a["avatarColor".concat((0,E.Z)(l))])}));var W=null;return v&&o.isValidElement(v)&&(W=o.cloneElement(v,{className:(0,k.Z)(a.icon,v.props.className,z&&a.iconSmall,"default"!==l&&a["iconColor".concat((0,E.Z)(l))])})),o.createElement(_,(0,O.Z)({role:R||h?"button":void 0,className:(0,k.Z)(a.root,n,"default"!==l&&[a["color".concat((0,E.Z)(l))],R&&a["clickableColor".concat((0,E.Z)(l))],h&&a["deletableColor".concat((0,E.Z)(l))]],"default"!==C&&[a.outlined,{primary:a.outlinedPrimary,secondary:a.outlinedSecondary}[l]],p&&a.disabled,z&&a.sizeSmall,R&&a.clickable,h&&a.deletable),"aria-disabled":!!p||void 0,tabIndex:R||h?0:void 0,onClick:m,onKeyDown:function(e){e.currentTarget===e.target&&$(e)&&e.preventDefault(),j&&j(e)},onKeyUp:function(e){e.currentTarget===e.target&&(h&&$(e)?h(e):"Escape"===e.key&&w.current&&w.current.blur()),x&&x(e)},ref:D},A,S),M||W,o.createElement("span",{className:(0,k.Z)(a.label,z&&a.labelSmall)},g),F)}));const N=(0,S.Z)((function(e){var t="light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],i=(0,w.Fq)(e.palette.text.primary,.26);return{root:{fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:e.palette.getContrastText(t),backgroundColor:t,borderRadius:16,whiteSpace:"nowrap",transition:e.transitions.create(["background-color","box-shadow"]),cursor:"default",outline:0,textDecoration:"none",border:"none",padding:0,verticalAlign:"middle",boxSizing:"border-box","&$disabled":{opacity:.5,pointerEvents:"none"},"& $avatar":{marginLeft:5,marginRight:-6,width:24,height:24,color:"light"===e.palette.type?e.palette.grey[700]:e.palette.grey[300],fontSize:e.typography.pxToRem(12)},"& $avatarColorPrimary":{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.dark},"& $avatarColorSecondary":{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.dark},"& $avatarSmall":{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:e.typography.pxToRem(10)}},sizeSmall:{height:24},colorPrimary:{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText},colorSecondary:{backgroundColor:e.palette.secondary.main,color:e.palette.secondary.contrastText},disabled:{},clickable:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover, &:focus":{backgroundColor:(0,w._4)(t,.08)},"&:active":{boxShadow:e.shadows[1]}},clickableColorPrimary:{"&:hover, &:focus":{backgroundColor:(0,w._4)(e.palette.primary.main,.08)}},clickableColorSecondary:{"&:hover, &:focus":{backgroundColor:(0,w._4)(e.palette.secondary.main,.08)}},deletable:{"&:focus":{backgroundColor:(0,w._4)(t,.08)}},deletableColorPrimary:{"&:focus":{backgroundColor:(0,w._4)(e.palette.primary.main,.2)}},deletableColorSecondary:{"&:focus":{backgroundColor:(0,w._4)(e.palette.secondary.main,.2)}},outlined:{backgroundColor:"transparent",border:"1px solid ".concat("light"===e.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),"$clickable&:hover, $clickable&:focus, $deletable&:focus":{backgroundColor:(0,w.Fq)(e.palette.text.primary,e.palette.action.hoverOpacity)},"& $avatar":{marginLeft:4},"& $avatarSmall":{marginLeft:2},"& $icon":{marginLeft:4},"& $iconSmall":{marginLeft:2},"& $deleteIcon":{marginRight:5},"& $deleteIconSmall":{marginRight:3}},outlinedPrimary:{color:e.palette.primary.main,border:"1px solid ".concat(e.palette.primary.main),"$clickable&:hover, $clickable&:focus, $deletable&:focus":{backgroundColor:(0,w.Fq)(e.palette.primary.main,e.palette.action.hoverOpacity)}},outlinedSecondary:{color:e.palette.secondary.main,border:"1px solid ".concat(e.palette.secondary.main),"$clickable&:hover, $clickable&:focus, $deletable&:focus":{backgroundColor:(0,w.Fq)(e.palette.secondary.main,e.palette.action.hoverOpacity)}},avatar:{},avatarSmall:{},avatarColorPrimary:{},avatarColorSecondary:{},icon:{color:"light"===e.palette.type?e.palette.grey[700]:e.palette.grey[300],marginLeft:5,marginRight:-6},iconSmall:{width:18,height:18,marginLeft:4,marginRight:-4},iconColorPrimary:{color:"inherit"},iconColorSecondary:{color:"inherit"},label:{overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},labelSmall:{paddingLeft:8,paddingRight:8},deleteIcon:{WebkitTapHighlightColor:"transparent",color:i,height:22,width:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:(0,w.Fq)(i,.4)}},deleteIconSmall:{height:16,width:16,marginRight:4,marginLeft:-4},deleteIconColorPrimary:{color:(0,w.Fq)(e.palette.primary.contrastText,.7),"&:hover, &:active":{color:e.palette.primary.contrastText}},deleteIconColorSecondary:{color:(0,w.Fq)(e.palette.secondary.contrastText,.7),"&:hover, &:active":{color:e.palette.secondary.contrastText}},deleteIconOutlinedColorPrimary:{color:(0,w.Fq)(e.palette.primary.main,.7),"&:hover, &:active":{color:e.palette.primary.main}},deleteIconOutlinedColorSecondary:{color:(0,w.Fq)(e.palette.secondary.main,.7),"&:hover, &:active":{color:e.palette.secondary.main}}}}),{name:"MuiChip"})(D);var R=i(5639),z=i(3258),_=i(46),A=i(2285),F=i(2318),P=i(282),M=i(1120),W=i(553);const U=(0,M.Z)((e=>({disabledSpacing:{},checkbox:{"& .MuiCheckbox-root":{margin:0,padding:0,paddingLeft:8}}}))),V=({truck:e,checked:t,useTrucksSelect:i})=>{const o=U(),[n,s]=i;return(0,a.jsx)(r.Z,Object.assign({button:!0,dense:!0,className:o.disabledSpacing},{children:(0,a.jsx)(W.Z,{className:o.checkbox,onChange:()=>{const t=n.findIndex((t=>e.deviceId===t.deviceId));-1===t?n.push(e):n.splice(t,1),s(JSON.parse(JSON.stringify(n)))},control:(0,a.jsx)(z.Z,{size:"small",checked:t,inputProps:{style:{padding:0}}},void 0),label:`${e.deviceAlias} `},void 0)}),void 0)};var B=i(4250),H=i(2780);const K=(0,v.Z)(o.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");var Y=i(179);const G=(0,v.Z)(o.createElement("path",{d:"M4.11 2.54a.9959.9959 0 00-1.41 0c-.39.39-.39 1.02 0 1.41L4.74 6H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h15.74l1.29 1.29c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L4.11 2.54zM10 4h4v2h-3.6L22 17.6V8c0-1.11-.89-2-2-2h-4V4c0-1.11-.89-2-2-2h-4c-.99 0-1.8.7-1.96 1.64L10 5.6V4z"}),"WorkOffRounded"),q=({value:e,operationSelect:t})=>(0,a.jsx)(l.Z,Object.assign({item:!0},{children:(0,a.jsx)(N,{style:{marginLeft:4},icon:(0,a.jsx)(G,{},void 0),size:"small",label:(()=>{switch(e){case h.u6.DME:return`Descarga: ${h.WW[t.download.type]} ${t.download.dme.name}`;case h.u6.PAD:return`Descarga: ${h.WW[t.download.type]} ${t.download.pad.name}`;case h.u6.STOCK:return`Descarga: ${h.WW[t.download.type]}`;default:return""}})()},void 0)}),void 0),J=({value:e,operationSelect:t})=>(0,a.jsx)(l.Z,Object.assign({item:!0},{children:(0,a.jsx)(N,{style:{marginLeft:4},icon:(0,a.jsx)(G,{},void 0),size:"small",label:(()=>{switch(e){case h.u6.STOCK:return`Carga:  ${h.WW[t.upload.type]}  ${t.upload.stock.name}`;case h.u6.PIT:return`Carga:  ${h.WW[t.upload.type]}  ${t.upload.pit.name}`;default:return""}})()},void 0)}),void 0);var X=i(1242);const Q=(0,v.Z)(o.createElement("path",{fillRule:"evenodd",d:"M14 6V4h-4v2h4zM4 8v11h16V8H4zm16-2c1.11 0 2 .89 2 2v11c0 1.11-.89 2-2 2H4c-1.11 0-2-.89-2-2l.01-11c0-1.11.88-2 1.99-2h4V4c0-1.11.89-2 2-2h4c1.11 0 2 .89 2 2v2h4z"}),"WorkOutline");var ee=i(3855),te=i(2672);const ie=e=>{const{operation:t}=e,[i,s]=o.useState(!1),r=(0,ee.T)(),c=(0,n.k6)(),d=t&&t.excavatorList&&t.excavatorList.length>0?t.excavatorList[0]:{};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(l.Z,Object.assign({container:!0,style:{paddingLeft:2},alignItems:"center"},{children:[(0,a.jsx)(l.Z,Object.assign({item:!0},{children:(0,a.jsxs)(F.Z,Object.assign({variant:"button",style:{paddingLeft:4,paddingTop:16}},{children:["Detalle de operación",(0,a.jsx)(N,{style:{marginLeft:4},icon:(0,a.jsx)(Q,{},void 0),size:"small",label:d.deviceAlias},void 0)]}),void 0)}),void 0),(0,a.jsx)(l.Z,Object.assign({item:!0},{children:(0,a.jsx)(N,{style:{marginLeft:4},icon:(0,a.jsx)(Q,{},void 0),size:"small",label:`Trucks: ${t?t.truckList.length:0}`},void 0)}),void 0),(0,a.jsx)(l.Z,Object.assign({item:!0},{children:(0,a.jsx)(N,{style:{marginLeft:4},icon:(0,a.jsx)(Q,{},void 0),size:"small",label:`Cycles: ${t?t.cycleList.length:0}`},void 0)}),void 0),(0,a.jsx)(l.Z,Object.assign({item:!0},{children:(0,a.jsx)((()=>{let e="";return t?(t.upload.pit&&(e="pit"),t.upload.stock&&(e="stock"),(0,a.jsx)(J,{value:e,operationSelect:t},void 0)):(0,a.jsx)(a.Fragment,{},void 0)}),{},void 0)}),void 0),(0,a.jsx)(l.Z,Object.assign({item:!0},{children:(0,a.jsx)((()=>{let e="";return t?(t.download.dme&&(e="dme"),t.download.pad&&(e="pad"),t.download.stock&&(e="stock"),(0,a.jsx)(q,{value:e,operationSelect:t},void 0)):(0,a.jsx)(a.Fragment,{},void 0)}),{},void 0)}),void 0),t&&t.state===h.J8.Operando&&(0,a.jsxs)(_.Z,Object.assign({m:.5},{children:[(0,a.jsx)(P.Z,Object.assign({variant:"contained",color:"primary",onClick:()=>{s(!0)},size:"small"},{children:"Finalizar Operación"}),void 0),(0,a.jsx)(X.a,{open:i,handleClose:()=>{s(!1)},handleConfirm:()=>{return e=void 0,i=void 0,o=function*(){const e=yield(0,H.wg)(t.id);e?r((0,te.L8)({open:!0,msg:e,severity:"error"})):(r((0,te.Ui)()),c.replace("/operation")),s(!1)},new((a=void 0)||(a=Promise))((function(t,n){function s(e){try{l(o.next(e))}catch(e){n(e)}}function r(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var i;e.done?t(e.value):(i=e.value,i instanceof a?i:new a((function(e){e(i)}))).then(s,r)}l((o=o.apply(e,i||[])).next())}));var e,i,a,o},title:"¿Esta seguro?",message:`Esta intentando finalizar la operacion  ${t.excavatorList[0].deviceAlias}, si ocurre algun error se le informará`},void 0)]}),void 0)]}),void 0)},void 0)};var ae=i(6796),oe=i(9299);function ne(e,t){return(0,a.jsx)(y,{cy:e,index:t+1},e.id)}const se=function({cycles:e}){const[t,i]=(0,o.useState)([]),[n,s]=(0,o.useState)([]);return(0,o.useEffect)((()=>{const t=e.map((e=>e.truck)),a=[...new Set(t.map((e=>e.deviceId)))];i(a.map((e=>t.find((t=>t.deviceId===e)))))}),[e.length]),(0,a.jsxs)(p.Z,Object.assign({dense:!0,style:{margin:"0px 8px"}},{children:[(0,a.jsx)(f.Z,Object.assign({id:"id-label"},{children:"Filtro por Camión"}),void 0),(0,a.jsx)(C.Z,Object.assign({labelId:"id-label",style:{width:"100%"},multiple:!0,value:n,onChange:e=>{const t=e.target.value;s(t)},renderValue:e=>(0,a.jsx)("div",{children:e.map((e=>(0,a.jsx)(N,{label:t.find((t=>t.deviceId===e)).deviceAlias,clickable:!0,deleteIcon:(0,a.jsx)(K,{onMouseDown:e=>e.stopPropagation()},void 0),onDelete:t=>(e=>{const t=n.findIndex((t=>t===e));t>=0&&n.splice(t,1),s(JSON.parse(JSON.stringify(n)))})(e)},e)))},void 0)},{children:t.map((e=>(0,a.jsxs)(R.Z,Object.assign({value:e.deviceId},{children:[(0,a.jsx)(z.Z,{checked:!!n.find((t=>t===e.deviceId))},void 0),(0,a.jsx)(c.Z,{primary:e.deviceAlias},void 0)]}),e.deviceId)))}),void 0),(0,a.jsx)(_.Z,{height:4},void 0),(0,a.jsx)(b,{},void 0),0===n.length?e.map(ne):e.filter((e=>n.find((t=>t===e.truck.deviceId)))).map(ne)]}),void 0)},re=()=>{const e=(0,o.useState)([]),{id:t}=(0,n.UO)(),i=e[0],d=(0,ee.T)(),u=(0,n.k6)(),{operationDetail:v,status:g}=(0,ee.C)(ae.tl);console.log("operationDetail",v);const m=v&&v.cycleList;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(l.Z,Object.assign({container:!0},{children:[(0,a.jsx)(ie,{operation:v},void 0),(0,a.jsxs)(l.Z,Object.assign({container:!0},{children:[m&&(0,a.jsx)(l.Z,Object.assign({item:!0,md:6},{children:(0,a.jsx)(A.Z,Object.assign({direction:"left",in:!!v,mountOnEnter:!0,unmountOnExit:!0},{children:(0,a.jsxs)(s.Z,Object.assign({elevation:4},{children:[(0,a.jsx)(F.Z,Object.assign({variant:"button",style:{paddingLeft:8,paddingTop:16}},{children:"Ciclos"}),void 0),(0,a.jsx)(se,{cycles:v.cycleList},void 0)]}),void 0)}),void 0)}),void 0),(0,a.jsx)(l.Z,Object.assign({item:!0,md:3,style:{paddingLeft:4}},{children:(0,a.jsx)(A.Z,Object.assign({in:!!v,mountOnEnter:!0,unmountOnExit:!0},{children:(0,a.jsxs)(s.Z,Object.assign({elevation:4},{children:[(0,a.jsx)(F.Z,Object.assign({variant:"button",style:{paddingLeft:8,paddingTop:16}},{children:"Trucks"}),void 0),(0,a.jsxs)(p.Z,Object.assign({dense:!0},{children:[m&&v.truckList.map((t=>{return(0,a.jsx)(V,{checked:(o=t,!!i.find((e=>o.id===e.id))),useTrucksSelect:e,truck:t},t.id);var o})),(0,a.jsx)(r.Z,{children:(0,a.jsx)(P.Z,Object.assign({onClick:()=>{return e=void 0,t=void 0,o=function*(){(yield(0,H.We)(v.id,i))?(d((0,te.Ui)()),u.replace("/operation")):(d((0,te.Ui)()),d((0,te.L8)({open:!0,msg:"Ocurrió un error",severity:"error"})))},new((a=void 0)||(a=Promise))((function(i,n){function s(e){try{l(o.next(e))}catch(e){n(e)}}function r(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(s,r)}l((o=o.apply(e,t||[])).next())}));var e,t,a,o},color:"secondary",variant:"contained",size:"small",disabled:0===i.length},{children:"Leave Trucks"}),void 0)},void 0)]}),void 0)]}),void 0)}),void 0)}),void 0),(0,a.jsxs)(l.Z,Object.assign({item:!0,md:3,style:{paddingLeft:4}},{children:[(0,a.jsx)(A.Z,Object.assign({in:!!v,mountOnEnter:!0,unmountOnExit:!0},{children:(0,a.jsxs)(s.Z,Object.assign({elevation:4},{children:[(0,a.jsx)(F.Z,Object.assign({variant:"button",style:{paddingLeft:8,paddingTop:16}},{children:"Roads"}),void 0),(0,a.jsx)(p.Z,Object.assign({dense:!0},{children:m&&v.roadList.map((e=>(0,a.jsx)(r.Z,{children:(0,a.jsx)(c.Z,{primary:`${e.name}`},void 0)},e.id)))}),void 0)]}),void 0)}),void 0),(0,a.jsx)(B.Z,{visible:!0,actionClick:()=>{d((0,ae.l4)(t))},Icon:Y.Z,disabled:g==oe.jR.LOADING,color:"secondary",right:16,keyAction:"R"},void 0)]}),void 0)]}),void 0)]}),void 0)},void 0)};var le=i(8850);function ce(){const{id:e}=(0,n.UO)(),t=(0,ee.T)();return(0,o.useEffect)((()=>{t((0,ae.l4)(e))}),[e]),(0,a.jsxs)("div",{children:[(0,a.jsx)(le.h,{title:"Detail Operation"},void 0),(0,a.jsx)(re,{},void 0)]},void 0)}}}]);