(self.webpackChunkdts_hytera=self.webpackChunkdts_hytera||[]).push([[690],{48101:(e,i,o)=>{"use strict";o.d(i,{Z:()=>l});var t=o(85893),n=o(67294),d=o(34880);const a=o(6158);a.accessToken=d.c3;const l=({dragRotate:e,map:i,pitch:o,bearing:d,mapContainer:l,lng:s,lat:r,zoom:c,setLoad:v,style:u,height:g,dragControls:j=!0})=>((0,n.useEffect)((()=>{i.current||l&&(i.current=new a.Map({container:l.current,style:u,center:[s,r],pitch:o,bearing:d,zoom:c,antialias:!0,dragRotate:e}))}),[i,l]),(0,n.useEffect)((()=>{i.current&&(j&&(i.current.addControl(new a.FullscreenControl,"bottom-left"),i.current.addControl(new a.NavigationControl,"bottom-left")),i.current.on("move",(()=>{})),i.current.on("click",(e=>{console.log(e.lngLat)})),i.current.on("load",(()=>{i.current&&v(!0)})))}),[i]),(0,n.useEffect)((()=>{i.current&&i.current.setBearing(d)}),[d]),(0,t.jsx)("div",{ref:l,style:{flex:1,height:g||"100vh",width:"100%"},className:"map-container"},void 0))},30433:(e,i,o)=>{"use strict";o.d(i,{DQ:()=>g,Ez:()=>j,g7:()=>u});var t=o(85893),n=o(71267),d=o(12575),a=o(61920),l=o(99945),s=o(44326),r=o(93584);const c=({value:e,operation:i,lineThrough:o=!1})=>{const d=e=>{var o,t,n,d,l,s,r,c,v,u,g,j;switch(e){case a.u6.DME:const e=(null===(t=null===(o=i.download)||void 0===o?void 0:o.dme)||void 0===t?void 0:t.cellList.length)>0?null===(d=null===(n=i.download)||void 0===n?void 0:n.dme)||void 0===d?void 0:d.cellList[0].name:"";return e.toUpperCase().includes("DME")?e:`DME-${e}`;case a.u6.PAD:const p=(null===(s=null===(l=i.download)||void 0===l?void 0:l.pad)||void 0===s?void 0:s.cellList.length)>0?null===(c=null===(r=i.download)||void 0===r?void 0:r.pad)||void 0===c?void 0:c.cellList[0].name:"";return p.toUpperCase().includes("PAD")?p:`PAD-${p}`;case a.u6.STOCK:const h=(null===(u=null===(v=i.download)||void 0===v?void 0:v.stock)||void 0===u?void 0:u.cellList.length)>0?null===(j=null===(g=i.download)||void 0===g?void 0:g.stock)||void 0===j?void 0:j.cellList[0].name:"";return h.toUpperCase().includes("STOCK")?h:`STK-${h}`;default:return""}};return(0,t.jsx)(t.Fragment,{children:e===a.u6.DME_PAD?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Z,{color:o?"default":"secondary",icon:(0,t.jsx)(l.Z,{color:"secondary",fontSize:"small"},void 0),size:"small",style:{backgroundColor:r.p1},label:(0,t.jsx)("p",Object.assign({style:{margin:0,padding:0,fontSize:"0.6rem",textDecoration:o?"line-through":"solid"}},{children:d("pad")}),void 0)},void 0),(0,t.jsx)(n.Z,{color:o?"default":"secondary",icon:(0,t.jsx)(l.Z,{color:"secondary",fontSize:"small"},void 0),style:{backgroundColor:r.AS},size:"small",label:(0,t.jsx)("p",Object.assign({style:{margin:0,padding:0,fontSize:"0.6rem",textDecoration:o?"line-through":"solid"}},{children:d("dme")}),void 0)},void 0)]},void 0):(0,t.jsx)(n.Z,{icon:(0,t.jsx)(l.Z,{color:"secondary",fontSize:"small"},void 0),size:"small",color:o?"default":"secondary",style:{backgroundColor:(e=>{switch(e){case a.u6.DME:return r.AS;case a.u6.PAD:return r.p1;case a.u6.STOCK:return r.o2;default:return r.sb}})(e)},label:(0,t.jsx)("p",Object.assign({style:{margin:0,padding:0,fontSize:"0.6rem",textDecoration:o?"line-through":"solid"}},{children:d(e)}),void 0)},void 0)},void 0)},v=({value:e,operation:i,lineThrough:o=!1})=>(0,t.jsx)(n.Z,{icon:(0,t.jsx)(s.Z,{color:"secondary",fontSize:"small"},void 0),size:"small",style:{background:(e=>{switch(e){case a.u6.PIT:return r.Jx;case a.u6.STOCK:return r.gH;default:return r.sb}})(e)},color:o?"default":"secondary",label:(0,t.jsx)("p",Object.assign({style:{margin:0,padding:0,fontSize:"0.6rem",textDecoration:o?"line-through":"solid"}},{children:(()=>{var o,t,n,d,l,s,r,c,v,u,g,j;switch(e){case a.u6.STOCK:const e=(null===(t=null===(o=i.upload)||void 0===o?void 0:o.stock)||void 0===t?void 0:t.cellList)&&(null===(d=null===(n=i.upload)||void 0===n?void 0:n.stock)||void 0===d?void 0:d.cellList.length)>0?null===(s=null===(l=i.upload)||void 0===l?void 0:l.stock)||void 0===s?void 0:s.cellList[0].name:"";return`${a.WW[i.upload.type]}  ${e}`;case a.u6.PIT:const p=null===(c=null===(r=i.upload)||void 0===r?void 0:r.pit)||void 0===c?void 0:c.name,h=(null===(v=i.upload.pit)||void 0===v?void 0:v.projectList.length)>0?`${null===(u=i.upload.pit)||void 0===u?void 0:u.projectList[0].name}`.substring(5):"",x=h&&(null===(g=i.upload.pit)||void 0===g?void 0:g.projectList[0].polygonList.length)>0?null===(j=i.upload.pit)||void 0===j?void 0:j.projectList[0].polygonList[0].name:"";return`${a.WW[i.upload.type]} ${p} ${h} ${x}`;default:return""}})()}),void 0)},void 0),u=({operation:e,lineThrough:i})=>{var o,n;let d="";return e?((null===(o=e.upload)||void 0===o?void 0:o.pit)&&(d="pit"),(null===(n=e.upload)||void 0===n?void 0:n.stock)&&(d="stock"),(0,t.jsx)(v,{value:d,operation:e,lineThrough:i},void 0)):(0,t.jsx)(t.Fragment,{},void 0)},g=({operation:e,lineThrough:i})=>{var o,n,d,a,l;let s="";return e?((null===(o=e.download)||void 0===o?void 0:o.dme)&&(s="dme"),(null===(n=e.download)||void 0===n?void 0:n.pad)&&(s="pad"),(null===(d=e.download)||void 0===d?void 0:d.stock)&&(s="stock"),(null===(a=e.download)||void 0===a?void 0:a.dme)&&(null===(l=e.download)||void 0===l?void 0:l.pad)&&(s="dme_pad"),(0,t.jsx)(c,{value:s,operation:e,lineThrough:i},void 0)):(0,t.jsx)(t.Fragment,{},void 0)},j=({operation:e,lineThrough:i})=>{const o=e&&e.excavatorList&&e.excavatorList.length>0?e.excavatorList[0].deviceAlias:"";return(0,t.jsx)(n.Z,{color:i?"default":"secondary",icon:(0,t.jsx)(d.Z,{fontSize:"small"},void 0),size:"small",style:{textDecoration:i?"line-through":"solid"},label:o},void 0)}},67539:(e,i,o)=>{"use strict";o.d(i,{S:()=>de,a:()=>ne});var t=o(85893),n=o(67294),d=o(79895),a=o(50998),l=o(41749),s=o(95757),r=o(81860),c=o(66037),v=o(62822),u=o(31125),g=o(73099),j=o(61920);const p=({value:e,cy:i})=>{var o,n,d,a;switch(e){case j.u6.PAD:return(0,t.jsx)(s.Z,{primary:`Descarga: ${j.WW[i.download.type]} -  ${null===(o=i.download.pad.cellList[0])||void 0===o?void 0:o.name}`},void 0);case j.u6.DME:return(0,t.jsx)(s.Z,{primary:`Descarga: ${j.WW[i.download.type]} -  ${null===(n=i.download.dme.cellList[0])||void 0===n?void 0:n.name}`},void 0);case j.u6.PIT:return(0,t.jsx)(s.Z,{primary:`Descarga: ${j.WW[i.download.type]} -  ${null===(d=i.download.pit.cellList[0])||void 0===d?void 0:d.name}`},void 0);case j.u6.STOCK:return(0,t.jsx)(s.Z,{primary:`Descarga: ${j.WW[i.download.type]} -  ${null===(a=i.download.stock.cellList[0])||void 0===a?void 0:a.name}`},void 0);default:return(0,t.jsx)(t.Fragment,{},void 0)}},h=({value:e,cy:i})=>{switch(e){case j.u6.PIT:return(0,t.jsx)(s.Z,{primary:`Carga: ${j.WW[i.upload.type]} -  ${i.upload.pit.projectList[0].name}- ${i.upload.pit.projectList[0].polygonList[0].name}`},void 0);case j.u6.STOCK:return(0,t.jsx)(s.Z,{primary:`Carga: ${j.WW[i.upload.type]} -  ${i.upload.stock.cellList[0].name}}`},void 0);default:return(0,t.jsx)(t.Fragment,{children:"node"},void 0)}},x=()=>(0,t.jsx)(d.Z,Object.assign({elevation:1,style:{marginBottom:4}},{children:(0,t.jsx)(a.Z,Object.assign({dense:!0,disableGutters:!0,selected:!0,button:!0,style:{backgroundColor:"#1d4e89",borderRadius:4}},{children:(0,t.jsxs)(l.Z,Object.assign({justifyContent:"space-between",container:!0},{children:[(0,t.jsx)(s.Z,{primary:"TRUCK",style:{color:"white"}},void 0),(0,t.jsx)(s.Z,{primary:"INICIO",style:{color:"white"}},void 0),(0,t.jsx)(s.Z,{primary:"DESCARGA",style:{color:"white"}},void 0),(0,t.jsx)(s.Z,{primary:"FIN",style:{color:"white"}},void 0)]}),void 0)}),void 0)}),void 0),m=()=>(0,t.jsx)(d.Z,Object.assign({elevation:1,style:{marginBottom:0}},{children:(0,t.jsx)(a.Z,Object.assign({dense:!0,disableGutters:!0,selected:!0,button:!0,style:{backgroundColor:"#1d4e89",borderRadius:4}},{children:(0,t.jsxs)(l.Z,Object.assign({justifyContent:"space-between",container:!0,style:{marginLeft:"4px"}},{children:[(0,t.jsx)(s.Z,{primary:"EXCAVADORA",style:{color:"white"}},void 0),(0,t.jsx)(s.Z,{primary:"INICIO",style:{color:"white"}},void 0),(0,t.jsx)(s.Z,{primary:"DESCARGA",style:{color:"white"}},void 0)]}),void 0)}),void 0)}),void 0),b=n.memo((({cy:e,index:i,isCycleTruck:o})=>{var j,x,m;const[b,y]=(0,n.useState)(!1),O=()=>{y(!b)},Z=e.startTime?new Date(1e3*(null===(j=e.startTime)||void 0===j?void 0:j.seconds)).toLocaleString():"NO REG",C=e.downloadArrivalTime?new Date(1e3*(null===(x=e.downloadArrivalTime)||void 0===x?void 0:x.seconds)).toLocaleString():"NO REG. ",f=e.endTime?new Date(1e3*(null===(m=e.endTime)||void 0===m?void 0:m.seconds)).toLocaleString():"NO REG. ";return(0,t.jsxs)(d.Z,Object.assign({elevation:1,style:{marginBottom:4},id:e.id},{children:[(0,t.jsxs)(a.Z,Object.assign({dense:!0,disableGutters:!0,selected:!0,button:!0,onClick:O},{children:[(0,t.jsxs)(l.Z,Object.assign({justifyContent:"space-between",container:!0},{children:[o?(0,t.jsx)(s.Z,{primary:`${i}.${e.excavator.deviceAlias} `},void 0):(0,t.jsx)(s.Z,{primary:`${i}.${e.truck.deviceAlias} `},void 0),(0,t.jsx)(s.Z,{primary:Z},void 0),(0,t.jsx)(s.Z,{primary:C},void 0),(0,t.jsx)(s.Z,{primary:f},void 0)]}),void 0),(0,t.jsx)(r.Z,Object.assign({onClick:O},{children:(0,t.jsx)(l.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:b?(0,t.jsx)(u.Z,{fontSize:"small",onClick:O},void 0):(0,t.jsx)(g.Z,{fontSize:"small",onClick:O},void 0)}),void 0)}),void 0)]}),void 0),(0,t.jsx)(c.Z,Object.assign({in:b,style:{paddingLeft:10}},{children:(0,t.jsxs)(v.Z,Object.assign({dense:!0,disablePadding:!0},{children:[e.upload&&(0,t.jsx)(a.Z,{children:(0,t.jsx)((()=>{let i="";return e.upload.pit&&(i="pit"),e.upload.stock&&(i="stock"),(0,t.jsx)(h,{value:i,cy:e},void 0)}),{},void 0)},void 0),(0,t.jsx)(a.Z,{children:(0,t.jsx)((()=>{var i,o,n;let d="";return(null===(i=e.download)||void 0===i?void 0:i.dme)&&(d="dme"),(null===(o=e.download)||void 0===o?void 0:o.pad)&&(d="pad"),(null===(n=e.download)||void 0===n?void 0:n.stock)&&(d="stock"),(0,t.jsx)(p,{value:d,cy:e},void 0)}),{},void 0)},void 0),(0,t.jsx)(a.Z,{children:(0,t.jsx)(s.Z,{primary:`Pala: ${null!=e.excavator?e.excavator.deviceAlias:""} `},void 0)},void 0),(0,t.jsx)(a.Z,{children:(0,t.jsx)(s.Z,{primary:`Camion: ${e.truck.deviceAlias} `},void 0)},void 0)]}),void 0)}),void 0)]}),e.id)})),y=n.memo((({cy:e,index:i})=>{var o,j,x;const[m,b]=(0,n.useState)(!1),y=()=>{b(!m)},O=e.startTime?new Date(1e3*(null===(o=e.startTime)||void 0===o?void 0:o.seconds)).toLocaleString():"NO REG",Z=e.downloadArrivalTime?new Date(1e3*(null===(j=e.downloadArrivalTime)||void 0===j?void 0:j.seconds)).toLocaleString():"NO REG. ";return e.endTime&&new Date(1e3*(null===(x=e.endTime)||void 0===x?void 0:x.seconds)).toLocaleString(),(0,t.jsx)(t.Fragment,{children:void 0!==e&&(0,t.jsxs)(d.Z,Object.assign({elevation:1,style:{marginBottom:4},id:e.id},{children:[(0,t.jsxs)(a.Z,Object.assign({dense:!0,disableGutters:!0,selected:!0,button:!0,onClick:y},{children:[(0,t.jsxs)(l.Z,Object.assign({justifyContent:"space-between",container:!0},{children:[(0,t.jsx)(s.Z,{primary:`${i}.${e.excavator.deviceAlias} `},void 0),(0,t.jsx)(s.Z,{primary:O},void 0),(0,t.jsx)(s.Z,{primary:Z},void 0)]}),void 0),(0,t.jsx)(r.Z,Object.assign({onClick:y},{children:(0,t.jsx)(l.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:m?(0,t.jsx)(u.Z,{fontSize:"small",onClick:y},void 0):(0,t.jsx)(g.Z,{fontSize:"small",onClick:y},void 0)}),void 0)}),void 0)]}),void 0),(0,t.jsx)(c.Z,Object.assign({in:m,style:{paddingLeft:10}},{children:(0,t.jsxs)(v.Z,Object.assign({dense:!0,disablePadding:!0},{children:[e.upload&&(0,t.jsx)(a.Z,{children:(0,t.jsx)((()=>{let i="";return e.upload.pit&&(i="pit"),e.upload.stock&&(i="stock"),(0,t.jsx)(h,{value:i,cy:e},void 0)}),{},void 0)},void 0),(0,t.jsx)(a.Z,{children:(0,t.jsx)((()=>{var i,o,n;let d="";return(null===(i=e.download)||void 0===i?void 0:i.dme)&&(d="dme"),(null===(o=e.download)||void 0===o?void 0:o.pad)&&(d="pad"),(null===(n=e.download)||void 0===n?void 0:n.stock)&&(d="stock"),(0,t.jsx)(p,{value:d,cy:e},void 0)}),{},void 0)},void 0),(0,t.jsx)(a.Z,{children:(0,t.jsx)(s.Z,{primary:`Pala: ${null!=e.excavator?e.excavator.deviceAlias:""} `},void 0)},void 0),(0,t.jsx)(a.Z,{},void 0)]}),void 0)}),void 0)]}),e.id)},void 0)}));var O=o(96019),Z=o(26209),C=o(71267),f=o(85639),A=o(13258),w=o(10046),D=o(73637),T=o(22318),k=o(282),L=o(41120),N=o(30553);const S=(0,L.Z)((e=>({disabledSpacing:{},checkbox:{"& .MuiCheckbox-root":{margin:0,padding:0,paddingLeft:8}}}))),E=({truck:e,checked:i,useTrucksSelect:o})=>{const n=S(),[d,l]=o;return(0,t.jsx)(a.Z,Object.assign({button:!0,dense:!0,className:n.disabledSpacing},{children:(0,t.jsx)(N.Z,{className:n.checkbox,onChange:()=>{const i=d.findIndex((i=>e.deviceId===i.deviceId));-1===i?d.push(e):d.splice(i,1),l(JSON.parse(JSON.stringify(d)))},control:(0,t.jsx)(A.Z,{size:"small",checked:i,inputProps:{style:{padding:0}}},void 0),label:`${e.deviceAlias} `},void 0)}),void 0)};var $=o(2780),G=o(24673),I=o(57965),H=o(90179),W=o(73855),_=o(5977);const P=e=>{const{lengthCycles:i,excavator:o}=e;return(0,W.T)(),(0,_.k6)(),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(l.Z,Object.assign({container:!0,style:{paddingLeft:2,paddingTop:8,paddingBottom:8},alignItems:"center"},{children:[(0,t.jsx)(l.Z,Object.assign({item:!0},{children:(0,t.jsx)(T.Z,Object.assign({variant:"button",style:{paddingLeft:4,paddingTop:16}},{children:(0,t.jsx)(C.Z,{style:{marginLeft:4},icon:(0,t.jsx)(I.Z,{},void 0),label:o.deviceAlias},void 0)}),void 0)}),void 0),(0,t.jsx)(l.Z,Object.assign({item:!0},{children:(0,t.jsx)(C.Z,{style:{marginLeft:4},icon:(0,t.jsx)(H.Z,{},void 0),label:`Ciclos en turno actual: ${i}`},void 0)}),void 0)]}),void 0)},void 0)};var z=o(52672),R=o(76796),K=o(868),U=o(17812),F=o(8286),M=o(86072),J=o(96588),B=o(10646),V=o(50648),X=o(52314),Y=o(99302),q=o(97700),Q=o(30433),ee=o(97111);const ie=({operation:e})=>{const i=(0,n.useRef)(),o=(0,n.useRef)(),[a,s]=(0,n.useState)([]),[r,c]=(0,n.useState)({label:"",id:"",value:""}),{truckInfoList:v}=(0,W.C)(Y.ej),[u,g]=(0,n.useState)(!1),j=(0,W.T)(),[p,h]=(0,n.useState)(),[x,m]=(0,n.useState)(),[b]=(0,B.l)(new Date),[y]=(0,B.i)(new Date),[O,Z]=(0,n.useState)({date:`${b}T${y}`}),{id:f}=(0,_.UO)(),A={id:"",centroid:void 0,pointList:void 0,name:"Desconocido",idDme:void 0,color:void 0},[D,L]=(0,n.useState)(A),[N,S]=(0,n.useState)(A),[E,$]=(0,n.useState)(A),{dmeCellList:G,padCellList:I,stockCellList:H,polygonList:P}=(0,W.C)(q.WD),[z,ie]=(0,n.useState)([]),[oe,te]=(0,n.useState)([]),[ne,de]=(0,n.useState)([]);(0,n.useEffect)((()=>{ie([D,...G]),te([N,...I]),de([E,...H])}),[G,I,H]);const[ae,le]=(0,n.useState)(ee.f.CHANGE_NOTHING),[se,re]=(0,n.useState)(V.TypeDownload.UNKNOWN),ce=(e,i,o)=>{const t=i.find((i=>i.id===e));t&&h(Object.assign(Object.assign({},t),{type:o}))},ve=(0,n.useCallback)((()=>(0,ee.eq)(ae,ne,se,z,oe)),[ae,P,ne,se,z,oe]),ue=(0,n.useCallback)((()=>(0,ee.Ul)(v)),[v]);return(0,n.useEffect)((()=>{c(x?{label:`${null==x?void 0:x.deviceAlias}`,id:`${null==x?void 0:x.deviceId}`,value:`${null==x?void 0:x.deviceId}`}:{label:"",id:"",value:""})}),[x]),(0,n.useEffect)((()=>{g(!!p&&!!x&&!!O.date)}),[p,x,O]),(0,t.jsxs)(d.Z,Object.assign({style:{height:"400px",marginLeft:"2px"},elevation:4},{children:[(0,t.jsx)(T.Z,Object.assign({variant:"button",style:{paddingLeft:8,paddingTop:16}},{children:"Agregar Nuevo Ciclo"}),void 0),(0,t.jsx)(w.Z,{width:"100%",height:8},void 0),(0,t.jsxs)(l.Z,Object.assign({container:!0,direction:"column",style:{padding:"0.4rem",alignItems:"center"}},{children:[(0,t.jsx)(l.Z,Object.assign({item:!0},{children:(0,t.jsxs)(l.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,t.jsx)(T.Z,{children:"Carga Actual:"},void 0),(0,t.jsx)(Q.g7,{operation:e,lineThrough:!1},void 0)]}),void 0)}),void 0),(0,t.jsx)(w.Z,{width:"100%",height:8},void 0),(0,t.jsxs)(l.Z,Object.assign({item:!0},{children:[(0,t.jsxs)(l.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,t.jsx)(T.Z,{children:"Descarga Actual: "},void 0),(0,t.jsx)(Q.DQ,{operation:e,lineThrough:!1},void 0),(0,t.jsx)(l.Z,Object.assign({item:!0},{children:(0,t.jsx)(l.Z,Object.assign({container:!0},{children:p&&(0,t.jsx)(K.ZP,Object.assign({title:"Nueva Descarga"},{children:(0,t.jsx)(U.Z,Object.assign({color:"primary",size:"small"},{children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M.Z,{},void 0),(0,t.jsx)(C.Z,{size:"small",color:"secondary",label:p.name,onDelete:()=>h("")},void 0)]},void 0)}),void 0)}),void 0)}),void 0)}),void 0)]}),void 0),(0,t.jsx)(w.Z,{width:"100%",height:8},void 0),x&&(0,t.jsxs)(l.Z,Object.assign({container:!0,direction:"row",justifyContent:"center"},{children:[(0,t.jsx)(T.Z,{children:"Camión: "},void 0),(0,t.jsx)(C.Z,{size:"small",color:"secondary",label:x.deviceAlias,onDelete:()=>{m(void 0),c({label:"",id:"",value:""})}},void 0)]}),void 0)]}),void 0),(0,t.jsx)(w.Z,{height:8},void 0),e&&(0,t.jsxs)(l.Z,Object.assign({item:!0,style:{marginTop:8}},{children:[(0,t.jsx)(F.Z,{id:"date",label:"Fecha",type:"datetime-local",name:"date",value:O.date,onChange:e=>{const i=e.target;Z(Object.assign(Object.assign({},O),{[i.name]:e.target.value}))},InputLabelProps:{shrink:!0,required:!0},error:void 0===O},void 0),(0,t.jsx)(w.Z,{height:12},void 0),(0,t.jsxs)("div",Object.assign({style:{display:"flex",flexDirection:"row",height:"100px"}},{children:[(0,t.jsx)(J.ZP,{size:"small",value:r,blurOnSelect:!0,onChange:(e,i)=>{((e,i)=>{const o=i.find((i=>i.id===e));o&&m(o)})(null!=i?i.value:"",v)},options:ue(),renderTags:(e,i)=>e.map(((e,o)=>(0,t.jsx)(C.Z,Object.assign({variant:"outlined",label:e.label},i({index:o})),void 0))),style:{width:150},getOptionLabel:e=>e.label,disableClearable:!0,filterSelectedOptions:!0,renderInput:e=>(0,t.jsx)(F.Z,Object.assign({},e,{autoFocus:!0,inputRef:o,label:"Agrega Camión",variant:"outlined",fullWidth:!0,error:void 0===x}),void 0)},void 0),(0,t.jsx)(w.Z,{width:4},void 0),a.length<3&&(0,t.jsx)(J.ZP,{size:"small",value:a,blurOnSelect:!0,onChange:(e,o)=>{switch(s(o),o.length){case 0:le(ee.f.CHANGE_DOWNLOAD),re(V.TypeDownload.UNKNOWN);break;case 1:le(ee.f.CHANGE_DOWNLOAD),re(Number(o[0].value));break;case 2:switch(ae){case ee.f.CHANGE_DOWNLOAD:switch(se){case V.TypeDownload.DME:ce(o[1].id,z,se);break;case V.TypeDownload.PAD:ce(o[1].id,oe,se);break;case V.TypeDownload.STOCK:ce(o[1].id,ne,se)}}re(V.TypeDownload.UNKNOWN),le(ee.f.CHANGE_NOTHING),s([])}setTimeout((()=>{var e,o;null===(e=i.current)||void 0===e||e.focus(),null===(o=i.current)||void 0===o||o.click()}),100)},options:ve(),multiple:!0,renderTags:(e,i)=>e.map(((e,o)=>(0,t.jsx)(C.Z,Object.assign({variant:"outlined",label:e.label},i({index:o})),void 0))),style:{width:200},getOptionLabel:e=>e.label,openOnFocus:!0,disableClearable:!0,filterSelectedOptions:!0,renderInput:e=>(0,t.jsx)(F.Z,Object.assign({},e,{autoFocus:!0,inputRef:i,label:"Agrega Descarga",variant:"outlined",fullWidth:!0,error:void 0===p}),void 0)},void 0)]}),void 0)]}),void 0)]}),void 0),(0,t.jsx)(w.Z,{height:20},void 0),(0,t.jsxs)(l.Z,Object.assign({item:!0,style:{textAlign:"center"}},{children:[(0,t.jsx)(k.Z,Object.assign({variant:"outlined",size:"small",color:"secondary",onClick:()=>{return i=void 0,o=void 0,n=function*(){const i={operation:e,date:O.date,newDownload:p,truck:x};i.date&&i.newDownload&&i.truck?(yield j((0,X.YI)(i)),j((0,R.l4)(e.excavatorList[0].deviceId)),h(""),m(void 0),g(!1)):g(!0)},new((t=void 0)||(t=Promise))((function(e,d){function a(e){try{s(n.next(e))}catch(e){d(e)}}function l(e){try{s(n.throw(e))}catch(e){d(e)}}function s(i){var o;i.done?e(i.value):(o=i.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,l)}s((n=n.apply(i,o||[])).next())}));var i,o,t,n},disabled:!u},{children:"Agregar Ciclo"}),void 0),(0,t.jsx)(w.Z,{height:10},void 0)]}),void 0)]}),void 0)};function oe(e,i){return(0,t.jsx)(b,{cy:e,index:i+1},`${e.id}${i}`)}function te(e,i){return(0,t.jsx)(y,{cy:e,index:i+1},`${e.id}${i}`)}const ne=function({cycleList:e,isCycleTruck:i}){const[o,d]=(0,n.useState)([]),[a,l]=(0,n.useState)([]);return(0,n.useEffect)((()=>{if(e&&e.length>0){const i=e.map((e=>e.truck)),o=[...new Set(i.map((e=>e.deviceId)))];d(o.map((e=>i.find((i=>i.deviceId===e)))))}}),[e.length]),(0,t.jsxs)("div",Object.assign({style:{padding:"4px"}},{children:[!i&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O.Z,Object.assign({id:"id-label"},{children:"Filtro por Camión"}),void 0),(0,t.jsx)(Z.Z,Object.assign({labelId:"id-label",style:{width:"100%"},multiple:!0,value:a,onChange:e=>{const i=e.target.value;l(i)},renderValue:e=>(0,t.jsx)("div",{children:e.map((e=>(0,t.jsx)(C.Z,{label:o.find((i=>i.deviceId===e)).deviceAlias,clickable:!0,deleteIcon:(0,t.jsx)(G.Z,{onMouseDown:e=>e.stopPropagation()},void 0),onDelete:i=>(e=>{const i=a.findIndex((i=>i===e));i>=0&&a.splice(i,1),l(JSON.parse(JSON.stringify(a)))})(e)},e)))},void 0)},{children:o.map((e=>(0,t.jsxs)(f.Z,Object.assign({value:e.deviceId},{children:[(0,t.jsx)(A.Z,{checked:!!a.find((i=>i===e.deviceId))},void 0),(0,t.jsx)(s.Z,{primary:e.deviceAlias},void 0)]}),e.deviceId)))}),void 0)]},void 0),(0,t.jsx)(w.Z,{height:4},void 0),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.Z,{color:"secondary",label:`Número de Ciclos: ${e?e.length:0}`,style:{color:"white"}},void 0),(0,t.jsx)(w.Z,{height:2},void 0),(0,t.jsx)(m,{},void 0)]},void 0):(0,t.jsx)(x,{},void 0)},void 0),(0,t.jsx)(v.Z,Object.assign({style:{maxHeight:"400px",overflowY:"scroll"}},{children:e.length>0?0===a.length?i?e.map(te):e.map(oe):e.filter((e=>a.find((i=>i===e.truck.deviceId)))).map(oe):(0,t.jsx)(t.Fragment,{},void 0)}),void 0)]},void 0)]}),void 0)},de=()=>{const e=(0,n.useState)([]),i=e[0],o=(0,W.T)(),{excavator:s,cycleList:r,status:c,operation:u}=(0,W.C)(R.tl);return(0,t.jsx)(D.Z,Object.assign({in:!!r},{children:(0,t.jsx)(l.Z,Object.assign({container:!0},{children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P,{excavator:s,lengthCycles:r?r.length:0},void 0),(0,t.jsxs)(l.Z,Object.assign({container:!0},{children:[r&&(0,t.jsx)(l.Z,Object.assign({item:!0,md:6},{children:(0,t.jsxs)(d.Z,Object.assign({elevation:4},{children:[(0,t.jsx)(T.Z,Object.assign({variant:"button",style:{paddingLeft:8,paddingTop:16}},{children:"Ciclos en turno Actual"}),void 0),(0,t.jsx)(ne,{cycleList:r},void 0)]}),void 0)}),void 0),(0,t.jsx)(l.Z,Object.assign({item:!0,md:2,style:{textAlign:"center"}},{children:(0,t.jsxs)(d.Z,Object.assign({elevation:4},{children:[(0,t.jsx)(T.Z,Object.assign({variant:"button",style:{paddingLeft:8,paddingTop:16}},{children:"Camiones"}),void 0),(0,t.jsxs)(v.Z,Object.assign({dense:!0},{children:[u&&u.truckList&&u.truckList.map((o=>{return(0,t.jsx)(E,{checked:(n=o,!!i.find((e=>n.deviceId===e.deviceId))),useTrucksSelect:e,truck:o},o.deviceId);var n})),(0,t.jsx)(a.Z,{children:(0,t.jsx)(k.Z,Object.assign({style:{textAlign:"center",width:"100%"},onClick:()=>{return e=void 0,t=void 0,d=function*(){(yield(0,$.We)(u.id,i))?(o((0,z.Ui)()),location.reload()):(o((0,z.Ui)()),o((0,z.L8)({open:!0,msg:"Ocurrió un error",severity:"error"})))},new((n=void 0)||(n=Promise))((function(i,o){function a(e){try{s(d.next(e))}catch(e){o(e)}}function l(e){try{s(d.throw(e))}catch(e){o(e)}}function s(e){var o;e.done?i(e.value):(o=e.value,o instanceof n?o:new n((function(e){e(o)}))).then(a,l)}s((d=d.apply(e,t||[])).next())}));var e,t,n,d},color:"secondary",variant:"contained",size:"small",disabled:0===i.length},{children:"Liberar Camiones"}),void 0)},void 0)]}),void 0)]}),void 0)}),void 0),(0,t.jsx)(l.Z,Object.assign({item:!0,md:4,style:{paddingLeft:4,textAlign:"center"}},{children:(0,t.jsx)(ie,{operation:u},void 0)}),void 0)]}),void 0)]},void 0)}),void 0)}),void 0)}},97111:(e,i,o)=>{"use strict";o.d(i,{f:()=>t,HT:()=>r,BF:()=>c,eq:()=>v,Ul:()=>u,M6:()=>g});var t,n=o(61920),d=o(50648);!function(e){e.CHANGE_NOTHING="0",e.CHANGE_UPLOAD="1",e.CHANGE_DOWNLOAD="2",e.CHANGE_EXCAVATOR="3",e.CHANGE_TRUCKS="changetruck"}(t||(t={})),t.CHANGE_DOWNLOAD,t.CHANGE_DOWNLOAD,t.CHANGE_TRUCKS,t.CHANGE_TRUCKS;const a=[{label:"Change Upload",value:t.CHANGE_UPLOAD,id:t.CHANGE_UPLOAD},{label:"Change/Add Download",value:t.CHANGE_DOWNLOAD,id:t.CHANGE_DOWNLOAD},{label:"Change Excavator",value:t.CHANGE_EXCAVATOR,id:t.CHANGE_EXCAVATOR}],l=[{label:"TAJO",value:n.WW.TAJO.toString(),id:""},{label:"STOCK",value:n.WW.STOCK.toString(),id:""}],s=[{label:"DME",value:d.TypeDownload.DME.toString(),id:""},{label:"PAD",value:d.TypeDownload.PAD.toString(),id:""},{label:"STOCK",value:d.TypeDownload.STOCK.toString(),id:""}],r=(e,i,o)=>{switch(e.id){case t.CHANGE_UPLOAD:return i.uploadList.length>0;case t.CHANGE_DOWNLOAD:return i.downloadList.length>1;case t.CHANGE_EXCAVATOR:return i.excavatorList.length>0}return i.downloadList.some((i=>i.type===Number(e.value)))},c=(e,i,o,r,c,v,u,g)=>{let j=e===t.CHANGE_NOTHING?a:e===t.CHANGE_UPLOAD?l:[];switch(e){case t.CHANGE_NOTHING:j=a;break;case t.CHANGE_UPLOAD:j=l;break;case t.CHANGE_DOWNLOAD:j=s;break;case t.CHANGE_EXCAVATOR:j=g.map((e=>({label:e.deviceAlias,id:e.id,value:e.id})));break;default:j=s}switch(i){case n.WW.TAJO:j=o.map((e=>({label:`${e.nameProject}-${e.name}-${e.material?e.material.type:""}`,value:e.id,id:e.id})));break;case n.WW.STOCK:j=r.map((e=>({label:`${e.name}`,value:e.id,id:e.id})))}switch(c){case d.TypeDownload.DME:j=v.map((e=>({label:`${e.name}`,value:e.id,id:e.id})));break;case d.TypeDownload.PAD:j=u.map((e=>({label:`${e.name}`,value:e.id,id:e.id})));break;case d.TypeDownload.STOCK:j=r.map((e=>({label:`${e.name}`,value:e.id,id:e.id})))}return j},v=(e,i,o,n,a)=>{let r=e===t.CHANGE_DOWNLOAD?s:e===t.CHANGE_UPLOAD?l:[];switch(e){case t.CHANGE_NOTHING:case t.CHANGE_DOWNLOAD:r=s;break;case t.CHANGE_TRUCKS:r=[];break;default:r=s}switch(o){case d.TypeDownload.DME:r=n.map((e=>({label:`${e.name}`,value:e.id,id:e.id})));break;case d.TypeDownload.PAD:r=a.map((e=>({label:`${e.name}`,value:e.id,id:e.id})));break;case d.TypeDownload.STOCK:r=i.map((e=>({label:`${e.name}`,value:e.id,id:e.id})))}return r},u=e=>e.map((e=>({label:e.deviceAlias,id:e.id,value:e.id}))),g=e=>e.map((e=>({label:e.deviceAlias,id:e.deviceId,value:e.deviceId})))},10646:(e,i,o)=>{"use strict";o.d(i,{l:()=>t,i:()=>n});const t=e=>[`${e.getFullYear()}-${`0${e.getMonth()+1}`.slice(-2)}-${`0${e.getDate()}`.slice(-2)}`],n=e=>[`${`0${e.getHours()}`.substr(-2)}:${`0${e.getMinutes()}`.substr(-2)}`]},2780:(e,i,o)=>{"use strict";o.d(i,{We:()=>d,wg:()=>a});var t=o(76533),n=function(e,i,o,t){return new(o||(o=Promise))((function(n,d){function a(e){try{s(t.next(e))}catch(e){d(e)}}function l(e){try{s(t.throw(e))}catch(e){d(e)}}function s(e){var i;e.done?n(e.value):(i=e.value,i instanceof o?i:new o((function(e){e(i)}))).then(a,l)}s((t=t.apply(e,i||[])).next())}))};const d=(e,i)=>n(void 0,void 0,void 0,(function*(){return yield(0,t.g$)(i,e)})),a=e=>n(void 0,void 0,void 0,(function*(){const i=yield(0,t.zY)(e);let o="";return i.truckErrorList.length>0&&i.truckErrorList.forEach((e=>{const i=1===e.state?"CARGANDO":"A DESCARGA";o+=` ${e.truckError.deviceAlias} => ${i},`})),o}))}}]);