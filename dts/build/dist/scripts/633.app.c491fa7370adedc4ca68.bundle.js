"use strict";(self.webpackChunkdts_hytera=self.webpackChunkdts_hytera||[]).push([[633],{45258:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(87462),s=i(45987),a=i(67294),o=(i(45697),i(86010)),l=i(14670),r=i(93871),d=i(79895),c=a.forwardRef((function(e,t){var i=e.classes,l=e.className,c=e.color,u=void 0===c?"primary":c,v=e.position,h=void 0===v?"fixed":v,m=(0,s.Z)(e,["classes","className","color","position"]);return a.createElement(d.Z,(0,n.Z)({square:!0,component:"header",elevation:4,className:(0,o.Z)(i.root,i["position".concat((0,r.Z)(h))],i["color".concat((0,r.Z)(u))],l,"fixed"===h&&"mui-fixed"),ref:t},m))}));const u=(0,l.Z)((function(e){var t="light"===e.palette.type?e.palette.grey[100]:e.palette.grey[900];return{root:{display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",zIndex:e.zIndex.appBar,flexShrink:0},positionFixed:{position:"fixed",top:0,left:"auto",right:0,"@media print":{position:"absolute"}},positionAbsolute:{position:"absolute",top:0,left:"auto",right:0},positionSticky:{position:"sticky",top:0,left:"auto",right:0},positionStatic:{position:"static"},positionRelative:{position:"relative"},colorDefault:{backgroundColor:t,color:e.palette.getContrastText(t)},colorPrimary:{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText},colorSecondary:{backgroundColor:e.palette.secondary.main,color:e.palette.secondary.contrastText},colorInherit:{color:"inherit"},colorTransparent:{backgroundColor:"transparent",color:"inherit"}}}),{name:"MuiAppBar"})(c)},80024:(e,t,i)=>{var n=i(95318),s=i(20862);t.Z=void 0;var a=s(i(67294)),o=(0,n(i(2108)).default)(a.createElement("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z"}),"AddToPhotos");t.Z=o},81395:(e,t,i)=>{var n=i(95318),s=i(20862);t.Z=void 0;var a=s(i(67294)),o=(0,n(i(2108)).default)(a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle");t.Z=o},59067:(e,t,i)=>{var n=i(95318),s=i(20862);t.Z=void 0;var a=s(i(67294)),o=(0,n(i(2108)).default)(a.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");t.Z=o},79192:(e,t,i)=>{var n=i(95318),s=i(20862);t.Z=void 0;var a=s(i(67294)),o=(0,n(i(2108)).default)(a.createElement("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDownOutlined");t.Z=o},94491:(e,t,i)=>{var n=i(95318),s=i(20862);t.Z=void 0;var a=s(i(67294)),o=(0,n(i(2108)).default)(a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUncheckedOutlined");t.Z=o},53375:(e,t,i)=>{var n=i(95318),s=i(20862);t.Z=void 0;var a=s(i(67294)),o=(0,n(i(2108)).default)(a.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");t.Z=o},52303:(e,t,i)=>{var n=i(95318),s=i(20862);t.Z=void 0;var a=s(i(67294)),o=(0,n(i(2108)).default)(a.createElement("path",{d:"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2z"}),"Timeline");t.Z=o},43471:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(67294);const s=(0,i(63786).Z)(n.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBack")},51972:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(67294);const s=(0,i(63786).Z)(n.createElement("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"}),"Notifications")},16575:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(67294);const s=(0,i(63786).Z)(n.createElement("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9 11H7V9h2v2zm4 0h-2V9h2v2zm4 0h-2V9h2v2z"}),"Textsms")},61242:(e,t,i)=>{i.d(t,{a:()=>u});var n=i(85893),s=i(41120),a=i(52663),o=i(66083),l=i(29525),r=i(66856),d=i(282);const c=(0,s.Z)({disabledPadding:{padding:0,textAlign:"center"}}),u=({open:e,handleClose:t,handleConfirm:i,title:s,children:u,maxWidth:v="lg",disabled:h=!1})=>{const m=c();return(0,n.jsxs)(a.Z,Object.assign({open:e,onClose:t,maxWidth:v},{children:[(0,n.jsx)(o.Z,Object.assign({className:m.disabledPadding},{children:s}),void 0),(0,n.jsx)(l.Z,{children:u},void 0),(0,n.jsxs)(r.Z,{children:[(0,n.jsx)(d.Z,Object.assign({size:"small",color:"primary",onClick:t},{children:"Cancel"}),void 0),i&&(0,n.jsx)(d.Z,Object.assign({disabled:h,variant:"outlined",size:"small",color:"secondary",onClick:i,autoFocus:!0},{children:"Confirm"}),void 0)]},void 0)]}),void 0)}},696:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(85893),s=i(92284),a=i(73914);const o=(0,i(57850).Z)(),l=(0,a.Z)((e=>({root:{flexDirection:"column","& .ant-empty-img-1":{fill:"light"===e.palette.type?"#aeb8c2":"#262626"},"& .ant-empty-img-2":{fill:"light"===e.palette.type?"#f5f5f7":"#595959"},"& .ant-empty-img-3":{fill:"light"===e.palette.type?"#dce0e6":"#434343"},"& .ant-empty-img-4":{fill:"light"===e.palette.type?"#fff":"#1c1c1c"},"& .ant-empty-img-5":{fillOpacity:"light"===e.palette.type?"0.8":"0.08",fill:"light"===e.palette.type?"#f5f5f5":"#fff"}},label:{marginTop:e.spacing(1)}})),{defaultTheme:o});function r(){const e=l();return(0,n.jsxs)(s.nik,Object.assign({className:e.root},{children:[(0,n.jsx)("svg",Object.assign({width:"120",height:"100",viewBox:"0 0 184 152","aria-hidden":!0,focusable:"false"},{children:(0,n.jsxs)("g",Object.assign({fill:"none",fillRule:"evenodd"},{children:[(0,n.jsxs)("g",Object.assign({transform:"translate(24 31.67)"},{children:[(0,n.jsx)("ellipse",{className:"ant-empty-img-5",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"},void 0),(0,n.jsx)("path",{className:"ant-empty-img-1",d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z"},void 0),(0,n.jsx)("path",{className:"ant-empty-img-2",d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z"},void 0),(0,n.jsx)("path",{className:"ant-empty-img-3",d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z"},void 0)]}),void 0),(0,n.jsx)("path",{className:"ant-empty-img-3",d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z"},void 0),(0,n.jsxs)("g",Object.assign({className:"ant-empty-img-4",transform:"translate(149.65 15.383)"},{children:[(0,n.jsx)("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"},void 0),(0,n.jsx)("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"},void 0)]}),void 0)]}),void 0)}),void 0),(0,n.jsx)("div",Object.assign({className:e.label},{children:"Sin datos"}),void 0)]}),void 0)}},10646:(e,t,i)=>{i.d(t,{l:()=>n});const n=e=>[`${e.getFullYear()}-${`0${e.getMonth()+1}`.substr(-2)}-${`0${e.getDate()}`.substr(-2)}`]},88093:(e,t,i)=>{i.d(t,{R:()=>n});const n=()=>{var e=new Date;return e.getHours(),{dateShift:e.getHours()>=0&&e.getHours()<7?new Date(e.getTime()-864e5):e}}},11115:(e,t,i)=>{i.r(t),i.d(t,{HourmeterView:()=>ze,default:()=>Re});var n=i(85893),s=i(41749),a=i(10046),o=i(67294),l=i(88093),r=i(73855),d=i(10646),c=i(2357),u=i(12207),v=i(89844),h=i(61242),m=i(60702),j=i(44562);const g=({error:e,index:t})=>{const[i,s]=o.useState(!0),[a,l]=o.useState({vertical:"bottom",horizontal:"right"}),{vertical:r,horizontal:d}=a,c=(e,t)=>{"clickaway"!==t&&s(!1)};return(0,n.jsx)(m.Z,Object.assign({anchorOrigin:{vertical:r,horizontal:d},open:i,onClose:c,style:{marginBottom:60*t+"px"}},{children:(0,n.jsx)(j.Z,Object.assign({style:{marginTop:".5rem"},onClose:c,severity:"error"},{children:(0,n.jsx)("strong",{children:e.message},void 0)}),void 0)}),void 0)},x=({error:e})=>{const[t,i]=o.useState({open:!0,vertical:"bottom",horizontal:"right"}),{vertical:s,horizontal:a,open:l}=t,r=()=>{i(Object.assign(Object.assign({},t),{open:!1}))};return(0,n.jsx)(m.Z,Object.assign({open:!0,anchorOrigin:{vertical:s,horizontal:a}},{children:(0,n.jsx)("div",{children:null==e?void 0:e.map(((e,t)=>(0,n.jsx)(g,{error:e,handleClose:r,index:t},e.deviceId)))},void 0)}),void 0)};var f=i(92284),p=i(73914),b=i(57850),O=i(59693);function T(e){return e.type||e.mode}const y=(0,b.Z)(),S=(0,p.Z)((e=>{const t="dark"===T(e.palette);return{root:{"& .MuiDataGrid-cell--editing":{backgroundColor:"rgb(255,115,115, 0.19)",color:"#1a3e72"},"& .Mui-error":{backgroundColor:`rgb(126,10,15, ${t?0:.1})`,color:t?"#ff4343":"#750f0f"},"& .super-app-theme--false":{backgroundColor:(i=e.palette.error.main,"dark"===T(e.palette)?(0,O._j)(i,.6):(0,O.$n)(i,.6)),"&:hover":{backgroundColor:(t=>"dark"===T(e.palette)?(0,O._j)(t,.5):(0,O.$n)(t,.5))(e.palette.error.main)}}}};var i}),{defaultTheme:y});var Z,C,N=i(696);!function(e){e[e.UNKNOWN_STATE=0]="UNKNOWN_STATE",e[e.UPLOAD=1]="UPLOAD",e[e.DOWNLOAD=2]="DOWNLOAD",e[e.TO_UPLOAD=3]="TO_UPLOAD",e[e.TO_DOWNLOAD=4]="TO_DOWNLOAD",e[e.WAITING=5]="WAITING",e[e.QUEUE=6]="QUEUE",e[e.MANTO=7]="MANTO",e[e.STANDBY=8]="STANDBY",e[e.INSPECTION=9]="INSPECTION",e[e.LOAD_FUEL=10]="LOAD_FUEL",e[e.LOAD_WATER=11]="LOAD_WATER",e[e.OPERATIVE=12]="OPERATIVE"}(Z||(Z={})),function(e){e[e.UNKNOWN_SHIFT=0]="UNKNOWN_SHIFT",e[e.NIGHT=1]="NIGHT",e[e.DAY=2]="DAY",e[e.BOTH=3]="BOTH"}(C||(C={}));var E=i(32759),k=i(868),I=i(17812),w=i(52303),A=i(80024),D=i(99050),H=i(85639),L=i(79192);const P=["NONE","STANDBY","OPERATIVE","INSPECTION","MANTO"];function z(){const e=(0,r.T)(),[t,i]=o.useState(null),s=Boolean(t),a=(t="NONE")=>{i(null),e("NONE"===t?(0,v.V)({columnField:"status",operatorValue:"contains",value:""}):(0,v.V)({columnField:"status",operatorValue:"contains",value:t})),console.log(t)};return(0,n.jsxs)("div",{children:[(0,n.jsx)(I.Z,Object.assign({style:{padding:"0px",margin:"0px"},"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:e=>{i(e.currentTarget)}},{children:(0,n.jsx)(L.Z,{},void 0)}),void 0),(0,n.jsx)(D.Z,Object.assign({id:"long-menu",anchorEl:t,keepMounted:!0,open:s,onClose:()=>a("NONE"),PaperProps:{style:{maxHeight:216,width:"20ch"}}},{children:P.map((e=>(0,n.jsx)(H.Z,Object.assign({onClick:()=>a(e)},{children:e}),e)))}),void 0)]},void 0)}const R=(e,t,i,s)=>[Object.assign(Object.assign({},f.mf9),{width:70,renderHeader:e=>(0,n.jsx)(k.ZP,Object.assign({title:"Select all"},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex",padding:"0px",margin:"0px"}},{children:[(0,n.jsx)(f.KOw,Object.assign({},e),void 0),(0,n.jsx)(z,{},void 0)]}),void 0)}),void 0)}),{field:"excavator",headerName:"Excavator"},{field:"shift",headerName:"Shift"},{field:"date",headerName:"Date"},{field:"status",headerName:"Status"},{field:"hmtStart",headerName:"Hourmeter",editable:s,type:"number"},{field:"hourmeterCurrent",headerName:"hourmeter Current",editable:!s,type:"number"},{field:"adjustment",headerName:"adjustment",type:"number"},{field:"Opciones",headerName:"Opc",minWidth:110,renderCell:({row:s})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.ZP,Object.assign({onClick:()=>{console.log(s),t(s),e(!0)},title:"Add timeline"},{children:(0,n.jsx)(I.Z,Object.assign({size:"small"},{children:(0,n.jsx)(A.Z,{color:"primary",fontSize:"small"},void 0)}),void 0)}),void 0),(0,n.jsx)(k.ZP,Object.assign({onClick:()=>{t(s),i(!0)},title:"View Timeline"},{children:(0,n.jsx)(I.Z,Object.assign({size:"small"},{children:(0,n.jsx)(w.Z,{htmlColor:"Green",fontSize:"small"},void 0)}),void 0)}),void 0)]},void 0)}],M=({setOpen:e,setTimelineCurrent:t,setOpenTimeline:i})=>{const s=S(),{rows:a}=(()=>{const{statusTimeslineExcavator:e,timeslineExcavator:t}=(0,r.C)(v.tH),{currentTimelineList:i}=t,[n,s]=(0,o.useState)([]);return(0,o.useEffect)((()=>{e===E.jR.DONE?s(null==i?void 0:i.map((e=>{var t,i,n,s,a,o,l,r;return Object.assign(Object.assign({},e),{id:e.deviceId,excavator:e.deviceAlias,status:Z[e.state],hmtStart:null===(t=e.hystoryShiftList[0])||void 0===t?void 0:t.initialHourmeter.toFixed(2),hourmeterCurrent:null===(i=e.hystoryShiftList.at(-1))||void 0===i?void 0:i.initialHourmeter.toFixed(2),shift:C[null===(n=e.currentTimeline)||void 0===n?void 0:n.shift],date:new Date(1e3*(null===(a=null===(s=e.currentTimeline)||void 0===s?void 0:s.shiftDate)||void 0===a?void 0:a.seconds)).toLocaleDateString(),adjustment:(null===(o=e.currentTimeline)||void 0===o?void 0:o.adjustment)?e.currentTimeline.adjustment:0,statusAdjustment:!!(null===(l=e.currentTimeline)||void 0===l?void 0:l.status)&&(null===(r=e.currentTimeline)||void 0===r?void 0:r.status)})}))):s([])}),[t,e]),{rows:n}})(),l=(0,r.T)(),{statusTimeslineExcavator:d,filterDataGrid:c,isEditableRows:u,initialEditRowsModel:h}=(0,r.C)(v.tH),[m,j]=(0,o.useState)({});return(0,o.useEffect)((()=>{d===E.jR.DONE&&(l((0,v.hV)()),l((0,v.OE)()))}),[a]),(0,o.useEffect)((()=>{j(h)}),[h]),(0,n.jsx)("div",Object.assign({style:{height:"1150px",overflowY:"scroll",display:"flex",flexDirection:"column"}},{children:(0,n.jsx)(f._$r,{className:s.root,rowHeight:30,rows:a,columns:R(e,t,i,u),density:"compact",components:{NoRowsOverlay:N.Z},checkboxSelection:!0,disableSelectionOnClick:!0,onSelectionModelChange:e=>(e=>{const t=new Set(e),i=a.filter((e=>t.has(e.id.toString())));l((0,v.Xm)(i))})(e),editRowsModel:m,onEditRowsModelChange:e=>(e=>{var t="";for(var[i,n]of Object.entries(e))Object.keys(n).length<=1&&Object.keys(n).forEach((e=>{t=e}));console.log("key",t);var s=Object.assign({},e);switch(t){case"hourmeterCurrent":console.log("updatedModel",s),j(Object.assign(Object.assign({},m),s)),l((0,v.Jo)(s));break;case"hmtStart":Object.keys(s).length>=2?(j({}),console.log("case modelxd",e),l((0,v.Yb)({}))):(Object.keys(s).forEach((e=>{if(s[e].hourmeterCurrent){var t=s[e].hourmeterCurrent.value>=0;s[e].hourmeterCurrent=Object.assign(Object.assign({},s[e].hourmeterCurrent),{error:!t})}})),j(s),l((0,v.Yb)(s)));break;default:console.log("case default")}})(e),filterModel:{items:[c]},getRowClassName:e=>`super-app-theme--${e.row.statusAdjustment}`},void 0)}),void 0)};var V=i(8286),$=i(282);const U=(0,i(63786).Z)(o.createElement("path",{d:"M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"SearchRounded");var F=i(59067),B=i(53375);const W=e=>{const[t,i]=(0,o.useState)(e);return Object.assign({form:t,handleInputChange:e=>{i(Object.assign(Object.assign({},t),{[e.target.name]:e.target.value}))},handleReactChange:e=>{i(Object.assign(Object.assign({},t),{[e.target.name]:e.target.value}))},reset:()=>{i(e)}},t)};var G=i(93007),_=i(64436),Y=i(96019),K=i(52541),q=i(30553),X=i(40074),Q=i(41120),J=i(35117);const ee=(0,Q.Z)((e=>(0,J.Z)({container:{display:"flex",flexDirection:"column",flexWrap:"wrap",fontFamily:"inherit"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),paddingBottom:"10px",width:100}}))),te=({value:e,label:t})=>{const i=ee(),a=(0,r.T)(),l=new Date,d=`0${l.getHours()}`,c=`0${l.getMinutes()}`,{form:u,handleInputChange:h,reset:m}=W({hoursStart:`${d.slice(-2)}:${c.slice(-2)}`,status:e});(0,o.useEffect)((()=>{a((0,v.wr)(u))}),[u]),(0,o.useEffect)((()=>()=>{a((0,v.wr)({}))}),[]);const{hoursStart:j,hoursEnd:g,status:x}=u;return(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:5},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsx)("form",Object.assign({className:i.container,noValidate:!0},{children:(0,n.jsx)(V.Z,{id:"date",label:"HOUR START",type:"time",name:"hoursStart",value:j,onChange:h,className:i.textField,InputLabelProps:{shrink:!0,required:!0}},void 0)}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsxs)(_.Z,Object.assign({component:"fieldset"},{children:[(0,n.jsx)(Y.Z,Object.assign({component:"legend"},{children:"choice"}),void 0),(0,n.jsx)(K.Z,Object.assign({defaultValue:"female","aria-label":"hourmeter",name:"customized-radios"},{children:(0,n.jsx)(q.Z,{value:`${e}`,control:(0,n.jsx)(X.Z,{icon:(0,n.jsx)(f._OA,{},void 0),checkedIcon:(0,n.jsx)(f._OA,{},void 0),name:"status",checked:!0,onChange:h},void 0),label:t},void 0)}),void 0)]}),void 0)}),void 0)]}),void 0)};var ie=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function o(e){try{r(n.next(e))}catch(e){a(e)}}function l(e){try{r(n.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}))};const ne=()=>{const{rowsTimeline:e,timeslineExcavator:t,objetHourmeter:i,hourmeterStart:c,initialEditRowsModel:u}=(0,r.C)(v.tH),{currentTimelineList:m}=t,j=(0,r.T)(),{dateShift:g}=(0,l.R)(),[x]=(0,d.l)(g),[f,p]=(0,o.useState)(!1),[b,O]=(0,o.useState)(!0),[T,y]=(0,o.useState)(!0),[S,Z]=(0,o.useState)(!0),[C,N]=(0,o.useState)(!1),[E,k]=(0,o.useState)(!1),[I,w]=(0,o.useState)(!1),[A,D]=(0,o.useState)(!1),[H,L]=(0,o.useState)({}),{form:P,handleInputChange:z,resetForms:R}=W({columnField:"excavator",operatorValue:"contains",value:""}),{value:M}=P;(0,o.useEffect)((()=>{j((0,v.V)(P))}),[M]);const _=()=>0!==e.length&&e.every((e=>"STANDBY"===e.status)),Y=()=>0!==e.length&&e.every((e=>"OPERATIVE"===e.status)),K=()=>0!==e.length&&e.every((e=>"INSPECTION"===e.status)),q=()=>0!==e.length&&e.every((e=>"UNKNOWN_STATE"===e.status)),X=()=>{N(!1),k(!1),w(!1),D(!1)},Q=()=>ie(void 0,void 0,void 0,(function*(){yield j((0,v.vd)()),N(!1),k(!1),w(!1);const e={shift:0,date:`${x}T00:00`};yield j((0,v.pW)(e))}));return(0,o.useEffect)((()=>{Y()&&(O(!1),y(!0),Z(!1)),q()&&(O(!1),y(!1),Z(!1)),_()&&(O(!0),y(!1),Z(!1)),K()&&(O(!1),y(!1),Z(!0)),0==q()&&0==_()&&0==K()&&0==Y()&&(O(!0),y(!0),Z(!0))}),[e]),(0,n.jsxs)(s.Z,Object.assign({container:!0,justifyContent:"flex-end",spacing:1,style:{paddingBottom:"20px"}},{children:[(0,n.jsx)(s.Z,{children:(0,n.jsxs)(a.Z,Object.assign({sx:{display:"flex",alignItems:"flex-end"}},{children:[(0,n.jsx)(U,{},void 0),(0,n.jsx)(V.Z,{id:"input-with-sx",label:"Search ",variant:"standard",name:"value",onChange:z},void 0)]}),void 0)},void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)($.Z,Object.assign({size:"small",disabled:S,onClick:()=>w(!0),variant:"contained",color:"primary"},{children:"TO INSPECTION"}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)($.Z,Object.assign({size:"small",disabled:T,onClick:()=>k(!0),variant:"contained",color:"primary"},{children:"TO OPERATIVE"}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)($.Z,Object.assign({size:"small",disabled:b,onClick:()=>N(!0),variant:"contained",color:"primary"},{children:"TO STANDBY"}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)($.Z,Object.assign({size:"small",onClick:()=>ie(void 0,void 0,void 0,(function*(){if(f){j((0,v.lb)(!0)),p(!1),j((0,v.s_)(i)),yield j((0,v.Qc)()),D(!1);const e={shift:0,date:`${x}T00:00`};L({}),yield j((0,v.pW)(e))}else t.currentTimelineList.forEach((e=>{var t;H[e.deviceId]={hourmeterCurrent:{value:null===(t=e.currentTimeline)||void 0===t?void 0:t.initialHourmeter.toFixed(2),error:!1}}})),j((0,v.lb)(!1)),j((0,v.Pq)(H)),p(!0)})),disabled:m.some((e=>{var t;return!1===(null===(t=e.currentTimeline)||void 0===t?void 0:t.status)})),variant:"contained",color:"primary",startIcon:f?(0,n.jsx)(B.Z,{},void 0):(0,n.jsx)(F.Z,{},void 0)},{children:f?"save Shift":"Edit Shift"}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)($.Z,Object.assign({size:"small",disabled:null==c?void 0:c.isDisabled,onClick:()=>ie(void 0,void 0,void 0,(function*(){yield j((0,v.Im)());const e={shift:0,date:`${x}T00:00`};yield j((0,v.pW)(e))})),variant:"contained",color:"primary"},{children:"Edit Initial Hourmeter"}),void 0)}),void 0),(0,n.jsx)(h.a,Object.assign({open:C,handleClose:X,handleConfirm:Q,title:"Truck to STANDBY  "},{children:(0,n.jsx)(te,{value:G.StateUnitGeneral.STANDBY,label:"STANDBY"},void 0)}),void 0),(0,n.jsx)(h.a,Object.assign({open:I,handleClose:X,handleConfirm:Q,title:"Truck to INSPECTION  "},{children:(0,n.jsx)(te,{value:G.StateUnitGeneral.INSPECTION,label:"INSPECTION"},void 0)}),void 0),(0,n.jsx)(h.a,Object.assign({open:E,handleClose:X,handleConfirm:Q,title:"Truck to OPERATIVE  "},{children:(0,n.jsx)(te,{value:G.StateUnitGeneral.OPERATIONAL,label:"OPERATIVE"},void 0)}),void 0)]}),void 0)};var se=i(94491);const ae=(0,Q.Z)((()=>(0,J.Z)({line:{width:"100%",minWidth:"90px",height:"1px",border:"0",backgroundColor:"rgba(191,128,11,1)",padding:"1px",margin:"5px"},container:{display:"flex",alignItems:"center"},timeline:{display:"flex",flexWrap:"wrap",flexDirection:"column",alignItems:"center",WebkitUserSelect:"none"},span:{display:"flex",alignSelf:"start",WebkitUserSelect:"none"}}))),oe=({icon:e})=>{const t=ae();return(0,n.jsxs)("div",Object.assign({className:t.container},{children:[e||(0,n.jsx)(se.Z,{htmlColor:"#F2BB13"},void 0),(0,n.jsx)(s.Z,{className:t.line},void 0)]}),void 0)},le=(0,o.createContext)({}),{Provider:re}=le,de=({children:e,data:t,setData:i})=>{const s=ae();return(0,n.jsx)(re,Object.assign({value:{data:t}},{children:(0,n.jsx)("div",Object.assign({className:s.timeline,onClick:()=>{i()}},{children:e}),void 0)}),void 0)};var ce=i(22318);const ue=({title:e})=>{const t=ae();return(0,n.jsx)("div",Object.assign({className:t.span},{children:(0,n.jsx)(ce.Z,Object.assign({variant:"button",display:"block",gutterBottom:!0},{children:e}),void 0)}),void 0)},ve=({title:e})=>{const{data:t}=(0,o.useContext)(le);return(0,n.jsx)(ce.Z,Object.assign({style:{fontSize:".8rem",fontWeight:700},variant:"h6",component:"h6"},{children:e||(null==t?void 0:t.title.toString().toLowerCase())}),void 0)};var he=i(10150);const me=(0,p.Z)((e=>(0,he.Z)({container:{display:"flex",flexDirection:"column",flexWrap:"wrap",fontFamily:"inherit"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),paddingBottom:"10px",width:100}}))),je=()=>{var e,t,i;const s=me(),{updateTimeline:a}=(0,r.C)(v.tH),l=(0,r.T)(),d=new Date(1e3*(null===(e=a.initialTime)||void 0===e?void 0:e.seconds)),c=`0${d.getHours()}`,u=`0${d.getMinutes()}`,h=`${c.slice(-2)}:${u.slice(-2)}`,[m,j]=(0,o.useState)(Object.assign(Object.assign({},a),{initialHourmeter:null===(t=a.initialHourmeter)||void 0===t?void 0:t.toFixed(2)})),g=e=>{j(Object.assign(Object.assign({},m),{[e.target.name]:e.target.value}))},{initialHourmeter:x}=m;return(0,o.useEffect)((()=>(l((0,v.mP)(m)),()=>{})),[m]),(0,o.useEffect)((()=>()=>{l((0,v.mP)({})),j({})}),[]),(0,n.jsx)("div",{children:(0,n.jsxs)("form",Object.assign({className:s.container,noValidate:!0},{children:[(0,n.jsx)(V.Z,{id:"date",label:"HOUR",type:"time",name:"time",disabled:!0,defaultValue:h,onChange:g,className:s.textField,InputLabelProps:{shrink:!0,required:!0}},void 0),(0,n.jsx)(V.Z,{id:"date",label:"INITIAL HOURMETER",type:"number",name:"initialHourmeter",defaultValue:x,onChange:g,className:s.textField,InputLabelProps:{shrink:!0}},void 0),(0,n.jsx)(V.Z,{id:"date",label:"END HOURMETER ",type:"number",name:"initialHourmeter",disabled:!0,defaultValue:null===(i=a.finalHourmeter)||void 0===i?void 0:i.toFixed(2),className:s.textField,InputLabelProps:{shrink:!0}},void 0)]}),void 0)},void 0)};const ge=({setClose:e})=>{var t,i;const{statusTimeslineExcavator:a,currentTimeline:c,updateTimeline:u}=(0,r.C)(v.tH),m=(0,r.T)(),[j,g]=(0,o.useState)(!1),{dateShift:x}=(0,l.R)(),[f]=(0,d.l)(x),p=(0,o.useCallback)((()=>{g(!1),m((0,v.zX)({}))}),[]),b=(0,o.useCallback)((()=>{return t=void 0,i=void 0,s=function*(){yield m((0,v.NT)()),m((0,v.zX)({})),a===E.jR.DONE&&(g(!1),e(!1));const t={shift:0,date:`${f}T00:00`};yield m((0,v.pW)(t))},new((n=void 0)||(n=Promise))((function(e,a){function o(e){try{r(s.next(e))}catch(e){a(e)}}function l(e){try{r(s.throw(e))}catch(e){a(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,l)}r((s=s.apply(t,i||[])).next())}));var t,i,n,s}),[]);return(0,n.jsxs)(s.Z,Object.assign({container:!0},{children:[null==c?void 0:c.hystoryShiftList.map((e=>{var t;let i=new Date(1e3*(null===(t=e.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString();return(0,n.jsxs)(de,Object.assign({data:e,setData:()=>(e=>{m((0,v.zX)(e)),g(!0)})(e)},{children:[(0,n.jsx)(ve,{title:Z[e.initialState]},void 0),(0,n.jsx)(oe,{},void 0),(0,n.jsx)(ue,{title:i.toLocaleString().split(" ")[1].substring(0,i.split(" ")[1].length-3)},void 0)]}),e.id+Math.random())})),(0,n.jsx)(h.a,Object.assign({open:j,handleClose:p,handleConfirm:b,title:`Update Timeline ${new Date(1e3*(null===(t=u.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString().split(" ")[1].substring(0,new Date(1e3*(null===(i=u.initialTime)||void 0===i?void 0:i.seconds)).toLocaleString().split(" ")[1].length-3)}`},{children:(0,n.jsx)(je,{},void 0)}),void 0)]}),void 0)};var xe=i(81395);const fe=(e,t)=>{const i=Number.parseFloat(e)+Number.parseFloat(t);return Number.parseFloat(i.toFixed(2))},pe=({currentTimeline:e})=>{var t;const i=me(),a=(0,r.T)(),[l,c]=(0,o.useState)(0),[v,h]=(0,o.useState)(!1),m=new Date,j=`0${m.getHours()}`,g=`0${m.getMinutes()}`,[x,f]=(0,o.useState)({time:`${j.slice(-2)}:${g.slice(-2)}`,hourmeterEnd:0===(null==e?void 0:e.hystoryShiftList.length)?0:null===(t=null==e?void 0:e.hystoryShiftList)||void 0===t?void 0:t.at(-1).initialHourmeter.toFixed(1),htm:0,hourmeterCalculated:0,status:"",currentTimeline:e}),[p]=(0,d.l)(new Date),b=null==e?void 0:e.status,{time:O,hourmeterEnd:T}=x,y=function(e,t){var i,n;if(0===(null==t?void 0:t.hystoryShiftList.length))return 0;{const a=null===(i=null==t?void 0:t.hystoryShiftList)||void 0===i?void 0:i.at(-1),o=new Date(e),l=new Date(1e3*(null===(n=null==a?void 0:a.initialTime)||void 0===n?void 0:n.seconds));console.log("CurrenteDate",o),console.log("hourmeterDate",l);var s=(o.getTime()-l.getTime())/1e3;return 1/60*Math.ceil(s/60)}}(`${p}T${O}`,e),S=e=>{x.status!=`${G.StateUnitGeneral.MANTO}`?f(Object.assign(Object.assign({},x),{[e.target.name]:e.target.value})):f(Object.assign(Object.assign({},x),{[e.target.name]:e.target.value}))};return(0,o.useEffect)((()=>(a((0,u.$6)(x)),()=>{})),[x]),(0,o.useEffect)((()=>(c(fe(T,y)),()=>{a((0,u.J$)())})),[]),(0,o.useEffect)((()=>{(null==e?void 0:e.status)===Z[G.StateUnitGeneral.STANDBY]?c(null==e?void 0:e.hourmeterCurrent):c(fe(T,y)),x.status!=`${G.StateUnitGeneral.MANTO}`&&f(Object.assign(Object.assign({},x),{htm:l}))}),[O]),console.log(x),(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:5},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsxs)("form",Object.assign({className:i.container,noValidate:!0},{children:[(0,n.jsx)(V.Z,{id:"date",label:"HOUR",type:"time",name:"time",value:O,onChange:S,className:i.textField,InputLabelProps:{shrink:!0,required:!0}},void 0),(0,n.jsx)(V.Z,{id:"date",label:"HOURMETER",type:"number",disabled:!0,name:"hourmeterCalculated",value:l,onChange:S,className:i.textField,InputLabelProps:{shrink:!0}},void 0),(b===Z[G.StateUnitGeneral.MANTO]||v)&&(0,n.jsx)(V.Z,{autoFocus:!0,id:"date",label:"HOURMETER Start",type:"number",name:"htm",defaultValue:l,onChange:S,className:i.textField,InputLabelProps:{shrink:!0,required:!0}},void 0)]}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsxs)(_.Z,Object.assign({component:"fieldset"},{children:[(0,n.jsx)(Y.Z,Object.assign({component:"legend"},{children:"choice"}),void 0),(0,n.jsxs)(K.Z,Object.assign({defaultValue:"female","aria-label":"hourmeter",name:"customized-radios"},{children:[(0,n.jsx)(q.Z,{value:`${G.StateUnitGeneral.MANTO}`,control:(0,n.jsx)(X.Z,{icon:(0,n.jsx)(xe.Z,{},void 0),checkedIcon:(0,n.jsx)(xe.Z,{},void 0),name:"status",onClick:e=>{setTimeout((()=>{f(Object.assign(Object.assign({},x),{htm:l,status:`${G.StateUnitGeneral.MANTO}`}))}),10),h(e.target.checked)},onChange:S,disabled:b===Z[G.StateUnitGeneral.MANTO]},void 0),label:Z[G.StateUnitGeneral.MANTO]},void 0),(0,n.jsx)(q.Z,{value:`${G.StateUnitGeneral.STANDBY}`,control:(0,n.jsx)(X.Z,{icon:(0,n.jsx)(xe.Z,{},void 0),checkedIcon:(0,n.jsx)(xe.Z,{},void 0),name:"status",onClick:()=>h(!1),disabled:b===Z[G.StateUnitGeneral.STANDBY],onChange:S},void 0),label:Z[G.StateUnitGeneral.STANDBY]},void 0),(0,n.jsx)(q.Z,{value:`${G.StateUnitGeneral.INSPECTION}`,control:(0,n.jsx)(X.Z,{icon:(0,n.jsx)(xe.Z,{},void 0),checkedIcon:(0,n.jsx)(xe.Z,{},void 0),onClick:()=>h(!1),name:"status",disabled:b===Z[G.StateUnitGeneral.INSPECTION],onChange:S},void 0),label:Z[G.StateUnitGeneral.INSPECTION]},void 0),(0,n.jsx)(q.Z,{value:`${G.StateUnitGeneral.OPERATIONAL}`,control:(0,n.jsx)(X.Z,{icon:(0,n.jsx)(xe.Z,{},void 0),checkedIcon:(0,n.jsx)(xe.Z,{},void 0),name:"status",disabled:b===Z[G.StateUnitGeneral.OPERATIONAL],onClick:()=>h(!1),onChange:S},void 0),label:Z[G.StateUnitGeneral.OPERATIONAL]},void 0)]}),void 0)]}),void 0)}),void 0)]}),void 0)};var be=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function o(e){try{r(n.next(e))}catch(e){a(e)}}function l(e){try{r(n.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}))};const Oe=()=>{const e=(0,r.T)(),{timelineErrorList:t,currentTimeline:i}=(0,r.C)(v.tH),{formValues:m}=(0,r.C)(u.k3),{dateShift:j}=(0,l.R)(),[g]=(0,d.l)(j),[f,p]=(0,o.useState)(c.Shift.UNKNOWN_SHIFT),[b,O]=(0,o.useState)(!1),[T,y]=(0,o.useState)(!1),[S,Z]=(0,o.useState)(!0),[C,N]=(0,o.useState)([]),E=(0,o.useCallback)((()=>{O(!1),Z(!0),y(!1)}),[]);return(0,o.useEffect)((()=>{const t={shift:0,date:`${g}T00:00`};return e((0,v.pW)(t)),()=>{}}),[]),(0,o.useEffect)((()=>{m.status?Z(!1):Z(!0)}),[m]),(0,o.useEffect)((()=>{e((0,v.gc)(C))}),[C]),(0,n.jsxs)(a.Z,Object.assign({m:2,p:.5,style:{height:"100%"}},{children:[(0,n.jsx)(s.Z,{children:(0,n.jsx)(ne,{},void 0)},void 0),(0,n.jsx)(s.Z,Object.assign({container:!0,style:{height:"100%"}},{children:(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,sm:12,xs:12},{children:(0,n.jsx)(M,{setOpen:O,setTimelineCurrent:N,setOpenTimeline:y},void 0)}),void 0)}),void 0),(0,n.jsx)(h.a,Object.assign({open:b,handleClose:E,handleConfirm:()=>be(void 0,void 0,void 0,(function*(){yield e((0,v.SN)()),O(!1),Z(!0),yield function(){return be(this,void 0,void 0,(function*(){const t={shift:f,date:`${g}T00:00`};yield e((0,v.pW)(t))}))}()})),title:`Excavator  ${C.deviceAlias}  `,disabled:S},{children:(0,n.jsx)(pe,{currentTimeline:i},void 0)}),void 0),(0,n.jsx)(h.a,Object.assign({open:T,handleClose:E,title:`Timeline to  ${C.deviceAlias} `,disabled:S},{children:(0,n.jsx)(ge,{setClose:y},void 0)}),void 0),!(null==t?void 0:t.success)&&(0,n.jsx)(x,{error:null==t?void 0:t.errorsList},void 0)]}),void 0)};var Te=i(54875);const ye=()=>{var e,t,i;const s=me(),{updateTimeline:a}=(0,r.C)(Te.rf),l=(0,r.T)(),d=new Date(1e3*(null===(e=a.initialTime)||void 0===e?void 0:e.seconds)),c=`0${d.getHours()}`,u=`0${d.getMinutes()}`,v=`${c.slice(-2)}:${u.slice(-2)}`,[h,m]=(0,o.useState)(Object.assign(Object.assign({},a),{initialHourmeter:null===(t=a.initialHourmeter)||void 0===t?void 0:t.toFixed(2)})),j=e=>{m(Object.assign(Object.assign({},h),{[e.target.name]:e.target.value}))},{initialHourmeter:g}=h;return console.log("formUpadateTimeline",h),(0,o.useEffect)((()=>(l((0,Te.Zp)(h)),()=>{})),[h]),(0,o.useEffect)((()=>()=>{l((0,Te.Zp)({})),m({})}),[]),(0,n.jsx)("div",{children:(0,n.jsxs)("form",Object.assign({className:s.container,noValidate:!0},{children:[(0,n.jsx)(V.Z,{id:"date",label:"HOUR",type:"time",name:"time",disabled:!0,defaultValue:v,onChange:j,className:s.textField,InputLabelProps:{shrink:!0,required:!0}},void 0),(0,n.jsx)(V.Z,{id:"date",label:"INITIAL HOURMETER",type:"number",name:"initialHourmeter",defaultValue:g,onChange:j,className:s.textField,InputLabelProps:{shrink:!0}},void 0),(0,n.jsx)(V.Z,{id:"date",label:"END HOURMETER ",type:"number",name:"initialHourmeter",disabled:!0,defaultValue:null===(i=a.finalHourmeter)||void 0===i?void 0:i.toFixed(2),className:s.textField,InputLabelProps:{shrink:!0}},void 0)]}),void 0)},void 0)};const Se=({setClose:e})=>{var t,i;const{status:a,currentTimeline:c,updateTimeline:u}=(0,r.C)(Te.rf),v=(0,r.T)(),[m,j]=(0,o.useState)(!1),{dateShift:g}=(0,l.R)(),[x]=(0,d.l)(g),f=(0,o.useCallback)((()=>{j(!1),v((0,Te.Uy)({}))}),[]),p=(0,o.useCallback)((()=>{return t=void 0,i=void 0,s=function*(){yield v((0,Te.ft)()),v((0,Te.Uy)({})),"done"===a&&(j(!1),e(!1));const t={shift:0,date:`${x}T00:00`};yield v((0,Te.mA)(t))},new((n=void 0)||(n=Promise))((function(e,a){function o(e){try{r(s.next(e))}catch(e){a(e)}}function l(e){try{r(s.throw(e))}catch(e){a(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,l)}r((s=s.apply(t,i||[])).next())}));var t,i,n,s}),[]);return(0,n.jsxs)(s.Z,Object.assign({container:!0},{children:[null==c?void 0:c.hystoryShiftList.map((e=>{var t;let i=new Date(1e3*(null===(t=e.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString();return(0,n.jsxs)(de,Object.assign({data:e,setData:()=>(e=>{v((0,Te.Uy)(e)),j(!0)})(e)},{children:[(0,n.jsx)(ve,{title:Z[e.initialState]},void 0),(0,n.jsx)(oe,{},void 0),(0,n.jsx)(ue,{title:i.toLocaleString().split(" ")[1].substring(0,i.split(" ")[1].length-3)},void 0)]}),e.id+Math.random())})),(0,n.jsx)(h.a,Object.assign({open:m,handleClose:f,handleConfirm:p,title:`Update Timeline ${new Date(1e3*(null===(t=u.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString().split(" ")[1].substring(0,new Date(1e3*(null===(i=u.initialTime)||void 0===i?void 0:i.seconds)).toLocaleString().split(" ")[1].length-3)}`},{children:(0,n.jsx)(ye,{},void 0)}),void 0)]}),void 0)},Ze=(0,Q.Z)((e=>(0,J.Z)({container:{display:"flex",flexDirection:"column",flexWrap:"wrap",fontFamily:"inherit"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),paddingBottom:"10px",width:100}}))),Ce=({value:e,label:t})=>{const i=Ze(),a=(0,r.T)(),l=new Date,d=`0${l.getHours()}`,c=`0${l.getMinutes()}`,{form:u,handleInputChange:v,reset:h}=W({hoursStart:`${d.slice(-2)}:${c.slice(-2)}`,status:e});(0,o.useEffect)((()=>{a((0,Te.gS)(u))}),[u]),(0,o.useEffect)((()=>()=>{a((0,Te.XH)())}),[]);const{hoursStart:m,hoursEnd:j,status:g}=u;return(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:5},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsx)("form",Object.assign({className:i.container,noValidate:!0},{children:(0,n.jsx)(V.Z,{id:"date",label:"HOUR START",type:"time",name:"hoursStart",value:m,onChange:v,className:i.textField,InputLabelProps:{shrink:!0,required:!0}},void 0)}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsxs)(_.Z,Object.assign({component:"fieldset"},{children:[(0,n.jsx)(Y.Z,Object.assign({component:"legend"},{children:"choice"}),void 0),(0,n.jsx)(K.Z,Object.assign({defaultValue:"female","aria-label":"hourmeter",name:"customized-radios"},{children:(0,n.jsx)(q.Z,{value:`${e}`,control:(0,n.jsx)(X.Z,{icon:(0,n.jsx)(f._OA,{},void 0),checkedIcon:(0,n.jsx)(f._OA,{},void 0),name:"status",checked:!0,onChange:v},void 0),label:t},void 0)}),void 0)]}),void 0)}),void 0)]}),void 0)};var Ne=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function o(e){try{r(n.next(e))}catch(e){a(e)}}function l(e){try{r(n.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}))};const Ee=()=>{const{rowsTimeline:e,timesline:t,objetHourmeter:i,hourmeterStart:c}=(0,r.C)(Te.rf),{currentTimelineList:u}=t,v=(0,r.T)(),{dateShift:m}=(0,l.R)(),[j]=(0,d.l)(m),[g,x]=(0,o.useState)(!1),[f,p]=(0,o.useState)(!0),[b,O]=(0,o.useState)(!0),[T,y]=(0,o.useState)(!0),[S,Z]=(0,o.useState)(!1),[C,N]=(0,o.useState)(!1),[E,k]=(0,o.useState)(!1),[I,w]=(0,o.useState)(!1),[A,D]=(0,o.useState)({}),{form:H,handleInputChange:L,resetForms:P}=W({columnField:"truck",operatorValue:"contains",value:""}),{value:z}=H;(0,o.useEffect)((()=>{v((0,Te.V)(H))}),[z]);const R=()=>0!==e.length&&e.every((e=>"STANDBY"===e.status)),M=()=>0!==e.length&&e.every((e=>"OPERATIVE"===e.status)),_=()=>0!==e.length&&e.every((e=>"INSPECTION"===e.status)),Y=()=>0!==e.length&&e.every((e=>"UNKNOWN_STATE"===e.status)),K=()=>{Z(!1),N(!1),k(!1),w(!1)},q=()=>Ne(void 0,void 0,void 0,(function*(){yield v((0,Te._C)()),Z(!1),N(!1),k(!1);const e={shift:0,date:`${j}T00:00`};yield v((0,Te.mA)(e))}));return(0,o.useEffect)((()=>{M()&&(p(!1),O(!0),y(!1)),Y()&&(p(!1),O(!1),y(!1)),R()&&(p(!0),O(!1),y(!1)),_()&&(p(!1),O(!1),y(!0)),0==Y()&&0==R()&&0==_()&&0==M()&&(p(!0),O(!0),y(!0))}),[e]),(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:1,justifyContent:"flex-end",style:{paddingBottom:"20px"}},{children:[(0,n.jsx)(s.Z,{children:(0,n.jsxs)(a.Z,Object.assign({sx:{display:"flex",alignItems:"flex-end"}},{children:[(0,n.jsx)(U,{},void 0),(0,n.jsx)(V.Z,{id:"input-with-sx",label:"Search ",variant:"standard",name:"value",onChange:L},void 0)]}),void 0)},void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)($.Z,Object.assign({size:"small",disabled:T,onClick:()=>k(!0),variant:"contained",color:"primary"},{children:"TO INSPECTION"}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)($.Z,Object.assign({size:"small",disabled:b,onClick:()=>N(!0),variant:"contained",color:"primary"},{children:"TO OPERATIVE"}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)($.Z,Object.assign({size:"small",disabled:f,onClick:()=>Z(!0),variant:"contained",color:"primary"},{children:"TO STANDBY"}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)($.Z,Object.assign({size:"small",disabled:u.some((e=>{var t;return!1===(null===(t=e.currentTimeline)||void 0===t?void 0:t.status)})),onClick:()=>Ne(void 0,void 0,void 0,(function*(){if(g){v((0,Te.zA)(!0)),x(!1),v((0,Te.S2)(i)),yield v((0,Te.nx)()),w(!1);const e={shift:0,date:`${j}T00:00`};v((0,Te.dy)()),D({}),yield v((0,Te.mA)(e))}else t.currentTimelineList.forEach((e=>{var t;A[e.deviceId]={hourmeterCurrent:{value:null===(t=e.currentTimeline)||void 0===t?void 0:t.initialHourmeter.toFixed(2),error:!1}}})),v((0,Te.zA)(!1)),v((0,Te.x)(A)),x(!0)})),variant:"contained",color:"primary",startIcon:g?(0,n.jsx)(B.Z,{},void 0):(0,n.jsx)(F.Z,{},void 0)},{children:g?"save Shift":"Edit Shift"}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)($.Z,Object.assign({size:"small",disabled:null==c?void 0:c.isDisabled,onClick:()=>Ne(void 0,void 0,void 0,(function*(){yield v((0,Te.cs)());const e={shift:0,date:`${j}T00:00`};v((0,Te.ZB)()),yield v((0,Te.mA)(e))})),variant:"contained",color:"primary"},{children:"Edit Initial Hourmeter"}),void 0)}),void 0),(0,n.jsx)(h.a,Object.assign({open:S,handleClose:K,handleConfirm:q,title:"Truck to STANDBY  "},{children:(0,n.jsx)(Ce,{value:G.StateUnitGeneral.STANDBY,label:"STANDBY"},void 0)}),void 0),(0,n.jsx)(h.a,Object.assign({open:E,handleClose:K,handleConfirm:q,title:"Truck to INSPECTION  "},{children:(0,n.jsx)(Ce,{value:G.StateUnitGeneral.INSPECTION,label:"INSPECTION"},void 0)}),void 0),(0,n.jsx)(h.a,Object.assign({open:C,handleClose:K,handleConfirm:q,title:"Truck to OPERATIVE  "},{children:(0,n.jsx)(Ce,{value:G.StateUnitGeneral.OPERATIONAL,label:"OPERATIVE"},void 0)}),void 0)]}),void 0)},ke=["NONE","STANDBY","OPERATIVE","INSPECTION","MANTO"];function Ie(){const e=(0,r.T)(),[t,i]=o.useState(null),s=Boolean(t),a=(t="NONE")=>{i(null),e("NONE"===t?(0,Te.V)({columnField:"status",operatorValue:"contains",value:""}):(0,Te.V)({columnField:"status",operatorValue:"contains",value:t})),console.log(t)};return(0,n.jsxs)("div",{children:[(0,n.jsx)(I.Z,Object.assign({style:{padding:"0px",margin:"0px"},"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:e=>{i(e.currentTarget)}},{children:(0,n.jsx)(L.Z,{},void 0)}),void 0),(0,n.jsx)(D.Z,Object.assign({id:"long-menu",anchorEl:t,keepMounted:!0,open:s,onClose:()=>a("NONE"),PaperProps:{style:{maxHeight:216,width:"20ch"}}},{children:ke.map((e=>(0,n.jsx)(H.Z,Object.assign({onClick:()=>a(e)},{children:e}),e)))}),void 0)]},void 0)}const we=(e,t,i,s)=>[Object.assign(Object.assign({},f.mf9),{width:70,renderHeader:e=>(0,n.jsx)(k.ZP,Object.assign({title:"Select all"},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex",padding:"0px",margin:"0px"}},{children:[(0,n.jsx)(f.KOw,Object.assign({},e),void 0),(0,n.jsx)(Ie,{},void 0)]}),void 0)}),void 0)}),{field:"truck",headerName:"Truck"},{field:"shift",headerName:"Shift"},{field:"date",headerName:"Date"},{field:"status",headerName:"Status"},{field:"hmtStart",headerName:"Hourmeter",editable:s,type:"number"},{field:"hourmeterCurrent",headerName:"hourmeter Current",editable:!s,type:"number"},{field:"adjustment",headerName:"adjustment",type:"number"},{field:"Opciones",headerName:"Opc",minWidth:110,renderCell:({row:s})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.ZP,Object.assign({onClick:()=>{console.log(s),t(s),e(!0)},title:"Add timeline"},{children:(0,n.jsx)(I.Z,Object.assign({size:"small"},{children:(0,n.jsx)(A.Z,{color:"primary",fontSize:"small"},void 0)}),void 0)}),void 0),(0,n.jsx)(k.ZP,Object.assign({onClick:()=>{t(s),i(!0)},title:"View Timeline"},{children:(0,n.jsx)(I.Z,Object.assign({size:"small"},{children:(0,n.jsx)(w.Z,{htmlColor:"Green",fontSize:"small"},void 0)}),void 0)}),void 0)]},void 0)}],Ae=o.memo((({setOpen:e,setTimelineCurrent:t,setOpenTimeline:i})=>{const s=S(),a=(0,r.T)(),{status:l,filterDataGrid:d,selectModel:c,initialEditRowsModel:u,statusUpdateInitialHourmeterTimeline:v,isEditableRows:h}=(0,r.C)(Te.rf),{rows:m}=(()=>{const{timesline:e,status:t}=(0,r.C)(Te.rf),{currentTimelineList:i}=e,[n,s]=(0,o.useState)([]);return(0,o.useEffect)((()=>{s("done"===t?null==i?void 0:i.map((e=>{var t,i,n,s,a,o,l,r;return Object.assign(Object.assign({},e),{id:e.deviceId,truck:e.deviceAlias,status:Z[e.state],hmtStart:null===(t=e.hystoryShiftList[0])||void 0===t?void 0:t.initialHourmeter.toFixed(2),hourmeterCurrent:null===(i=e.hystoryShiftList.at(-1))||void 0===i?void 0:i.initialHourmeter.toFixed(2),shift:C[null===(n=e.currentTimeline)||void 0===n?void 0:n.shift],date:new Date(1e3*(null===(a=null===(s=e.currentTimeline)||void 0===s?void 0:s.shiftDate)||void 0===a?void 0:a.seconds)).toLocaleDateString(),adjustment:(null===(o=e.currentTimeline)||void 0===o?void 0:o.adjustment)?e.currentTimeline.adjustment:0,statusAdjustment:!!(null===(l=e.currentTimeline)||void 0===l?void 0:l.status)&&(null===(r=e.currentTimeline)||void 0===r?void 0:r.status)})})):[])}),[e,t]),{rows:n}})(),[j,g]=(0,o.useState)({}),[x,p]=(0,o.useState)(!0),[b,O]=(0,o.useState)({}),[T,y]=o.useState([]);return(0,o.useEffect)((()=>{g({})}),[v]),(0,o.useEffect)((()=>{p("done"!==l&&"failed"!==l)}),[l]),(0,o.useEffect)((()=>{"done"===l&&y(c)}),[c]),(0,o.useEffect)((()=>{"done"===l&&(a((0,Te.Cb)()),a((0,Te.B6)([])))}),[m]),(0,o.useEffect)((()=>()=>{a((0,Te.gI)())}),[]),(0,o.useEffect)((()=>{g(u)}),[u]),(0,n.jsx)("div",Object.assign({style:{height:"1150px",overflowY:"scroll",display:"flex",flexDirection:"column"}},{children:(0,n.jsx)(f._$r,{className:s.root,rowHeight:30,rows:m,columns:we(e,t,i,h),density:"compact",components:{NoRowsOverlay:N.Z},checkboxSelection:!0,disableSelectionOnClick:!0,loading:x,onSelectionModelChange:e=>(e=>{const t=new Set(e),i=m.filter((e=>t.has(e.id.toString())));a((0,Te.Xm)(i))})(e),editRowsModel:j,onEditRowsModelChange:e=>(e=>{var t="";for(var[i,n]of Object.entries(e))Object.keys(n).length<=1&&Object.keys(n).forEach((e=>{t=e}));var s=Object.assign({},e);switch(t){case"hourmeterCurrent":console.log("updatedModel",s),g(Object.assign(Object.assign({},j),s)),a((0,Te.t8)(s));break;case"hmtStart":Object.keys(s).length>=2?(g({}),console.log("case modelxd",e),a((0,Te.ZB)())):(Object.keys(s).forEach((e=>{if(s[e].hourmeterCurrent){var t=s[e].hourmeterCurrent.value>=10;s[e].hourmeterCurrent=Object.assign(Object.assign({},s[e].hourmeterCurrent),{error:!t})}})),g(s),a((0,Te.SZ)(s)));break;default:console.log("case default")}})(e),filterModel:{items:[d]},getRowClassName:e=>`super-app-theme--${e.row.statusAdjustment}`},void 0)}),void 0)}));var De=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function o(e){try{r(n.next(e))}catch(e){a(e)}}function l(e){try{r(n.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}))};const He=()=>{const e=(0,r.T)(),{status:t,timelineErrorList:i,currentTimeline:v}=(0,r.C)(Te.rf),{formValues:m}=(0,r.C)(u.k3),{dateShift:j}=(0,l.R)(),[g]=(0,d.l)(j),[f,p]=(0,o.useState)(c.Shift.UNKNOWN_SHIFT),[b,O]=(0,o.useState)(!1),[T,y]=(0,o.useState)(!1),[S,Z]=(0,o.useState)(!0),[C,N]=(0,o.useState)([]),E=(0,o.useCallback)((()=>{O(!1),Z(!0),y(!1)}),[]);return(0,o.useEffect)((()=>{const t={shift:0,date:`${g}T00:00`};return e((0,Te.mA)(t)),()=>{e((0,Te.gI)())}}),[]),(0,o.useEffect)((()=>{m.status?Z(!1):Z(!0)}),[m]),(0,o.useEffect)((()=>{e((0,Te.jO)(C))}),[C]),(0,n.jsxs)(a.Z,Object.assign({m:2,p:.5,style:{height:"100%"}},{children:[(0,n.jsx)(s.Z,{children:(0,n.jsx)(Ee,{},void 0)},void 0),(0,n.jsx)(s.Z,Object.assign({container:!0,style:{height:"100%"}},{children:(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,sm:12,xs:12},{children:(0,n.jsx)(Ae,{setOpen:O,setTimelineCurrent:N,setOpenTimeline:y},void 0)}),void 0)}),void 0),(0,n.jsx)(h.a,Object.assign({open:b,handleClose:E,handleConfirm:()=>De(void 0,void 0,void 0,(function*(){yield e((0,Te.Sp)()),O(!1),Z(!0),yield function(){return De(this,void 0,void 0,(function*(){const t={shift:f,date:`${g}T00:00`};yield e((0,Te.mA)(t))}))}()})),title:`Truck  ${C.truck}  `,disabled:S},{children:(0,n.jsx)(pe,{currentTimeline:v},void 0)}),void 0),(0,n.jsx)(h.a,Object.assign({open:T,handleClose:E,title:`Timeline to  ${C.truck} `,disabled:S},{children:(0,n.jsx)(Se,{setClose:y},void 0)}),void 0),"done"===t&&!(null==i?void 0:i.success)&&(0,n.jsx)(x,{error:null==i?void 0:i.errorsList},void 0)]}),void 0)},Le=()=>(0,n.jsx)("div",{children:(0,n.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6},{children:(0,n.jsx)(He,{},void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6},{children:(0,n.jsx)(Oe,{},void 0)}),void 0)]}),void 0)},void 0);var Pe=i(16281);const ze=()=>(0,n.jsxs)("div",{children:[(0,n.jsx)(Pe.h,{title:"Hourmeter",notificationPannel:!0},void 0),(0,n.jsx)(Le,{},void 0)]},void 0),Re=ze},16281:(e,t,i)=>{i.d(t,{h:()=>T});var n=i(85893),s=i(45258),a=i(28358),o=i(282),l=i(22318),r=i(43471),d=i(5977),c=i(55517),u=i(17812),v=i(96617),h=i(73637),m=i(79895),j=i(16575),g=i(51972),x=i(67294),f=i(73855),p=i(45855);const b=({title:e,content:t})=>(0,n.jsxs)("div",Object.assign({style:{paddingBottom:"8px",paddingTop:"8px"}},{children:[(0,n.jsxs)(l.Z,Object.assign({variant:"subtitle1"},{children:[(0,n.jsx)(j.Z,{style:{fontSize:"14px",marginRight:"4px"}},void 0),e]}),void 0),(0,n.jsx)(l.Z,Object.assign({variant:"body1"},{children:t}),void 0),(0,n.jsx)(c.Z,{},void 0)]}),void 0),O=({})=>{var e,t,i;const[s,a]=(0,x.useState)(null),[o,r]=(0,x.useState)(!1),{notificationsHeader:d}=(0,f.C)(p.Af),c=(0,f.T)();(0,x.useEffect)((()=>{c((0,p.pK)())}),[]);const j=o&&Boolean(s)?"transition-popper":void 0;return(0,n.jsxs)("div",Object.assign({style:{display:"flex",flexDirection:"row",alignItems:"center",width:"8%",marginRight:"4px"}},{children:["Notifications",(0,n.jsx)(u.Z,Object.assign({color:(null===(e=d.notificationsList)||void 0===e?void 0:e.length)>0?"primary":"inherit",onClick:e=>{a(e.currentTarget),r((e=>!e))}},{children:(0,n.jsxs)("div",Object.assign({style:{margin:"4px"}},{children:[(0,n.jsx)(l.Z,Object.assign({variant:"subtitle2",style:{color:"white",zIndex:1,position:"absolute",justifyContent:"right",marginLeft:"18px"}},{children:(null===(t=d.notificationsList)||void 0===t?void 0:t.length)>0?null===(i=d.notificationsList)||void 0===i?void 0:i.length:""}),void 0),(0,n.jsx)(g.Z,{},void 0)]}),void 0)}),void 0),(0,n.jsx)("div",Object.assign({style:{zIndex:1}},{children:(0,n.jsx)(v.Z,Object.assign({id:j,open:o,anchorEl:s,transition:!0,style:{zIndex:3}},{children:({TransitionProps:e})=>{var t,i,s;return(0,n.jsx)(h.Z,Object.assign({},e,{timeout:350},{children:(0,n.jsxs)(m.Z,Object.assign({elevation:3,style:{width:"300px",height:(null===(t=d.notificationsList)||void 0===t?void 0:t.length)>10?"87vh":"100%",padding:"8px",overflow:"scroll"}},{children:[0===(null===(i=d.notificationsList)||void 0===i?void 0:i.length)&&(0,n.jsx)(n.Fragment,{children:"Not Have a new Notification"},void 0),null===(s=d.notificationsList)||void 0===s?void 0:s.map(((e,t)=>(0,n.jsx)(b,{title:e.title,content:e.message},t)))]}),void 0)}),void 0)}}),void 0)}),void 0)]}),void 0)},T=({title:e,positionContainer:t,notificationPannel:i})=>{const c=t||"sticky",u=(0,d.k6)();return(0,n.jsx)(s.Z,Object.assign({position:c,color:"secondary",style:{display:"flex"},elevation:0},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex"}},{children:[(0,n.jsxs)(a.Z,Object.assign({style:{width:"90%"}},{children:[(0,n.jsx)(o.Z,{size:"small",startIcon:(0,n.jsx)(r.Z,{color:"action",style:{color:"#fff"}},void 0),onClick:()=>{u.goBack()}},void 0),(0,n.jsx)(l.Z,Object.assign({variant:"h6"},{children:e}),void 0)]}),void 0),i&&(0,n.jsx)(O,{},void 0)]}),void 0)}),void 0)}}}]);