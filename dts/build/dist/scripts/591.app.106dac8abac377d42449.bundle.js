"use strict";(self.webpackChunkdts_hytera=self.webpackChunkdts_hytera||[]).push([[591],{48101:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(85893),a=i(67294),l=i(34880);const s=i(6158);s.accessToken=l.c3;const o=({dragRotate:e,map:t,pitch:i,bearing:l,mapContainer:o,lng:d,lat:r,zoom:c,setLoad:u,style:v,height:j,dragControls:g=!0})=>((0,a.useEffect)((()=>{t.current||o&&(t.current=new s.Map({container:o.current,style:v,center:[d,r],pitch:i,bearing:l,zoom:c,antialias:!0,dragRotate:e}))}),[t,o]),(0,a.useEffect)((()=>{t.current&&(g&&(t.current.addControl(new s.FullscreenControl,"bottom-left"),t.current.addControl(new s.NavigationControl,"bottom-left")),t.current.on("move",(()=>{})),t.current.on("click",(e=>{console.log(e.lngLat)})),t.current.on("load",(()=>{t.current&&u(!0)})))}),[t]),(0,a.useEffect)((()=>{t.current&&t.current.setBearing(l)}),[l]),(0,n.jsx)("div",{ref:o,style:{flex:1,height:j||"100vh",width:"100%"},className:"map-container"}))},30433:(e,t,i)=>{i.d(t,{DQ:()=>j,Ez:()=>g,g7:()=>v});var n=i(85893),a=i(71267),l=i(12575),s=i(61920),o=i(99945),d=i(44326),r=i(93584);const c=({value:e,operation:t,lineThrough:i=!1})=>{const l=e=>{var i,n,a,l,o,d,r,c,u,v,j,g;switch(e){case s.u6.DME:const e=(null===(n=null===(i=t.download)||void 0===i?void 0:i.dme)||void 0===n?void 0:n.cellList.length)>0?null===(l=null===(a=t.download)||void 0===a?void 0:a.dme)||void 0===l?void 0:l.cellList[0].name:"";return e.toUpperCase().includes("DME")?e:`DME-${e}`;case s.u6.PAD:const p=(null===(d=null===(o=t.download)||void 0===o?void 0:o.pad)||void 0===d?void 0:d.cellList.length)>0?null===(c=null===(r=t.download)||void 0===r?void 0:r.pad)||void 0===c?void 0:c.cellList[0].name:"";return p.toUpperCase().includes("PAD")?p:`PAD-${p}`;case s.u6.STOCK:const x=(null===(v=null===(u=t.download)||void 0===u?void 0:u.stock)||void 0===v?void 0:v.cellList.length)>0?null===(g=null===(j=t.download)||void 0===j?void 0:j.stock)||void 0===g?void 0:g.cellList[0].name:"";return x.toUpperCase().includes("STOCK")?x:`STK-${x}`;default:return""}};return(0,n.jsx)(n.Fragment,{children:e===s.u6.DME_PAD?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Z,{color:i?"default":"secondary",icon:(0,n.jsx)(o.Z,{color:"secondary",fontSize:"small"}),size:"small",style:{backgroundColor:r.p1},label:(0,n.jsx)("p",Object.assign({style:{margin:0,padding:0,fontSize:"0.6rem",textDecoration:i?"line-through":"solid"}},{children:l("pad")}))}),(0,n.jsx)(a.Z,{color:i?"default":"secondary",icon:(0,n.jsx)(o.Z,{color:"secondary",fontSize:"small"}),style:{backgroundColor:r.AS},size:"small",label:(0,n.jsx)("p",Object.assign({style:{margin:0,padding:0,fontSize:"0.6rem",textDecoration:i?"line-through":"solid"}},{children:l("dme")}))})]}):(0,n.jsx)(a.Z,{icon:(0,n.jsx)(o.Z,{color:"secondary",fontSize:"small"}),size:"small",color:i?"default":"secondary",style:{backgroundColor:(e=>{switch(e){case s.u6.DME:return r.AS;case s.u6.PAD:return r.p1;case s.u6.STOCK:return r.o2;default:return r.sb}})(e)},label:(0,n.jsx)("p",Object.assign({style:{margin:0,padding:0,fontSize:"0.6rem",textDecoration:i?"line-through":"solid"}},{children:l(e)}))})})},u=({value:e,operation:t,lineThrough:i=!1})=>(0,n.jsx)(a.Z,{icon:(0,n.jsx)(d.Z,{color:"secondary",fontSize:"small"}),size:"small",style:{background:(e=>{switch(e){case s.u6.PIT:return r.Jx;case s.u6.STOCK:return r.gH;default:return r.sb}})(e)},color:i?"default":"secondary",label:(0,n.jsx)("p",Object.assign({style:{margin:0,padding:0,fontSize:"0.6rem",textDecoration:i?"line-through":"solid"}},{children:(()=>{var i,n,a,l,o,d,r,c,u,v,j,g;switch(e){case s.u6.STOCK:const e=(null===(n=null===(i=t.upload)||void 0===i?void 0:i.stock)||void 0===n?void 0:n.cellList)&&(null===(l=null===(a=t.upload)||void 0===a?void 0:a.stock)||void 0===l?void 0:l.cellList.length)>0?null===(d=null===(o=t.upload)||void 0===o?void 0:o.stock)||void 0===d?void 0:d.cellList[0].name:"";return`${s.WW[t.upload.type]}  ${e}`;case s.u6.PIT:const p=null===(c=null===(r=t.upload)||void 0===r?void 0:r.pit)||void 0===c?void 0:c.name,x=(null===(u=t.upload.pit)||void 0===u?void 0:u.projectList.length)>0?`${null===(v=t.upload.pit)||void 0===v?void 0:v.projectList[0].name}`.substring(5):"",h=x&&(null===(j=t.upload.pit)||void 0===j?void 0:j.projectList[0].polygonList.length)>0?null===(g=t.upload.pit)||void 0===g?void 0:g.projectList[0].polygonList[0].name:"";return`${s.WW[t.upload.type]} ${p} ${x} ${h}`;default:return""}})()}))}),v=({operation:e,lineThrough:t})=>{var i,a;let l="";return e?((null===(i=e.upload)||void 0===i?void 0:i.pit)&&(l="pit"),(null===(a=e.upload)||void 0===a?void 0:a.stock)&&(l="stock"),(0,n.jsx)(u,{value:l,operation:e,lineThrough:t})):(0,n.jsx)(n.Fragment,{})},j=({operation:e,lineThrough:t})=>{var i,a,l,s,o;let d="";return e?((null===(i=e.download)||void 0===i?void 0:i.dme)&&(d="dme"),(null===(a=e.download)||void 0===a?void 0:a.pad)&&(d="pad"),(null===(l=e.download)||void 0===l?void 0:l.stock)&&(d="stock"),(null===(s=e.download)||void 0===s?void 0:s.dme)&&(null===(o=e.download)||void 0===o?void 0:o.pad)&&(d="dme_pad"),(0,n.jsx)(c,{value:d,operation:e,lineThrough:t})):(0,n.jsx)(n.Fragment,{})},g=({operation:e,lineThrough:t})=>{const i=e&&e.excavatorList&&e.excavatorList.length>0?e.excavatorList[0].deviceAlias:"";return(0,n.jsx)(a.Z,{color:t?"default":"secondary",icon:(0,n.jsx)(l.Z,{fontSize:"small"}),size:"small",style:{textDecoration:t?"line-through":"solid"},label:i})}},70164:(e,t,i)=>{i.d(t,{S:()=>ie,a:()=>te});var n=i(85893),a=i(67294),l=i(79895),s=i(50998),o=i(41749),d=i(95757),r=i(81860),c=i(66037),u=i(62822),v=i(31125),j=i(73099),g=i(61920);const p=({value:e,cy:t})=>{var i,a,l,s;switch(e){case g.u6.PAD:return(0,n.jsx)(d.Z,{primary:`Descarga: ${g.WW[t.download.type]} -  ${null===(i=t.download.pad.cellList[0])||void 0===i?void 0:i.name}`});case g.u6.DME:return(0,n.jsx)(d.Z,{primary:`Descarga: ${g.WW[t.download.type]} -  ${null===(a=t.download.dme.cellList[0])||void 0===a?void 0:a.name}`});case g.u6.PIT:return(0,n.jsx)(d.Z,{primary:`Descarga: ${g.WW[t.download.type]} -  ${null===(l=t.download.pit.cellList[0])||void 0===l?void 0:l.name}`});case g.u6.STOCK:return(0,n.jsx)(d.Z,{primary:`Descarga: ${g.WW[t.download.type]} -  ${null===(s=t.download.stock.cellList[0])||void 0===s?void 0:s.name}`});default:return(0,n.jsx)(n.Fragment,{})}},x=({value:e,cy:t})=>{switch(e){case g.u6.PIT:return(0,n.jsx)(d.Z,{primary:`Carga: ${g.WW[t.upload.type]} -  ${t.upload.pit.projectList[0].name}- ${t.upload.pit.projectList[0].polygonList[0].name}`});case g.u6.STOCK:return(0,n.jsx)(d.Z,{primary:`Carga: ${g.WW[t.upload.type]} -  ${t.upload.stock.cellList[0].name}}`});default:return(0,n.jsx)(n.Fragment,{children:"node"})}},h=()=>(0,n.jsx)(l.Z,Object.assign({elevation:1,style:{marginBottom:4}},{children:(0,n.jsx)(s.Z,Object.assign({dense:!0,disableGutters:!0,selected:!0,button:!0,style:{backgroundColor:"#1d4e89",borderRadius:4}},{children:(0,n.jsxs)(o.Z,Object.assign({justifyContent:"space-between",container:!0},{children:[(0,n.jsx)(d.Z,{primary:"TRUCK",style:{color:"white"}}),(0,n.jsx)(d.Z,{primary:"INICIO",style:{color:"white"}}),(0,n.jsx)(d.Z,{primary:"DESCARGA",style:{color:"white"}}),(0,n.jsx)(d.Z,{primary:"FIN",style:{color:"white"}})]}))}))})),m=()=>(0,n.jsx)(l.Z,Object.assign({elevation:1,style:{marginBottom:0}},{children:(0,n.jsx)(s.Z,Object.assign({dense:!0,disableGutters:!0,selected:!0,button:!0,style:{backgroundColor:"#1d4e89",borderRadius:4}},{children:(0,n.jsxs)(o.Z,Object.assign({justifyContent:"space-between",container:!0,style:{marginLeft:"4px"}},{children:[(0,n.jsx)(d.Z,{primary:"EXCAVADORA",style:{color:"white"}}),(0,n.jsx)(d.Z,{primary:"INICIO",style:{color:"white"}}),(0,n.jsx)(d.Z,{primary:"DESCARGA",style:{color:"white"}})]}))}))})),b=a.memo((({cy:e,index:t,isCycleTruck:i})=>{var g,h,m;const[b,y]=(0,a.useState)(!1),O=()=>{y(!b)},C=e.startTime?new Date(1e3*(null===(g=e.startTime)||void 0===g?void 0:g.seconds)).toLocaleString():"NO REG",Z=e.downloadArrivalTime?new Date(1e3*(null===(h=e.downloadArrivalTime)||void 0===h?void 0:h.seconds)).toLocaleString():"NO REG. ",A=e.endTime?new Date(1e3*(null===(m=e.endTime)||void 0===m?void 0:m.seconds)).toLocaleString():"NO REG. ";return(0,n.jsxs)(l.Z,Object.assign({elevation:1,style:{marginBottom:4},id:e.id},{children:[(0,n.jsxs)(s.Z,Object.assign({dense:!0,disableGutters:!0,selected:!0,button:!0,onClick:O},{children:[(0,n.jsxs)(o.Z,Object.assign({justifyContent:"space-between",container:!0},{children:[i?(0,n.jsx)(d.Z,{primary:`${t}.${e.excavator.deviceAlias} `}):(0,n.jsx)(d.Z,{primary:`${t}.${e.truck.deviceAlias} `}),(0,n.jsx)(d.Z,{primary:C}),(0,n.jsx)(d.Z,{primary:Z}),(0,n.jsx)(d.Z,{primary:A})]})),(0,n.jsx)(r.Z,Object.assign({onClick:O},{children:(0,n.jsx)(o.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:b?(0,n.jsx)(v.Z,{fontSize:"small",onClick:O}):(0,n.jsx)(j.Z,{fontSize:"small",onClick:O})}))}))]})),(0,n.jsx)(c.Z,Object.assign({in:b,style:{paddingLeft:10}},{children:(0,n.jsxs)(u.Z,Object.assign({dense:!0,disablePadding:!0},{children:[e.upload&&(0,n.jsx)(s.Z,{children:(0,n.jsx)((()=>{let t="";return e.upload.pit&&(t="pit"),e.upload.stock&&(t="stock"),(0,n.jsx)(x,{value:t,cy:e})}),{})}),(0,n.jsx)(s.Z,{children:(0,n.jsx)((()=>{var t,i,a;let l="";return(null===(t=e.download)||void 0===t?void 0:t.dme)&&(l="dme"),(null===(i=e.download)||void 0===i?void 0:i.pad)&&(l="pad"),(null===(a=e.download)||void 0===a?void 0:a.stock)&&(l="stock"),(0,n.jsx)(p,{value:l,cy:e})}),{})}),(0,n.jsx)(s.Z,{children:(0,n.jsx)(d.Z,{primary:`Pala: ${null!=e.excavator?e.excavator.deviceAlias:""} `})}),(0,n.jsx)(s.Z,{children:(0,n.jsx)(d.Z,{primary:`Camion: ${e.truck.deviceAlias} `})})]}))}))]}),e.id)})),y=a.memo((({cy:e,index:t})=>{var i,g,h;const[m,b]=(0,a.useState)(!1),y=()=>{b(!m)},O=e.startTime?new Date(1e3*(null===(i=e.startTime)||void 0===i?void 0:i.seconds)).toLocaleString():"NO REG",C=e.downloadArrivalTime?new Date(1e3*(null===(g=e.downloadArrivalTime)||void 0===g?void 0:g.seconds)).toLocaleString():"NO REG. ";return e.endTime&&new Date(1e3*(null===(h=e.endTime)||void 0===h?void 0:h.seconds)).toLocaleString(),(0,n.jsx)(n.Fragment,{children:void 0!==e&&(0,n.jsxs)(l.Z,Object.assign({elevation:1,style:{marginBottom:4},id:e.id},{children:[(0,n.jsxs)(s.Z,Object.assign({dense:!0,disableGutters:!0,selected:!0,button:!0,onClick:y},{children:[(0,n.jsxs)(o.Z,Object.assign({justifyContent:"space-between",container:!0},{children:[(0,n.jsx)(d.Z,{primary:`${t}.${e.excavator.deviceAlias} `}),(0,n.jsx)(d.Z,{primary:O}),(0,n.jsx)(d.Z,{primary:C})]})),(0,n.jsx)(r.Z,Object.assign({onClick:y},{children:(0,n.jsx)(o.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:m?(0,n.jsx)(v.Z,{fontSize:"small",onClick:y}):(0,n.jsx)(j.Z,{fontSize:"small",onClick:y})}))}))]})),(0,n.jsx)(c.Z,Object.assign({in:m,style:{paddingLeft:10}},{children:(0,n.jsxs)(u.Z,Object.assign({dense:!0,disablePadding:!0},{children:[e.upload&&(0,n.jsx)(s.Z,{children:(0,n.jsx)((()=>{let t="";return e.upload.pit&&(t="pit"),e.upload.stock&&(t="stock"),(0,n.jsx)(x,{value:t,cy:e})}),{})}),(0,n.jsx)(s.Z,{children:(0,n.jsx)((()=>{var t,i,a;let l="";return(null===(t=e.download)||void 0===t?void 0:t.dme)&&(l="dme"),(null===(i=e.download)||void 0===i?void 0:i.pad)&&(l="pad"),(null===(a=e.download)||void 0===a?void 0:a.stock)&&(l="stock"),(0,n.jsx)(p,{value:l,cy:e})}),{})}),(0,n.jsx)(s.Z,{children:(0,n.jsx)(d.Z,{primary:`Pala: ${null!=e.excavator?e.excavator.deviceAlias:""} `})}),(0,n.jsx)(s.Z,{})]}))}))]}),e.id)})}));var O=i(96019),C=i(26209),Z=i(71267),A=i(85639),w=i(13258),f=i(60395),D=i(95477),T=i(73637),N=i(22318),L=i(95090),E=(i(2780),i(24673)),k=i(33901),S=i(90179),$=i(73855),G=i(5977);const H=i(53292),I=e=>{const{lengthCycles:t,excavator:i}=e;return(0,$.T)(),(0,G.k6)(),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(o.Z,Object.assign({container:!0,style:{paddingLeft:2,paddingTop:8,paddingBottom:8},alignItems:"center"},{children:[(0,n.jsx)("div",Object.assign({style:{display:"flex",alignItems:"center"}},{children:(0,n.jsx)(k.Z,{style:{borderRadius:0,padding:4},src:H})})),(0,n.jsx)("div",{children:(0,n.jsx)(Z.Z,{color:"secondary",label:(0,n.jsx)(N.Z,Object.assign({variant:"button",color:"secondary",style:{color:"white",fontWeight:"bold"}},{children:i.deviceAlias?i.deviceAlias:"..."}))})}),(0,n.jsx)(o.Z,Object.assign({item:!0},{children:(0,n.jsx)(Z.Z,{style:{marginLeft:4},icon:(0,n.jsx)(S.Z,{}),label:`Ciclos en Excavadora actual: ${t}`})}))]}))})};i(52672);var W=i(76796),_=i(868),R=i(17812),P=i(8286),F=i(282),z=i(86072),K=i(96588),U=i(10646),M=i(50648),J=i(52314),B=i(99302),V=i(97700),X=i(30433),Y=i(97111);const q=({operation:e})=>{const t=(0,a.useRef)(),i=(0,a.useRef)(),[s,d]=(0,a.useState)([]),[r,c]=(0,a.useState)({label:"",id:"",value:""}),{truckInfoList:u}=(0,$.C)(B.ej),[v,j]=(0,a.useState)(!1),g=(0,$.T)(),[p,x]=(0,a.useState)(),[h,m]=(0,a.useState)(),[b]=(0,U.l)(new Date),[y]=(0,U.i)(new Date),[O,C]=(0,a.useState)({date:`${b}T${y}`}),{id:A}=(0,G.UO)(),w={id:"",centroid:void 0,pointList:void 0,name:"Desconocido",idDme:void 0,color:void 0},[D,T]=(0,a.useState)(w),[L,E]=(0,a.useState)(w),[k,S]=(0,a.useState)(w),{dmeCellList:H,padCellList:I,stockCellList:q,polygonList:Q}=(0,$.C)(V.WD),[ee,te]=(0,a.useState)([]),[ie,ne]=(0,a.useState)([]),[ae,le]=(0,a.useState)([]);(0,a.useEffect)((()=>{te([D,...H]),ne([L,...I]),le([k,...q])}),[H,I,q]);const[se,oe]=(0,a.useState)(Y.f.CHANGE_NOTHING),[de,re]=(0,a.useState)(M.TypeDownload.UNKNOWN),ce=(e,t,i)=>{const n=t.find((t=>t.id===e));n&&x(Object.assign(Object.assign({},n),{type:i}))},ue=(0,a.useCallback)((()=>(0,Y.eq)(se,ae,de,ee,ie)),[se,Q,ae,de,ee,ie]),ve=(0,a.useCallback)((()=>(0,Y.Ul)(u)),[u]);return(0,a.useEffect)((()=>{c(h?{label:`${null==h?void 0:h.deviceAlias}`,id:`${null==h?void 0:h.deviceId}`,value:`${null==h?void 0:h.deviceId}`}:{label:"",id:"",value:""})}),[h]),(0,a.useEffect)((()=>{j(!!p&&!!h&&!!O.date)}),[p,h,O]),(0,n.jsxs)(l.Z,Object.assign({style:{height:"400px",marginLeft:"2px"},elevation:4},{children:[(0,n.jsx)(N.Z,Object.assign({variant:"button",style:{paddingLeft:8,paddingTop:16}},{children:"Agregar Nuevo Ciclo"})),(0,n.jsx)(f.Z,{width:"100%",height:8}),(0,n.jsxs)(o.Z,Object.assign({container:!0,direction:"column",style:{padding:"0.4rem",alignItems:"center"}},{children:[(0,n.jsx)(o.Z,Object.assign({item:!0},{children:(0,n.jsxs)(o.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,n.jsx)(N.Z,{children:"Carga Actual:"}),(0,n.jsx)(X.g7,{operation:e,lineThrough:!1})]}))})),(0,n.jsx)(f.Z,{width:"100%",height:8}),(0,n.jsxs)(o.Z,Object.assign({item:!0},{children:[(0,n.jsxs)(o.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,n.jsx)(N.Z,{children:"Descarga Actual: "}),(0,n.jsx)(X.DQ,{operation:e,lineThrough:!1}),(0,n.jsx)(o.Z,Object.assign({item:!0},{children:(0,n.jsx)(o.Z,Object.assign({container:!0},{children:p&&(0,n.jsx)(_.ZP,Object.assign({title:"Nueva Descarga"},{children:(0,n.jsx)(R.Z,Object.assign({color:"primary",size:"small"},{children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z.Z,{}),(0,n.jsx)(Z.Z,{size:"small",color:"secondary",label:p.name,onDelete:()=>x("")})]})}))}))}))}))]})),(0,n.jsx)(f.Z,{width:"100%",height:8}),h&&(0,n.jsxs)(o.Z,Object.assign({container:!0,direction:"row",justifyContent:"center"},{children:[(0,n.jsx)(N.Z,{children:"Camión: "}),(0,n.jsx)(Z.Z,{size:"small",color:"secondary",label:h.deviceAlias,onDelete:()=>{m(void 0),c({label:"",id:"",value:""})}})]}))]})),(0,n.jsx)(f.Z,{height:8}),e&&(0,n.jsxs)(o.Z,Object.assign({item:!0,style:{marginTop:8}},{children:[(0,n.jsx)(P.Z,{id:"date",label:"Fecha",type:"datetime-local",name:"date",value:O.date,onChange:e=>{const t=e.target;C(Object.assign(Object.assign({},O),{[t.name]:e.target.value}))},InputLabelProps:{shrink:!0,required:!0},error:void 0===O}),(0,n.jsx)(f.Z,{height:12}),(0,n.jsxs)("div",Object.assign({style:{display:"flex",flexDirection:"row",height:"100px"}},{children:[(0,n.jsx)(K.ZP,{size:"small",value:r,blurOnSelect:!0,onChange:(e,t)=>{((e,t)=>{const i=t.find((t=>t.id===e));i&&m(i)})(null!=t?t.value:"",u)},options:ve(),renderTags:(e,t)=>e.map(((e,i)=>(0,n.jsx)(Z.Z,Object.assign({variant:"outlined",label:e.label},t({index:i}))))),style:{width:150},getOptionLabel:e=>e.label,disableClearable:!0,filterSelectedOptions:!0,renderInput:e=>(0,n.jsx)(P.Z,Object.assign({},e,{autoFocus:!0,inputRef:i,label:"Agrega Camión",variant:"outlined",fullWidth:!0,error:void 0===h}))}),(0,n.jsx)(f.Z,{width:4}),s.length<3&&(0,n.jsx)(K.ZP,{size:"small",value:s,blurOnSelect:!0,onChange:(e,i)=>{switch(d(i),i.length){case 0:oe(Y.f.CHANGE_DOWNLOAD),re(M.TypeDownload.UNKNOWN);break;case 1:oe(Y.f.CHANGE_DOWNLOAD),re(Number(i[0].value));break;case 2:if(se===Y.f.CHANGE_DOWNLOAD)switch(de){case M.TypeDownload.DME:ce(i[1].id,ee,de);break;case M.TypeDownload.PAD:ce(i[1].id,ie,de);break;case M.TypeDownload.STOCK:ce(i[1].id,ae,de)}re(M.TypeDownload.UNKNOWN),oe(Y.f.CHANGE_NOTHING),d([])}setTimeout((()=>{var e,i;null===(e=t.current)||void 0===e||e.focus(),null===(i=t.current)||void 0===i||i.click()}),100)},options:ue(),multiple:!0,renderTags:(e,t)=>e.map(((e,i)=>(0,n.jsx)(Z.Z,Object.assign({variant:"outlined",label:e.label},t({index:i}))))),style:{width:200},getOptionLabel:e=>e.label,openOnFocus:!0,disableClearable:!0,filterSelectedOptions:!0,renderInput:e=>(0,n.jsx)(P.Z,Object.assign({},e,{autoFocus:!0,inputRef:t,label:"Agrega Descarga",variant:"outlined",fullWidth:!0,error:void 0===p}))})]}))]}))]})),(0,n.jsx)(f.Z,{height:20}),(0,n.jsxs)(o.Z,Object.assign({item:!0,style:{textAlign:"center"}},{children:[(0,n.jsx)(F.Z,Object.assign({variant:"outlined",size:"small",color:"secondary",onClick:()=>{return t=void 0,i=void 0,a=function*(){const t={operation:e,date:O.date,newDownload:p,truck:h};t.date&&t.newDownload&&t.truck?(yield g((0,J.YI)(t)),g((0,W.l4)(e.excavatorList[0].deviceId)),x(""),m(void 0),j(!1)):j(!0)},new((n=void 0)||(n=Promise))((function(e,l){function s(e){try{d(a.next(e))}catch(e){l(e)}}function o(e){try{d(a.throw(e))}catch(e){l(e)}}function d(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(s,o)}d((a=a.apply(t,i||[])).next())}));var t,i,n,a},disabled:!v},{children:"Agregar Ciclo"})),(0,n.jsx)(f.Z,{height:10})]}))]}))};function Q(e,t){return(0,n.jsx)(b,{cy:e,index:t+1},`${e.id}${t}`)}function ee(e,t){return(0,n.jsx)(y,{cy:e,index:t+1},`${e.id}${t}`)}const te=function({cycleList:e,isCycleTruck:t}){const[i,l]=(0,a.useState)([]),[s,o]=(0,a.useState)([]),{statusGet:r}=(0,$.C)(J.XE),{status:c}=(0,$.C)(W.tl);return(0,a.useEffect)((()=>{if(e&&e.length>0){const t=e.map((e=>e.truck)),i=[...new Set(t.map((e=>e.deviceId)))];l(i.map((e=>t.find((t=>t.deviceId===e)))))}}),[e.length]),(0,n.jsxs)("div",Object.assign({style:{padding:"4px"}},{children:[!t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(O.Z,Object.assign({id:"id-label"},{children:"Filtro por Camión"})),(0,n.jsx)(C.Z,Object.assign({labelId:"id-label",style:{width:"100%"},multiple:!0,value:s,onChange:e=>{const t=e.target.value;o(t)},renderValue:e=>(0,n.jsx)("div",{children:e.map((e=>(0,n.jsx)(Z.Z,{label:i.find((t=>t.deviceId===e)).deviceAlias,clickable:!0,deleteIcon:(0,n.jsx)(E.Z,{onMouseDown:e=>e.stopPropagation()}),onDelete:t=>(e=>{const t=s.findIndex((t=>t===e));t>=0&&s.splice(t,1),o(JSON.parse(JSON.stringify(s)))})(e)},e)))})},{children:i.map((e=>(0,n.jsxs)(A.Z,Object.assign({value:e.deviceId},{children:[(0,n.jsx)(w.Z,{checked:!!s.find((t=>t===e.deviceId))}),(0,n.jsx)(d.Z,{primary:e.deviceAlias})]}),e.deviceId)))}))]}),(0,n.jsx)(f.Z,{height:4}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z.Z,{color:"secondary",label:`Número de Ciclos: ${e?e.length:0}`,style:{color:"white"}}),(0,n.jsx)(f.Z,{height:2}),(0,n.jsx)(m,{})]}):(0,n.jsx)(h,{})}),(0,n.jsx)(u.Z,Object.assign({style:{maxHeight:"400px",overflowY:"scroll",textAlign:"center"}},{children:t?(0,n.jsx)(n.Fragment,{children:r!==L.JD.DONE&&r!==L.JD.ERROR?(0,n.jsx)(D.Z,{}):(0,n.jsx)(n.Fragment,{children:e.length>0?e.map(ee):(0,n.jsx)(n.Fragment,{children:"El Camión no registra ciclos"})})}):(0,n.jsx)(n.Fragment,{children:c!==L.JD.DONE&&r!==L.JD.ERROR?(0,n.jsx)(D.Z,{}):(0,n.jsx)(n.Fragment,{children:e.length>0?(0,n.jsx)(n.Fragment,{children:s.length>0?e.filter((e=>s.find((t=>t===e.truck.deviceId)))).map(Q):e.map(Q)}):(0,n.jsx)(n.Fragment,{children:"La excavadora no registra ciclos"})})})}))]})]}))},ie=()=>{(0,a.useState)([])[0],(0,$.T)();const{excavator:e,cycleList:t,status:i,operation:s}=(0,$.C)(W.tl);return(0,n.jsx)(T.Z,Object.assign({in:!!t},{children:(0,n.jsx)(o.Z,Object.assign({container:!0},{children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(I,{excavator:e,lengthCycles:t?t.length:0}),(0,n.jsxs)(o.Z,Object.assign({container:!0},{children:[t&&(0,n.jsx)(o.Z,Object.assign({item:!0,md:8},{children:(0,n.jsxs)(l.Z,Object.assign({elevation:4},{children:[(0,n.jsx)(N.Z,Object.assign({variant:"button",style:{paddingLeft:8,paddingTop:16}},{children:"Ciclos en Excavadora Actual"})),(0,n.jsx)(te,{cycleList:t})]}))})),(0,n.jsx)(o.Z,Object.assign({item:!0,md:4,style:{paddingLeft:4,textAlign:"center"}},{children:(0,n.jsx)(q,{operation:s})}))]}))]})}))}))}},97111:(e,t,i)=>{i.d(t,{BF:()=>c,HT:()=>r,M6:()=>j,Ul:()=>v,eq:()=>u,f:()=>n});var n,a=i(61920),l=i(50648);!function(e){e.CHANGE_NOTHING="0",e.CHANGE_UPLOAD="1",e.CHANGE_DOWNLOAD="2",e.CHANGE_EXCAVATOR="3",e.CHANGE_TRUCKS="changetruck"}(n||(n={})),n.CHANGE_DOWNLOAD,n.CHANGE_DOWNLOAD,n.CHANGE_TRUCKS,n.CHANGE_TRUCKS;const s=[{label:"Change Upload",value:n.CHANGE_UPLOAD,id:n.CHANGE_UPLOAD},{label:"Change/Add Download",value:n.CHANGE_DOWNLOAD,id:n.CHANGE_DOWNLOAD},{label:"Change Excavator",value:n.CHANGE_EXCAVATOR,id:n.CHANGE_EXCAVATOR}],o=[{label:"TAJO",value:a.WW.TAJO.toString(),id:""},{label:"STOCK",value:a.WW.STOCK.toString(),id:""}],d=[{label:"DME",value:l.TypeDownload.DME.toString(),id:""},{label:"PAD",value:l.TypeDownload.PAD.toString(),id:""},{label:"STOCK",value:l.TypeDownload.STOCK.toString(),id:""}],r=(e,t,i)=>{switch(e.id){case n.CHANGE_UPLOAD:return t.uploadList.length>0;case n.CHANGE_DOWNLOAD:return t.downloadList.length>1;case n.CHANGE_EXCAVATOR:return t.excavatorList.length>0}return t.downloadList.some((t=>t.type===Number(e.value)))},c=(e,t,i,r,c,u,v,j)=>{let g=e===n.CHANGE_NOTHING?s:e===n.CHANGE_UPLOAD?o:[];switch(e){case n.CHANGE_NOTHING:g=s;break;case n.CHANGE_UPLOAD:g=o;break;case n.CHANGE_DOWNLOAD:g=d;break;case n.CHANGE_EXCAVATOR:g=j.map((e=>({label:e.deviceAlias,id:e.id,value:e.id})));break;default:g=d}switch(t){case a.WW.TAJO:g=i.map((e=>({label:`${e.nameProject}-${e.name}-${e.material?e.material.type:""}`,value:e.id,id:e.id})));break;case a.WW.STOCK:g=r.map((e=>({label:`${e.name}`,value:e.id,id:e.id})))}switch(c){case l.TypeDownload.DME:g=u.map((e=>({label:`${e.name}`,value:e.id,id:e.id})));break;case l.TypeDownload.PAD:g=v.map((e=>({label:`${e.name}`,value:e.id,id:e.id})));break;case l.TypeDownload.STOCK:g=r.map((e=>({label:`${e.name}`,value:e.id,id:e.id})))}return g},u=(e,t,i,a,s)=>{let r=e===n.CHANGE_DOWNLOAD?d:e===n.CHANGE_UPLOAD?o:[];switch(e){case n.CHANGE_NOTHING:case n.CHANGE_DOWNLOAD:r=d;break;case n.CHANGE_TRUCKS:r=[];break;default:r=d}switch(i){case l.TypeDownload.DME:r=a.map((e=>({label:`${e.name}`,value:e.id,id:e.id})));break;case l.TypeDownload.PAD:r=s.map((e=>({label:`${e.name}`,value:e.id,id:e.id})));break;case l.TypeDownload.STOCK:r=t.map((e=>({label:`${e.name}`,value:e.id,id:e.id})))}return r},v=e=>e.map((e=>({label:e.deviceAlias,id:e.id,value:e.id}))),j=e=>e.map((e=>({label:e.deviceAlias,id:e.deviceId,value:e.deviceId})))},10646:(e,t,i)=>{i.d(t,{i:()=>a,l:()=>n});const n=e=>[`${e.getFullYear()}-${`0${e.getMonth()+1}`.slice(-2)}-${`0${e.getDate()}`.slice(-2)}`],a=e=>[`${`0${e.getHours()}`.substr(-2)}:${`0${e.getMinutes()}`.substr(-2)}`]},2780:(e,t,i)=>{i.d(t,{We:()=>l,wg:()=>s});var n=i(76533),a=function(e,t,i,n){return new(i||(i=Promise))((function(a,l){function s(e){try{d(n.next(e))}catch(e){l(e)}}function o(e){try{d(n.throw(e))}catch(e){l(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}d((n=n.apply(e,t||[])).next())}))};const l=(e,t)=>a(void 0,void 0,void 0,(function*(){return yield(0,n.g$)(t,e)})),s=e=>a(void 0,void 0,void 0,(function*(){var t,i;const a=yield(0,n.zY)(e);let l="";return(null===(t=a.truckErrorList)||void 0===t?void 0:t.length)>0&&(null===(i=a.truckErrorList)||void 0===i||i.forEach((e=>{const t=1===e.state?"CARGANDO":"A DESCARGA";l+=` ${e.truckError.deviceAlias} => ${t},`}))),l}))}}]);