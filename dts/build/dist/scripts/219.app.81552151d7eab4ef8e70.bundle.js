"use strict";(self.webpackChunkdts_hytera=self.webpackChunkdts_hytera||[]).push([[219],{63663:(e,t,n)=>{n.d(t,{F2:()=>r,xu:()=>v.I,zx:()=>c,iz:()=>p,T5:()=>m,P4:()=>h,hU:()=>u,Mi:()=>b,IB:()=>o.C});var i=n(85893),s=n(8286),a=n(96588);const r=e=>(0,i.jsx)(a.ZP,Object.assign({},Object.assign({},e.propsAutocomplete),{renderInput:e=>(0,i.jsx)(s.Z,Object.assign({},e,{label:"Seleccione una opción",variant:"outlined"}))}));var o=n(45287),l=n(282);const c=e=>(0,i.jsx)(l.Z,Object.assign({},Object.assign({},e.propsButton),{children:e.label}));var d=n(17812);const u=e=>(0,i.jsx)(d.Z,Object.assign({},Object.assign({},e),{children:e.children}));var v=n(47463),g=n(41749);const m=e=>(0,i.jsx)(g.Z,Object.assign({},Object.assign({},e),{container:!0},{children:e.children})),h=e=>(0,i.jsx)(g.Z,Object.assign({},Object.assign({},e),{item:!0},{children:e.children}));var j=n(55517);const p=e=>(0,i.jsx)(j.Z,Object.assign({},Object.assign({},e)));var x=n(82285);const b=e=>(0,i.jsx)(x.Z,Object.assign({},Object.assign({},e),{children:(0,i.jsx)(g.Z,{children:e.children})}))},45287:(e,t,n)=>{n.d(t,{C:()=>r});var i=n(85893),s=n(64436),a=n(8286);const r=e=>{const{propsTextField:t,propsForm:n}=e;return(0,i.jsx)(s.Z,Object.assign({},Object.assign({},n),{children:(0,i.jsx)(a.Z,Object.assign({},Object.assign({},t)))}))}},47463:(e,t,n)=>{n.d(t,{I:()=>a});var i=n(85893),s=n(60395);const a=({children:e,height:t,width:n})=>(0,i.jsx)(s.Z,Object.assign({height:t,width:n},{children:e}))},61242:(e,t,n)=>{n.d(t,{a:()=>g});var i=n(85893),s=n(41120),a=n(52663),r=n(66083),o=n(29525),l=n(66856),c=n(95477),d=n(282),u=n(93584);const v=(0,s.Z)({disabledPadding:{padding:0,textAlign:"center"}}),g=({open:e,handleClose:t,handleConfirm:n,title:s,children:g,maxWidth:m="lg",disabled:h=!1,loading:j})=>{const p=v();return(0,i.jsxs)(a.Z,Object.assign({open:e,onClose:t,maxWidth:m},{children:[(0,i.jsx)(r.Z,Object.assign({style:{color:"white",background:`${u.Jx}`,padding:"0.5rem"},className:p.disabledPadding},{children:s})),(0,i.jsx)(o.Z,{children:g}),(0,i.jsx)(l.Z,{children:j?(0,i.jsx)(c.Z,{style:{width:"30px",height:"30px"}}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(d.Z,Object.assign({size:"small",color:"primary",onClick:t},{children:"Cancelar"})),n&&(0,i.jsx)(d.Z,Object.assign({disabled:h,variant:"outlined",size:"small",color:"secondary",onClick:n,autoFocus:!0},{children:"Confirmar"}))]})})]}))}},86842:(e,t,n)=>{n.d(t,{y:()=>v});var i=n(85893),s=n(96912),a=n(44562),r=n(37155),o=n(67294),l=n(41120),c=n(33681);const d=(0,l.Z)({root:{width:"100%"}});function u({time:e}){const t=d(),[n,s]=o.useState(100),a=10*e/100;return o.useEffect((()=>{s((e=>e-10));const e=setInterval((()=>{s((e=>e-10))}),a);return()=>{clearInterval(e)}}),[]),(0,i.jsx)("div",Object.assign({className:t.root},{children:(0,i.jsx)(c.Z,{variant:"determinate",value:n})}))}const v=({error:e,callBack:t,success:n})=>{const[l,c]=o.useState({open:!0,vertical:"bottom",horizontal:"center"}),{vertical:d,horizontal:v}=l,g=()=>{c(Object.assign(Object.assign({},l),{open:!1})),t()};return(0,o.useEffect)((()=>{const e=setTimeout((()=>{g()}),4e3);return()=>{window.clearTimeout(e)}}),[]),(0,i.jsx)(s.Z,Object.assign({open:l.open,anchorOrigin:{vertical:d,horizontal:v},onClose:g},{children:(0,i.jsxs)(a.Z,Object.assign({severity:n?"success":"error",onClose:g},{children:[(0,i.jsx)(r.Z,{children:n?"Exito":"error"}),(0,i.jsxs)("strong",{children:[" ",e]}),(0,i.jsx)(u,{time:4e3})]}))}))}},11818:(e,t,n)=>{n.d(t,{y:()=>a});var i=n(67294),s=n(49032);const a=e=>{const[t,n]=(0,i.useState)(!0),[a,r]=(0,i.useState)(!0),[o,l]=(0,i.useState)(!0),[c,d]=(0,i.useState)(!0);return(0,i.useEffect)((()=>{const t=()=>0!==(null==e?void 0:e.length)&&(null==e?void 0:e.every((e=>{var t,n;return(null===(n=null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.event)||void 0===n?void 0:n.event)===s.EnumEvent.NO_OPERATIONAL}))),i=()=>0!==(null==e?void 0:e.length)&&(null==e?void 0:e.every((e=>{var t,n;return(null===(n=null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.event)||void 0===n?void 0:n.event)===s.EnumEvent.OPERATIONAL}))),a=()=>0!==(null==e?void 0:e.length)&&(null==e?void 0:e.every((e=>{var t,n;return(null===(n=null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.event)||void 0===n?void 0:n.event)===s.EnumEvent.OPERATIONAL_DELAY}))),o=()=>0!==(null==e?void 0:e.length)&&(null==e?void 0:e.every((e=>{var t,n;return(null===(n=null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.event)||void 0===n?void 0:n.event)===s.EnumEvent.MAINTENANCE}))),c=()=>0!==(null==e?void 0:e.length)&&(null==e?void 0:e.every((e=>{var t,n;return void 0===(null===(n=null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.event)||void 0===n?void 0:n.event)})));n(!0),r(!0),l(!0),d(!0),i()&&(n(!1),r(!0),l(!1),d(!1)),c()&&(n(!1),r(!1),l(!1)),t()&&(n(!0),r(!1),l(!1),d(!1)),a()&&(n(!1),r(!1),l(!0)),o()&&(n(!1),r(!1),l(!0),d(!0)),0==c()&&0==t()&&0==a()&&0==i()&&0==o()&&(n(!0),r(!0),l(!0),d(!0))}),[e]),[t,a,o,c]}},15635:(e,t,n)=>{n.d(t,{r:()=>a});var i=n(67294),s=n(95090);const a=e=>{const[t,n]=(0,i.useState)(!1);return(0,i.useEffect)((()=>(e===s.JD.DONE||e===s.JD.UNKNOWN||e===s.JD.ERROR?n(!1):n(!0),()=>{n(!1)})),[e]),[t]}},31379:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Bt});var i=n(85893),s=n(41749),a=n(868),r=n(17812),o=n(30115),l=n(59240),c=n(95757),d=n(50998),u=n(71267),v=n(282),g=n(62822),m=n(79895),h=n(55517),j=n(60395),p=n(33681);const x=({loading:e})=>e?(0,i.jsx)(p.Z,{}):(0,i.jsx)(i.Fragment,{}),b="truck";var O=n(73637),f=n(5200),E=n(93584),y=n(73855),N=n(73250),S=n(75647),L=n(44824),C=n(28231),T=n(715),Z=n(95692),k=n(41042),A=n(67294),I=n(78721),w=n(5814),D=n(49032),R=n(67774),P=n(52314),z=n(56731),W=n(7258),_=n(53559),F=n(97700),M=n(1754),$=n(57163),U=n(89452),H=n(99302),G=n(60465),K=function(e,t,n,i){return new(n||(n=Promise))((function(s,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))};const J=(0,o.Z)({rootFilter:{flex:"0 0",margin:2,border:"1px dashed #7b81836e",cursor:"move",float:"left",width:"98%",background:E.sb},rootItem:{margin:2,border:"1px dashed #7b81836e",cursor:"move",float:"left",width:"98%",flex:"0 0"},rootItemTemporal:{flex:"0 0",margin:2,border:"1px dashed green",cursor:"move",float:"left",width:"98%",background:"#34d0ff6e"},rootItemTemporalRemove:{flex:"0 0",margin:2,border:"1px dashed red",background:"#ff60604a",cursor:"move",float:"left",width:"98%"},titleTruck:{fontSize:"1em",cursor:"move"},contentTruck:{margin:2,padding:0,width:"100%",position:"relative",height:"100%"},contentCycle:{height:16,minWidth:16,display:"flex",borderRadius:"50%",background:"#efecec",justifyContent:"center",alignItems:"center",justifyItems:"center"},stateTruck:{position:"absolute",fontSize:"0.5rem",top:0,left:0},containerMoreTruck:{position:"absolute",top:-6,right:2,cursor:"pointer"},moreTruck:{fontSize:"0.8rem",cursor:"pointer"},actions:{minWidth:36},labelCycleNumber:{fontSize:11,color:"#5a5757"},labelExcavator:{marginTop:4,background:"#424141",color:"#fff"},labelDistance:{marginTop:4,background:`${E.J$}20`}}),V=({truck:e})=>{var t,n,s,o,l;let c="",d=null;switch(null===(t=e.eventState)||void 0===t?void 0:t.eventState){case I.EnumEventState.UNKNOWN_STATE:d=(0,i.jsx)(S.Z,{style:{fontSize:"1rem"},fontSize:"small"}),c=e.operationList&&e.operationList.length>0?"En camino":"Sin operación";break;case I.EnumEventState.DOWNLOAD:d=(0,i.jsx)(L.Z,{style:{fontSize:"1rem"},fontSize:"small"}),c=null===(n=e.eventState)||void 0===n?void 0:n.name;break;case I.EnumEventState.UPLOAD:d=(0,i.jsx)(C.Z,{style:{fontSize:"1rem"},fontSize:"small"}),c=null===(s=e.eventState)||void 0===s?void 0:s.name;break;case I.EnumEventState.TO_UPLOAD:d=(0,i.jsx)(T.Z,{style:{fontSize:"1rem",transform:"rotate(180deg)"},fontSize:"small"}),c=null===(o=e.eventState)||void 0===o?void 0:o.name;break;case I.EnumEventState.TO_DOWNLOAD:d=(0,i.jsx)(T.Z,{style:{fontSize:"1rem"},fontSize:"small"}),c=null===(l=e.eventState)||void 0===l?void 0:l.name;break;default:d=(0,i.jsx)(Z.Z,{style:{fontSize:"1rem"},fontSize:"small"}),c="Advertencia!!! en otro estado..."}return d&&(0,i.jsx)(a.ZP,Object.assign({title:c,placement:"top",TransitionComponent:O.Z,TransitionProps:{timeout:600}},{children:(0,i.jsx)(r.Z,Object.assign({style:{margin:0,padding:0,zIndex:4},size:"small",onClick:()=>{}},{children:d}))}))},B=({truck:e,temporal:t,operation:n,temporalRemove:r,eventFrom:o,isFilter:l=!1,distanceToExcavator:c,excavator:u,id:v})=>{var g,h;const j=(0,y.T)(),{eventStateList:p}=(0,y.C)(F.eG),{timeline:x}=(0,y.C)(w.h3),{user:S}=(0,y.C)(_.MR),[L,C]=(0,A.useState)(Number(null==x?void 0:x.initialHourmeter.toFixed(1))),{hours:T,minutes:Z}=(()=>{const e=new Date;return{hours:e.getHours(),minutes:e.getMinutes()}})(),B=`${`00${T}`.slice(-2)}:${`00${Z}`.slice(-2)}`,[Y]=(0,A.useState)(B),{lostConnection:X}=(0,G.AT)(e),q=J(),[{isDragging:Q},ee]=(0,f.c)((()=>({type:b,item:{truck:e},end:(t,i)=>{const s=i.getDropResult();i.canDrag(),null!==s&&(j((0,w.Qi)({truck:e,eventTo:null==s?void 0:s.eventTo,eventFrom:o})),j((0,R.CB)(null==s?void 0:s.eventTo)),j((0,w.h1)(e)),(null==s?void 0:s.operation)&&j((0,N.UN)({operationId:s.operation.id,truck:e,operationOldId:n?n.id:""})))},collect:e=>({isDragging:e.isDragging(),handlerId:e.getHandlerId()})})),[r,n,e]),te=(0,A.useCallback)((()=>{var t;const n=null===(t=e.deviceAlias)||void 0===t?void 0:t.split("-");return n&&n.length>1?n[1]:""}),[e.deviceAlias]);return(0,i.jsx)(m.Z,Object.assign({id:v||`truck-${e.deviceId}`,style:{opacity:Q?.5:1},className:l&&!r?q.rootFilter:t?q.rootItemTemporal:r?q.rootItemTemporalRemove:q.rootItem,ref:ee,elevation:4},{children:(0,i.jsxs)(d.Z,Object.assign({disableGutters:!0,className:q.contentTruck},{children:[(0,i.jsx)(k.Z,{className:q.stateTruck,style:{color:X||0==(null===(g=e.sensor)||void 0===g?void 0:g.latitude)?E.fQ:E.FD},fontSize:"small"}),(0,i.jsxs)(s.Z,Object.assign({container:!0,onMouseDown:()=>K(void 0,void 0,void 0,(function*(){const e={id:"",name:"",event:o},t={id:"",deviceId:"",deviceAlias:"",initialHourmeter:0,finalHourmeter:0,initialEventState:{id:"",name:"",eventState:I.EnumEventState.UNKNOWN_STATE,event:e},initialState:D.EnumEvent.UNKNOWN_STATE_EVENT,finalState:D.EnumEvent.UNKNOWN_STATE_EVENT,durationTime:0,shift:z.Shift.UNKNOWN_SHIFT,stateRegister:0,adjustment:0,status:!1,assetType:0,guard:W.EnumGuard.UNKNOWN_GUARD,userId:S.user.id};yield j((0,w.f0)(t))}))},{children:[(0,i.jsx)(s.Z,Object.assign({item:!0,style:{marginTop:4}},{children:(0,i.jsx)(a.ZP,{title:(()=>{var t,n;return(null===(n=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===n?void 0:n.name)?e.eventState.event.name:""})(),placement:"top",TransitionComponent:O.Z,TransitionProps:{timeout:600},children:(0,i.jsx)("label",Object.assign({className:q.titleTruck,style:{color:`${(e=>{var t;let n;switch(null===(t=null==e?void 0:e.event)||void 0===t?void 0:t.event){case D.EnumEvent.NO_OPERATIONAL:n=e.eventState===I.EnumEventState.LACK_OF_OPERATOR?E.DM:E.oz;break;case D.EnumEvent.OPERATIONAL:n=E.Ez;break;case D.EnumEvent.OPERATIONAL_DELAY:n=E.Gj}return n})(e.eventState)}`}},{children:te()})),onClick:()=>{(e=>{K(void 0,void 0,void 0,(function*(){var t,n,i,s;if(yield j((0,U.Gy)(D.EnumEvent.OPERATIONAL)),console.log("EventoObj: After"),(null===(n=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===n?void 0:n.event)===D.EnumEvent.OPERATIONAL_DELAY||(null===(s=null===(i=e.eventState)||void 0===i?void 0:i.event)||void 0===s?void 0:s.event)===D.EnumEvent.NO_OPERATIONAL&&e.operationList.length>0){yield j((0,w.h1)(e));const t=p.find((e=>{var t;return(null===(t=e.event)||void 0===t?void 0:t.event)===D.EnumEvent.OPERATIONAL}));console.log("EventoObj: ",t);const n=null,i=null,s=null,a=Number(L);if(null==t?void 0:t.event){const r={id:"",deviceAlias:e.deviceAlias,deviceId:e.deviceId,initialHourmeter:a,adjustment:0,durationTime:0,finalHourmeter:0,initialTime:B,initialEventState:Object.assign(Object.assign({},t),{id:"",name:"",eventState:I.EnumEventState.UNKNOWN_STATE}),initialState:D.EnumEvent.OPERATIONAL,finalState:n,shift:i,status:!1,stateRegister:s,assetType:$.EnumAssetType.TRUCK,guard:W.EnumGuard.UNKNOWN_GUARD,userId:S.user.id};(0,w.hO)(r),yield j((0,M.BU)({timeline:r,hour:Y})),j((0,N.hS)()),j((0,H.RK)()),console.log("Cambiando a Operative")}}}))})(e)}})})),(0,i.jsxs)(s.Z,Object.assign({item:!0},{children:[(0,i.jsxs)(s.Z,Object.assign({container:!0,className:q.actions,alignItems:"center"},{children:[(0,i.jsx)(V,{truck:e}),(0,i.jsx)("div",Object.assign({style:{display:"flex",flexDirection:"row",alignItems:"center"}},{children:(0,i.jsx)(a.ZP,Object.assign({placement:"top",TransitionComponent:O.Z,TransitionProps:{timeout:600},title:(()=>{let t=!1;return null==n||n.truckList.find((n=>{n.deviceId===e.deviceId&&(t=!0)})),t})()?"Agregar Ciclo":"Número de ciclos"},{children:(0,i.jsx)("div",Object.assign({className:q.contentCycle},{children:(0,i.jsx)("label",Object.assign({className:q.labelCycleNumber,onClick:()=>{j((0,P.eh)(e))}},{children:void 0===e.cycleNumber?"0":e.cycleNumber}))}))}))}))]})),void 0!==c&&(0,i.jsx)(s.Z,Object.assign({item:!0,className:q.labelDistance},{children:(0,i.jsxs)("label",Object.assign({className:q.titleTruck},{children:[c.toFixed(2),"m"]}))})),void 0!==u&&(0,i.jsx)(s.Z,Object.assign({item:!0,className:q.labelExcavator},{children:(0,i.jsx)("label",Object.assign({className:q.titleTruck},{children:e.operationList&&e.operationList.length>0?null===(h=e.operationList[0].excavator)||void 0===h?void 0:h.deviceAlias:""}))}))]}))]}))]}))}))};var Y=n(63663),X=n(48101),q=n(10980),Q=n(6777),ee=n(95090),te=n(89613),ne=n(34344),ie=n(54150),se=n(40036);class ae{constructor(e,t,n,i,s,a,r,o){this.circleList=e,this.map=t,this.idSource=n,this.radius=s,this.idLayer=i,this.fontSize=9,this.color=a,this.transparent=r,this.onClickElement=o}getInMap(){return this.map.getSource(this.idSource)}generateFeatures(){return this.circleList.map((e=>({type:"Feature",properties:{label:e.label},geometry:{type:"Point",coordinates:2===e.point.length?e.point:[0,0]}})))}addToMap(){var e,t;!this.getInMap()&&this.circleList.length>0&&(this.map.getSource(this.idSource)||this.map.addSource(this.idSource,{type:"geojson",data:{type:"FeatureCollection",features:this.generateFeatures()}}),this.map.getLayer(this.idLayer)||(this.map.addLayer({id:this.idLayer,type:"circle",source:this.idSource,paint:{"circle-radius":{stops:[[0,0],[20,(e=this.radius,t=this.circleList[0].point[1],e/.075/Math.cos(t*Math.PI/180))]],base:2},"circle-stroke-color":this.color,"circle-stroke-width":this.transparent?2:0,"circle-color":this.color,"circle-opacity":this.transparent?0:1}}),this.map.addLayer({id:this.idLayer+"LABEL",type:"symbol",source:this.idSource,layout:{"text-field":["get","label"],"text-variable-anchor":["top"],"text-radial-offset":.5,"text-justify":"auto","text-allow-overlap":!0}})),this.map.on("click",this.idLayer,(e=>{this.onClickElement&&this.onClickElement(e)})),this.map.on("mouseenter",this.idLayer,(()=>{this.map.getCanvas().style.cursor="pointer"})),this.map.on("mouseleave",this.idLayer,(()=>{this.map.getCanvas().style.cursor=""})))}updateInMap(){const e=this.getInMap();e?e.setData({type:"FeatureCollection",features:this.generateFeatures()}):this.addToMap()}removeOfMap(){this.getInMap()&&(this.map.removeLayer(this.idLayer),this.map.removeLayer(this.idLayer+"LABEL")),this.map.removeSource(this.idSource)}}var re=n(78479),oe=n(45287),le=n(34880);const ce=(0,o.Z)({rootList:{flex:1,padding:2,margin:2,overflow:"auto"},rootMap:{borderRadius:16,position:"relative",right:0,left:0},mapBackground:{position:"absolute",right:0,left:0,top:0,bottom:0,zIndex:1}}),de=({operation:e})=>{const t=(0,A.useRef)(null),[n,a]=(0,re._)(`RADIOSEX${e.excavatorList&&e.excavatorList.length>0?e.excavatorList[0].deviceAlias:""}`,35),r=ce(),o=(0,A.useRef)(null),{excavator:l,truckInRange:c,truckListInOperation:d}=(({operation:e,radio:t})=>{const[n,i]=(0,A.useState)(q.kM),[s,a]=(0,A.useState)([]),[r,o]=(0,A.useState)([]),{initial:l,truckStream:c}=(0,y.C)(ne.dc),{initial:d,excavatorStream:u}=(0,y.C)(te.oT);return(0,A.useEffect)((()=>{if(l===Q.Vj.INITIAL&&c.sensor&&c.sensor.latitude&&n.sensor&&n.sensor.latitude&&!s.some((e=>e.deviceId===c.deviceId))){const e=(0,ie.xmu)([c.sensor.longitude,c.sensor.latitude]),i=(0,ie.xmu)([n.sensor.longitude,n.sensor.latitude]),s=(0,ie.TE$)(e,i),a=r.findIndex((e=>e.truck.deviceId===c.deviceId)),l=[...r];if(1e3*s<=t){const e={truck:c,distance:1e3*s};if(console.log("distanceBettween",s,a),-1===a){let t="";switch(n.deviceAlias.slice(0,2)){case"EX":t="excavadora";break;case"CF":t="cargador frontal"}const i=Number(c.deviceAlias.slice(-2));(0,se.jQ)(`volquete ${i} en ${t} ${n.deviceAlias.slice(-2)}`),l.push(e)}else l[a]=e;o(l)}else-1!==a&&(l.splice(a,1),o(l))}}),[c,s,t]),(0,A.useEffect)((()=>{var e;n.deviceId&&d===ee.JD.DONE&&u.deviceId===n.deviceId&&(!n.sensor&&u.sensor||u.sensor&&u.sensor.latitude!==(null===(e=n.sensor)||void 0===e?void 0:e.latitude))&&i(u)}),[u]),(0,A.useEffect)((()=>{e.excavatorList&&n.deviceId!=e.excavatorList[0].deviceId&&i(e.excavatorList[0]);let t=!1;const s=[...r];e.truckList.forEach((e=>{const n=r.findIndex((t=>t.truck.deviceId===e.deviceId));n>-1&&(s.splice(n,1),console.log("truckInRangeremommmmm",n),t=!0)})),t&&o(s),a(e.truckList)}),[e.truckList]),{truckListInOperation:s,truckInRange:r,excavator:n}})({operation:e,radio:n}),[u,v]=(0,A.useState)(!1);(0,A.useEffect)((()=>()=>{o.current=null,t.current=null}),[]),(0,A.useEffect)((()=>{let e,n;if(u&&l.deviceId&&l.sensor&&l.sensor.latitude){const i={point:[l.sensor.longitude,l.sensor.latitude],label:l.deviceAlias};e=new ae([i],t.current,`ID_SOUCE_CIRCLE_${l.deviceAlias}`,`ID_LAYER_CIRCLE_${l.deviceAlias}`,le.Xb,E.J$,!0),e.addToMap(),n=new ae([i],t.current,`ID_SOUCE_EXCAVATOR_${l.deviceAlias}`,`ID_SOUCE_EXCAVATOR_${l.deviceAlias}`,1,E.sb,!1),e.addToMap(),n.addToMap(),setTimeout((()=>{var e;null===(e=t.current)||void 0===e||e.setCenter(i.point)}),100)}return()=>{e&&(e.removeOfMap(),n.removeOfMap())}}),[u,l]),(0,A.useEffect)((()=>{let e;if(u&&l.deviceId&&d.length>0){const n=d.map((e=>e.sensor?{point:[e.sensor.longitude,e.sensor.latitude],label:`C${e.deviceAlias.slice(-2)} /${e.sensor.speed.toFixed(0)}kh`}:{point:[0,0],label:""}));e=new ae(n,t.current,`ID_SOUCE_TRUCKOPE_${l.deviceAlias}`,`ID_SOUCE_TRUCKOPE_${l.deviceAlias}`,1,"green",!1),e.addToMap()}return()=>{e&&e.removeOfMap()}}),[u,d]),(0,A.useEffect)((()=>{let e;if(u&&l.deviceId&&c.length>0){const n=c.map((e=>{var t,n;return{point:[e.truck.sensor?e.truck.sensor.longitude:0,e.truck.sensor?e.truck.sensor.latitude:0],label:`C${e.truck.deviceAlias.slice(-2)} /${null===(n=null===(t=e.truck)||void 0===t?void 0:t.sensor)||void 0===n?void 0:n.speed.toFixed(0)}kh`}}));e=new ae(n,t.current,`ID_SOUCE_TRUCKRANGE_${l.deviceAlias}`,`ID_LAYER_TRUCKRANGE_${l.deviceAlias}`,1,E.J$,!1),e.addToMap()}return()=>{e&&e.removeOfMap()}}),[u,c]);const g=(0,A.useMemo)((()=>(0,i.jsx)(Y.T5,Object.assign({style:{position:"absolute",top:0,zIndex:2}},{children:(0,i.jsx)(Y.T5,Object.assign({container:!0,direction:"row"},{children:c.map((e=>(0,i.jsx)(B,{eventFrom:e.truck.operationList&&e.truck.operationList.length>0?D.EnumEvent.OPERATIONAL:D.EnumEvent.UNKNOWN_STATE_EVENT,truck:e.truck,distanceToExcavator:e.distance,excavator:l},e.truck.deviceId)))}))}))),[c,l.deviceAlias]),m=(0,A.useMemo)((()=>(0,i.jsx)(Y.P4,Object.assign({item:!0},{children:(0,i.jsx)(oe.C,{propsForm:{},propsTextField:{variant:"outlined",size:"small",label:"Radio de proximidad",style:{marginTop:8},onChange:e=>{const t=parseInt(e.target.value);t&&a(t)},value:n}})}))),[n]);return(0,i.jsxs)(s.Z,Object.assign({className:r.rootList},{children:[m,(0,i.jsxs)(Y.P4,Object.assign({item:!0,className:r.rootMap},{children:[g,(0,i.jsxs)(Y.T5,{children:[(0,i.jsx)(Y.P4,{className:r.mapBackground}),(0,i.jsx)(X.Z,Object.assign({map:t,dragRotate:!1,style:"mapbox://styles/dispatchgat/ckqqsfc2y46bo17sf1y29zwnj",mapContainer:o,bearing:0,pitch:15},{lat:-7.6163,lng:-78.196,zoom:18,setLoad:v},{height:"300px",dragControls:!1}),"map2")]})]}))]}))};var ue=n(43829),ve=n(82200),ge=n(59544),me=n(7654),he=n(78965),je=n(22318),pe=n(64436),xe=n(52541),be=n(30553),Oe=n(40074),fe=n(95477),Ee=n(52663),ye=n(66856),Ne=n(29525);function Se({open:e,setOpen:t,handleClickConfirm:n,children:s,loading:a,handleClose:r}){return(0,i.jsxs)(Ee.Z,Object.assign({fullWidth:!0,maxWidth:"lg",open:e,onClose:r||(()=>{t(!1)}),"aria-labelledby":"max-width-dialog-title"},{children:[(0,i.jsx)(Ne.Z,{children:s}),(0,i.jsx)(ye.Z,{children:a?(0,i.jsx)(fe.Z,{}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.Z,Object.assign({onClick:r,size:"small",color:"primary"},{children:"Cancel"})),(0,i.jsx)(v.Z,Object.assign({onClick:n,variant:"outlined",size:"small",color:"secondary"},{children:"Confirm"}))]})})]}))}var Le=n(61242),Ce=n(76533),Te=n(52672),Ze=n(14125),ke=n(41120),Ae=n(10465),Ie=n(13258);const we=(0,ke.Z)((e=>({disabledSpacing:{margin:0,padding:0,width:"auto"},checkbox:{"& .MuiCheckbox-root":{margin:0,padding:0,paddingLeft:8}}}))),De=A.memo((({truck:e,checked:t,trucksSelect:n,setTrucksSelect:s,disableWithOperation:a,handleonchangeTruck:r})=>{var o;const l=we(),u=e.state>=0||0!==(null===(o=e.sensor)||void 0===o?void 0:o.latitude)?e.state===I.EnumEventState.UNKNOWN_STATE&&e.operationList&&e.operationList.length>0?"En camino":ee.SS[e.state]:"Conexión perdida",v=e.operationList&&e.operationList.length>0&&e.operationList[0]&&e.operationList[0].excavator?e.operationList[0].excavator.deviceAlias:"";return(0,i.jsx)(d.Z,Object.assign({button:!0,dense:!0,className:l.disabledSpacing,disabled:!!a&&!!v},{children:(0,i.jsx)(be.Z,{className:l.checkbox,onChange:()=>{const t=n.findIndex((t=>e.deviceId===t.deviceId));-1===t?n.push(e):n.splice(t,1),s(JSON.parse(JSON.stringify(n)))},control:(0,i.jsx)(Ie.Z,{onClick:()=>r(e),size:"small",checked:t,inputProps:{style:{padding:0}}}),label:(0,i.jsx)(c.Z,{primary:`${e.deviceAlias} ${v?` ➜ ${v}`:""} (${u})`})})}))})),Re=(0,ke.Z)({root:{paddingLeft:4,maxHeight:"60vh",overflowY:"scroll",boxShadow:"inset 0px -2px 10px 0px rgb(17 16 10 / 56%)",borderRadius:4},searchContainer:{marginRight:8}}),Pe=A.memo((({trucksSelect:e,setTrucksSelect:t,handleonchangeTruck:n,disableWithOperation:a})=>{const{truckInfoList:r}=(0,y.C)(H.ej),o=Re(),[l,c]=(0,A.useState)([]),[d,u]=(0,A.useState)("");(0,A.useEffect)((()=>{c(r.filter((e=>e.deviceAlias.toLowerCase().includes(d.toLowerCase()))))}),[r]);const v=(0,A.useCallback)((e=>{if(e){const t=e.target?e.target.value.toUpperCase():"";c(r.filter((e=>e.deviceAlias.toUpperCase().includes(t)))),u(t)}}),[r]),m=(0,A.useCallback)((()=>{c(r),u("")}),[r]);return(0,i.jsxs)(g.Z,Object.assign({dense:!0,disablePadding:!0,style:{margin:4,paddingTop:4}},{children:[(0,i.jsx)(Ae.V,{functionFilter:v,functionCancel:m}),(0,i.jsx)(s.Z,Object.assign({container:!0,className:o.root},{children:l.map((s=>{return(0,i.jsx)(A.Fragment,{children:(0,i.jsx)(De,{handleonchangeTruck:n,disableWithOperation:a,checked:(r=s,!!e.find((e=>r.deviceId===e.deviceId))),trucksSelect:e,setTrucksSelect:t,truck:s})},s.deviceId);var r}))}))]}))}));var ze=n(44562),We=n(61920);const _e=(e,t,n,i)=>{return s=void 0,a=void 0,o=function*(){n(!0);const s=yield(0,Ce.e1)(e,t);n(!1),i((e=>!e));let a="";s.truckErrorList.length>0&&s.truckErrorList.forEach((e=>{const t=1===e.state?"CARGANDO":"A DESCARGA";a+=` ${e.truckError.deviceAlias}=> ${t},`})),""!==a&&alert(`Las siguientes unidades no han podido ser reasignadas: ${a}`)},new((r=void 0)||(r=Promise))((function(e,t){function n(e){try{l(o.next(e))}catch(e){t(e)}}function i(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var s;t.done?e(t.value):(s=t.value,s instanceof r?s:new r((function(e){e(s)}))).then(n,i)}l((o=o.apply(s,a||[])).next())}));var s,a,r,o},Fe=({open:e,setOpen:t,setRefresh:n,operations:r})=>{const o=(0,y.T)(),[l,u]=(0,A.useState)([]),[v,h]=(0,A.useState)(""),[j,p]=(0,A.useState)([]),[x,b]=(0,A.useState)(!1),[O,f]=A.useState(!1);(0,A.useEffect)((()=>{o(H.RK),o(Ze.CE)}),[]);const E=e=>{h(e.target.value)};return(0,i.jsxs)(Se,Object.assign({},{loading:O},{open:e,handleClickConfirm:()=>{j.length<=0||v.length<=0?o((0,Te.L8)({open:!0,msg:"Debe seleccionar almenos una excavadora y un camión",severity:"warning"})):b(!0)},handleClose:()=>{t(!1),p([]),h("")}},{children:[(0,i.jsx)(s.Z,Object.assign({container:!0},{children:(0,i.jsx)(s.Z,Object.assign({item:!0,xs:12},{children:(0,i.jsx)(je.Z,Object.assign({variant:"button",style:{paddingLeft:8,paddingTop:16}},{children:"Reasignación de camiones"}))}))})),(0,i.jsxs)(s.Z,Object.assign({container:!0,style:{paddingLeft:4}},{children:[(0,i.jsx)(s.Z,Object.assign({item:!0,xs:6},{children:(0,i.jsx)(m.Z,Object.assign({elevation:4},{children:(0,i.jsx)(Pe,{handleonchangeTruck:()=>{},setTrucksSelect:p,trucksSelect:j})}))})),(0,i.jsx)(s.Z,Object.assign({item:!0,xs:6},{children:(0,i.jsx)(m.Z,Object.assign({style:{margin:10}},{children:(0,i.jsxs)(g.Z,{children:[(0,i.jsx)(d.Z,{children:(0,i.jsx)(c.Z,{secondary:"Excavadora de destino"})}),(0,i.jsx)(d.Z,{children:(0,i.jsx)(c.Z,{children:(0,i.jsx)(pe.Z,Object.assign({component:"fieldset"},{children:(0,i.jsx)(xe.Z,Object.assign({row:!0,"aria-label":"gender",name:"radio-buttons-group"},{children:r.map((e=>{var t;return(0,i.jsx)(a.ZP,Object.assign({title:e.state!==We.J8.Operando?"Excavadora sin operación":"Excavadora de destino"},{children:(0,i.jsx)(be.Z,{value:e.id,disabled:e.state!==We.J8.Operando,control:(0,i.jsx)(Oe.Z,{disabled:e.state!==We.J8.Operando}),onChange:E,label:`  ${null===(t=e.excavatorList[0])||void 0===t?void 0:t.deviceAlias}`})}),e.id)}))}))}))})})]})}))}))]})),(0,i.jsx)(Le.a,Object.assign({open:x,handleClose:()=>{b(!1)},handleConfirm:()=>{b(!1),t(!1),p([]),h(""),_e(v,j,f,n)},title:"Area you sure?"},{children:(0,i.jsx)(ze.Z,Object.assign({severity:"warning"},{children:"Intentaremos mover estos camiones, si ocurre algun error se le informará"}))}))]}))};var Me=n(30433),$e=n(73727),Ue=n(2780),He=n(66083),Ge=n(8286),Ke=n(86072),Je=n(89601);const Ve=({newOperation:e})=>{const t=(0,y.T)(),n=()=>{t((0,Je.mg)())},o=(0,A.useMemo)((()=>e.uploadList.map(((e,t)=>{const s=e.type===We.WW.TAJO?`\n      ${e.nameProject}-${e.name}-${e.material?e.material.type:""}\n      `:e.name;return(0,i.jsx)(u.Z,{color:"secondary",label:s,onDelete:n},t)}))),[e.uploadList]);return 0===e.uploadList.length?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)(s.Z,Object.assign({item:!0},{children:(0,i.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,i.jsx)(a.ZP,Object.assign({title:"Change Upload"},{children:(0,i.jsx)(r.Z,Object.assign({color:"primary",size:"small"},{children:(0,i.jsx)(Ke.Z,{})}))})),o]}))}))},Be=({newOperation:e})=>{const t=(0,y.T)(),n=(0,A.useMemo)((()=>e.downloadList.map(((e,n)=>(0,i.jsx)(u.Z,{color:"secondary",label:e.name,onDelete:()=>{return n=e.id,void t((0,Je.$g)({id:n}));var n}},n)))),[e.downloadList]);return 0===e.downloadList.length?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)(s.Z,Object.assign({item:!0},{children:(0,i.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,i.jsx)(a.ZP,Object.assign({title:"Change Download"},{children:(0,i.jsx)(r.Z,Object.assign({color:"primary",size:"small"},{children:(0,i.jsx)(Ke.Z,{})}))})),n]}))}))},Ye=({newOperation:e})=>{const t=(0,y.T)(),n=()=>{t((0,Je.QW)())},o=(0,A.useMemo)((()=>e.excavatorList.map(((e,t)=>{const s=e.deviceAlias;return(0,i.jsx)(u.Z,{color:"secondary",label:s,onDelete:n},t)}))),[e.excavatorList]);return 0===e.excavatorList.length?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)(s.Z,Object.assign({item:!0},{children:(0,i.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,i.jsx)(a.ZP,Object.assign({title:"Change Excavator"},{children:(0,i.jsx)(r.Z,Object.assign({color:"primary",size:"small"},{children:(0,i.jsx)(Ke.Z,{})}))})),o]}))}))};var Xe=n(96588),qe=n(97111),Qe=n(50648);const et=({open:e,operation:t,setOpen:n})=>{const[r,o]=(0,A.useState)([]),{excavatorInfoList:l}=(0,y.C)(Ze.kW),c=(0,A.useRef)(),{dmeCellList:d,padCellList:g,stockCellList:m,polygonList:p}=(0,y.C)(F.WD),[x,b]=(0,A.useState)(qe.f.CHANGE_NOTHING),[O,f]=(0,A.useState)(We.WW.DESCONOCIDO),[E,N]=(0,A.useState)(Qe.TypeDownload.UNKNOWN),S=(0,y.T)(),{newOperation:L}=(0,y.C)(F.e5),C=(e,t,n)=>{const i=t.find((t=>t.id===e));i&&S((0,Je.qn)(Object.assign(Object.assign({},i),{type:n})))},T=(e,t,n)=>{const i=t.find((t=>t.id===e));i&&S((0,Je.Ru)(Object.assign(Object.assign({},i),{type:n})))},Z=(0,A.useCallback)((()=>(0,qe.BF)(x,O,p,m,E,d,g,l)),[x,O,p,m,E,d,g,l]);return(0,i.jsxs)(Ee.Z,Object.assign({open:e,onClose:n,title:"Migrate Operation"},{children:[(0,i.jsx)(He.Z,Object.assign({style:{paddingTop:8,paddingBottom:0}},{children:"Update Operation Attributes"})),(0,i.jsx)(Ne.Z,Object.assign({style:{minHeight:320}},{children:(0,i.jsxs)(s.Z,Object.assign({container:!0,direction:"column"},{children:[(0,i.jsx)(s.Z,Object.assign({item:!0},{children:(0,i.jsxs)(s.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,i.jsx)(je.Z,{children:"Upload:"}),(0,i.jsx)(Me.g7,{operation:t,lineThrough:L.uploadList.length>0}),(0,i.jsx)(Ve,Object.assign({},{operation:t,newOperation:L}))]}))})),(0,i.jsx)(j.Z,{width:"100%",height:8}),(0,i.jsxs)(s.Z,Object.assign({item:!0},{children:[(0,i.jsxs)(s.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,i.jsx)(je.Z,{children:"Download: "}),(0,i.jsx)(Me.DQ,{operation:t,lineThrough:L.downloadList.length>0}),(0,i.jsx)(Be,Object.assign({},{operation:t,newOperation:L}))]})),(0,i.jsx)(j.Z,{width:"100%",height:8}),(0,i.jsx)(h.Z,{orientation:"horizontal"}),(0,i.jsx)(a.ZP,Object.assign({title:"Puede agregar hasta 2 puntos de descarga"},{children:(0,i.jsx)(je.Z,Object.assign({style:{fontSize:11}},{children:"*You can add up to 2 download points, example 1 DME and 1 PAD or 1 STOCK"}))})),(0,i.jsx)(h.Z,{orientation:"horizontal"})]})),(0,i.jsx)(j.Z,{width:"100%",height:8}),(0,i.jsx)(s.Z,Object.assign({item:!0},{children:(0,i.jsxs)(s.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,i.jsx)(je.Z,{children:"Excavator: "}),(0,i.jsx)(Me.Ez,{operation:t,lineThrough:L.excavatorList.length>0}),(0,i.jsx)(Ye,Object.assign({},{operation:t,newOperation:L}))]}))})),(0,i.jsx)(j.Z,{height:8}),(1!==L.excavatorList.length||2!==L.downloadList.length||1!==L.uploadList.length)&&(0,i.jsx)(s.Z,Object.assign({item:!0,style:{marginTop:8}},{children:(0,i.jsx)(Xe.ZP,{size:"small",value:r,blurOnSelect:!0,onChange:(e,t)=>{switch(o(t),t.length){case 0:b(qe.f.CHANGE_NOTHING),f(We.WW.DESCONOCIDO),N(Qe.TypeDownload.UNKNOWN);break;case 1:b(t[0].value),f(We.WW.DESCONOCIDO),N(Qe.TypeDownload.UNKNOWN);break;case 2:switch(x){case qe.f.CHANGE_UPLOAD:f(Number(t[1].value));break;case qe.f.CHANGE_DOWNLOAD:N(Number(t[1].value));break;case qe.f.CHANGE_EXCAVATOR:((e,t)=>{const n=t.find((t=>t.id===e));n&&S((0,Je.Zh)(n))})(t[1].value,l),o([]),b(qe.f.CHANGE_NOTHING)}break;case 3:switch(x){case qe.f.CHANGE_UPLOAD:switch(O){case We.WW.TAJO:C(t[2].id,p,We.WW.TAJO);break;case We.WW.STOCK:C(t[2].id,m,We.WW.STOCK)}break;case qe.f.CHANGE_DOWNLOAD:switch(E){case Qe.TypeDownload.DME:T(t[2].id,d,E);break;case Qe.TypeDownload.PAD:T(t[2].id,g,E);break;case Qe.TypeDownload.STOCK:T(t[2].id,m,E)}}f(We.WW.DESCONOCIDO),N(Qe.TypeDownload.UNKNOWN),b(qe.f.CHANGE_NOTHING),o([])}setTimeout((()=>{var e,t;null===(e=c.current)||void 0===e||e.focus(),null===(t=c.current)||void 0===t||t.click()}),100)},options:Z(),multiple:!0,renderTags:(e,t)=>e.map(((e,n)=>(0,i.jsx)(u.Z,Object.assign({variant:"outlined",label:e.label},t({index:n}))))),style:{minWidth:200},getOptionLabel:e=>e.label,openOnFocus:!0,disableClearable:!0,getOptionDisabled:e=>(0,qe.HT)(e,L,E),filterSelectedOptions:!0,renderInput:e=>(0,i.jsx)(Ge.Z,Object.assign({},e,{autoFocus:!0,inputRef:c,label:"Cómo puedo ayudarte?",variant:"outlined",fullWidth:!0}))})}))]}))})),(0,i.jsx)(ye.Z,{children:(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(v.Z,Object.assign({onClick:n,size:"small",color:"primary"},{children:"Cancel"})),(0,i.jsx)(v.Z,Object.assign({variant:"outlined",size:"small",color:"secondary",onClick:()=>{S((0,Je.db)({oldOperation:t,newOperation:L}))}},{children:"Save"}))]})})]}))};var tt=n(76796);const nt=(0,o.Z)({rootList:{flex:1,padding:2,margin:2,overflow:"auto"},rootNoDropItem:{padding:2,margin:2,width:32,height:"92vh"},rootListOver:{flex:1,padding:2,margin:2,overflow:"auto",background:"#80808045"},rootNotDropList:{width:300,padding:2,margin:2,overflow:"auto",zIndex:1,transform:"translateX(-50%) translateY(130px) rotate(-90deg)",msTransform:"translateX(-50%) translateY(130px) rotate(-90deg)",mozTransform:"translateX(-50%) translateY(130px) rotate(-90deg)",OTransform:"translateX(-50%) translateY(130px) rotate(-90deg)",position:"absolute",left:"50%",top:"0%"},rootNotOperation:{width:36,padding:2,margin:2,background:`${E.J$}10`,borderColor:E.J$,borderWidth:2,borderStyle:"dotted"},disabledPadding:{padding:0,paddingBottom:2,flex:1},labelExcavator:{fontSize:21,borderRadius:8,borderStyle:"dotted",padding:4,margin:2,background:"#424141",color:"#fff"}}),it=({operation:e})=>{const t=nt(),n=e.excavatorList.length>0?e.excavatorList[0]:null;return(0,i.jsxs)(Y.T5,Object.assign({container:!0,className:t.disabledPadding,alignItems:"center",justifyContent:e.id?"flex-start":"flex-end"},{children:[(0,i.jsx)(Y.P4,Object.assign({item:!0},{children:(0,i.jsx)(c.Z,{secondary:(0,i.jsx)("strong",Object.assign({className:t.labelExcavator},{children:null==n?void 0:n.deviceAlias}))})})),!e.id&&(0,i.jsx)($e.rU,Object.assign({style:{textDecoration:"none"},to:`/operation/create/${n?n.deviceId:""}/${n?n.id:""}`},{children:(0,i.jsx)(a.ZP,Object.assign({title:`Asignar operación a ${n?n.deviceAlias:""}`},{children:(0,i.jsx)(r.Z,Object.assign({size:"small",color:"secondary"},{children:(0,i.jsx)(ue.Z,{fontSize:"small"})}))}))}))]}))},st=({operation:e,loading:t,setLoading:n,setRefresh:o})=>{const l=nt(),[c,g]=(0,A.useState)(!1),[m,h]=(0,A.useState)(!1),{timeline:j}=(0,y.C)(w.h3),[p,x]=(0,A.useState)(Number(null==j?void 0:j.initialHourmeter.toFixed(1))),[b,O]=(0,A.useState)(null),{hours:f,minutes:E}=(()=>{const e=new Date;return{hours:e.getHours(),minutes:e.getMinutes()}})(),S=`${`00${f}`.slice(-2)}:${`00${E}`.slice(-2)}`,[L,C]=(0,A.useState)(S),{user:T}=(0,y.C)(_.MR),Z=()=>{h((e=>!e))},k=(0,y.T)(),{state:R}=(0,y.C)(F.e5),{eventStateList:z}=(0,y.C)(F.eG);(0,A.useEffect)((()=>{switch(R){case Je.m4.SAVING:n(!0);break;case Je.m4.ERROR:n(!1);break;case Je.m4.DONE:n(!1),h(!1)}}),[R]);const U=()=>g((e=>!e)),H=e.excavatorList.length>0?e.excavatorList[0]:null;return e.id?(0,i.jsxs)(d.Z,Object.assign({disableGutters:!0,className:l.disabledPadding},{children:[(0,i.jsx)(Le.a,Object.assign({open:c,handleClose:U,handleConfirm:()=>{return t=void 0,i=void 0,a=function*(){n(!0);const t=yield(0,Ue.wg)(e.id);k(t?(0,Te.L8)({open:!0,msg:t,severity:"error"}):(0,Te.Ui)()),n(!1),o((e=>!e)),g(!1)},new((s=void 0)||(s=Promise))((function(e,n){function r(e){try{l(a.next(e))}catch(e){n(e)}}function o(e){try{l(a.throw(e))}catch(e){n(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(r,o)}l((a=a.apply(t,i||[])).next())}));var t,i,s,a},title:"Esta seguro?"},{children:(0,i.jsxs)(ze.Z,Object.assign({severity:"warning"},{children:["Esta intentando finalizar la operacion"," ",e.excavatorList[0].deviceAlias,", si ocurre algun error se le informará"]}))})),(0,i.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,i.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,i.jsx)(it,Object.assign({},{operation:e})),(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(a.ZP,Object.assign({title:"Cambiar Carga/Descarga/Cambiones/Excavadora"},{children:(0,i.jsx)(r.Z,Object.assign({color:"secondary",size:"small",onClick:Z},{children:(0,i.jsx)(ve.Z,{fontSize:"small"})}))})),(0,i.jsx)(a.ZP,Object.assign({title:"Finalizar Operación"},{children:(0,i.jsx)(r.Z,Object.assign({color:"secondary",onClick:U,size:"small"},{children:(0,i.jsx)(ge.Z,{fontSize:"small"})}))})),(0,i.jsx)(a.ZP,Object.assign({title:"Detalle Operación"},{children:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(r.Z,Object.assign({color:"secondary",size:"small",onClick:()=>{k((0,tt.l4)(H.deviceId)),k((0,P.m1)(H))}},{children:(0,i.jsx)(me.Z,{fontSize:"small"})}))})}))]})]})),(0,i.jsxs)(s.Z,Object.assign({item:!0,md:12},{children:[(0,i.jsx)(Me.g7,{operation:e}),(0,i.jsx)(Me.DQ,{operation:e}),e.truckList.length>0?(0,i.jsx)(u.Z,{size:"small",label:`${e.truckList.length} camiones`}):(0,i.jsx)(i.Fragment,{})]})),(0,i.jsx)(s.Z,Object.assign({item:!0},{children:e.truckTemporalList&&e.truckTemporalList.length>0&&!t&&(0,i.jsx)(a.ZP,Object.assign({title:"Guardar cambios"},{children:(0,i.jsx)(v.Z,Object.assign({size:"small",variant:"outlined",color:"secondary",startIcon:(0,i.jsx)(he.Z,{color:"secondary",fontSize:"small"}),onClick:()=>{var t;k((0,N.hK)({operationId:e.id}));const i=z.find((e=>{var t;return(null===(t=e.event)||void 0===t?void 0:t.event)===D.EnumEvent.OPERATIONAL}));(null===(t=null==i?void 0:i.event)||void 0===t?void 0:t.event)&&e.truckTemporalList.map((e=>{var t,n,s,a;if(console.log("eventStateObject: ",i),(null===(n=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===n?void 0:n.event)===D.EnumEvent.NO_OPERATIONAL||(null===(a=null===(s=e.eventState)||void 0===s?void 0:s.event)||void 0===a?void 0:a.event)===D.EnumEvent.OPERATIONAL_DELAY){k((0,w.h1)(e));const t=null,n=null,s=null,a=Number(p),r={id:"",deviceAlias:e.deviceAlias,deviceId:e.deviceId,initialHourmeter:a,adjustment:0,durationTime:0,finalHourmeter:0,initialTime:S,initialEventState:Object.assign(Object.assign({},i),{id:"",name:"",eventState:I.EnumEventState.UNKNOWN_STATE}),initialState:D.EnumEvent.OPERATIONAL,finalState:t,shift:n,status:!1,stateRegister:s,assetType:$.EnumAssetType.TRUCK,guard:W.EnumGuard.UNKNOWN_GUARD,userId:T.user.id};(0,w.hO)(r),k((0,M.BU)({timeline:r,hour:L})),console.log("Changuin Operative")}})),_e(e.id,e.truckTemporalList,n,o)}},{children:"GUARDAR"}))}))})),(0,i.jsx)(et,{open:m,operation:e,setOpen:Z})]}))]})):(0,i.jsx)(it,Object.assign({},{operation:e}))},at=({operation:e,filterList:t})=>{const n=(0,A.useMemo)((()=>{var n;return null===(n=e.truckTemporalList)||void 0===n?void 0:n.map(((n,s)=>(0,i.jsx)(B,{operation:e,truck:n,eventFrom:D.EnumEvent.OPERATIONAL,temporal:!0,isFilter:t.some((e=>e.deviceId===n.deviceId))},s)))}),[e.truckTemporalList]);return(0,i.jsx)(i.Fragment,{children:n})},rt=({operation:e,filterList:t})=>{const[n,s]=(0,A.useState)(e.truckList);(0,A.useEffect)((()=>{s((t=>e.truckList&&e.truckList.length!==n.length||n.some((t=>e.truckList.some((e=>e.deviceId==t.deviceId&&(t.sensor&&e.sensor?t.cycleNumber!==e.cycleNumber||t.state!==e.state||t.eventState!==e.eventState||t.sensor.latitude!=e.sensor.latitude:t.cycleNumber!==e.cycleNumber||t.state!==e.state||t.eventState!==e.eventState)))))?e.truckList:t))}),[e.truckList]);const a=(0,A.useMemo)((()=>e.truckList.map(((n,s)=>{var a;return(0,i.jsx)(B,{operation:e,isFilter:t.some((e=>e.deviceId===n.deviceId)),eventFrom:D.EnumEvent.OPERATIONAL,truck:n,temporalRemove:null===(a=e.truckTemporalRemoveList)||void 0===a?void 0:a.some((e=>e.deviceId===n.deviceId))},s)}))),[n,t]);return(0,i.jsx)(i.Fragment,{children:a})},ot=({operation:e,setRefresh:t,filterList:n})=>{const[a,r]=(0,A.useState)(!1),[o,c]=(0,A.useState)(q.kM);(0,A.useEffect)((()=>{e&&e.truckList&&e.truckList.length>0?c((t=>o.deviceId!==e.excavatorList[0].deviceId?e.excavatorList[0]:t)):c(q.kM)}),[e]);const[{canDrop:d,isOver:u},v]=(0,l.L)((()=>({accept:b,drop:()=>({operation:e,eventTo:D.EnumEvent.OPERATIONAL}),collect:t=>({isOver:!!t.isOver(),canDrop:!!e.id})})),[e]),p=nt(),O=(0,A.useCallback)((()=>u&&d?p.rootListOver:u&&!d?p.rootNotDropList:p.rootList),[u,d]),f=(0,A.useMemo)((()=>(0,i.jsx)(i.Fragment,{children:o&&(0,i.jsx)(de,{truckList:[],operation:e})})),[o,e]),E=(0,A.useMemo)((()=>(0,i.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,i.jsx)(rt,{operation:e,filterList:n}),(0,i.jsx)(at,{operation:e,filterList:n})]}))),[e,n]);return d?(0,i.jsxs)(g.Z,Object.assign({ref:v,disablePadding:!0,component:m.Z,style:{display:"flex",flexDirection:"column"},className:O()},{children:[(0,i.jsxs)(Y.P4,Object.assign({item:!0,style:{flex:1}},{children:[(0,i.jsx)(st,Object.assign({},{operation:e,setLoading:r,loading:a,setRefresh:t})),(0,i.jsx)(h.Z,{orientation:"horizontal"}),(0,i.jsx)(x,{loading:a}),(0,i.jsx)(j.Z,{height:4}),E]})),f]})):(0,i.jsx)(g.Z,Object.assign({disablePadding:!0,component:m.Z,className:p.rootNotOperation},{children:(0,i.jsx)("div",Object.assign({className:p.rootNotDropList},{children:(0,i.jsx)(st,Object.assign({},{operation:e,setLoading:r,loading:a,setRefresh:t}))}))}))};var lt=n(14129),ct=n(57865);const dt=e=>{if(!e)return"";const t=We.PW[e.type];switch(e.type){case 1:return e.pit&&e.pit.projectList&&e.pit.projectList.length>0&&e.pit.projectList[0].polygonList&&e.pit.projectList[0].polygonList.length>0?`${e.pit.projectList[0].name} - ${e.pit.projectList[0].polygonList[0].name}`:"";case 3:return e[t]&&e[t].cellList&&e[t].cellList.length>0?e[t].cellList[0].name:"";default:return""}},ut=e=>{if(!e&&1!==e.type)return"";const t=We.PW[e.type];return`${"dme"===t?"Desm.":"stock"===t?"STK":"Mine."} ${e[t]&&e[t].cellList&&e[t].cellList.length>0?e[t].cellList[0].name:""}`},vt=()=>(0,i.jsx)(s.Z,Object.assign({container:!0,justifyContent:"center",alignItems:"center"},{children:(0,i.jsx)(s.Z,Object.assign({item:!0},{children:(0,i.jsx)(je.Z,{children:"No data found"})}))}));var gt=n(58365);const mt=({height:e,width:t})=>(0,i.jsx)(s.Z,Object.assign({container:!0,justifyContent:"center",alignItems:"center"},{children:(0,i.jsx)(gt.Z,{height:e,width:t,variant:"rect"})}));var ht=n(14741),jt=n(17215),pt=n(59693);const xt=(0,ke.Z)((e=>({search:{position:"relative",marginRight:2,borderRadius:e.shape.borderRadius,backgroundColor:(0,pt.Fq)(e.palette.common.white,.15),"&:hover":{backgroundColor:(0,pt.Fq)(e.palette.common.white,.25)},marginLeft:0,width:"100%",[e.breakpoints.up("sm")]:{width:"auto"}},searchIcon:{padding:e.spacing(0,0),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},cancelIcon:{padding:e.spacing(0,0),height:"100%",alignItems:"center",justifyContent:"center",display:"flex"},inputRoot:{color:"inherit"},inputInput:{padding:e.spacing(1,1,1,0),paddingLeft:`calc(1em + ${e.spacing(1)}px)`,paddingRight:`calc(1em + ${e.spacing(1)}px)`,transition:e.transitions.create("width"),width:"100%",[e.breakpoints.up("sm")]:{width:"40ch","&:focus":{width:"50ch"}}}}))),bt=({search:e,setSearch:t})=>{const n=xt(),a=(0,A.useRef)();(0,A.useEffect)((()=>{document.onkeydown=r}),[]);const r=(0,A.useCallback)((e=>{"Escape"===e.key&&(l(),setTimeout((()=>{var e;console.log("Escape",a.current),null===(e=a.current)||void 0===e||e.focus()}),300))}),[]),o=(0,A.useCallback)((e=>{t(e.target.value)}),[]),l=(0,A.useCallback)((()=>{t("")}),[]);return(0,i.jsx)(m.Z,Object.assign({style:{marginTop:2,marginRight:2}},{children:(0,i.jsx)(s.Z,Object.assign({container:!0,alignItems:"center"},{children:(0,i.jsxs)("div",Object.assign({className:n.search},{children:[(0,i.jsx)("div",Object.assign({className:n.searchIcon},{children:(0,i.jsx)(jt.Z,{color:"primary",fontSize:"small"})})),(0,i.jsx)(ht.Z,{color:"primary",value:e,autoFocus:!0,inputRef:a,onKeyDown:r,onChange:o,placeholder:"Buscar...",classes:{root:n.inputRoot,input:n.inputInput},inputProps:{"aria-label":"search"}})]}))}))}))};var Ot=n(73099),ft=n(31125);const Et=({enumEvent:e})=>{const{truck:t,events:n}=(0,y.C)(w.h3),{eventTo:s,eventFrom:a}=n;return(0,i.jsx)(i.Fragment,{children:s==D.EnumEvent.OPERATIONAL&&a==D.EnumEvent.MAINTENANCE&&1==e||s==e?(0,i.jsx)(B,{eventFrom:D.EnumEvent.UNKNOWN_STATE_EVENT,id:`truck-hormeter-${null==t?void 0:t.deviceId}`,truck:t,isFilter:!1},null==t?void 0:t.deviceId):(0,i.jsx)(i.Fragment,{})})};var yt=n(11818);const Nt=(0,ke.Z)({rootNoDropItem:{},rootListOver:{marginBottom:4,background:"#80808045"},root:{padding:2},rootList:{marginBottom:4},ListItem:{padding:0,margin:0},itemHeaderList:{flex:1,paddingLeft:2},textHeaderList:{margin:0},iconTextList:{padding:0,margin:0},chipText:{height:12,color:"#fff",fontWeight:"bold"}}),St=({items:e,filterList:t,title:n,useVisibleList:s,keyState:a,isAviable:r})=>{(0,y.T)();const o=Nt(),[{canDrop:v,isOver:h},j]=(0,l.L)((()=>({accept:b,drop:()=>({eventTo:a}),collect:e=>({isOver:e.isOver(),canDrop:!0})})),[]),p=(0,A.useCallback)((()=>h&&v?o.rootListOver:o.rootList),[h,v]),[x,f]=s,E=(0,A.useMemo)((()=>e.map((e=>(0,i.jsx)(B,{eventFrom:a,truck:e,isFilter:t.some((t=>t.deviceId===e.deviceId))},e.deviceId)))),[e,t]),[N,S]=(0,A.useState)(!1),L=(0,A.useCallback)((()=>{const e=x.findIndex((e=>e.value===a));if(e>-1){S((e=>!e));const t=JSON.parse(JSON.stringify(x));t[e].visible=!x[e].visible,f(t)}console.log("Visibility: ",x,a)}),[x]);return(0,i.jsxs)(g.Z,Object.assign({ref:!1===r?j:null,component:m.Z,disablePadding:!0,className:p()},{children:[(0,i.jsx)(d.Z,Object.assign({button:!0,disableGutters:!0,className:o.ListItem,onClick:L},{children:(0,i.jsxs)(Y.T5,Object.assign({container:!0,justifyContent:"space-between",alignItems:"center"},{children:[(0,i.jsxs)(Y.P4,Object.assign({className:o.itemHeaderList,container:!0,direction:"column",justifyContent:"center",alignContent:"flex-start"},{children:[(0,i.jsx)(c.Z,{className:o.textHeaderList,secondary:n}),(0,i.jsx)(u.Z,{size:"small",className:o.chipText,color:"primary",label:`(${e.length}) camiones`})]})),e.length?(0,i.jsx)(Y.hU,Object.assign({size:"small",className:o.iconTextList},{children:N?(0,i.jsx)(Ot.Z,{fontSize:"small"}):(0,i.jsx)(ft.Z,{fontSize:"small"})})):(0,i.jsx)(i.Fragment,{})]}))})),(0,i.jsx)(Y.iz,{orientation:"horizontal"}),(0,i.jsx)(O.Z,Object.assign({in:!N,mountOnEnter:!0,unmountOnExit:!0},{children:(0,i.jsxs)(Y.T5,Object.assign({container:!0,justifyContent:"center"},{children:[E,(0,i.jsx)(Et,{enumEvent:a})]}))}))]}))},Lt=({truckAvailable:e,filterList:t})=>{const n=(0,y.T)(),{timelineObject:s,truck:a}=(0,y.C)(w.h3),[r,o,l,c]=(0,yt.y)(s),{mantoList:d,DOperativeList:u,NOperativeList:v}=(e=>{const{truck:t,events:n}=(0,y.C)(w.h3),[i,s]=(0,A.useState)([]),[a,r]=(0,A.useState)([]),[o,l]=(0,A.useState)([]),[c,d]=(0,A.useState)([]);return(0,A.useEffect)((()=>{r((t=>{const n=e.filter((e=>{var t,n;return e.eventState&&(null===(n=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===n?void 0:n.event)===D.EnumEvent.MAINTENANCE}));return t.length===n.length&&JSON.stringify(t)===JSON.stringify(n)?t:n})),l((t=>{const n=e.filter((e=>{var t,n;return e.eventState&&(null===(n=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===n?void 0:n.event)===D.EnumEvent.OPERATIONAL_DELAY}));return t.length===n.length&&JSON.stringify(t)===JSON.stringify(n)?t:n})),d((t=>{const n=e.filter((e=>{var t,n,i,s,a,r,o,l;return e.eventState&&(null===(n=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===n?void 0:n.event)===D.EnumEvent.NO_OPERATIONAL||e.state===I.EnumEventState.UNKNOWN_STATE&&e.eventState&&(null===(s=null===(i=e.eventState)||void 0===i?void 0:i.event)||void 0===s?void 0:s.event)===D.EnumEvent.UNKNOWN_STATE_EVENT||e.eventState&&(null===(r=null===(a=e.eventState)||void 0===a?void 0:a.event)||void 0===r?void 0:r.event)===D.EnumEvent.OPERATIONAL||(null===(l=null===(o=e.eventState)||void 0===o?void 0:o.event)||void 0===l?void 0:l.event)===D.EnumEvent.UNKNOWN_STATE_EVENT}));return t.length===n.length&&JSON.stringify(t)===JSON.stringify(n)?t:n}))}),[e]),{availableList:i,mantoList:a,DOperativeList:o,NOperativeList:c}})(e);(0,A.useEffect)((()=>()=>{n((0,w.S)())}),[a]);const g=Nt(),m=(0,re._)("VISIBLE_STATES_TABS",Object.keys(D.EnumEvent).map(((e,t)=>({value:D.EnumEvent[e],label:e,visible:!1})))),h=(0,A.useMemo)((()=>(0,i.jsx)(Y.T5,Object.assign({className:g.root},{children:(0,i.jsx)(St,{items:v,filterList:t,title:"NOPERATIVO",useVisibleList:m,keyState:D.EnumEvent.NO_OPERATIONAL,isAviable:r})}))),[v,t,m]),j=(0,A.useMemo)((()=>(0,i.jsx)(Y.T5,Object.assign({className:g.root},{children:(0,i.jsx)(St,{items:d,filterList:t,title:"MANTO",useVisibleList:m,keyState:D.EnumEvent.MAINTENANCE,isAviable:c})}))),[d,t,m]),p=(0,A.useMemo)((()=>(0,i.jsx)(Y.T5,Object.assign({className:g.root},{children:(0,i.jsx)(St,{items:u,filterList:t,title:"DOPERATIVO",useVisibleList:m,keyState:D.EnumEvent.OPERATIONAL_DELAY,isAviable:l})}))),[u,t,m]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(Y.T5,Object.assign({className:g.root},{children:[h,j,p]}))})};var Ct=n(89550),Tt=n(47463);const Zt=(0,ke.Z)({paddingContainer:{padding:8}}),kt=({timeline:e,truck:t,eventSelect:n,setRefresh:a})=>{var r,o,l;const c=Zt(),d=(0,A.useRef)(),u=(0,A.useRef)(),g=(0,A.useRef)(),h=(0,y.T)(),{stateCreateTimeline:j}=(0,y.C)(M.yV),{eventStateList:p}=(0,y.C)(F.eG),[x,b]=(0,A.useState)([]),[O,f]=(0,A.useState)(Number(e.initialHourmeter.toFixed(1))),[E,N]=(0,A.useState)(null),[S,L]=(0,A.useState)(null),{hours:C,minutes:T}=(()=>{const e=new Date;return{hours:e.getHours(),minutes:e.getMinutes()}})(),Z=`${`00${C}`.slice(-2)}:${`00${T}`.slice(-2)}`,[k,R]=(0,A.useState)(Z),{user:P}=(0,y.C)(_.MR),{events:z}=(0,y.C)(w.h3),{eventTo:U,eventFrom:H}=z;(0,A.useEffect)((()=>{p.length>0&&(b(p),N(p[0]))}),[p,n]),(0,A.useEffect)((()=>{d&&d.current&&(d.current.focus(),d.current.setSelectionRange(d.current.value.length-2,d.current.value.length))}),[d]);const G=e=>{if(console.log("enumEventState Value: ",E),console.log("enumEventStateHig Value: ",S),"Scape"===e.key)return N(null),void setTimeout((()=>{var e;L(null),null===(e=g.current)||void 0===e||e.focus()}),100);if(("Enter"===e.key||"Tab"===e.key)&&p.length>0){if(console.log("enumEventHigthlight",S),S)return N(S),void setTimeout((()=>{var e;L(null),null===(e=g.current)||void 0===e||e.focus()}),100);if(E)console.log("saving"),K();else{const e=x.filter((e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(g.current?g.current.value.toLocaleLowerCase():"")}));console.log("filterd",e),e.length>0&&(N(e[0]),setTimeout((()=>{L(null)}),100))}}else N(null)},K=()=>{return e=void 0,i=void 0,r=function*(){if(E){const e=null,i=null,s=null,r=Object.assign({},E);n===D.EnumEvent.OPERATIONAL&&(r.eventState=I.EnumEventState.UNKNOWN_STATE,r.id="",r.name="");const o=Number(O);if(o>=0){const l={id:"",deviceAlias:t.deviceAlias,deviceId:t.deviceId,initialHourmeter:o,adjustment:0,durationTime:0,finalHourmeter:0,initialTime:Z,initialEventState:r,initialState:n,finalState:e,shift:i,status:!1,stateRegister:s,assetType:$.EnumAssetType.TRUCK,guard:W.EnumGuard.UNKNOWN_GUARD,userId:P.user.id};switch(n){case D.EnumEvent.MAINTENANCE:break;case D.EnumEvent.NO_OPERATIONAL:r.eventState===I.EnumEventState.LACK_OF_OPERATOR&&t.operationList.length>0&&(console.log("removing Of Operation... ",t.deviceAlias),yield(0,Ue.We)(t.operationList[0].id,[t]));case D.EnumEvent.OPERATIONAL:case D.EnumEvent.OPERATIONAL_DELAY:}console.log("savingnewTimeline",l),(0,w.hO)(l),yield h((0,M.BU)({timeline:l,hour:k})),h((0,w.Go)()),a((e=>!e))}else alert("Ingrese un horometro correcto")}else alert("Seleccionar un evento")},new((s=void 0)||(s=Promise))((function(t,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof s?n:new s((function(e){e(n)}))).then(a,o)}l((r=r.apply(e,i||[])).next())}));var e,i,s,r};return(0,i.jsx)(m.Z,Object.assign({elevation:4},{children:(0,i.jsxs)(s.Z,Object.assign({className:c.paddingContainer},{children:[(0,i.jsxs)(je.Z,{children:["Camión ",t.deviceAlias]}),(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)("div",{children:["Estado actual: ",null===(o=null===(r=e.initialEventState)||void 0===r?void 0:r.event)||void 0===o?void 0:o.name]}),(0,i.jsxs)("div",{children:["Horometro aprox: ",e.initialHourmeter.toFixed(1),"h"]}),(0,i.jsxs)(s.Z,Object.assign({style:{marginTop:8,minHeight:"25vh"}},{children:[(()=>{if(U===D.EnumEvent.MAINTENANCE||H===D.EnumEvent.MAINTENANCE)return!0})()&&(0,i.jsx)(oe.C,{propsForm:{},propsTextField:{variant:"outlined",autoFocus:!1,size:"small",label:"Horometro de ingreso",inputRef:d,onChange:e=>{e.target.value?f(e.target.value):f("")},value:O,inputProps:{onKeyDown:e=>{"Enter"===e.key&&u.current&&u.current.focus()}}}}),(0,i.jsx)(oe.C,{propsForm:{},propsTextField:{variant:"outlined",autoFocus:!1,size:"small",inputRef:u,type:"time",value:k,onChange:e=>{R(e.target.value)},inputProps:{onKeyDown:e=>{"Enter"===e.key&&g.current&&(g.current.focus(),g.current.setSelectionRange(0,g.current.value.length))}}}}),(0,i.jsx)(Tt.I,{height:8,width:"100%"}),(0,i.jsx)(Y.T5,{children:x.length>0&&((null===(l=x[0].event)||void 0===l?void 0:l.event)!=D.EnumEvent.OPERATIONAL?(0,i.jsx)(Xe.ZP,{renderInput:e=>(0,i.jsx)(Ge.Z,Object.assign({},e,{fullWidth:!0,variant:"outlined",onKeyDown:G,inputRef:g})),options:x,fullWidth:!0,blurOnSelect:!0,onChange:(e,t)=>N(t),size:"small",value:E,onHighlightChange:(e,t)=>{L(t)},getOptionLabel:e=>e.name,openOnFocus:!0}):(0,i.jsx)(i.Fragment,{children:"CAMBIANDO A OPERATIVO"}))})]})),(0,i.jsxs)(s.Z,Object.assign({container:!0,style:{marginTop:8,gap:4},justifyContent:"flex-end"},{children:[(0,i.jsx)(v.Z,Object.assign({onClick:()=>{h((0,w.Go)())},size:"small",variant:"outlined",color:"primary"},{children:"CANCELAR"})),(0,i.jsx)(v.Z,Object.assign({disabled:j===ee.JD.LOADING,size:"small",variant:"contained",color:"secondary",onClick:K},{children:"CONFIRMAR"}))]}))]})]}))}))};var At=n(71308);const It=(0,ke.Z)({modalStyle:{minWidth:"10%",minHeight:"10%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,justifyContent:"center",textAlign:"center",alignItems:"center",outline:"none"}}),wt=({setRefresh:e})=>{const[t,n]=(0,A.useState)(null),{eventSelect:s}=(0,y.C)(F.yJ),[a,r]=(0,A.useState)(!1),{openModal:o,truck:l,loadingCurrentTimeline:c,timeline:d}=(0,y.C)(w.h3),u=(0,y.T)(),v=It();(0,A.useEffect)((()=>{if(l){const e=document.getElementById(`truck-hormeter-${l.deviceId}`);e&&n(e)}}),[l]),(0,A.useEffect)((()=>{o||n(null)}),[o]),(0,A.useEffect)((()=>{window.onkeydown=g}),[]),(0,A.useEffect)((()=>{u((0,U.Gy)(s))}),[s]);const g=e=>{"Escape"===e.key&&(u((0,w.Go)()),u((0,N.uP)()),n(null))};return(0,i.jsx)(i.Fragment,{children:t&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(Ct.Z,Object.assign({open:o,onClose:()=>{u((0,w.Go)())}},{children:(0,i.jsx)("div",Object.assign({className:v.modalStyle},{children:!c&&l&&d?(0,i.jsx)(kt,{timeline:d,truck:l,setRefresh:e,eventSelect:s}):(0,i.jsx)("div",{children:(0,i.jsx)(At.g,{})})}))}))})})};var Dt=n(70164),Rt=n(33901),Pt=n(10646),zt=n(15635);const Wt=({idTruck:e})=>{const t=(0,A.useRef)(),n=(0,A.useRef)(),[o,l]=(0,A.useState)([]),[c,d]=(0,A.useState)({label:"",id:"",value:""}),{truckInfoList:g}=(0,y.C)(H.ej),{excavatorInfoList:m}=(0,y.C)(Ze.kW),{statusCycle:h}=(0,y.C)(P.XE),[p]=(0,zt.r)(h),[x,b]=(0,A.useState)(!1),O=(0,y.T)(),[f,E]=(0,A.useState)(),[N,S]=(0,A.useState)(),[L]=(0,Pt.l)(new Date),[C]=(0,Pt.i)(new Date),[T,Z]=(0,A.useState)({date:`${L}T${C}`}),{truckSelect:k}=(0,y.C)(P.XE),I={id:"",centroid:void 0,pointList:void 0,name:"Desconocido",idDme:void 0,color:void 0},[w,D]=(0,A.useState)(I),[R,z]=(0,A.useState)(I),[W,_]=(0,A.useState)(I),{dmeCellList:M,padCellList:$,stockCellList:U,polygonList:G}=(0,y.C)(F.WD),[K,J]=(0,A.useState)([]),[V,B]=(0,A.useState)([]),[Y,X]=(0,A.useState)([]);(0,A.useEffect)((()=>{J([w,...M]),B([R,...$]),X([W,...U])}),[M,$,U]);const[q,Q]=(0,A.useState)(qe.f.CHANGE_NOTHING),[te,ne]=(0,A.useState)(Qe.TypeDownload.UNKNOWN),ie=(e,t,n)=>{const i=t.find((t=>t.id===e));i&&E(Object.assign(Object.assign({},i),{type:n}))},se=(0,A.useCallback)((()=>(0,qe.eq)(q,Y,te,K,V)),[q,G,Y,te,K,V]),ae=(0,A.useCallback)((()=>(0,qe.M6)(m)),[m]);return(0,A.useEffect)((()=>{d(N?{label:`${null==N?void 0:N.deviceAlias}`,id:`${null==N?void 0:N.deviceId}`,value:`${null==N?void 0:N.deviceId}`}:{label:"",id:"",value:""})}),[N]),(0,A.useEffect)((()=>{b(!!f&&!!N&&!!T.date)}),[f,N,T]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(je.Z,Object.assign({variant:"button",style:{paddingLeft:8,paddingTop:16,color:"black"}},{children:`Agregar Ciclo al camión ${e}`})),(0,i.jsx)(j.Z,{width:"100%",height:8}),(0,i.jsxs)(s.Z,Object.assign({container:!0,direction:"column",style:{padding:"0.4rem",alignItems:"center"}},{children:[(0,i.jsx)(j.Z,{width:"100%",height:8}),(0,i.jsx)(s.Z,Object.assign({item:!0},{children:(0,i.jsxs)(s.Z,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,i.jsx)(je.Z,Object.assign({style:{color:"black"}},{children:"Descarga:"})),(0,i.jsx)(s.Z,Object.assign({item:!0},{children:(0,i.jsx)(s.Z,Object.assign({container:!0},{children:f&&(0,i.jsx)(a.ZP,Object.assign({title:"Nueva Descarga"},{children:(0,i.jsx)(r.Z,Object.assign({color:"primary",size:"small"},{children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Ke.Z,{}),(0,i.jsx)(u.Z,{size:"small",color:"secondary",label:f.name,onDelete:()=>E("")})]})}))}))}))}))]}))})),(0,i.jsx)(j.Z,{width:"100%",height:8}),(0,i.jsx)(s.Z,Object.assign({item:!0},{children:(0,i.jsxs)(s.Z,Object.assign({container:!0,direction:"row",justifyContent:"center"},{children:[(0,i.jsxs)(je.Z,Object.assign({style:{color:"black"}},{children:["Excavadora:"," "]})),N&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Ke.Z,{color:"primary"}),(0,i.jsx)(u.Z,{size:"small",color:"secondary",label:null==N?void 0:N.deviceAlias,onDelete:()=>{S(void 0),d({label:"",id:"",value:""})}})]})]}))})),h==ee.JD.LOADING?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(fe.Z,{})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.Z,{height:8}),(0,i.jsxs)(s.Z,Object.assign({item:!0,style:{marginTop:8}},{children:[(0,i.jsx)(Ge.Z,{id:"date",label:"Fecha",type:"datetime-local",name:"date",value:T.date,onChange:e=>{const t=e.target;Z(Object.assign(Object.assign({},T),{[t.name]:e.target.value}))},InputLabelProps:{shrink:!0,required:!0},error:void 0===T}),(0,i.jsx)(j.Z,{height:12}),(0,i.jsxs)("div",Object.assign({style:{display:"flex",flexDirection:"row",height:"100px"}},{children:[(0,i.jsx)(Xe.ZP,{size:"small",value:c,blurOnSelect:!0,onChange:(e,t)=>{((e,t)=>{const n=t.find((t=>t.deviceId===e));n&&S(n)})(null!=t?t.value:"",m)},options:ae(),renderTags:(e,t)=>e.map(((e,n)=>(0,i.jsx)(u.Z,Object.assign({variant:"outlined",label:e.label},t({index:n}))))),style:{width:150},getOptionLabel:e=>e.label,disableClearable:!0,filterSelectedOptions:!0,renderInput:e=>(0,i.jsx)(Ge.Z,Object.assign({},e,{autoFocus:!0,inputRef:n,label:"Excavadora",variant:"outlined",fullWidth:!0,error:void 0===N}))}),(0,i.jsx)(j.Z,{width:4}),o.length<3&&(0,i.jsx)(Xe.ZP,{size:"small",value:o,blurOnSelect:!0,onChange:(e,n)=>{switch(l(n),n.length){case 0:Q(qe.f.CHANGE_DOWNLOAD),ne(Qe.TypeDownload.UNKNOWN);break;case 1:Q(qe.f.CHANGE_DOWNLOAD),ne(Number(n[0].value)),q===qe.f.CHANGE_DOWNLOAD&&ne(Number(n[0].value));break;case 2:if(q===qe.f.CHANGE_DOWNLOAD)switch(te){case Qe.TypeDownload.DME:ie(n[1].id,K,te);break;case Qe.TypeDownload.PAD:ie(n[1].id,V,te);break;case Qe.TypeDownload.STOCK:ie(n[1].id,Y,te)}ne(Qe.TypeDownload.UNKNOWN),Q(qe.f.CHANGE_DOWNLOAD),l([])}setTimeout((()=>{var e,n;null===(e=t.current)||void 0===e||e.focus(),null===(n=t.current)||void 0===n||n.click()}),100)},options:se(),multiple:!0,renderTags:(e,t)=>e.map(((e,n)=>(0,i.jsx)(u.Z,Object.assign({variant:"outlined",label:e.label},t({index:n}))))),style:{width:200},getOptionLabel:e=>e.label,openOnFocus:!0,disableClearable:!0,filterSelectedOptions:!0,renderInput:e=>(0,i.jsx)(Ge.Z,Object.assign({},e,{autoFocus:!0,inputRef:t,label:"Agrega Descarga",variant:"outlined",fullWidth:!0,error:void 0===f}))})]}))]})),(0,i.jsx)(j.Z,{height:30}),(0,i.jsxs)(s.Z,Object.assign({item:!0,style:{display:"flex",flexDirection:"column",alignItems:"center"}},{children:[(0,i.jsx)(v.Z,Object.assign({variant:"outlined",size:"small",color:"secondary",onClick:()=>{return e=void 0,t=void 0,i=function*(){const e={date:T.date,newDownload:f,excavator:N,truck:k};e.date&&e.newDownload&&e.excavator?(yield O((0,P.QM)(e)),yield O((0,tt.l4)(k.deviceId)),E(""),S(void 0),b(!1),yield O((0,P.Jg)())):b(!0)},new((n=void 0)||(n=Promise))((function(s,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}));var e,t,n,i},disabled:!x},{children:"Agregar Ciclo"})),(0,i.jsx)(j.Z,{height:10})]}))]})]}))]})},_t=n(69711),Ft=(0,ke.Z)((e=>({container:{width:"100%",scrollBehavior:"auto"},item:{justifySelf:"center",justifyContent:"center",alignContent:"center",textAlign:"center"},title:{fontSize:14},header:{display:"flex",padding:4},body:{textAlign:"center",maxHeight:"650px"},cardNewCycle:{height:"100%",color:"white",borderRadius:0},paperNewCycle:{color:"white"}}))),Mt=()=>{const e=Ft(),t=(0,y.T)(),{cyclesList:n,truckSelect:a,statusCycle:r,statusGet:o}=(0,y.C)(P.XE);return(0,A.useEffect)((()=>{t((0,P.EC)(a.deviceId))}),[a]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.Z,Object.assign({container:!0,className:e.container,spacing:0,direction:"column",style:{}},{children:[(0,i.jsx)("div",Object.assign({style:{borderRadius:"4px",backgroundColor:E.Jx,textAlign:"center",padding:2}},{children:(0,i.jsx)(je.Z,Object.assign({style:{textAlign:"center",fontSize:16,color:"white"},variant:"button"},{children:(0,i.jsxs)("div",Object.assign({style:{display:"flex",alignItems:"center",textAlign:"center",justifyContent:"center"}},{children:[(0,i.jsx)(Rt.Z,{style:{borderRadius:0,padding:4,marginRight:4},src:_t}),a?`CICLOS DEL CAMIÓN  ${null==a?void 0:a.deviceAlias}`:"CAMIÓN NO DISPONIBLE"]}))}))})),(0,i.jsx)(j.Z,{height:12}),a&&(0,i.jsxs)(s.Z,Object.assign({item:!0,container:!0,className:e.item,md:12,spacing:1},{children:[(0,i.jsx)(s.Z,Object.assign({item:!0,md:6},{children:(0,i.jsx)(m.Z,Object.assign({elevation:2,className:e.body},{children:n&&n.length>0?(0,i.jsx)(Dt.a,{cycleList:n,isCycleTruck:!0}):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(Dt.a,{cycleList:[],isCycleTruck:!0})})}))})),(0,i.jsx)(s.Z,Object.assign({item:!0,md:6},{children:(0,i.jsx)(m.Z,Object.assign({elevation:2,className:e.paperNewCycle},{children:(0,i.jsx)(Wt,{idTruck:a.deviceId})}))}))]}))]}))})};var $t=n(86842);const Ut="92vh",Ht=(0,ke.Z)((e=>({rootOperation:{display:"block",position:"relative",flexGrow:1,height:"96vh",margin:e.spacing(1,1,1,1)},rootAbsolute:{position:"absolute",top:0,bottom:0,right:0,left:0},operation:{overflow:"overlay",flex:11},containerOperation:{width:"100%",display:"flex",maxHeight:Ut,minHeight:Ut,alignContent:"center",justifyContent:"flex-start"},containerTrucks:{width:"100%",maxHeight:Ut,minHeight:Ut,margin:2,padding:2},rootTruck:{overflow:"auto",maxHeight:Ut},rootIconResize:{height:Ut,display:"flex",position:"relative",width:16,backgroundColor:E.Jx,paddingRight:7,paddingLeft:7,backgroundClip:"content-box",cursor:"col-resize"},rootLabel:{width:8,height:8,background:"green",borderRadius:4,padding:0,margin:0},withoutMP:{padding:0,margin:0}})));var Gt,Kt,Jt;const Vt=()=>{const{operationsAll:e,status:t,truckAvailable:n}=(()=>{const{operationList:e,status:t,truckAvailable:n}=(0,y.C)(N.YL),{truckInfoList:i}=(0,y.C)(H.ej),{initial:s}=(0,y.C)(Ze.kW),a=(0,y.T)(),[r,o]=(0,A.useState)([]);return(0,A.useEffect)((()=>{if(t===ee.JD.DONE&&s!==Q.Vj.LOADING){const t=e.map((e=>{var t,n,i;return Object.assign(Object.assign({},e),{excavator:e.excavatorList.length>0?e.excavatorList[0]:{},typeUpload:We.WW[null===(t=e.upload)||void 0===t?void 0:t.type],labelUpload:`${We.WW[null===(n=e.upload)||void 0===n?void 0:n.type]} ${e.upload?dt(e.upload):""}`,labelDownload:e.download?`${ut(e.download)}`:"",typeDownload:We.WW[null===(i=e.download)||void 0===i?void 0:i.type],labelstate:We.J8[e.state],cycles:e.cycleList.length,truckList:e.truckList.map((e=>{var t;return Object.assign(Object.assign({},e),{deviceAliasNumber:Number(null===(t=e.deviceAlias.match(/\d/g))||void 0===t?void 0:t.join(""))})})).sort(((e,t)=>e.deviceAliasNumber-t.deviceAliasNumber))})}));o(t)}else o([])}),[e]),(0,A.useEffect)((()=>{e.length>0&&i.length>0&&a((0,N.Vb)({truckList:i}))}),[i,t]),{operationsAll:r,status:t,truckAvailable:n}})(),{truckInfoList:o}=(0,y.C)(H.ej),l=(0,A.useRef)(),c=(0,A.useRef)(),d=(0,A.useRef)(),[u,v]=(0,A.useState)(!1),[g,m]=(0,A.useState)(!1),{state:h}=(0,y.C)(F.e5),[j,p]=(0,A.useState)(!1),[x,b]=(0,A.useState)(""),[O,f]=(0,A.useState)([]),{excavatorSelect:S,truckSelect:L}=(0,y.C)(P.XE),{timelineError:C}=(0,y.C)(M.yV);(({search:e,setSearch:t,items:n,setFilterList:i})=>{const[]=(0,A.useState)([]);(0,A.useEffect)((()=>{if(!e||0===n.length)return void i((e=>0===e.length?e:[]));const t=n.filter((t=>{var n;return null===(n=t.deviceAlias)||void 0===n?void 0:n.toUpperCase().includes(e.toUpperCase())}));i((e=>JSON.stringify(e.map((e=>e.deviceId)))===JSON.stringify(t.map((e=>e.deviceId)))?e:(console.log("LiminadodChange",t),t)))}),[e,n])})({search:x,setSearch:b,items:o,setFilterList:f});const T=(0,y.T)(),Z=Ht();(0,A.useEffect)((()=>{}),[]),(0,A.useEffect)((()=>{Gt=document.querySelector("#wrapper"),Kt=null==Gt?void 0:Gt.querySelector("#listTruck"),Jt=null==Gt?void 0:Gt.querySelector("#listOperation");const e=localStorage.getItem("localStorajeTruck"),t=localStorage.getItem("localStorajeOperation");e&&(Kt.style.flex=Number(e)),t&&(Jt.style.flex=Number(t))}),[]),(0,A.useEffect)((()=>{T((0,H.RK)()),T((0,N.hS)())}),[j]);const k=(0,A.useMemo)((()=>(0,i.jsx)("div",Object.assign({className:Z.containerOperation},{children:t!==ee.JD.DONE?(0,i.jsx)(s.Z,Object.assign({container:!0,alignItems:"stretch",justifyContent:"center"},{children:(0,i.jsx)(mt,{height:"100%",width:"100%"})})):e.length>0?e.map(((e,t)=>(0,i.jsx)(ot,{operation:e,setRefresh:p,filterList:O},t))):(0,i.jsx)(vt,{})}))),[e,O,t]);(0,A.useEffect)((()=>{h===Je.m4.DONE&&p((e=>!e))}),[h]);const I=()=>m((e=>!e)),w=(0,A.useCallback)((e=>{var t;if(!(u&&Gt&&Kt&&Jt))return;const n=12*(e.clientX-Gt.offsetLeft-46)/(null===(t=l.current)||void 0===t?void 0:t.clientWidth),i=Number(c.current.style.flex)>0?c.current.style.flex:0,s=Math.abs(i-n)>.05?Math.max(n,1):i;Kt.style.flex=s,Jt.style.flex=12-s,localStorage.setItem("localStorajeTruck",`${s}`),localStorage.setItem("localStorajeOperation",""+(12-s))}),[u]),D=(0,A.useMemo)((()=>(0,i.jsx)(s.Z,Object.assign({item:!0,id:"listTruck",style:{margin:0,padding:0,flex:1},className:Z.rootTruck,innerRef:c},{children:(0,i.jsx)(Lt,{truckAvailable:n,filterList:O})}))),[n,O]),R=(0,A.useMemo)((()=>(0,i.jsxs)(s.Z,Object.assign({container:!0,justifyContent:"flex-end",alignItems:"center"},{children:[(0,i.jsx)(a.ZP,Object.assign({title:"Nueva Operación"},{children:(0,i.jsx)($e.rU,Object.assign({to:"/operation/create/0/0"},{children:(0,i.jsx)(r.Z,Object.assign({color:"secondary",size:"small"},{children:(0,i.jsx)(ue.Z,{fontSize:"small"})}))}))})),(0,i.jsx)(a.ZP,Object.assign({title:"Reasignación global de Camiones"},{children:(0,i.jsx)(r.Z,Object.assign({onClick:I,color:"secondary",size:"small"},{children:(0,i.jsx)(ve.Z,{fontSize:"small"})}))})),(0,i.jsx)(bt,{search:x,setSearch:b})]}))),[x]),z=(0,A.useCallback)((e=>{e.target===d.current&&v(!0)}),[d]),W=(0,A.useCallback)((()=>v(!1)),[]),_=(0,A.useMemo)((()=>(0,i.jsx)(wt,{setRefresh:p})),[]),$=()=>{T((0,P.kY)()),T((0,tt.pJ)()),p((e=>!e))};return(0,i.jsxs)(lt.W,Object.assign({backend:ct.PD},{children:[(0,i.jsxs)("div",Object.assign({className:Z.rootOperation},{children:[(0,i.jsxs)("div",Object.assign({className:Z.rootAbsolute},{children:[(0,i.jsx)(s.Z,Object.assign({item:!0,innerRef:c},{children:R})),(0,i.jsxs)(s.Z,Object.assign({container:!0,innerRef:l,id:"wrapper",onMouseUp:W,onMouseMove:w,onMouseDown:z},{children:[D,(0,i.jsx)(Y.P4,{className:Z.rootIconResize,id:"handler",innerRef:d}),(0,i.jsx)(s.Z,Object.assign({item:!0,className:Z.operation,id:"listOperation"},{children:(0,i.jsx)(s.Z,Object.assign({container:!0,direction:"column"},{children:(0,i.jsxs)(s.Z,Object.assign({item:!0},{children:[(0,i.jsx)("div",Object.assign({className:Z.containerOperation},{children:t!==ee.JD.DONE?(0,i.jsx)(s.Z,Object.assign({container:!0,alignItems:"stretch",justifyContent:"center"},{children:(0,i.jsx)(mt,{height:"100%",width:"100%"})})):e.length>0?k:(0,i.jsx)(vt,{})})),(0,i.jsxs)(Y.T5,Object.assign({container:!0,direction:"row",style:{gap:8}},{children:[(0,i.jsx)(Y.P4,{children:(0,i.jsxs)(Y.T5,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,i.jsx)("p",{className:Z.rootLabel}),(0,i.jsx)("p",Object.assign({style:{padding:0,margin:0}},{children:"Asignados"}))]}))}),(0,i.jsx)(Y.P4,{children:(0,i.jsxs)(Y.T5,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,i.jsx)("p",{style:{background:E.J$},className:Z.rootLabel}),(0,i.jsx)("p",Object.assign({style:{padding:0,margin:0}},{children:"No asignados"}))]}))}),(0,i.jsx)(Y.P4,{children:(0,i.jsxs)(Y.T5,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,i.jsx)("p",{style:{background:E.sb},className:Z.rootLabel}),(0,i.jsx)("p",Object.assign({style:{padding:0,margin:0}},{children:"Excavadora"}))]}))}),(0,i.jsx)(Y.P4,{children:(0,i.jsxs)(Y.T5,Object.assign({container:!0,direction:"row",alignItems:"center"},{children:[(0,i.jsx)("p",{style:{borderColor:E.J$,background:"#00000000",borderStyle:"solid",borderWidth:2},className:Z.rootLabel}),(0,i.jsxs)("p",Object.assign({style:{padding:0,margin:0}},{children:["Área de carguío (",le.Xb,"mts)"]}))]}))})]}))]}))}))}))]}))]})),(0,i.jsx)(Fe,{open:g,setOpen:m,setRefresh:p,operations:e}),(0,i.jsx)(Se,{open:!!S.deviceId,setOpen:$,children:(0,i.jsx)(Dt.S,{}),handleClose:$,handleClickConfirm:$}),(0,i.jsx)(Se,{open:!!L.deviceId,setOpen:$,children:(0,i.jsx)(Mt,{}),handleClose:$,handleClickConfirm:$}),_]})),!!C.message&&(0,i.jsx)($t.y,{error:C.message,success:C.success,callBack:()=>T((0,M.OL)())})]}))};function Bt(){return(0,i.jsx)(Vt,{})}}}]);