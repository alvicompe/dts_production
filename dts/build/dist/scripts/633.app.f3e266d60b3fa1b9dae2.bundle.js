"use strict";(self.webpackChunkdts_hytera=self.webpackChunkdts_hytera||[]).push([[633],{61242:(e,t,i)=>{i.d(t,{a:()=>u});var n=i(85893),s=i(41120),o=i(52663),a=i(66083),l=i(29525),r=i(66856),d=i(282);const c=(0,s.Z)({disabledPadding:{padding:0,textAlign:"center"}}),u=({open:e,handleClose:t,handleConfirm:i,title:s,children:u,maxWidth:v="lg",disabled:m=!1})=>{const h=c();return(0,n.jsxs)(o.Z,Object.assign({open:e,onClose:t,maxWidth:v},{children:[(0,n.jsx)(a.Z,Object.assign({className:h.disabledPadding},{children:s}),void 0),(0,n.jsx)(l.Z,{children:u},void 0),(0,n.jsxs)(r.Z,{children:[(0,n.jsx)(d.Z,Object.assign({size:"small",color:"primary",onClick:t},{children:"Cancel"}),void 0),i&&(0,n.jsx)(d.Z,Object.assign({disabled:m,variant:"outlined",size:"small",color:"secondary",onClick:i,autoFocus:!0},{children:"Confirm"}),void 0)]},void 0)]}),void 0)}},10646:(e,t,i)=>{i.d(t,{l:()=>n});const n=e=>[`${e.getFullYear()}-${`0${e.getMonth()+1}`.substr(-2)}-${`0${e.getDate()}`.substr(-2)}`]},88093:(e,t,i)=>{i.d(t,{R:()=>n});const n=()=>{var e=new Date;return e.getHours(),{dateShift:e.getHours()>=0&&e.getHours()<7?new Date(e.getTime()-864e5):e}}},50466:(e,t,i)=>{i.r(t),i.d(t,{HourmeterView:()=>tt,default:()=>it});var n=i(85893),s=i(41749),o=i(10046),a=i(67294),l=i(88093),r=i(73855),d=i(10646),c=i(12207),u=i(74046),v=i(61242),m=i(60702),h=i(44562);const g=({error:e,index:t})=>{const[i,s]=a.useState(!0),[o,l]=a.useState({vertical:"bottom",horizontal:"right"}),{vertical:r,horizontal:d}=o,c=(e,t)=>{"clickaway"!==t&&s(!1)};return(0,n.jsx)(m.Z,Object.assign({anchorOrigin:{vertical:r,horizontal:d},open:i,onClose:c,style:{marginBottom:60*t+"px"}},{children:(0,n.jsx)(h.Z,Object.assign({style:{marginTop:".5rem"},onClose:c,severity:"error"},{children:(0,n.jsx)("strong",{children:e.message},void 0)}),void 0)}),void 0)},j=({error:e})=>{const[t,i]=a.useState({open:!0,vertical:"bottom",horizontal:"right"}),{vertical:s,horizontal:o,open:l}=t,r=()=>{i(Object.assign(Object.assign({},t),{open:!1}))},[d,c]=(0,a.useState)([]);return null==e||e.forEach((e=>{console.log()})),(0,n.jsx)(m.Z,Object.assign({open:!0,anchorOrigin:{vertical:s,horizontal:o}},{children:(0,n.jsx)("div",{children:null==e?void 0:e.map(((e,t)=>(0,n.jsx)(g,{error:e,handleClose:r,index:t},e.deviceId)))},void 0)}),void 0)};var f=i(92284),x=i(73914),b=i(57850),p=i(59693),O=i(93584);function E(e){return e.type||e.mode}const S=(0,b.Z)(),T=(0,x.Z)((e=>{const t=t=>"dark"===E(e.palette)?(0,p._j)(t,.1):(0,p.$n)(t,.1);return{root:{"& .Mui-error":{backgroundColor:`rgb(126,10,15, ${"dark"===E(e.palette)?0:.1})`,color:"#750f0f"},"& .Mui-error.negative":{backgroundColor:"#d47483",color:"#1a3e72",fontWeight:"600"},"& .Mui-error.positive":{backgroundColor:"rgba(157, 255, 118, 0.49)",color:"#1a3e72",fontWeight:"600"},"& .super-app-theme--false":{backgroundColor:(i="rgb(255, 48, 83)","dark"===E(e.palette)?(0,p._j)(i,.1):(0,p.$n)(i,.5)),"&:hover":{backgroundColor:t(e.palette.error.main)}},"& .MuiDataGrid-row":{"&:hover":{backgroundColor:t(`${O.sb}`)},"& .Mui-selected":{"&:hover":{backgroundColor:t(`${O.sb}`)}}}}};var i}),{defaultTheme:S}),y=(0,b.Z)(),N=(0,x.Z)((e=>({root:{flexDirection:"column","& .ant-empty-img-1":{fill:"light"===e.palette.type?"#aeb8c2":"#262626"},"& .ant-empty-img-2":{fill:"light"===e.palette.type?"#f5f5f7":"#595959"},"& .ant-empty-img-3":{fill:"light"===e.palette.type?"#dce0e6":"#434343"},"& .ant-empty-img-4":{fill:"light"===e.palette.type?"#fff":"#1c1c1c"},"& .ant-empty-img-5":{fillOpacity:"light"===e.palette.type?"0.8":"0.08",fill:"light"===e.palette.type?"#f5f5f5":"#fff"}},label:{marginTop:e.spacing(1)}})),{defaultTheme:y});function C(){const e=N();return(0,n.jsxs)(f.nik,Object.assign({className:e.root},{children:[(0,n.jsx)("svg",Object.assign({width:"120",height:"100",viewBox:"0 0 184 152","aria-hidden":!0,focusable:"false"},{children:(0,n.jsxs)("g",Object.assign({fill:"none",fillRule:"evenodd"},{children:[(0,n.jsxs)("g",Object.assign({transform:"translate(24 31.67)"},{children:[(0,n.jsx)("ellipse",{className:"ant-empty-img-5",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"},void 0),(0,n.jsx)("path",{className:"ant-empty-img-1",d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z"},void 0),(0,n.jsx)("path",{className:"ant-empty-img-2",d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z"},void 0),(0,n.jsx)("path",{className:"ant-empty-img-3",d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z"},void 0)]}),void 0),(0,n.jsx)("path",{className:"ant-empty-img-3",d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z"},void 0),(0,n.jsxs)("g",Object.assign({className:"ant-empty-img-4",transform:"translate(149.65 15.383)"},{children:[(0,n.jsx)("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"},void 0),(0,n.jsx)("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"},void 0)]}),void 0)]}),void 0)}),void 0),(0,n.jsx)("div",Object.assign({className:e.label},{children:"Sin datos"}),void 0)]}),void 0)}var Z=i(868),k=i(17812),w=i(86010),L=i(52303),A=i(80024),I=i(99050),M=i(85639),H=i(79192),F=i(67774),D=i(18973);const $=()=>{const{eventList:e}=(0,r.C)(D.yJ),t=(0,r.T)(),[i,n]=a.useState([]);return(0,a.useEffect)((()=>{n([{id:"NONE",name:"NONE",event:""},...e])}),[e]),(0,a.useEffect)((()=>{t((0,F.TU)())}),[]),[i]},R=(e,t)=>{const i=(0,r.T)();return[(n="NONE")=>{t(null),console.log("option",n),i(e("NONE"===n?{columnField:"statusEvent",operatorValue:"startsWith",value:""}:{columnField:"statusEvent",operatorValue:"startsWith",value:n}))}]};function _(){const[e]=$();console.log("eventList",e);const[t,i]=a.useState(null),s=Boolean(t),[o]=R(u.V,i);return(0,n.jsxs)("div",{children:[(0,n.jsx)(k.Z,Object.assign({style:{padding:"0px",margin:"0px"},"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:e=>{i(e.currentTarget)}},{children:(0,n.jsx)(H.Z,{},void 0)}),void 0),(0,n.jsx)(I.Z,Object.assign({id:"long-menu",anchorEl:t,keepMounted:!0,open:s,onClose:()=>o("NONE"),PaperProps:{style:{maxHeight:216,width:"20ch"}}},{children:e.map((e=>(0,n.jsx)(M.Z,Object.assign({onClick:()=>o(e.event.toString())},{children:e.name}),e.name)))}),void 0)]},void 0)}const P=(e,t,i,s)=>[Object.assign(Object.assign({},f.mf9),{width:70,renderHeader:e=>(0,n.jsx)(Z.ZP,Object.assign({title:"Select all"},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex",padding:"0px",margin:"0px"}},{children:[(0,n.jsx)(f.KOw,Object.assign({},e),void 0),(0,n.jsx)(_,{},void 0)]}),void 0)}),void 0)}),{field:"excavator",headerName:"Excavator",hideSortIcons:!0},{field:"shift",headerName:"shift",hideSortIcons:!0},{field:"statusEvent",headerName:"statusEvent",type:"string",hide:!0},{field:"status",headerName:"Status",width:170,hideSortIcons:!0},{field:"hmtStart",headerName:"Hourmeter",editable:!1,type:"number",hideSortIcons:!0},{field:"hourmeterCurrent",headerName:"hourmeter Current",editable:!s,hideSortIcons:!0,type:"number"},{field:"hourmeterFinal",headerName:"hourmeter Final",editable:!0,type:"number",hideSortIcons:!0,cellClassName:e=>(0,w.Z)("Mui-error",{positive:e.value>0,negative:e.value<=0||0===e.value})},{field:"adjustment",headerName:"adjustment",type:"number",hideSortIcons:!0},{field:"Opciones",headerName:"Opc",hideSortIcons:!0,minWidth:110,renderCell:({row:s})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z.ZP,Object.assign({onClick:()=>{console.log(s),t(s),e(!0)},title:"Add timeline"},{children:(0,n.jsx)(k.Z,Object.assign({size:"small"},{children:(0,n.jsx)(A.Z,{color:"primary",fontSize:"small"},void 0)}),void 0)}),void 0),(0,n.jsx)(Z.ZP,Object.assign({onClick:()=>{t(s),i(!0)},title:"View Timeline"},{children:(0,n.jsx)(k.Z,Object.assign({size:"small"},{children:(0,n.jsx)(L.Z,{htmlColor:"Green",fontSize:"small"},void 0)}),void 0)}),void 0)]},void 0)}];var V=i(32759);const z=(e,t)=>{const[i,n]=(0,a.useState)([{field:e,sort:t}]);return{sortModel:i,handleModelGrid:e=>{0!=e.length?e[0].field!=i[0].field||e[0].sort!=i[0].sort?n(e):console.log("else"):"desc"==i[0].sort?n([Object.assign(Object.assign({},i[0]),{sort:"asc"})]):n([Object.assign(Object.assign({},i[0]),{sort:"desc"})])}}};var W,U;!function(e){e[e.UNKNOWN_STATE_EVENT=0]="UNKNOWN_STATE_EVENT",e[e.MA=1]="MA",e[e.NOP=2]="NOP",e[e.DOP=3]="DOP",e[e.OP=4]="OP"}(W||(W={})),function(e){e[e.UNKNOWN_SHIFT=0]="UNKNOWN_SHIFT",e[e.NIGHT=1]="NIGHT",e[e.DAY=2]="DAY",e[e.BOTH=3]="BOTH"}(U||(U={}));const K=(e,t)=>{const[i,n]=(0,a.useState)([]);return(0,a.useEffect)((()=>{t===V.jR.DONE?n(null==e?void 0:e.map((e=>{var t,i,n,s,o,a,l,r,d,c,u,v,m;return Object.assign(Object.assign({},e),{id:e.deviceId,excavator:e.deviceAlias,status:` ${(null===(t=e.eventState.event)||void 0===t?void 0:t.name)?null===(i=e.eventState.event)||void 0===i?void 0:i.name.substring(0,3):""}  ${(null===(n=e.eventState)||void 0===n?void 0:n.name)?` - ${null===(s=e.eventState)||void 0===s?void 0:s.name.toString().toLowerCase()}`:""}`,statusEvent:null===(o=e.eventState.event)||void 0===o?void 0:o.event,hmtStart:null===(a=e.hystoryShiftList[0])||void 0===a?void 0:a.initialHourmeter.toFixed(2),hourmeterCurrent:null===(l=e.hystoryShiftList.at(-1))||void 0===l?void 0:l.initialHourmeter.toFixed(2),shift:U[null===(r=e.currentTimeline)||void 0===r?void 0:r.shift],date:new Date(1e3*(null===(c=null===(d=e.currentTimeline)||void 0===d?void 0:d.shiftDate)||void 0===c?void 0:c.seconds)).toLocaleDateString(),adjustment:(null===(u=e.currentTimeline)||void 0===u?void 0:u.adjustment)?e.currentTimeline.adjustment:0,statusAdjustment:!!(null===(v=e.currentTimeline)||void 0===v?void 0:v.status)&&(null===(m=e.currentTimeline)||void 0===m?void 0:m.status)})}))):n([])}),[e,t]),[i]};var B=i(78479);const G=e=>e>=0,Y=({setOpen:e,setTimelineCurrent:t,setOpenTimeline:i})=>{const s=T(),o=(0,r.T)(),{statusTimeslineExcavator:l,filterDataGrid:d,isEditableRows:c,initialEditRowsModel:v,timeslineExcavator:m}=(0,r.C)(u.tH),[h]=K(m.currentTimelineList,l),{sortModel:g,handleModelGrid:j}=z("excavator","asc"),[x,b]=(0,B._)("hourmeterExcavator",null),[p,O]=(0,a.useState)(Object.assign({},x));return(0,a.useEffect)((()=>{setTimeout((()=>{O(Object.assign({},x))}),3e3)}),[]),console.log("editRowsModelex",p),(0,a.useEffect)((()=>{l===V.jR.DONE&&(o((0,u.hV)()),o((0,u.OE)()))}),[h]),(0,n.jsx)("div",Object.assign({style:{height:"1113px",overflowY:"scroll",display:"flex",flexDirection:"column"}},{children:(0,n.jsx)(f._$r,{className:s.root,rowHeight:30,rows:h,columns:P(e,t,i,c),density:"compact",components:{NoRowsOverlay:C},checkboxSelection:!0,disableSelectionOnClick:!0,onSelectionModelChange:e=>(e=>{const t=new Set(e),i=h.filter((e=>t.has(e.id.toString())));o((0,u.Xm)(i))})(e),disableColumnMenu:!0,sortModel:g,editRowsModel:p,onEditRowsModelChange:e=>(e=>{var t="";for(var[i,n]of Object.entries(e))Object.keys(n).length<=1&&Object.keys(n).forEach((e=>{t=e}));console.log("key",t);var s=Object.assign({},e);switch(t){case"hourmeterCurrent":console.log("updatedModel",s),O(Object.assign(Object.assign({},p),s)),o((0,u.Jo)(s));break;case"hmtStart":Object.keys(s).length>=2?(O({}),console.log("case modelxd",e),o((0,u.Yb)({}))):(Object.keys(s).forEach((e=>{if(s[e].hourmeterCurrent){var t=G(s[e].hourmeterCurrent.value);s[e].hourmeterCurrent=Object.assign(Object.assign({},s[e].hourmeterCurrent),{error:!t})}})),O(s),o((0,u.Yb)(s)));break;case"hourmeterFinal":Object.keys(s).forEach((e=>{var t=G(s[e].hourmeterFinal.value);s[e].hourmeterFinal=Object.assign(Object.assign({},s[e].hourmeterFinal),{error:!t})})),O(Object.assign(Object.assign(Object.assign({},x),p),s));var a=!1;for(var[l,n]of Object.entries(e))void 0===s[l].hourmeterFinal.value&&(a=!0);a||s&&b(p),o((0,u.WZ)(p));break;default:console.log("case default")}})(e),filterModel:{items:[d]},getRowClassName:e=>`super-app-theme--${e.row.statusAdjustment}`},void 0)}),void 0)};var J=i(8286),X=i(66977);const q=e=>{const[t,i]=(0,a.useState)(e);return[t,e=>{i(Object.assign(Object.assign({},t),{[e.target.name]:e.target.value}))},()=>{i(e)},i]};var Q=i(49032),ee=i(41120),te=i(35117),ie=i(64436),ne=i(96019),se=i(67162),oe=i(30553),ae=i(40074),le=i(81395),re=i(89452),de=i(95090);const ce=({setEventState:e,event:t})=>{const[i,s,o,l]=q({status:Q.EnumEvent.UNKNOWN_STATE_EVENT}),{eventStateList:d,statusEventStateList:c}=(0,r.C)(D.eG),u=(0,r.T)();return(0,a.useEffect)((()=>{if(t.toString()===Q.EnumEvent.OPERATIONAL.toString()){if(c===de.JD.DONE){const t=d[0];e(Object.assign(Object.assign({},t),{id:"",name:"",eventState:0,event:t.event}))}}else{const t=d.find((e=>e.eventState.toString()===i.status.toString()));e(t)}}),[i.status]),(0,a.useEffect)((()=>{u((0,re.Gy)(t))}),[t]),(0,a.useEffect)((()=>{e({id:"",name:"",eventState:0,event:{id:"",name:"",event:0}})}),[]),(0,a.useEffect)((()=>{if(c===de.JD.DONE&&t.toString()===Q.EnumEvent.OPERATIONAL.toString()){const t=d[0];e(Object.assign(Object.assign({},t),{id:"",name:"",eventState:0,event:t.event}))}}),[c]),(0,a.useEffect)((()=>{o()}),[t]),t.toString()===Q.EnumEvent.OPERATIONAL.toString()?null:(0,n.jsxs)(ie.Z,Object.assign({component:"fieldset"},{children:[(0,n.jsx)(ne.Z,Object.assign({component:"legend"},{children:W[t]}),void 0),(0,n.jsx)(se.Z,Object.assign({defaultValue:"female","aria-label":"hourmeter",name:"customized-radios"},{children:d.map((e=>(0,n.jsx)(oe.Z,{value:e.eventState,control:(0,n.jsx)(ae.Z,{checked:i.status===e.eventState.toString(),icon:(0,n.jsx)(le.Z,{},void 0),checkedIcon:(0,n.jsx)(le.Z,{},void 0),name:"status",onClick:()=>{},onChange:s,disabled:e.event.event.toString()===Q.EnumEvent.OPERATIONAL.toString()},void 0),label:e.name},e.id)))}),void 0)]}),void 0)},ue=(0,ee.Z)((e=>(0,te.Z)({container:{display:"flex",flexDirection:"column",flexWrap:"wrap",fontFamily:"inherit"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),paddingBottom:"10px",width:100}}))),ve=({value:e,label:t})=>{const i=ue(),o=(0,r.T)(),l=new Date,d=`0${l.getHours()}`,u=`0${l.getMinutes()}`,[v,m]=(0,a.useState)({hoursStart:`${d.slice(-2)}:${u.slice(-2)}`,status:e,substatus:{id:"",name:"",eventState:Q.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:Q.EnumEvent.UNKNOWN_STATE_EVENT}}}),[h,g]=(0,a.useState)({id:"",name:"",eventState:Q.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:Q.EnumEvent.UNKNOWN_STATE_EVENT}});console.log(v),(0,a.useEffect)((()=>{o((0,c.gS)(Object.assign({},v)))}),[v]),(0,a.useEffect)((()=>()=>{o((0,c.XH)())}),[]),(0,a.useEffect)((()=>{m(Object.assign(Object.assign({},v),{substatus:h}))}),[h]);const{hoursStart:j}=v;return(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:1},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsx)("form",Object.assign({className:i.container,noValidate:!0},{children:(0,n.jsx)(J.Z,{id:"date",label:"HOUR START",type:"time",name:"hoursStart",value:j,onChange:e=>{m(Object.assign(Object.assign({},v),{[e.target.name]:e.target.value}))},className:i.textField,InputLabelProps:{shrink:!0,required:!0}},void 0)}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsx)(ce,{setEventState:g,event:v.status},void 0)}),void 0)]}),void 0)};var me=i(282);const he=({rowsTimelines:e,setOpenEvent:t,setevent:i})=>{const[s,o]=(0,a.useState)(!0),[l,d]=(0,a.useState)(!0),[c,u]=(0,a.useState)(!0),v=(0,r.T)(),{eventList:m}=(0,r.C)(D.yJ),[h,g]=a.useState(null);(0,a.useEffect)((()=>{f()&&(o(!1),d(!0),u(!1)),b()&&(o(!1),d(!1),u(!1)),j()&&(o(!0),d(!1),u(!1)),x()&&(o(!1),d(!1),u(!0)),0==b()&&0==j()&&0==x()&&0==f()&&(o(!0),d(!0),u(!0))}),[e]);const j=()=>0!==e.length&&e.every((e=>{var t,i;return(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===Q.EnumEvent.NO_OPERATIONAL})),f=()=>0!==e.length&&e.every((e=>{var t,i;return(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===Q.EnumEvent.OPERATIONAL})),x=()=>0!==e.length&&e.every((e=>{var t,i;return(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===Q.EnumEvent.OPERATIONAL_DELAY})),b=()=>0!==e.length&&e.every((e=>{var t,i;return void 0===(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)}));return(0,a.useEffect)((()=>{v((0,F.TU)())}),[]),(0,n.jsxs)("div",{children:[(0,n.jsx)(me.Z,Object.assign({"aria-controls":"simple-menu","aria-haspopup":"true",onClick:e=>{g(e.currentTarget)},color:"primary",size:"small",variant:"outlined"},{children:"Go to"}),void 0),(0,n.jsx)(I.Z,Object.assign({id:"simple-menu",anchorEl:h,keepMounted:!0,open:Boolean(h),onClose:()=>{g(null)}},{children:m.map((e=>{var o=!1;return e.event===Q.EnumEvent.OPERATIONAL_DELAY&&(o=c),e.event===Q.EnumEvent.OPERATIONAL&&(o=l),e.event===Q.EnumEvent.NO_OPERATIONAL&&(o=s),e.event===Q.EnumEvent.MAINTENANCE&&(o=!0),(0,n.jsx)(M.Z,Object.assign({disabled:o,onClick:()=>(e=>{t(!0),i(e)})(e.event),color:"primary"},{children:e.name}),e.id)}))}),void 0)]},void 0)};var ge=i(97480),je=i(71267),fe=i(69798);const xe=({shift:e,date:t})=>(0,n.jsxs)("div",{children:[(0,n.jsx)(je.Z,{icon:(0,n.jsx)(ge.Z,{},void 0),label:e,clickable:!0,color:"secondary",deleteIcon:(0,n.jsx)(ge.Z,{},void 0),variant:"outlined"},void 0),(0,n.jsx)(je.Z,{icon:(0,n.jsx)(fe.Z,{},void 0),label:t,clickable:!0,color:"secondary",deleteIcon:(0,n.jsx)(fe.Z,{},void 0),variant:"outlined"},void 0)]},void 0);const be=()=>{var e,t;const{rowsTimeline:i,hourmeterStart:m,timeslineExcavator:h,statusTimeslineExcavator:g}=(0,r.C)(u.tH),j=(0,r.T)(),{dateShift:f}=(0,l.R)(),{formValuesBtn:x}=(0,r.C)(c.k3),[b]=(0,d.l)(f),[p,O]=(0,a.useState)(!1),[E,S]=(0,a.useState)(Q.EnumEvent.UNKNOWN_STATE_EVENT),[T]=K(h.currentTimelineList,g),[y,N]=(0,a.useState)(!1);console.log("rowsTimelineex",i);const[C,Z]=q({columnField:"excavator",operatorValue:"contains",value:""}),{value:k}=C;return(0,a.useEffect)((()=>{j((0,u.V)(C))}),[k]),(0,a.useEffect)((()=>{var e,t;(null===(t=null===(e=x.substatus)||void 0===e?void 0:e.event)||void 0===t?void 0:t.id)?N(!1):N(!0)}),[x]),(0,n.jsxs)(s.Z,Object.assign({container:!0,justifyContent:"flex-start",spacing:1,style:{paddingBottom:"20px"},alignItems:"center"},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,style:{width:"20%"}},{children:(0,n.jsxs)(o.Z,Object.assign({sx:{display:"flex",alignItems:"flex-end"}},{children:[(0,n.jsx)(X.Z,{},void 0),(0,n.jsx)(J.Z,{id:"input-with-sx",label:"Search ",variant:"standard",name:"value",onChange:Z,fullWidth:!0},void 0)]}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(he,{rowsTimelines:i,setevent:S,setOpenEvent:O},void 0)}),void 0),(0,n.jsx)(s.Z,{item:!0},void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(xe,{shift:null===(e=T[0])||void 0===e?void 0:e.shift,date:null===(t=T[0])||void 0===t?void 0:t.date},void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:p,handleClose:()=>{O(!1)},handleConfirm:()=>{return e=void 0,t=void 0,n=function*(){yield j((0,u.vd)()),O(!1);const e={shift:0,date:`${b}T00:00`};yield j((0,u.pW)(e))},new((i=void 0)||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}));var e,t,i,n},title:`Excavator to ${W[E]}  `,disabled:y},{children:(0,n.jsx)(ve,{value:E},void 0)}),void 0)]}),void 0)};var pe=i(94491);const Oe=(0,ee.Z)((()=>(0,te.Z)({line:{width:"100%",minWidth:"100px",height:"1px",border:"0",backgroundColor:"rgba(191,128,11,1)",padding:"1px",margin:"5px"},container:{display:"flex",alignItems:"center"},timeline:{display:"flex",flexWrap:"wrap",flexDirection:"column",WebkitUserSelect:"none"},span:{display:"flex",alignSelf:"start",WebkitUserSelect:"none"}}))),Ee=({icon:e})=>{const t=Oe();return(0,n.jsxs)("div",Object.assign({className:t.container},{children:[e||(0,n.jsx)(pe.Z,{htmlColor:"#F2BB13"},void 0),(0,n.jsx)(s.Z,{className:t.line},void 0)]}),void 0)},Se=(0,a.createContext)({}),{Provider:Te}=Se,ye=({children:e,data:t,setData:i})=>{const s=Oe();return(0,n.jsx)(Te,Object.assign({value:{data:t}},{children:(0,n.jsx)("div",Object.assign({className:s.timeline,onClick:()=>{i()}},{children:e}),void 0)}),void 0)};var Ne=i(22318);const Ce=({title:e})=>{const t=Oe();return(0,n.jsx)("div",Object.assign({className:t.span},{children:(0,n.jsx)(Ne.Z,Object.assign({variant:"button",display:"block",gutterBottom:!0},{children:e}),void 0)}),void 0)},Ze=({title:e,subTitle:t})=>{const{data:i}=(0,a.useContext)(Se);return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)(Ne.Z,Object.assign({style:{fontSize:".7rem",fontWeight:700,padding:"0 2rem"},variant:"h6",component:"h6"},{children:e||(null==i?void 0:i.title.toString().toLowerCase())}),void 0),(0,n.jsx)("span",Object.assign({style:{color:"rgba(0, 0, 0, 0.54)",padding:"0 2rem"}},{children:t}),void 0)]},void 0)};var ke=i(28428),we=i(10150);const Le=(0,x.Z)((e=>(0,we.Z)({container:{display:"flex",flexDirection:"column",flexWrap:"wrap",fontFamily:"inherit"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),paddingBottom:"10px",width:100}})));const Ae=({currentTimeline:e,updateTimeline:t,startDeleteTimeline:i,setFormUpdateTimeline:s,handleGetTimeline:o})=>{var l,d,c,u;const v=Le(),m=(0,r.T)(),h=new Date(1e3*(null===(l=t.initialTime)||void 0===l?void 0:l.seconds)),g=`0${h.getHours()}`,j=`0${h.getMinutes()}`,f=`${g.slice(-2)}:${j.slice(-2)}`,[x,b]=(0,a.useState)(Object.assign(Object.assign({},t),{initialHourmeter:null===(d=t.initialHourmeter)||void 0===d?void 0:d.toFixed(2)})),[p,O]=(0,a.useState)(!1),[E,S]=(0,a.useState)(!1);(0,a.useEffect)((()=>{(null==e?void 0:e.hystoryShiftList.at(-1).id)===t.id&&O(!0),(null==e?void 0:e.hystoryShiftList.at(0).id)===t.id&&O(!1)}),[t]),(0,a.useEffect)((()=>{(null==e?void 0:e.hystoryShiftList.at(0).id)===t.id&&S(!0)}),[t]);const T=e=>{b(Object.assign(Object.assign({},x),{[e.target.name]:e.target.value}))},{initialHourmeter:y}=x;return console.log("formUpadateTimeline",x),(0,a.useEffect)((()=>(m(s(x)),()=>{})),[x]),(0,a.useEffect)((()=>()=>{m(s({})),b({})}),[]),(0,n.jsxs)("div",{children:[(0,n.jsxs)("form",Object.assign({className:v.container,noValidate:!0},{children:[(0,n.jsx)(J.Z,{id:"date",label:"HOUR",type:"time",name:"time",defaultValue:f,disabled:E,onChange:T,className:v.textField,InputLabelProps:{shrink:!0,required:!0}},void 0),(0,n.jsx)(J.Z,{id:"date",label:"INITIAL HOURMETER",type:"number",name:"initialHourmeter",disabled:(null===(c=null==t?void 0:t.initialEventState)||void 0===c?void 0:c.event.event.toString())!=Q.EnumEvent.MAINTENANCE.toString(),defaultValue:y,onChange:T,className:v.textField,InputLabelProps:{shrink:!0}},void 0),(0,n.jsx)(J.Z,{id:"date",label:"END HOURMETER ",type:"number",name:"initialHourmeter",disabled:!0,defaultValue:null===(u=t.finalHourmeter)||void 0===u?void 0:u.toFixed(2),className:v.textField,InputLabelProps:{shrink:!0}},void 0)]}),void 0),p&&(0,n.jsx)(me.Z,Object.assign({variant:"contained",onClick:()=>{return e=void 0,t=void 0,s=function*(){yield m(i()),yield o()},new((n=void 0)||(n=Promise))((function(i,o){function a(e){try{r(s.next(e))}catch(e){o(e)}}function l(e){try{r(s.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}r((s=s.apply(e,t||[])).next())}));var e,t,n,s},style:{background:"rgb(154, 0, 54)",color:"white",width:"100%"},startIcon:(0,n.jsx)(ke.Z,{},void 0)},{children:"Delete"}),void 0)]},void 0)};var Ie=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const Me=({setClose:e})=>{var t,i;const{statusTimeslineExcavator:o,currentTimeline:c,updateTimeline:m}=(0,r.C)(u.tH),h=(0,r.T)(),[g,j]=(0,a.useState)(!1),{dateShift:f}=(0,l.R)(),[x]=(0,d.l)(f),b=(0,a.useCallback)((()=>{j(!1),h((0,u.zX)({}))}),[]),p=(0,a.useCallback)((()=>Ie(void 0,void 0,void 0,(function*(){yield h((0,u.NT)()),h((0,u.zX)({})),o===V.jR.DONE&&(j(!1),e(!1));const t={shift:0,date:`${x}T00:00`};yield h((0,u.pW)(t))}))),[]),O=(0,a.useCallback)((()=>Ie(void 0,void 0,void 0,(function*(){h((0,u.zX)({})),o===V.jR.DONE&&(j(!1),e(!1));const t={shift:0,date:`${x}T00:00`};yield h((0,u.pW)(t))}))),[]);return(0,n.jsxs)(s.Z,Object.assign({container:!0,alignItems:"flex-end"},{children:[null==c?void 0:c.hystoryShiftList.map((e=>{var t,i,s,o,a,l,r;let d=new Date(1e3*(null===(t=e.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString();return(0,n.jsxs)(ye,Object.assign({data:e,setData:()=>(e=>{h((0,u.zX)(e)),j(!0)})(e)},{children:[(0,n.jsx)(Ze,{title:(null===(s=null===(i=e.initialEventState)||void 0===i?void 0:i.event)||void 0===s?void 0:s.name)?null===(a=null===(o=e.initialEventState)||void 0===o?void 0:o.event)||void 0===a?void 0:a.name:"",subTitle:(null===(l=e.initialEventState)||void 0===l?void 0:l.name)?null===(r=e.initialEventState)||void 0===r?void 0:r.name.toString().toLowerCase():""},void 0),(0,n.jsx)(Ee,{},void 0),(0,n.jsx)(Ce,{title:d.toLocaleString().split(" ")[1].substring(0,d.split(" ")[1].length-3)},void 0)]}),e.id+Math.random())})),(0,n.jsx)(v.a,Object.assign({open:g,handleClose:b,handleConfirm:p,title:`Update Timeline ${new Date(1e3*(null===(t=m.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString().split(" ")[1].substring(0,new Date(1e3*(null===(i=m.initialTime)||void 0===i?void 0:i.seconds)).toLocaleString().split(" ")[1].length-3)}`},{children:(0,n.jsx)(Ae,{currentTimeline:c,updateTimeline:m,startDeleteTimeline:u.T1,setFormUpdateTimeline:u.mP,handleGetTimeline:O},void 0)}),void 0)]}),void 0)},He=(e,t)=>{const i=Number.parseFloat(e)+Number.parseFloat(t);return Number.parseFloat(i.toFixed(2))},Fe=({setstateform:e,isDisabled:t,setisManto:i,handleIsManto:s})=>{const{eventList:o}=(0,r.C)(D.yJ),l=(0,r.T)(),[d,c]=(0,a.useState)({status:Q.EnumEvent.UNKNOWN_STATE_EVENT,Substatus:{id:"",name:"",eventState:0,event:{id:"",name:"",event:0}}}),u=e=>{d.status!=Q.EnumEvent.MAINTENANCE?c(Object.assign(Object.assign({},d),{[e.target.name]:e.target.value})):c(Object.assign(Object.assign({},d),{[e.target.name]:e.target.value}))},v=()=>{c(Object.assign(Object.assign({},d),{Substatus:{id:"",name:"",eventState:0,event:{id:"",name:"",event:0}}})),i(!1)};return(0,a.useEffect)((()=>{e(d)}),[d]),(0,a.useEffect)((()=>{l((0,F.TU)())}),[]),(0,n.jsxs)(ie.Z,Object.assign({component:"fieldset"},{children:[(0,n.jsx)(ne.Z,Object.assign({component:"legend"},{children:"choice"}),void 0),(0,n.jsx)(se.Z,Object.assign({defaultValue:"female","aria-label":"hourmeter",name:"customized-radios"},{children:o.map((e=>e.event.toString()===Q.EnumEvent.MAINTENANCE.toString()?(0,n.jsx)(oe.Z,{value:e.event,control:(0,n.jsx)(ae.Z,{icon:(0,n.jsx)(le.Z,{},void 0),checkedIcon:(0,n.jsx)(le.Z,{},void 0),name:"status",onClick:()=>s(),onChange:u,checked:d.status.toString()===e.event.toString(),disabled:t.toString()===e.event.toString()},void 0),label:e.name},e.id):(0,n.jsx)(oe.Z,{value:e.event,onClick:v,control:(0,n.jsx)(ae.Z,{icon:(0,n.jsx)(le.Z,{},void 0),checkedIcon:(0,n.jsx)(le.Z,{},void 0),name:"status",checked:d.status.toString()===e.event.toString(),disabled:t.toString()===e.event.toString(),onClick:v,onChange:u},void 0),label:e.name},e.id)))}),void 0)]}),void 0)},De=({currentTimeline:e})=>{var t;const i=Le(),o=(0,r.T)(),[l,u]=(0,a.useState)(0),[v,m]=(0,a.useState)(!1),h=new Date,g=`0${h.getHours()}`,j=`0${h.getMinutes()}`,[f,x]=(0,a.useState)({time:`${g.slice(-2)}:${j.slice(-2)}`,hourmeterEnd:0===(null==e?void 0:e.hystoryShiftList.length)?0:null===(t=null==e?void 0:e.hystoryShiftList)||void 0===t?void 0:t.at(-1).initialHourmeter.toFixed(1),htm:0,status:Q.EnumEvent.UNKNOWN_STATE_EVENT,Substatus:{id:"",name:"",eventState:Q.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:Q.EnumEvent.UNKNOWN_STATE_EVENT}},currentTimeline:e}),[b]=(0,d.l)(new Date),p=null==e?void 0:e.eventState.event.event,{time:O,hourmeterEnd:E}=f,S=function(e,t){var i,n;if(0===(null==t?void 0:t.hystoryShiftList.length))return 0;{const o=null===(i=null==t?void 0:t.hystoryShiftList)||void 0===i?void 0:i.at(-1),a=new Date(e),l=new Date(1e3*(null===(n=null==o?void 0:o.initialTime)||void 0===n?void 0:n.seconds));console.log("CurrenteDate",a),console.log("hourmeterDate",l);var s=(a.getTime()-l.getTime())/1e3;return 1/60*Math.ceil(s/60)}}(`${b}T${O}`,e),[T,y]=(0,a.useState)({id:"",name:"",eventState:0,event:{id:"",name:"",event:0}});console.log("formsEventState  exter",T);const[N,C]=(0,a.useState)({}),Z=e=>{f.status!=Q.EnumEvent.MAINTENANCE?x(Object.assign(Object.assign({},f),{[e.target.name]:e.target.value})):x(Object.assign(Object.assign({},f),{[e.target.name]:e.target.value}))};return(0,a.useEffect)((()=>(o((0,c.$6)(f)),()=>{})),[f]),(0,a.useEffect)((()=>(u(He(E,S)),()=>{o((0,c.J$)())})),[]),(0,a.useEffect)((()=>{(null==e?void 0:e.status)===Q.EnumEvent.NO_OPERATIONAL?u(null==e?void 0:e.hourmeterCurrent):u(He(E,S)),f.status!=Q.EnumEvent.MAINTENANCE&&x(Object.assign(Object.assign({},f),{htm:l}))}),[O]),(0,a.useEffect)((()=>{x(Object.assign(Object.assign({},f),{Substatus:Object.assign({},T)}))}),[T]),(0,a.useEffect)((()=>{x(Object.assign(Object.assign({},f),N))}),[N]),(0,n.jsxs)("div",{children:[(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:1},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:12},{children:(0,n.jsxs)("form",Object.assign({className:i.container,noValidate:!0},{children:[(0,n.jsx)(J.Z,{id:"date",label:"HOUR",type:"time",name:"time",value:O,onChange:Z,className:i.textField,InputLabelProps:{shrink:!0,required:!0}},void 0),(0,n.jsx)(J.Z,{id:"date",label:"HOURMETER",type:"number",disabled:!0,name:"hourmeterCalculated",value:l,onChange:Z,className:i.textField,InputLabelProps:{shrink:!0}},void 0),(p===Q.EnumEvent.MAINTENANCE||v)&&(0,n.jsx)(J.Z,{autoFocus:!0,id:"date",label:"HOURMETER Start",type:"number",name:"htm",defaultValue:l,onChange:Z,className:i.textField,InputLabelProps:{shrink:!0,required:!0}},void 0)]}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:12},{children:(0,n.jsx)(Fe,{setstateform:C,isDisabled:p,setisManto:m,handleIsManto:e=>{m(!0),x(Object.assign(Object.assign({},f),{htm:l,status:Q.EnumEvent.MAINTENANCE,Substatus:{id:"",name:"",eventState:Q.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:Q.EnumEvent.UNKNOWN_STATE_EVENT}}})),console.log("e.target.checked",e.target.checked)}},void 0)}),void 0)]}),void 0),(0,n.jsx)(s.Z,Object.assign({container:!0,spacing:2},{children:!!f.status&&(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,sm:12,xs:12},{children:(0,n.jsx)(ce,{setEventState:y,event:f.status},void 0)}),void 0)}),void 0)]},void 0)};var $e=i(56731),Re=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const _e=()=>{const e=(0,r.T)(),{timelineErrorList:t,currentTimeline:i}=(0,r.C)(u.tH),{formValues:m}=(0,r.C)(c.k3),{dateShift:h}=(0,l.R)(),[g]=(0,d.l)(h),[f,x]=(0,a.useState)($e.Shift.UNKNOWN_SHIFT),[b,p]=(0,a.useState)(!1),[O,E]=(0,a.useState)(!1),[S,T]=(0,a.useState)(!0),[y,N]=(0,a.useState)([]),C=(0,a.useCallback)((()=>{p(!1),T(!0),E(!1)}),[]);return(0,a.useEffect)((()=>{const t={shift:0,date:`${g}T00:00`};return e((0,u.pW)(t)),()=>{}}),[]),(0,a.useEffect)((()=>{m.status&&m.Substatus?T(!1):T(!0)}),[m]),(0,a.useEffect)((()=>{e((0,u.gc)(y))}),[y]),(0,n.jsxs)(o.Z,Object.assign({m:2,p:.5,style:{height:"100%"}},{children:[(0,n.jsx)(s.Z,{children:(0,n.jsx)(be,{},void 0)},void 0),(0,n.jsx)(s.Z,Object.assign({container:!0,style:{height:"100%"}},{children:(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,sm:12,xs:12},{children:(0,n.jsx)(Y,{setOpen:p,setTimelineCurrent:N,setOpenTimeline:E},void 0)}),void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:b,handleClose:C,handleConfirm:()=>Re(void 0,void 0,void 0,(function*(){yield e((0,u.SN)()),p(!1),T(!0),yield function(){return Re(this,void 0,void 0,(function*(){const t={shift:f,date:`${g}T00:00`};yield e((0,u.pW)(t))}))}()})),title:`Excavator  ${y.deviceAlias}  `,disabled:S},{children:(0,n.jsx)(De,{currentTimeline:i},void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:O,handleClose:C,title:`Timeline to  ${y.deviceAlias} `,disabled:S},{children:(0,n.jsx)(Me,{setClose:E},void 0)}),void 0),!(null==t?void 0:t.success)&&(0,n.jsx)(j,{error:null==t?void 0:t.errorsList},void 0)]}),void 0)};var Pe=i(19225);const Ve=({setClose:e})=>{var t,i;const{status:o,currentTimeline:c,updateTimeline:u}=(0,r.C)(Pe.rf),m=(0,r.T)(),[h,g]=(0,a.useState)(!1),{dateShift:j}=(0,l.R)(),[f]=(0,d.l)(j),x=(0,a.useCallback)((()=>{g(!1),m((0,Pe.Uy)({}))}),[]),b=(0,a.useCallback)((()=>{return t=void 0,i=void 0,s=function*(){yield m((0,Pe.ft)()),m((0,Pe.Uy)({})),"done"===o&&(g(!1),e(!1));const t={shift:0,date:`${f}T00:00`};yield m((0,Pe.mA)(t))},new((n=void 0)||(n=Promise))((function(e,o){function a(e){try{r(s.next(e))}catch(e){o(e)}}function l(e){try{r(s.throw(e))}catch(e){o(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(a,l)}r((s=s.apply(t,i||[])).next())}));var t,i,n,s}),[]),p=(0,a.useCallback)((()=>{m((0,Pe.Uy)({})),"done"===o&&(g(!1),e(!1));const t={shift:0,date:`${f}T00:00`};m((0,Pe.mA)(t))}),[]);return(0,n.jsxs)(s.Z,Object.assign({container:!0,alignItems:"flex-end"},{children:[null==c?void 0:c.hystoryShiftList.map((e=>{var t,i,s,o,a,l,r;let d=new Date(1e3*(null===(t=e.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString();return(0,n.jsxs)(ye,Object.assign({data:e,setData:()=>(e=>{m((0,Pe.Uy)(e)),g(!0)})(e)},{children:[(0,n.jsx)(Ze,{title:(null===(s=null===(i=e.initialEventState)||void 0===i?void 0:i.event)||void 0===s?void 0:s.name)?null===(a=null===(o=e.initialEventState)||void 0===o?void 0:o.event)||void 0===a?void 0:a.name:null,subTitle:(null===(l=e.initialEventState)||void 0===l?void 0:l.name)?`${null===(r=e.initialEventState)||void 0===r?void 0:r.name.toString().toLowerCase()}`:""},void 0),(0,n.jsx)(Ee,{},void 0),(0,n.jsx)(Ce,{title:d.toLocaleString().split(" ")[1].substring(0,d.split(" ")[1].length-3)},void 0)]}),e.id+Math.random())})),(0,n.jsx)(v.a,Object.assign({open:h,handleClose:x,handleConfirm:b,title:`Update  ${new Date(1e3*(null===(t=u.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString().split(" ")[1].substring(0,new Date(1e3*(null===(i=u.initialTime)||void 0===i?void 0:i.seconds)).toLocaleString().split(" ")[1].length-3)}`},{children:(0,n.jsx)(Ae,{currentTimeline:c,updateTimeline:u,startDeleteTimeline:Pe.a8,setFormUpdateTimeline:Pe.Zp,handleGetTimeline:p},void 0)}),void 0)]}),void 0)},ze=(e,t)=>{const[i,n]=(0,a.useState)([]);return console.log("currentTimelineList",e),(0,a.useEffect)((()=>{n("done"===t?null==e?void 0:e.map((e=>{var t,i,n,s,o,a,l,r,d,c,u,v,m;return Object.assign(Object.assign({},e),{id:e.deviceId,truck:e.deviceAlias,status:`${(null===(t=e.eventState.event)||void 0===t?void 0:t.name)?null===(i=e.eventState.event)||void 0===i?void 0:i.name.substring(0,3):""}  ${(null===(n=e.eventState)||void 0===n?void 0:n.name)?` - ${null===(s=e.eventState)||void 0===s?void 0:s.name.toString().toLowerCase()}`:""}`,statusEvent:null===(o=e.eventState.event)||void 0===o?void 0:o.event,hmtStart:null===(a=e.hystoryShiftList[0])||void 0===a?void 0:a.initialHourmeter.toFixed(2),hourmeterCurrent:null===(l=e.hystoryShiftList.at(-1))||void 0===l?void 0:l.initialHourmeter.toFixed(2),shift:U[null===(r=e.currentTimeline)||void 0===r?void 0:r.shift],date:new Date(1e3*(null===(c=null===(d=e.currentTimeline)||void 0===d?void 0:d.shiftDate)||void 0===c?void 0:c.seconds)).toLocaleDateString(),adjustment:(null===(u=e.currentTimeline)||void 0===u?void 0:u.adjustment)?e.currentTimeline.adjustment:0,statusAdjustment:!!(null===(v=e.currentTimeline)||void 0===v?void 0:v.status)&&(null===(m=e.currentTimeline)||void 0===m?void 0:m.status)})})):[])}),[e,t]),[i]};var We=i(53375);const Ue=()=>{const{timesline:e,rowsEditModelHourmeterTruck:t,isCheckFinalizeTruck:i}=(0,r.C)(Pe.rf),{timeslineExcavator:s,rowsEditModelHourmeterExcavator:o,isCheckFinalizeExcavator:c}=(0,r.C)(u.tH),{currentTimelineList:v}=e,m=(0,r.T)(),[h,g]=(0,a.useState)(!0),{dateShift:j}=(0,l.R)(),[f,x]=(0,B._)("hourmeterTruck",null),b=(0,a.useCallback)((()=>{console.log("g7h8h7gyh87g8h timelineErrorList.success",i),console.log("g7h8h7gyh87g8h  timelineErrorListExcavator.success",c),!0===i.success&&!0===c.success&&(console.log("g7h8h7gyh87g8h finalize ok"),m((0,Pe.nx)()),m((0,u.Qc)()),window.localStorage.removeItem("hourmeterTruck"),window.localStorage.removeItem("hourmeterExcavator"),m((0,Pe.zq)()),m((0,u.jF)()),location.reload(),console.log("finalize ok 2"))}),[i,c]);(0,a.useEffect)((()=>{b()}),[i,c]);const[p]=(0,d.l)(j);(0,a.useEffect)((()=>{g(v.some((e=>{var t;return!1===(null===(t=e.currentTimeline)||void 0===t?void 0:t.status)}))||s.currentTimelineList.some((e=>{var t;return!1===(null===(t=e.currentTimeline)||void 0===t?void 0:t.status)}))),console.log("   currentTimelineList.length  ",v.length),console.log("   currentTimelineList.length  ",null==t?void 0:t.length),console.log("    timeslineExcavator.currentTimelineList.length ",s.currentTimelineList.length),console.log("    timeslineExcavator.currentTimelineList.length ",null==o?void 0:o.length),v.length===(null==t?void 0:t.length)?g(!1):g(!0)}),[v,t,o,s]);const O=v.some((e=>{var t;return!1===(null===(t=e.currentTimeline)||void 0===t?void 0:t.status)}))?"#808080":"#ec9f05";return(0,n.jsx)(me.Z,Object.assign({onClick:()=>{return t=void 0,i=void 0,o=function*(){const t={shift:0,date:`${p}T00:00`};e.currentTimelineList.some((e=>{var t;return(null===(t=e.currentTimeline)||void 0===t?void 0:t.shift)===Q.EnumEvent.UNKNOWN_STATE_EVENT}))?yield m((0,Pe.nx)()):yield m((0,Pe.tj)()),s.currentTimelineList.some((e=>{var t;return(null===(t=e.currentTimeline)||void 0===t?void 0:t.shift)===Q.EnumEvent.UNKNOWN_STATE_EVENT}))?yield m((0,u.Qc)()):yield m((0,u.pC)()),yield m((0,Pe.mA)(t)),yield m((0,u.pW)(t))},new((n=void 0)||(n=Promise))((function(e,s){function a(e){try{r(o.next(e))}catch(e){s(e)}}function l(e){try{r(o.throw(e))}catch(e){s(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(a,l)}r((o=o.apply(t,i||[])).next())}));var t,i,n,o},disabled:h,startIcon:(0,n.jsx)(We.Z,{htmlColor:O},void 0),variant:"outlined",color:"primary",size:"small"},{children:"Close Shift"}),void 0)};const Ke=()=>{var e,t;const{rowsTimeline:i,timesline:u,status:m,hourmeterStart:h}=(0,r.C)(Pe.rf),{formValuesBtn:g}=(0,r.C)(c.k3),j=(0,r.T)(),{dateShift:f}=(0,l.R)(),[x]=ze(u.currentTimelineList,m),[b]=(0,d.l)(f),[p,O]=(0,a.useState)(!1),[E,S]=(0,a.useState)(Q.EnumEvent.UNKNOWN_STATE_EVENT),[T,y]=(0,a.useState)(!1),[N,C]=q({columnField:"truck",operatorValue:"contains",value:""}),{value:Z}=N;return(0,a.useEffect)((()=>{j((0,Pe.V)(N))}),[Z]),(0,a.useEffect)((()=>{var e,t;(null===(t=null===(e=g.substatus)||void 0===e?void 0:e.event)||void 0===t?void 0:t.id)?y(!1):y(!0)}),[g]),(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:1,justifyContent:"flex-start",style:{paddingBottom:"20px"},alignItems:"center"},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,style:{width:"20%"}},{children:(0,n.jsxs)(o.Z,Object.assign({sx:{display:"flex",alignItems:"flex-end"}},{children:[(0,n.jsx)(X.Z,{},void 0),(0,n.jsx)(J.Z,{id:"input-with-sx",label:"Search ",variant:"standard",name:"value",onChange:C,fullWidth:!0},void 0)]}),void 0)}),void 0),(0,n.jsx)(he,{rowsTimelines:i,setevent:S,setOpenEvent:O},void 0)," ",(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(Ue,{},void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(xe,{shift:null===(e=x[0])||void 0===e?void 0:e.shift,date:null===(t=x[0])||void 0===t?void 0:t.date},void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:p,handleClose:()=>{O(!1)},handleConfirm:()=>{return e=void 0,t=void 0,n=function*(){yield j((0,Pe._C)()),O(!1);const e={shift:0,date:`${b}T00:00`};yield j((0,Pe.mA)(e))},new((i=void 0)||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}));var e,t,i,n},title:`Truck to ${W[E]}  `,disabled:T},{children:(0,n.jsx)(ve,{value:E},void 0)}),void 0)]}),void 0)};function Be(){(0,r.T)();const[e]=$();console.log("eventList",e);const[t,i]=a.useState(null),s=Boolean(t),[o]=R(Pe.V,i);return(0,n.jsxs)("div",{children:[(0,n.jsx)(k.Z,Object.assign({style:{padding:"0px",margin:"0px"},"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:e=>{i(e.currentTarget)}},{children:(0,n.jsx)(H.Z,{},void 0)}),void 0),(0,n.jsx)(I.Z,Object.assign({id:"long-menu",anchorEl:t,keepMounted:!0,open:s,onClose:()=>o("NONE"),PaperProps:{style:{maxHeight:216,width:"20ch"}}},{children:e.map((e=>(0,n.jsx)(M.Z,Object.assign({onClick:()=>o(e.event.toString())},{children:e.name}),e.name)))}),void 0)]},void 0)}const Ge=(e,t,i,s)=>[Object.assign(Object.assign({},f.mf9),{width:70,renderHeader:e=>(0,n.jsx)(Z.ZP,Object.assign({title:"Select all"},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex",padding:"0px",margin:"0px"}},{children:[(0,n.jsx)(f.KOw,Object.assign({},e),void 0),(0,n.jsx)(Be,{},void 0)]}),void 0)}),void 0)}),{field:"truck",headerName:"Truck",hideSortIcons:!0},{field:"shift",headerName:"shift",hideSortIcons:!0},{field:"statusEvent",headerName:"statusEvent",type:"string",hide:!0},{field:"status",headerName:"Status",width:170,hideSortIcons:!0},{field:"hmtStart",headerName:"Hourmeter",editable:!1,type:"number",hideSortIcons:!0},{field:"hourmeterCurrent",headerName:"hourmeter Current",editable:!s,type:"number",hideSortIcons:!0},{field:"hourmeterFinal",headerName:"hourmeter Final",editable:!0,type:"number",hideSortIcons:!0,cellClassName:e=>(0,w.Z)("Mui-error",{positive:e.value>0,negative:e.value<=0||0===e.value})},{field:"adjustment",headerName:"adjustment",type:"number",hideSortIcons:!0},{field:"Opciones",headerName:"Opc",minWidth:110,hideSortIcons:!0,renderCell:({row:s})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z.ZP,Object.assign({onClick:()=>{console.log(s),t(s),e(!0)},title:"Add timeline"},{children:(0,n.jsx)(k.Z,Object.assign({size:"small"},{children:(0,n.jsx)(A.Z,{color:"primary",fontSize:"small"},void 0)}),void 0)}),void 0),(0,n.jsx)(Z.ZP,Object.assign({onClick:()=>{t(s),i(!0)},title:"View Timeline"},{children:(0,n.jsx)(k.Z,Object.assign({size:"small"},{children:(0,n.jsx)(L.Z,{htmlColor:"Green",fontSize:"small"},void 0)}),void 0)}),void 0)]},void 0)}],Ye=e=>e>0,Je=a.memo((({setOpen:e,setTimelineCurrent:t,setOpenTimeline:i})=>{const s=T(),o=(0,r.T)(),{status:l,filterDataGrid:d,statusUpdateInitialHourmeterTimeline:c,isEditableRows:u,timesline:v,hourmeterTruckLocalStorage:m}=(0,r.C)(Pe.rf);console.log("timeslinetimeslinetimesline",v);const[h]=ze(v.currentTimelineList,l),[g,j]=(0,B._)("hourmeterTruck",null),[x,b]=(0,a.useState)(Object.assign({},g)),[p,O]=(0,a.useState)(!0),[E,S]=a.useState([]),{sortModel:y}=z("truck","asc");return(0,a.useEffect)((()=>{setTimeout((()=>{b(Object.assign({},g))}),2e3)}),[]),console.log("editRowsModeltruck",x),(0,a.useEffect)((()=>{b({})}),[c]),(0,a.useEffect)((()=>{O("done"!==l&&"failed"!==l)}),[l]),(0,a.useEffect)((()=>{"done"===l&&o((0,Pe.Cb)())}),[h]),(0,a.useEffect)((()=>()=>{o((0,Pe.gI)())}),[]),(0,n.jsx)("div",Object.assign({style:{height:"1150px",overflowY:"scroll",display:"flex",flexDirection:"column"}},{children:(0,n.jsx)(f._$r,{className:s.root,rowHeight:30,rows:h,columns:Ge(e,t,i,u),density:"compact",components:{NoRowsOverlay:C},checkboxSelection:!0,disableSelectionOnClick:!0,sortModel:y,loading:p,onSelectionModelChange:e=>(e=>{const t=new Set(e),i=h.filter((e=>t.has(e.id.toString())));o((0,Pe.Xm)(i))})(e),disableColumnMenu:!0,editRowsModel:x,onEditRowsModelChange:e=>(e=>{var t="";for(var[i,n]of Object.entries(e))Object.keys(n).length<=1&&Object.keys(n).forEach((e=>{t=e}));console.log("model",e),console.log("key",t);var s=Object.assign({},e);switch(t){case"hourmeterCurrent":b(Object.assign(Object.assign({},x),s));break;case"hmtStart":Object.keys(s).length>=2?(b({}),console.log("case modelxd",e),o((0,Pe.ZB)())):(Object.keys(s).forEach((e=>{if(s[e].hourmeterCurrent){var t=Ye(s[e].hourmeterCurrent.value);s[e].hourmeterCurrent=Object.assign(Object.assign({},s[e].hourmeterCurrent),{error:!t})}})),b(s),o((0,Pe.SZ)(s)));break;case"hourmeterFinal":Object.keys(s).forEach((e=>{var t=Ye(s[e].hourmeterFinal.value);s[e].hourmeterFinal=Object.assign(Object.assign({},s[e].hourmeterFinal),{error:!t})})),b(Object.assign(Object.assign(Object.assign({},g),x),s));var a=!1;for(var[l,n]of Object.entries(e))void 0===s[l].hourmeterFinal.value&&(a=!0);a||s&&j(x),o((0,Pe.H3)(x));break;default:console.log("case default")}})(e),filterModel:{items:[d]},getRowClassName:e=>`super-app-theme--${e.row.statusAdjustment}`},void 0)}),void 0)}));var Xe=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function a(e){try{r(n.next(e))}catch(e){o(e)}}function l(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const qe=()=>{const e=(0,r.T)(),{status:t,timelineErrorList:i,currentTimeline:u}=(0,r.C)(Pe.rf),{formValues:m}=(0,r.C)(c.k3),{dateShift:h}=(0,l.R)(),[g]=(0,d.l)(h),[f,x]=(0,a.useState)($e.Shift.UNKNOWN_SHIFT),[b,p]=(0,a.useState)(!1),[O,E]=(0,a.useState)(!1),[S,T]=(0,a.useState)(!0),[y,N]=(0,a.useState)([]),C=(0,a.useCallback)((()=>{p(!1),T(!0),E(!1)}),[]);return(0,a.useEffect)((()=>{const t={shift:0,date:`${g}T00:00`};return e((0,Pe.mA)(t)),setTimeout((()=>{e((0,Pe.n9)())}),1e3),()=>{e((0,Pe.gI)())}}),[]),(0,a.useEffect)((()=>{var e,t;m.status&&(null===(t=null===(e=m.Substatus)||void 0===e?void 0:e.event)||void 0===t?void 0:t.id)?T(!1):T(!0)}),[m.status,m.Substatus]),(0,a.useEffect)((()=>{e((0,Pe.jO)(y))}),[y]),(0,n.jsxs)(o.Z,Object.assign({m:2,p:.5,style:{height:"100%"}},{children:[(0,n.jsx)(s.Z,{children:(0,n.jsx)(Ke,{},void 0)},void 0),(0,n.jsx)(s.Z,Object.assign({container:!0,style:{height:"100%"}},{children:(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,sm:12,xs:12},{children:(0,n.jsx)(Je,{setOpen:p,setTimelineCurrent:N,setOpenTimeline:E},void 0)}),void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:b,handleClose:C,handleConfirm:()=>Xe(void 0,void 0,void 0,(function*(){yield e((0,Pe.Sp)()),p(!1),T(!0),yield function(){return Xe(this,void 0,void 0,(function*(){const t={shift:f,date:`${g}T00:00`};yield e((0,Pe.mA)(t))}))}()})),title:`Truck  ${y.truck}  `,disabled:S},{children:(0,n.jsx)(De,{currentTimeline:u},void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:O,handleClose:C,title:`Timeline to  ${y.truck} `,disabled:S},{children:(0,n.jsx)(Ve,{setClose:E},void 0)}),void 0),"done"===t&&!(null==i?void 0:i.success)&&(0,n.jsx)(j,{error:null==i?void 0:i.errorsList},void 0)]}),void 0)},Qe=()=>(0,n.jsx)("div",{children:(0,n.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:7},{children:(0,n.jsx)(qe,{},void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:5},{children:(0,n.jsx)(_e,{},void 0)}),void 0)]}),void 0)},void 0);var et=i(16281);const tt=()=>(0,n.jsxs)("div",{children:[(0,n.jsx)(et.h,{title:"Hourmeter",notificationPannel:!0},void 0),(0,n.jsx)(Qe,{},void 0)]},void 0),it=tt},16281:(e,t,i)=>{i.d(t,{h:()=>E});var n=i(85893),s=i(45258),o=i(28358),a=i(282),l=i(22318),r=i(43471),d=i(5977),c=i(55517),u=i(17812),v=i(96617),m=i(73637),h=i(79895),g=i(16575),j=i(51972),f=i(67294),x=i(73855),b=i(45855);const p=({title:e,content:t})=>(0,n.jsxs)("div",{children:[(0,n.jsxs)(l.Z,Object.assign({variant:"subtitle1"},{children:[(0,n.jsx)(g.Z,{style:{fontSize:"14px",marginRight:"4px"}},void 0),e]}),void 0),(0,n.jsx)(l.Z,Object.assign({variant:"body1"},{children:t}),void 0),(0,n.jsx)(c.Z,{},void 0)]},void 0),O=({})=>{var e,t,i;const[s,o]=(0,f.useState)(null),[a,r]=(0,f.useState)(!1),{notificationsHeader:d}=(0,x.C)(b.Af),c=(0,x.T)();(0,f.useEffect)((()=>{c((0,b.pK)())}),[]);const g=a&&Boolean(s)?"transition-popper":void 0;return console.log("notificationsHeader.notificationsList",d.notificationsList),(0,n.jsxs)("div",Object.assign({style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",width:"8%",marginRight:"4px"}},{children:[(0,n.jsx)(u.Z,Object.assign({color:(null===(e=d.notificationsList)||void 0===e?void 0:e.length)>0?"primary":"inherit",onClick:e=>{o(e.currentTarget),r((e=>!e))},size:"small"},{children:(0,n.jsxs)("div",Object.assign({style:{margin:"4px"}},{children:[(0,n.jsx)(l.Z,Object.assign({variant:"subtitle2",style:{color:"white",zIndex:1,position:"absolute",justifyContent:"right",marginLeft:"18px"}},{children:(null===(t=d.notificationsList)||void 0===t?void 0:t.length)>0?null===(i=d.notificationsList)||void 0===i?void 0:i.length:""}),void 0),(0,n.jsx)(j.Z,{},void 0)]}),void 0)}),void 0),(0,n.jsx)("div",Object.assign({style:{zIndex:1}},{children:(0,n.jsx)(v.Z,Object.assign({id:g,open:a,anchorEl:s,transition:!0,style:{zIndex:3}},{children:({TransitionProps:e})=>{var t,i,s;return(0,n.jsx)(m.Z,Object.assign({},e,{timeout:350},{children:(0,n.jsxs)(h.Z,Object.assign({elevation:3,style:{width:"300px",height:(null===(t=d.notificationsList)||void 0===t?void 0:t.length)>10?"87vh":"100%",padding:"8px",overflow:"scroll"}},{children:[(!d.notificationsList||0===(null===(i=d.notificationsList)||void 0===i?void 0:i.length))&&(0,n.jsx)(n.Fragment,{children:"Not Have a new Notification"},void 0),null===(s=d.notificationsList)||void 0===s?void 0:s.map(((e,t)=>(0,n.jsx)(p,{title:e.title,content:e.message},t)))]}),void 0)}),void 0)}}),void 0)}),void 0)]}),void 0)},E=({title:e,positionContainer:t,notificationPannel:i})=>{const c=t||"sticky",u=(0,d.k6)();return(0,n.jsx)(s.Z,Object.assign({position:c,color:"secondary",style:{display:"flex"},elevation:0},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex"}},{children:[(0,n.jsxs)(o.Z,Object.assign({variant:"dense",style:{width:"90%"}},{children:[(0,n.jsx)(a.Z,{size:"small",startIcon:(0,n.jsx)(r.Z,{color:"action",style:{color:"#fff"}},void 0),onClick:()=>{u.goBack()}},void 0),(0,n.jsx)(l.Z,Object.assign({variant:"h6"},{children:e}),void 0)]}),void 0),i&&(0,n.jsx)(O,{},void 0)]}),void 0)}),void 0)}}}]);