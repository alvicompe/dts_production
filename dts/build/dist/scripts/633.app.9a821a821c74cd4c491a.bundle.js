"use strict";(self.webpackChunkdts_hytera=self.webpackChunkdts_hytera||[]).push([[633],{63663:(e,t,i)=>{i.d(t,{F2:()=>a,xu:()=>v.I,zx:()=>d,iz:()=>j,T5:()=>h,P4:()=>g,hU:()=>u,Mi:()=>b,IB:()=>o.C});var n=i(85893),s=i(8286),l=i(96588);const a=e=>(0,n.jsx)(l.ZP,Object.assign({},Object.assign({},e.propsAutocomplete),{renderInput:e=>(0,n.jsx)(s.Z,Object.assign({},e,{label:"Seleccione una opción",variant:"outlined"}))}));var o=i(45287),r=i(282);const d=e=>(0,n.jsx)(r.Z,Object.assign({},Object.assign({},e.propsButton),{children:e.label}));var c=i(17812);const u=e=>(0,n.jsx)(c.Z,Object.assign({},Object.assign({},e),{children:e.children}));var v=i(47463),m=i(41749);const h=e=>(0,n.jsx)(m.Z,Object.assign({},Object.assign({},e),{container:!0},{children:e.children})),g=e=>(0,n.jsx)(m.Z,Object.assign({},Object.assign({},e),{item:!0},{children:e.children}));var f=i(55517);const j=e=>(0,n.jsx)(f.Z,Object.assign({},Object.assign({},e)));var x=i(82285);const b=e=>(0,n.jsx)(x.Z,Object.assign({},Object.assign({},e),{children:(0,n.jsx)(m.Z,{children:e.children})}))},45287:(e,t,i)=>{i.d(t,{C:()=>a});var n=i(85893),s=i(64436),l=i(8286);const a=e=>{const{propsTextField:t,propsForm:i}=e;return(0,n.jsx)(s.Z,Object.assign({},Object.assign({},i),{children:(0,n.jsx)(l.Z,Object.assign({},Object.assign({},t)))}))}},47463:(e,t,i)=>{i.d(t,{I:()=>l});var n=i(85893),s=i(60395);const l=({children:e,height:t,width:i})=>(0,n.jsx)(s.Z,Object.assign({height:t,width:i},{children:e}))},61242:(e,t,i)=>{i.d(t,{a:()=>m});var n=i(85893),s=i(41120),l=i(52663),a=i(66083),o=i(29525),r=i(66856),d=i(95477),c=i(282),u=i(93584);const v=(0,s.Z)({disabledPadding:{padding:0,textAlign:"center"}}),m=({open:e,handleClose:t,handleConfirm:i,title:s,children:m,maxWidth:h="lg",disabled:g=!1,loading:f})=>{const j=v();return(0,n.jsxs)(l.Z,Object.assign({open:e,onClose:t,maxWidth:h},{children:[(0,n.jsx)(a.Z,Object.assign({style:{color:"white",background:`${u.Jx}`,padding:"0.5rem"},className:j.disabledPadding},{children:s})),(0,n.jsx)(o.Z,{children:m}),(0,n.jsx)(r.Z,{children:f?(0,n.jsx)(d.Z,{style:{width:"30px",height:"30px"}}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Z,Object.assign({size:"small",color:"primary",onClick:t},{children:"Cancelar"})),i&&(0,n.jsx)(c.Z,Object.assign({disabled:g,variant:"outlined",size:"small",color:"secondary",onClick:i,autoFocus:!0},{children:"Confirmar"}))]})})]}))}},86842:(e,t,i)=>{i.d(t,{y:()=>v});var n=i(85893),s=i(96912),l=i(44562),a=i(37155),o=i(67294),r=i(41120),d=i(33681);const c=(0,r.Z)({root:{width:"100%"}});function u({time:e}){const t=c(),[i,s]=o.useState(100),l=10*e/100;return o.useEffect((()=>{s((e=>e-10));const e=setInterval((()=>{s((e=>e-10))}),l);return()=>{clearInterval(e)}}),[]),(0,n.jsx)("div",Object.assign({className:t.root},{children:(0,n.jsx)(d.Z,{variant:"determinate",value:i})}))}const v=({error:e,callBack:t,success:i})=>{const[r,d]=o.useState({open:!0,vertical:"bottom",horizontal:"center"}),{vertical:c,horizontal:v}=r,m=()=>{d(Object.assign(Object.assign({},r),{open:!1})),t()};return(0,o.useEffect)((()=>{const e=setTimeout((()=>{m()}),4e3);return()=>{window.clearTimeout(e)}}),[]),(0,n.jsx)(s.Z,Object.assign({open:r.open,anchorOrigin:{vertical:c,horizontal:v},onClose:m},{children:(0,n.jsxs)(l.Z,Object.assign({severity:i?"success":"error",onClose:m},{children:[(0,n.jsx)(a.Z,{children:i?"Exito":"error"}),(0,n.jsxs)("strong",{children:[" ",e]}),(0,n.jsx)(u,{time:4e3})]}))}))}},2834:(e,t,i)=>{i.d(t,{d:()=>a});var n=i(85893),s=i(282),l=i(95477);const a=e=>{var{loading:t,text:i}=e,a=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["loading","text"]);return(0,n.jsx)(s.Z,Object.assign({},a,{disabled:t},{children:t?(0,n.jsx)(l.Z,{style:{width:"20px",height:"20px"}}):i}))}},31366:(e,t,i)=>{i.d(t,{Z:()=>v});var n=i(85893),s=i(67294),l=i(41120),a=i(35117),o=i(85639),r=i(64436),d=i(26209),c=i(71308);const u=(0,l.Z)((e=>(0,a.Z)({formControl:{margin:e.spacing(1),minWidth:"100%"},selectEmpty:{marginTop:e.spacing(2)}})));function v(e){var{placeholder:t,iteams:i,selectValue:l,value:a,loading:v=!1}=e,m=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["placeholder","iteams","selectValue","value","loading"]);const h=u(),[g,f]=s.useState("");return(0,s.useEffect)((()=>{f(a||"")}),[a]),(0,s.useEffect)((()=>{l(g)}),[g]),(0,n.jsx)(r.Z,Object.assign({className:h.formControl},{children:(0,n.jsxs)(d.Z,Object.assign({},m,{value:g,onChange:e=>{f(e.target.value)},displayEmpty:!0,className:h.selectEmpty,inputProps:{"aria-label":`${t}`}},{children:[(0,n.jsx)(o.Z,Object.assign({value:"",disabled:!0},{children:t})),v?(0,n.jsx)(c.g,{}):null==i?void 0:i.map((e=>(0,n.jsx)(o.Z,Object.assign({value:null==e?void 0:e.value},{children:null==e?void 0:e.tittle}),e.value)))]}))}))}},11818:(e,t,i)=>{i.d(t,{y:()=>l});var n=i(67294),s=i(49032);const l=e=>{const[t,i]=(0,n.useState)(!0),[l,a]=(0,n.useState)(!0),[o,r]=(0,n.useState)(!0),[d,c]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{const t=()=>0!==(null==e?void 0:e.length)&&(null==e?void 0:e.every((e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===s.EnumEvent.NO_OPERATIONAL}))),n=()=>0!==(null==e?void 0:e.length)&&(null==e?void 0:e.every((e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===s.EnumEvent.OPERATIONAL}))),l=()=>0!==(null==e?void 0:e.length)&&(null==e?void 0:e.every((e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===s.EnumEvent.OPERATIONAL_DELAY}))),o=()=>0!==(null==e?void 0:e.length)&&(null==e?void 0:e.every((e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===s.EnumEvent.MAINTENANCE}))),d=()=>0!==(null==e?void 0:e.length)&&(null==e?void 0:e.every((e=>{var t,i;return void 0===(null===(i=null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)})));i(!0),a(!0),r(!0),c(!0),n()&&(i(!1),a(!0),r(!1),c(!1)),d()&&(i(!1),a(!1),r(!1)),t()&&(i(!0),a(!1),r(!1),c(!1)),l()&&(i(!1),a(!1),r(!0)),o()&&(i(!1),a(!1),r(!0),c(!0)),0==d()&&0==t()&&0==l()&&0==n()&&0==o()&&(i(!0),a(!0),r(!0),c(!0))}),[e]),[t,l,o,d]}},990:(e,t,i)=>{i.d(t,{M:()=>s});var n=i(67294);const s=e=>{const[t,i]=(0,n.useState)(e),s=()=>{i(e)};return(0,n.useEffect)((()=>()=>{s()}),[]),[t,e=>{console.log("type e",typeof e),i(Object.assign(Object.assign({},t),{[e.target.name]:e.target.value?e.target.value:e.target.checked}))},s,i]}},15635:(e,t,i)=>{i.d(t,{r:()=>l});var n=i(67294),s=i(95090);const l=e=>{const[t,i]=(0,n.useState)(!1);return(0,n.useEffect)((()=>(e===s.JD.DONE||e===s.JD.UNKNOWN||e===s.JD.ERROR?i(!1):i(!0),()=>{i(!1)})),[e]),[t]}},42627:(e,t,i)=>{i.r(t),i.d(t,{HourmeterView:()=>l,default:()=>a});var n=i(85893),s=i(49521);const l=()=>(0,n.jsxs)("div",{children:[(0,n.jsx)(s.h,{title:"Hourmeter"}),(0,n.jsx)("div",{style:{marginTop:"60px"}})]}),a=l},8540:(e,t,i)=>{i.r(t),i.d(t,{HourmeterView:()=>gt,default:()=>ft});var n=i(85893),s=i(41749),l=i(52541),a=i(30553),o=i(40074),r=i(282),d=i(44562),c=i(67294),u=i(93584),v=i(88093),m=i(73855),h=i(10646),g=i(15635),f=i(56731),j=i(1754),x=i(38062),b=i(61242),p=i(71308),y=i(29829),S=i(85639),E=i(24837),O=i(52387),T=i(41120),N=i(35117),I=i(81605),A=i(95090),C=i(78479),Z=i(49032),w=i(67774),D=i(89452),F=i(97700);const L=43200,R=e=>{new Date;const[t]=(0,v.R)();t.getHours()>=7&&t.getHours()<19?(t.setHours(7),t.setSeconds(0),t.setMinutes(0),t.setMilliseconds(0)):(t.setHours(19),t.setSeconds(0),t.setMinutes(0),t.setMilliseconds(0));const i=((new Date).getTime()-t.getTime())/1e3;return{flex:i/L||0,time:i}},H=e=>{var t,i,n;if(e&&(null==e?void 0:e.initialEventState)&&(null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.event))switch(null===(n=null===(i=null==e?void 0:e.initialEventState)||void 0===i?void 0:i.event)||void 0===n?void 0:n.event){case Z.EnumEvent.MAINTENANCE:return"#FF0000";case Z.EnumEvent.OPERATIONAL:return"#069B15";case Z.EnumEvent.NO_OPERATIONAL:return"#F1C012";case Z.EnumEvent.OPERATIONAL_DELAY:return"#0000FF"}return"#fff"},k=e=>{switch(e){case Z.EnumEvent.MAINTENANCE:return"#FF0000";case Z.EnumEvent.OPERATIONAL:return"#069B15";case Z.EnumEvent.NO_OPERATIONAL:return"#F1C012";case Z.EnumEvent.OPERATIONAL_DELAY:return"#0000FF";default:return"#808080"}},P=e=>`${`0${e.getHours()}`.slice(-2)}:${`0${e.getMinutes()}`.slice(-2)}`;var z=i(11818),M=i(8286),_=i(62822),W=i(50998),G=i(95757),$=i(78721),U=i(53559);const V=()=>{const{shiftSelect:e,dateShiftSelect:t}=(0,m.C)(j.yV),[i]=(0,v.R)(),[n]=(0,h.l)(i);return[{shift:e,date:`${n}T00:00`}]},B=e=>{const{historyTimelineShift:t}=(0,m.C)(j.yV),[i]=(0,h.l)(new Date),[n]=(0,h.l)(new Date((new Date).getTime()-864e5)),[s,l]=(0,c.useState)(i);return(0,c.useEffect)((()=>{var s,a,o;(null===(s=t[0])||void 0===s?void 0:s.shift)===f.Shift.NIGHT&&new Date(1e3*(null===(o=null===(a=t[0])||void 0===a?void 0:a.shiftDate)||void 0===o?void 0:o.seconds)).toLocaleDateString()===(new Date).toLocaleDateString()?l(i):parseInt(e.split(":")[0])>=19&&parseInt(e.split(":")[0])<=23?l(n):l(i)}),[e]),[s]};const q=({handlePopoverClose:e,eventSelect:t})=>{var i,l,a;const{unitSelectTimelineList:o}=(0,m.C)(j.yV),{user:d}=(0,m.C)(U.MR),[u]=V(),v=(0,m.T)(),[h,g]=(0,c.useState)(P(new Date)),[f]=B(h),[x,b]=(0,c.useState)("");(0,c.useEffect)((()=>{var e,t;const i=1===o.length?null===(t=null===(e=o[0])||void 0===e?void 0:e.initialHourmeter)||void 0===t?void 0:t.toFixed(1):"";b(i)}),[o]);const[p,y]=(0,c.useState)(),{eventStateList:S,statusEventStateList:E}=(0,m.C)(F.eG),O=1===o.length&&(null===(a=null===(l=null===(i=o[0])||void 0===i?void 0:i.initialEventState)||void 0===l?void 0:l.event)||void 0===a?void 0:a.event)===Z.EnumEvent.MAINTENANCE;return E===A.JD.LOADING?(0,n.jsx)(n.Fragment,{children:"CARGANDO..."}):(0,n.jsxs)(s.Z,{children:[(0,n.jsx)(M.Z,{label:"Entrada",type:"time",value:h,autoFocus:!0,name:"timeStart",size:"small",InputLabelProps:{shrink:!0,required:!0},onChange:e=>g(e.target.value)}),O&&(0,n.jsx)(M.Z,{label:"H. salida",type:"number",name:"initialHourmeter",size:"small",value:x,style:{maxWidth:100},onChange:e=>{var t;return b(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value)},InputLabelProps:{shrink:!0}}),t&&t.event!==Z.EnumEvent.OPERATIONAL&&(0,n.jsx)(_.Z,{children:S.map(((e,t)=>(0,n.jsx)(W.Z,Object.assign({selected:(null==p?void 0:p.id)===e.id,dense:!0,button:!0,onClick:()=>y(e),disableGutters:!0},{children:(0,n.jsx)(G.Z,{secondary:e.name})}),t)))}),(0,n.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,n.jsx)(r.Z,Object.assign({onClick:e,color:"primary",variant:"outlined",size:"small"},{children:"CANCELAR"})),(0,n.jsx)(r.Z,Object.assign({disabled:!(null==p?void 0:p.id)&&t&&t.event!==Z.EnumEvent.OPERATIONAL&&o.length>0,onClick:()=>{return i=void 0,n=void 0,l=function*(){var i;let n=p;t.event===Z.EnumEvent.OPERATIONAL&&(n={eventState:$.EnumEventState.UNKNOWN_STATE,id:"",name:"",event:t});const s={args:{htm:x,Substatus:n,status:null===(i=null==n?void 0:n.event)||void 0===i?void 0:i.event,date:f,time:h},currentTimeline:o[0]};n&&n.event?(O?yield v((0,j.sx)(s)):yield v((0,j.hd)({event:n.event,eventState:n,dateShift:f,hourStart:h})),e()):alert("Seleccione un subestado")},new((s=void 0)||(s=Promise))((function(e,t){function a(e){try{r(l.next(e))}catch(e){t(e)}}function o(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(a,o)}r((l=l.apply(i,n||[])).next())}));var i,n,s,l},color:"secondary",variant:"contained",size:"small"},{children:"CONFIRMAR"}))]}))]})};const K=(0,T.Z)((e=>(0,N.Z)({popover:{},paper:{padding:e.spacing(1),zIndex:5}}))),Y=({list:e,setOpen:t,setSelected:i,selected:s})=>{const[l,a]=(0,c.useState)(e),o={id:"",name:"NINGUNO",event:Z.EnumEvent.UNKNOWN_STATE_EVENT};return(0,c.useEffect)((()=>{const t=[...e];t.unshift(o),a(t)}),[e]),(0,n.jsx)(y.Z,Object.assign({style:{padding:0},id:"split-button-menu"},{children:l.map(((e,l)=>e.event===Z.EnumEvent.MAINTENANCE?null:(0,n.jsx)(S.Z,Object.assign({style:{background:k(e.event),color:"white",fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:12},selected:e===s,onClick:n=>((e,n)=>{i(n),t(!1)})(0,e)},{children:e.name}),l)))}))},J=({stateShift:e})=>{const{unitSelectTimelineList:t}=(0,m.C)(j.yV),[i,s,l]=(0,z.y)(t),a=K(),{eventList:o,statusEventList:d}=(0,m.C)(F.yJ),[v,h]=(0,C._)("MOVE_SELECT_EVENT",!1),[g,f]=(0,c.useState)(),[x,b,p]=(()=>{const{eventList:e,statusEventList:t}=(0,m.C)(F.yJ),[i,n]=(0,c.useState)(""),[s,l]=(0,c.useState)(""),[a,o]=(0,c.useState)("");return(0,c.useEffect)((()=>{var i,s,a;t===A.JD.DONE&&(n(null===(i=null==e?void 0:e.find((e=>e.event.toString()===Z.EnumEvent.NO_OPERATIONAL.toString())))||void 0===i?void 0:i.name),l(null===(s=null==e?void 0:e.find((e=>e.event.toString()===Z.EnumEvent.OPERATIONAL.toString())))||void 0===s?void 0:s.name),o(null===(a=null==e?void 0:e.find((e=>e.event.toString()===Z.EnumEvent.OPERATIONAL_DELAY.toString())))||void 0===a?void 0:a.name))}),[t,e]),[i,s,a]})(),{historyTimelineShift:y}=(0,m.C)(j.yV),S=(0,m.T)(),T=(0,c.useRef)(),[N,L]=(0,c.useState)(!1),[R,H]=(0,c.useState)(null),P=()=>{H(null),L(!1)},M=(e,t)=>{return i=void 0,n=void 0,l=function*(){H(e.currentTarget),yield S((0,D.Gy)(t));const i=o.find((e=>e.event===t));h(i)},new((s=void 0)||(s=Promise))((function(e,t){function a(e){try{r(l.next(e))}catch(e){t(e)}}function o(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(a,o)}r((l=l.apply(i,n||[])).next())}));var i,n,s,l};(0,c.useEffect)((()=>{S((0,j.Rt)()),null==y||y.map((e=>{var t,i;(null===(i=null===(t=null==e?void 0:e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===(null==g?void 0:g.event)&&S((0,j.WZ)(e.currentTimeline))}))}),[g]),(0,c.useEffect)((()=>{S((0,w.TU)())}),[]);const _=Boolean(R);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(E.Z,Object.assign({variant:"contained",color:"primary",disabled:e,ref:T,size:"small","aria-owns":_?"mouse-over-popover":void 0,"aria-label":"split button"},{children:[(0,n.jsx)(r.Z,Object.assign({style:{padding:4,margin:0,color:"#fff",fontSize:10,background:i?"grey":k(Z.EnumEvent.NO_OPERATIONAL)},disabled:i,size:"small",onClick:e=>M(e,Z.EnumEvent.NO_OPERATIONAL)},{children:x})),(0,n.jsx)(r.Z,Object.assign({style:{padding:4,margin:0,color:"#fff",fontSize:10,background:s?"grey":k(Z.EnumEvent.OPERATIONAL)},disabled:s,size:"small",onClick:e=>M(e,Z.EnumEvent.OPERATIONAL)},{children:b})),(0,n.jsx)(r.Z,Object.assign({style:{padding:4,margin:0,color:"#fff",fontSize:10,background:l?"grey":k(Z.EnumEvent.OPERATIONAL_DELAY)},disabled:l,size:"small",onClick:e=>M(e,Z.EnumEvent.OPERATIONAL_DELAY)},{children:p})),(0,n.jsx)(r.Z,Object.assign({color:"primary",size:"small","aria-controls":"split-button-menu","aria-expanded":"true","aria-label":"select merge strategy","aria-haspopup":"menu",onClick:()=>{L((e=>!e))},style:{padding:0,margin:0,color:"#fff",background:u.sb}},{children:(0,n.jsx)(I.Z,{fontSize:"small"})}))]})),(0,n.jsx)(O.ZP,Object.assign({open:N,anchorEl:T.current,role:void 0,id:"mouse-list-popover",className:a.popover,classes:{paper:a.paper},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:P},{children:(0,n.jsx)(Y,{setOpen:L,list:d===A.JD.DONE?o:[],selected:g,setSelected:f})})),(0,n.jsx)(O.ZP,Object.assign({id:"mouse-over-popover",className:a.popover,classes:{paper:a.paper},open:_,anchorEl:R,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},onClose:P},{children:(0,n.jsx)(q,{eventSelect:v,handlePopoverClose:P})}))]})},X=e=>{const[t,i]=(0,c.useState)(!1);return(0,c.useEffect)((()=>{for(var[t,n]of Object.entries(null==e?{}:e)){if(0==n||""==n){i(!0);break}i(!1)}}),[e]),[t]};var Q=i(64436),ee=i(96019),te=i(6562),ie=i(13258),ne=i(990),se=i(51182),le=i(31366),ae=i(71267),oe=i(38799),re=i(96394),de=i(26209),ce=i(8920);const ue=(0,T.Z)((e=>(0,N.Z)({formControl:{margin:e.spacing(1)},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},noLabel:{marginTop:e.spacing(3)}}))),ve={PaperProps:{style:{maxHeight:224,width:250}}};function me(e,t,i){return{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',borderTop:-1===(null==t?void 0:t.indexOf(e))?"":"1px solid",color:-1===(null==t?void 0:t.indexOf(e))?"black":"white",background:-1===(null==t?void 0:t.indexOf(e))?"":`${u.Jx}`,fontWeight:(null==t||t.indexOf(e),i.typography.fontWeightLight)}}function he(e){var{placeholder:t,iteams:i,selectValue:s}=e,l=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["placeholder","iteams","selectValue"]);const a=ue(),o=(0,ce.Z)(),[r,d]=c.useState([]);return(0,c.useEffect)((()=>{s(r)}),[r]),(0,n.jsx)(c.Fragment,{children:(0,n.jsxs)(Q.Z,Object.assign({fullWidth:!0,className:a.formControl},l,{children:[(0,n.jsx)(re.Z,Object.assign({id:"demo-mutiple-chip-label"},{children:t})),(0,n.jsxs)(de.Z,Object.assign({fullWidth:!0,id:"demo-mutiple-chip",input:(0,n.jsx)(oe.Z,{id:"select-multiple-chip"}),labelId:"demo-mutiple-chip-label",MenuProps:ve,multiple:!0,onChange:e=>{const t=null==i?void 0:i.map((e=>e.name));e.target.value.some((e=>"TODOS"===e))?(null==i?void 0:i.length)===(null==r?void 0:r.length)?d([]):d([...t]):d(e.target.value)},value:r,renderValue:e=>(0,n.jsx)("div",Object.assign({className:a.chips},{children:e.map((e=>(0,n.jsx)(ae.Z,{label:e,className:a.chip},e)))}))},{children:[(0,n.jsx)(S.Z,Object.assign({value:"TODOS",onClick:()=>{const e=null==i?void 0:i.map((e=>e.name));0===(null==r?void 0:r.length)?d([...e]):d([])}},{children:"TODOS"})),0===(null==i?void 0:i.length)?(0,n.jsx)(p.g,{}):null==i?void 0:i.map((e=>(0,n.jsx)(S.Z,Object.assign({style:me(e.name,r,o),value:e.name},{children:e.name}),e.value)))]}))]}))})}const ge=({setForm:e,setFormCheckbox:t})=>{const i=(0,m.T)(),[l,o]=c.useState(f.Shift.UNKNOWN_SHIFT),[r]=(0,h.l)(new Date),[d]=(0,h.l)(new Date),[u,v]=c.useState([]),g=(()=>{const{assetList:e,statusAssetList:t}=(0,m.C)(se.LG),[i,n]=(0,c.useState)([]);return(0,c.useEffect)((()=>{t===A.JD.DONE?n(e):n([])}),[t]),i})(),j=((e,t)=>{const[i,n]=(0,c.useState)([]);return(0,c.useEffect)((()=>{const i=[];e.forEach((e=>{t.forEach((t=>{e.name!==t||i.push(e.enumAssetType)}))})),n(i)}),[t,e]),i})(g,u),[x,b,p,y]=(0,ne.M)({assetTypeList:j,endDate:r,shift:l||f.Shift.UNKNOWN_SHIFT,startDate:d}),[S,E]=(0,ne.M)({history:!1,resumen:!0}),{startDate:O,endDate:T}=x;return(0,c.useEffect)((()=>{e(x),t(S)}),[x,S]),(0,c.useEffect)((()=>{y(Object.assign(Object.assign({},x),{assetTypeList:j,shift:l}))}),[l,j]),(0,c.useEffect)((()=>{i((0,se.BX)())}),[]),(0,n.jsx)(c.Fragment,{children:(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:2,direction:"row",justifyContent:"space-between"},{children:[(0,n.jsx)(s.Z,Object.assign({container:!0,spacing:2,xs:12,sm:6,md:6},{children:(0,n.jsx)(s.Z,Object.assign({item:!0,xs:12,sm:12,md:12},{children:(0,n.jsx)(he,{iteams:g.map((e=>({name:e.name,value:e.enumAssetType}))),placeholder:"Tipo de equipos",selectValue:v,style:{minWidth:400,maxWidth:450}})}))})),(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:2,xs:12,sm:6,md:6},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,xs:12,sm:12,md:6},{children:(0,n.jsx)(M.Z,{autoFocus:!0,fullWidth:!0,id:"startDate",label:"Fecha Inicial",margin:"normal",name:"startDate",onChange:b,required:!0,style:{textAlign:"center"},type:"date",value:O,variant:"outlined"})})),(0,n.jsx)(s.Z,Object.assign({item:!0,xs:12,sm:12,md:6},{children:(0,n.jsx)(M.Z,{label:"Fecha Final",autoFocus:!0,fullWidth:!0,id:"endDate",margin:"normal",name:"endDate",onChange:b,required:!0,style:{textAlign:"center"},type:"date",value:T,variant:"outlined"})}))," ",(0,n.jsx)(s.Z,Object.assign({item:!0,xs:12,sm:12,md:6},{children:(0,n.jsx)(le.Z,{iteams:[{value:f.Shift.BOTH,tittle:"Ambos"},{value:f.Shift.DAY,tittle:"Dia"},{value:f.Shift.NIGHT,tittle:"Noche"}],placeholder:"Turno",required:!0,selectValue:o})})),(0,n.jsx)(s.Z,Object.assign({item:!0,xs:12,sm:12,md:6},{children:(0,n.jsxs)(Q.Z,Object.assign({component:"fieldset"},{children:[(0,n.jsx)(ee.Z,Object.assign({component:"legend"},{children:"Tipo de Excel"})),(0,n.jsxs)(te.Z,Object.assign({row:!0},{children:[(0,n.jsx)(a.Z,{control:(0,n.jsx)(ie.Z,{checked:S.resumen,name:"resumen",onChange:E}),label:"Resumen"}),(0,n.jsx)(a.Z,{control:(0,n.jsx)(ie.Z,{checked:S.history,name:"history",onChange:E}),label:"Historico"})]}))]}))}))]}))]}))})};var fe=i(43099);const je=()=>{const e=(0,m.T)(),[t,i]=(0,c.useState)(!1),[s,l]=(0,c.useState)(),[a,o]=(0,c.useState)(),[d]=X(s);return(0,n.jsxs)(c.Fragment,{children:[(0,n.jsx)(r.Z,Object.assign({color:"secondary",size:"small",variant:"contained",startIcon:(0,n.jsx)(fe.Z,{}),onClick:()=>{i(!0)}},{children:"Reportes"})),(0,n.jsx)(b.a,Object.assign({open:t,handleClose:()=>{i(!1)},title:"Descargar Reportes línea de tiempo",disabled:d,handleConfirm:()=>{(null==a?void 0:a.history)&&e((0,j.g7)(s)),(null==a?void 0:a.resumen)&&e((0,j.LO)(s)),i(!1)}},{children:(0,n.jsx)(ge,{setForm:l,setFormCheckbox:o})}))]})};var xe=i(22318),be=i(7258),pe=i(80936);const ye=()=>{const{historyTimelineShift:e,guardShift:t,stateShift:i}=(0,m.C)(j.yV),s=(e=>{switch(e){case be.EnumGuard.A:return"A";case be.EnumGuard.B:return"B";case be.EnumGuard.C:return"C";case be.EnumGuard.UNKNOWN_GUARD:return"DESCONOCIDO"}})(t),l=i===(null===pe.TimelinesShiftResponse||void 0===pe.TimelinesShiftResponse?void 0:pe.TimelinesShiftResponse.State.CLOSED)?"CERRADO":"EN PROGRESO";return(0,n.jsx)(n.Fragment,{children:0===(null==e?void 0:e.length)?(0,n.jsx)(n.Fragment,{}):(0,n.jsxs)(xe.Z,Object.assign({variant:"subtitle1",style:{color:"white"}},{children:["GUARDIA ",s," - TURNO: ",l]}))})};var Se=i(96617),Ee=i(79895),Oe=i(868),Te=i(28428),Ne=i(30115),Ie=i(39704),Ae=i(19238),Ce=i(63663),Ze=i(2834);const we=(e,t)=>{const[i,n]=(0,c.useState)(!1);return(0,c.useEffect)((()=>{var i,s,l,a;n(!1);const o=null==e?void 0:e.find((e=>e.deviceId===t.deviceId)),r=null==o?void 0:o.historyShiftList.findIndex((e=>e.id===t.id)),d=null==o?void 0:o.historyShiftList.at(r-1);(null===(s=null===(i=null==t?void 0:t.initialEventState)||void 0===i?void 0:i.event)||void 0===s?void 0:s.event.toString())===Z.EnumEvent.MAINTENANCE.toString()&&n(!0),(null===(a=null===(l=null==d?void 0:d.initialEventState)||void 0===l?void 0:l.event)||void 0===a?void 0:a.event.toString())===Z.EnumEvent.MAINTENANCE.toString()&&n(!0)}),[t,e]),[i]};var De=function(e,t,i,n){return new(i||(i=Promise))((function(s,l){function a(e){try{r(n.next(e))}catch(e){l(e)}}function o(e){try{r(n.throw(e))}catch(e){l(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}r((n=n.apply(e,t||[])).next())}))};const Fe=(0,Ne.Z)((()=>({root:{minWidth:150,padding:4,borderWidth:2,borderStyle:"solid"}}))),Le=e=>{var t;const i=new Date(1e3*(null===(t=null==e?void 0:e.initialTime)||void 0===t?void 0:t.seconds)),n=(null==e?void 0:e.finalTime)?new Date(1e3*(null==e?void 0:e.finalTime.seconds)):new Date;return{timeInitial:i,timeFinal:n,hourInitial:P(i),hourFinal:P(n)}},Re=({timeline:e})=>{var t,i,l,a,o,r;const d=H(e),{statusUpdateTimeline:u,currentTimeline:v}=(0,m.C)(j.yV),{historyTimelineShift:h,statusDelete:f}=(0,m.C)(j.yV),[x]=(0,g.r)(u),[b]=(0,g.r)(f),p=(0,Ie.I0)(),y=Fe(),S=(0,c.useRef)(),{hourInitial:E,hourFinal:O}=Le(e),[T,N]=(0,c.useState)(E),[I,A]=(0,c.useState)(null===(t=null==e?void 0:e.initialHourmeter)||void 0===t?void 0:t.toFixed(1));(0,c.useEffect)((()=>{var t;A(null===(t=null==e?void 0:e.initialHourmeter)||void 0===t?void 0:t.toFixed(1))}),[e]);const[C,Z,w]=((e,t)=>{const[i,n]=(0,c.useState)(!1),[s,l]=(0,c.useState)(!0),[a,o]=(0,c.useState)(!0);return(0,c.useEffect)((()=>{var i,s,a,r;const d=e.find((e=>e.deviceId===t.deviceId));n(!1),l(!1),o(!1),(null==d?void 0:d.historyShiftList.length)>1&&(o(!0),l(!1)),(null===(s=null===(i=null==d?void 0:d.historyShiftList)||void 0===i?void 0:i.at(-1))||void 0===s?void 0:s.id)===(null==t?void 0:t.id)&&(n(!0),l(!1)),(null===(r=null===(a=null==d?void 0:d.historyShiftList)||void 0===a?void 0:a[0])||void 0===r?void 0:r.id)===(null==t?void 0:t.id)&&(n(!1),l(!0))}),[t]),[i,s,a]})(h,e),[D]=we(h,e),[F,L]=(0,c.useState)(!1);(0,c.useEffect)((()=>{var t;const{hourInitial:i}=Le(e);N(i),A(null===(t=null==e?void 0:e.initialHourmeter)||void 0===t?void 0:t.toFixed(1)),S.current&&setTimeout((()=>{S.current.focus()}),100)}),[e]);const R=(null==e?void 0:e.finalHourmeter)-(null==e?void 0:e.initialHourmeter),k=e=>De(void 0,void 0,void 0,(function*(){"Enter"===e.key&&P()})),P=()=>De(void 0,void 0,void 0,(function*(){var t,i;const[n,s]=T.split(":"),[l,a]=E.split(":"),o=(Number(n),Number(l),Number(s),Number(a),{});o.id=e.id,o.deviceId=e.deviceId,o.deviceAlias=e.deviceAlias,o.initialHourmeter=I,o.finalHourmeter=e.finalHourmeter,o.initialState=e.initialState,o.finalState=e.finalState,o.date=(0,Ae.v)(new Date),o.time=T,e.finalTime&&(o.finalTime={seconds:null===(t=e.finalTime)||void 0===t?void 0:t.seconds}),o.shiftDate={seconds:null===(i=null==e?void 0:e.shiftDate)||void 0===i?void 0:i.seconds},o.shift=e.shift,yield p((0,j.yi)(o)),!1===x&&v&&p((0,j.IE)())}));return(0,n.jsx)(Ee.Z,Object.assign({elevation:4,className:y.root,style:{borderColor:d}},{children:(0,n.jsxs)(Ce.T5,Object.assign({alignItems:"center",justifyContent:"center",direction:"row",style:{gap:4,alignItems:"stretch"}},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"column",style:{height:"100%"}},{children:[(0,n.jsx)(Ce.P4,{children:(0,n.jsx)(ae.Z,{size:"small",label:null==e?void 0:e.deviceAlias})}),(0,n.jsx)(Ce.P4,{children:(0,n.jsx)(ae.Z,{style:{background:d,color:"#fff"},size:"small",label:(0,n.jsx)("span",Object.assign({style:{fontSize:9}},{children:null===(l=null===(i=null==e?void 0:e.initialEventState)||void 0===i?void 0:i.event)||void 0===l?void 0:l.name}))})}),(null===(a=e.initialEventState)||void 0===a?void 0:a.name)&&(0,n.jsx)(Ce.P4,{children:(0,n.jsx)(ae.Z,{style:{maxWidth:150,borderWidth:2,borderStyle:"solid",borderColor:d},size:"small",label:(0,n.jsx)("span",Object.assign({style:{fontSize:9}},{children:null===(o=e.initialEventState)||void 0===o?void 0:o.name}))})}),(0,n.jsx)(Ce.P4,{children:(0,n.jsx)(ae.Z,{size:"small",label:R>=0?`${R.toFixed(1)}h`:"..."})}),(0,n.jsx)(Ce.P4,{children:(0,n.jsx)(ae.Z,{size:"small",label:new Date(1e3*(null===(r=null==e?void 0:e.initialTime)||void 0===r?void 0:r.seconds)).toLocaleDateString()})})]}))})),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"column"},{children:[(0,n.jsx)(M.Z,{label:"Entrada",type:"time",disabled:Z,value:T,autoFocus:!0,onKeyDown:k,name:"timeStart",size:"small",inputRef:S,InputLabelProps:{shrink:!0,required:!0},onChange:e=>N(e.target.value)}),(0,n.jsx)(M.Z,{label:"Salida",type:"time",name:"timeEnd",size:"small",disabled:!0,value:O})]}))})),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"column"},{children:[(0,n.jsx)(M.Z,{label:"H. inicial",type:"number",name:"initialHourmeter",size:"small",disabled:!D,onKeyDown:k,value:I,style:{maxWidth:100},onChange:e=>A(e.target.value),InputLabelProps:{shrink:!0}}),(0,n.jsx)(M.Z,{label:"H. final ",name:"initialHourmeter",size:"small",disabled:!0,style:{maxWidth:100},value:e.finalHourmeter?e.finalHourmeter.toFixed(1):"...",InputLabelProps:{shrink:!0}})]}))})),!Z&&(0,n.jsx)(Ze.d,{size:"small",variant:"contained",color:"secondary",onClick:P,text:"GUARDAR",loading:x}),C&&(0,n.jsx)(Oe.ZP,Object.assign({title:"Doble click para borrar"},{children:(0,n.jsx)(Ze.d,{size:"small",variant:"contained",onDoubleClick:()=>De(void 0,void 0,void 0,(function*(){const t={};t.id=e.id,t.deviceId=e.deviceId,yield p((0,j.Td)(t)),!1===b&&v&&(L(!1),p((0,j.IE)()))})),style:{background:"rgb(154, 0, 54)",color:"white"},startIcon:(0,n.jsx)(Te.Z,{}),loading:b,text:"Borrar"})}))]}))}))};var He=i(60395);const ke=({timeline:e})=>{var t,i;const{eventStateList:l,statusEventStateList:a}=(0,m.C)(F.eG),[o]=(0,g.r)(a);console.log("loadingEventStateList",o,a);const d=new Date,u=`0${d.getHours()}`,v=`0${d.getMinutes()}`,h=(0,Ie.I0)(),f=Fe(),x=(0,c.useRef)(),[b,p]=(0,c.useState)(`${u.slice(-2)}:${v.slice(-2)}`),[y]=B(b),[S]=function(e,t){const[i,n]=(0,c.useState)(0);return(0,c.useEffect)((()=>{var i,s,l;const a=new Date;a.setHours(Number.parseInt(e.split(":")[0])),a.setMinutes(Number.parseInt(e.split(":")[1]));const o=new Date(1e3*(null===(i=null==t?void 0:t.initialTime)||void 0===i?void 0:i.seconds));var r=(a.getTime()-o.getTime())/1e3;let d=1/60*Math.ceil(r/60);const c=t.initialHourmeter+Number.parseFloat(d);return(null===(l=null===(s=t.initialEventState)||void 0===s?void 0:s.event)||void 0===l?void 0:l.event)===Z.EnumEvent.NO_OPERATIONAL?n(Number.parseFloat(t.initialHourmeter.toFixed(1))):n(Number.parseFloat(c.toFixed(1))),()=>{n(0)}}),[e,t]),[i]}(b,e),[E,O]=(0,c.useState)("");(0,c.useEffect)((()=>{setTimeout((()=>{O(S)}),100)}),[S]),(0,c.useEffect)((()=>{h((0,D.Gy)(Z.EnumEvent.MAINTENANCE))}),[]);const[T,N]=c.useState();return(0,n.jsx)(He.Z,Object.assign({component:"form",onSubmit:t=>{return i=void 0,n=void 0,a=function*(){var i;t.preventDefault();const n={},s=l.find((e=>e.eventState===T));n.deviceId=null==e?void 0:e.deviceId,n.deviceAlias=null==e?void 0:e.deviceAlias,n.assetType=null==e?void 0:e.assetType,n.initialHourmeter=E,n.initialState=Z.EnumEvent.MAINTENANCE,n.initialEventState=s,n.date=y,n.time=b,n.shiftDate={seconds:null===(i=null==e?void 0:e.shiftDate)||void 0===i?void 0:i.seconds},n.shift=null==e?void 0:e.shift,n.eventState=s,yield h((0,j.lY)(n))},new((s=void 0)||(s=Promise))((function(e,t){function l(e){try{r(a.next(e))}catch(e){t(e)}}function o(e){try{r(a.throw(e))}catch(e){t(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(l,o)}r((a=a.apply(i,n||[])).next())}));var i,n,s,a}},{children:(0,n.jsx)(Ee.Z,Object.assign({elevation:4,className:f.root,style:{borderColor:k(Z.EnumEvent.MAINTENANCE)}},{children:(0,n.jsxs)(Ce.T5,Object.assign({alignItems:"center",justifyContent:"center",direction:"row",style:{gap:4,alignItems:"stretch"}},{children:[(0,n.jsxs)(s.Z,Object.assign({item:!0,direction:"column"},{children:[(0,n.jsx)(Ce.P4,{children:(0,n.jsx)(ae.Z,{size:"small",label:null==e?void 0:e.deviceAlias})}),(0,n.jsx)(Ce.P4,{children:(0,n.jsx)(ae.Z,{style:{background:k(Z.EnumEvent.MAINTENANCE),color:"#fff"},size:"small",label:(0,n.jsx)("span",Object.assign({style:{fontSize:9}},{children:null===(i=null===(t=l[0])||void 0===t?void 0:t.event)||void 0===i?void 0:i.name}))})})]})),(0,n.jsxs)(s.Z,Object.assign({item:!0},{children:[(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"row",justifyContent:"space-between"},{children:[(0,n.jsx)(M.Z,{required:!0,label:"Entrada",type:"time",value:b,autoFocus:!0,name:"timeStart",size:"small",inputRef:x,InputLabelProps:{shrink:!0,required:!0},onChange:e=>p(e.target.value)}),(0,n.jsx)(M.Z,{required:!0,label:"H. de entreda",type:"number",name:"initialHourmeter",size:"small",value:E,style:{maxWidth:100},onChange:e=>O(e.target.value),InputLabelProps:{shrink:!0,required:!0}})]})),(0,n.jsx)(s.Z,Object.assign({container:!0,item:!0,direction:"row"},{children:(0,n.jsx)(le.Z,{required:!0,value:"",placeholder:"Estado",loading:o,iteams:l.map((e=>({value:e.eventState,tittle:e.name}))),selectValue:N})}))]})),(0,n.jsx)(r.Z,Object.assign({size:"small",type:"submit",variant:"contained",color:"secondary"},{children:"GUARDAR"}))]}))}))}))},Pe=(0,T.Z)({layoutPopper:{position:"absolute",top:0,bottom:0,right:0,left:0,zIndex:3},arrowPopper:{width:11,height:4,background:e=>e.color,transform:"translateX(-7px) rotate(40deg)"},rootPopper:{zIndex:5,marginTop:8,marginLeft:6}}),ze=()=>{var e,t;const i=(0,m.T)(),{currentTimeline:s,currentMantoTimeline:l}=(0,m.C)(j.yV),[a,o]=(0,c.useState)(null);(0,c.useEffect)((()=>{if(s){const e=document.getElementById(`state-${(null==s?void 0:s.id)?null==s?void 0:s.id:null==s?void 0:s.deviceId}`);e&&o(e),s&&i((0,j.Gf)())}}),[s]),(0,c.useEffect)((()=>{if(l){const e=document.getElementById(`stateManto-${(null==l?void 0:l.id)?null==l?void 0:l.id:null==l?void 0:l.deviceId}`);e&&o(e),l&&i((0,j.IE)())}}),[l]);const r=s?H(s):"#fff",d=Pe({color:r});return a&&(s||l)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(Se.Z,Object.assign({open:!!s||!!l,className:d.rootPopper,anchorEl:a,placement:"right-start"},{children:[l&&(null===(t=null===(e=l.initialEventState)||void 0===e?void 0:e.event)||void 0===t?void 0:t.event)!==Z.EnumEvent.MAINTENANCE&&(0,n.jsxs)(c.Fragment,{children:[(0,n.jsx)("div",{className:d.arrowPopper}),(0,n.jsx)(ke,{timeline:l})]}),s&&(0,n.jsxs)(c.Fragment,{children:[(0,n.jsx)("div",{className:d.arrowPopper}),(0,n.jsx)(Re,{timeline:s})]})]})),(0,n.jsx)("div",{onClick:()=>{i((0,j.IE)()),i((0,j.Gf)())},className:d.layoutPopper})]}):(0,n.jsx)(n.Fragment,{})};var Me=i(57163);const _e=e=>{const[t,i]=(0,c.useState)(!0);return(0,c.useEffect)((()=>{i(!0),e===pe.TimelinesShiftResponse.State.CLOSED&&i(!0),e===pe.TimelinesShiftResponse.State.IN_PROGRESS&&i(!1)}),[e]),{state:t}},We=()=>{const[e,t]=(0,c.useState)({flex:0,time:0}),[i]=(0,v.R)();return(0,c.useEffect)((()=>{i.getHours()>=7&&i.getHours()<19?t(R(f.Shift.DAY)):t(R(f.Shift.NIGHT)),setInterval((()=>{i.getHours()>=7&&i.getHours()<19?t(R(f.Shift.DAY)):t(R(f.Shift.NIGHT))}),5e3)}),[]),{currentLine:e}},Ge=(0,T.Z)((()=>({root:{position:"absolute",display:"flex",bottom:0,right:400,left:50,top:-4},itemHour:{flex:1,borderRightColor:"grey",borderRightWidth:1,borderRightStyle:"dashed",position:"relative"},labelItemHour:{color:"rgb(131 126 126)",position:"absolute",left:-19,top:-8,background:"white",userSelect:"none"},labelContainerHour:{zIndex:5,top:90,position:"sticky"},rootTimeline:{position:"absolute",right:0,height:"100%",left:0,display:"flex",zIndex:0},beforeTimeline:{height:0},afterTimeline:{height:0,borderRightColor:"#ccc",borderRightWidth:1,borderRightStyle:"dashed"},line:{width:1,background:u.Jx,height:"100%"},rootLine:{paddingTop:8,height:"100%"},labelTitle:{color:"rgb(131 126 126)",background:"white",userSelect:"none"},labelContainer:{top:80,position:"sticky",height:10,background:"#fafafa",width:80,zIndex:2},rootRigth:{textAlign:"center",position:"absolute",display:"flex",bottom:0,right:0,top:-14}}))),$e=({shift:e})=>{const{currentLine:t}=We(),i=Ge(),l=(e=>e===f.Shift.DAY?[7,8,9,10,11,12,13,14,15,16,17,18]:[19,20,21,22,23,0,1,2,3,4,5,6])(e),a=(0,c.useMemo)((()=>l.map(((e,t)=>(0,n.jsx)("div",Object.assign({className:i.itemHour},{children:(0,n.jsx)("div",Object.assign({className:i.labelContainerHour},{children:(0,n.jsxs)("label",Object.assign({className:i.labelItemHour},{children:[`0${e}`.slice(-2),":00"]}))}))}),t)))),[l]);return(0,n.jsxs)(c.Fragment,{children:[(0,n.jsxs)(s.Z,Object.assign({className:i.root},{children:[a,(0,n.jsxs)("div",Object.assign({className:i.rootTimeline},{children:[(0,n.jsx)("div",{className:i.beforeTimeline,style:{flex:t.flex}}),(0,n.jsx)("div",Object.assign({className:i.rootLine},{children:(0,n.jsx)("div",{className:i.line})})),(0,n.jsx)("div",{className:i.afterTimeline,style:{flex:1-t.flex}})]}))]})),(0,n.jsxs)(s.Z,Object.assign({className:i.rootRigth},{children:[(0,n.jsx)("div",Object.assign({className:i.labelContainer},{children:(0,n.jsx)("label",Object.assign({className:i.labelTitle},{children:"Nombre"}))})),(0,n.jsx)("div",Object.assign({className:i.labelContainer},{children:(0,n.jsx)("label",Object.assign({className:i.labelTitle},{children:"Inicial"}))})),(0,n.jsx)("div",Object.assign({className:i.labelContainer},{children:(0,n.jsx)("label",Object.assign({className:i.labelTitle},{children:"Proyectado"}))})),(0,n.jsx)("div",Object.assign({className:i.labelContainer},{children:(0,n.jsx)("label",Object.assign({className:i.labelTitle},{children:"Ajuste"}))})),(0,n.jsx)("div",Object.assign({className:i.labelContainer},{children:(0,n.jsx)("label",Object.assign({className:i.labelTitle},{children:"Final"}))}))]}))]})};var Ue=i(95875),Ve=i(50743),Be=i(61201),qe=i(64566);const Ke=e=>{const[t,i]=(0,c.useState)("");return(0,c.useEffect)((()=>{var t;const n=null===(t=null==e?void 0:e.deviceAlias)||void 0===t?void 0:t.split("-"),s=1===n.length?n[0]:`${n[0]}${n[1].slice(-3)}`;i(s)}),[e]),[t]},Ye=(0,T.Z)((()=>({rootUnitState:{height:2,position:"relative"},dotUnitState:{width:12,height:12,borderRadius:6,background:"#fff",position:"absolute",borderColor:"#6d6c6c",borderWidth:2,borderStyle:"solid",top:-5,left:-4,zIndex:5,cursor:"pointer"},dotUnitStateCurrent:{width:12,height:12,borderRadius:6,position:"absolute",top:-5,right:-5,zIndex:4,cursor:"pointer"},dotLabelHour:{fontSize:9,position:"absolute",left:-4,bottom:-15,userSelect:"none"},rootRowTimeline:{background:e=>e.indexTimeline%2!=0?"#cccccc52":"#fff","&:hover, &:focus":{backgroundColor:"#ccc"}}}))),Je=(e,t,i,n)=>{if(e<0)return null;let s;const l=i?`${n}${e===t?0:e+1}`:`${n}${0===e?t:e-1}`;return s=document.getElementById(l),setTimeout((()=>{s.setSelectionRange(s.value.length,s.value.length)}),10),s&&s.disabled&&(s=null),!s&&e<t&&0!==e?Je(i?e+1:e-1,t,i):s};const Xe=(0,T.Z)((()=>({borderLeft:{borderLeftColor:"gray",borderLeftWidth:1,borderLeftStyle:"dashed",width:80,paddingLeft:4,zIndex:1},inputHourmeterFinal:{borderColor:e=>e.error?"orange":"#ccc",borderRadius:2,width:80,paddingLeft:4,zIndex:1,"&:focus":{background:"#1D4E89",color:"white",fontWeight:900}},borderAdjustement:{borderLeftColor:"gray",borderLeftWidth:1,borderLeftStyle:"dashed",color:e=>e.errorAjustment?"red":"grey",textAlign:"center",width:80},borderAdjustementCloseShift:{borderLeftColor:"gray",borderLeftWidth:1,borderLeftStyle:"dashed",color:e=>e.errorAjustmentCloseShift?"red":"grey",textAlign:"center",width:80}}))),Qe=({currentTimeline:e,index:t,lastIndex:i,idInitial:l,timeFinal:a,setTimeFinal:o})=>{var r,d,u,v,h,g,f,x,b,p,y;const S=(0,m.T)(),{unitSelectTimelineList:E,historyTimelineShift:O,stateShift:T}=(0,m.C)(j.yV),{}=We(),[N,I]=(0,c.useState)("2222"),{error:A,textInput:w,onChangeText:D,onKeyDown:F}=(({currentState:e,setTimeFinal:t,timeFinal:i,historyTimelineShift:n})=>{const[s,l]=(0,C._)("close_shift_units",[]),[a,o]=(0,c.useState)(null),[r,d]=(0,c.useState)(""),[u,v]=(0,c.useState)(!1),[h]=we(n,e),{timelineError:g}=(0,m.C)(j.yV);(0,c.useEffect)((()=>{f(0)}),[]),(0,c.useEffect)((()=>{if(null!=typeof g.code&&410===g.code&&0!=e.finalHourmeter){let t=e.finalHourmeter.toFixed(1).toString();d(t),f(Number(t))}}),[g.code]);const f=t=>{const i=localStorage.getItem("close_shift_units"),n=i?JSON.parse(i):[],s=n.findIndex((t=>t.deviceId===e.deviceId)),a={deviceAlias:e.deviceAlias,deviceId:e.deviceId,hourmeter:t>0?parseFloat(t.toFixed(1)):0,time:t>0?(new Date).getTime()/1e3:0},o=[...n];-1===s?o.push(a):o[s]=a,l(o)};return{error:u,textInput:r,setTextInput:d,timeFinal:i,setTimeFinal:t,onChangeText:i=>{let n=i.target.value;h&&!n&&(n=""),i.target.value||(n=0===e.finalHourmeter?"":e.finalHourmeter.toFixed(1).toString(),""===i.target.value&&0==e.finalHourmeter&&(n=""),h&&(n="")),!i.target.value&&Object.entries(i).length>1&&(n=i.target.value),d(n),t(i.target.value?(new Date).getTime()/1e3:-1),f(Number(n))},onKeyDown:()=>{clearTimeout(a)}}})({currentState:e,setTimeFinal:o,timeFinal:a,historyTimelineShift:O}),[L]=((e,t,i)=>{const[n,s]=(0,c.useState)(""),[l]=((e,t)=>{const[i,n]=(0,c.useState)(!1);return(0,c.useEffect)((()=>{var i,s;n(!1);const l=null==e?void 0:e.find((e=>e.deviceId===t.deviceId)),a=null==l?void 0:l.historyShiftList.findIndex((e=>e.id===t.id)),o=null==l?void 0:l.historyShiftList.at(a-1);(null===(s=null===(i=null==o?void 0:o.initialEventState)||void 0===i?void 0:i.event)||void 0===s?void 0:s.event.toString())===Z.EnumEvent.MAINTENANCE.toString()&&n(!0)}),[t,e]),[i]})(e,t);return(0,c.useEffect)((()=>{var e,n;(null===(n=null===(e=t.initialEventState)||void 0===e?void 0:e.event)||void 0===n?void 0:n.event)===Z.EnumEvent.MAINTENANCE?s(t.initialHourmeter.toFixed(1)):s(""===i?i:"number"==typeof i?parseFloat(i).toFixed(1):i),l&&s(i)}),[i,l]),[n]})(O,e,w),[R]=Ke(e),{editHourmeter:H,intialHourmeter:k,handleEditHourmeter:P,handleLabelInitialHourmeter:z,handlesetIntialHourmeter:M}=(e=>{const[t,i]=(0,c.useState)(""),n=(0,m.T)(),[s,l]=(0,c.useState)(!1),[a]=V(),{historyTimelineShift:o}=(0,m.C)(j.yV),r=o.find((t=>t.deviceId===e.deviceId)),d=e=>{i(e)};return{editHourmeter:s,intialHourmeter:t,handleEditHourmeter:e=>{return t=void 0,i=void 0,a=function*(){var t;if("Escape"===e.key&&l(!1),"Enter"===e.key){const i=Object.assign(Object.assign({},r.historyShiftList[0]),{initialHourmeter:null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value});yield n((0,j.xe)(i)),l(!1)}},new((s=void 0)||(s=Promise))((function(e,n){function l(e){try{r(a.next(e))}catch(e){n(e)}}function o(e){try{r(a.throw(e))}catch(e){n(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(l,o)}r((a=a.apply(t,i||[])).next())}));var t,i,s,a},handleLabelInitialHourmeter:()=>{var t,i;l(!0),d(null===(i=null===(t=r.historyShiftList[0])||void 0===t?void 0:t.initialHourmeter)||void 0===i?void 0:i.toFixed(1)),setTimeout((()=>{const t=null==e?void 0:e.id;document.getElementById(t).focus()}),100)},handlesetIntialHourmeter:d}})(e),_=()=>{""!=w&&(S((0,j.r6)({truck:{deviceId:e.deviceId,deviceAlias:e.deviceAlias},hourmeter:w?parseFloat(w):0})),D({target:{value:w}}))},W=((e,t)=>{var i,n,s,l,a,o;if((null===(n=null===(i=e.initialEventState)||void 0===i?void 0:i.event)||void 0===n?void 0:n.event)!==Z.EnumEvent.NO_OPERATIONAL&&(null===(l=null===(s=e.initialEventState)||void 0===s?void 0:s.event)||void 0===l?void 0:l.event)!==Z.EnumEvent.MAINTENANCE){if(-1===t){const t=((new Date).getTime()/1e3-(null===(a=null==e?void 0:e.initialTime)||void 0===a?void 0:a.seconds))/3600;return(e.initialHourmeter+t).toFixed(1)}const i=((t||(new Date).getTime()/1e3)-(null===(o=null==e?void 0:e.initialTime)||void 0===o?void 0:o.seconds))/3600;return(e.initialHourmeter+i).toFixed(1)}return e.initialHourmeter.toFixed(1)})(e,Number(a)),G=null==O?void 0:O.find((t=>t.deviceId===e.deviceId)),$=Number(w)>0?Number(w)-(null===(u=null===(d=null===(r=null==G?void 0:G.historyShiftList)||void 0===r?void 0:r.at(-1))||void 0===d?void 0:d.initialHourmeter)||void 0===u?void 0:u.toFixed(1)):0,U=$>=.3||$<=-.3,B=(null===(v=null==G?void 0:G.currentTimeline)||void 0===v?void 0:v.adjustment.toFixed(1))>=.3||(null===(h=null==G?void 0:G.currentTimeline)||void 0===h?void 0:h.adjustment.toFixed(1))<=-.3,q=Xe({error:A,errorAjustment:U,errorAjustmentCloseShift:B}),K=(0,c.useCallback)((()=>E.some((t=>t.deviceId===e.deviceId))),[E]);return(0,c.useEffect)((()=>{K()&&S((0,j.Z7)(e))}),[e]),(0,c.useEffect)((()=>{D({target:{value:""}})}),[null===(f=null===(g=e.initialEventState)||void 0===g?void 0:g.event)||void 0===f?void 0:f.event]),(0,n.jsxs)(s.Z,Object.assign({style:{width:400,display:"flex",textAlign:"center"}},{children:[(0,n.jsxs)("label",Object.assign({style:{width:30,userSelect:"none",flex:2}},{children:[(0,n.jsx)(ie.Z,{onClick:()=>{S((0,j.WZ)(e))},checked:K(),style:{padding:0,flex:1,zIndex:1},size:"small"}),R]})),!H&&(0,n.jsx)("label",Object.assign({className:q.borderLeft,onDoubleClick:z},{children:null===(b=null===(x=null==G?void 0:G.historyShiftList[0])||void 0===x?void 0:x.initialHourmeter)||void 0===b?void 0:b.toFixed(1)})),H&&(0,n.jsx)("input",{id:e.id,className:q.borderLeft,type:"number",value:k,onChange:e=>M(e.currentTarget.value),name:"hourmeterInitial",onKeyUp:e=>P(e)}),(0,n.jsx)("label",Object.assign({className:q.borderLeft},{children:W})),T===pe.TimelinesShiftResponse.State.IN_PROGRESS?(0,n.jsxs)(c.Fragment,{children:[(0,n.jsx)("label",Object.assign({className:q.borderAdjustement},{children:Number(w).toFixed(1)?$.toFixed(1):"...."})),(0,n.jsx)("input",{id:`${l}${t}`,className:q.inputHourmeterFinal,value:w,type:"text",pattern:"[0-9]+([.,][0-9]+)?",onChange:e=>function(e){const t=e.currentTarget.value;""===t&&D(Object.assign({target:{value:t}},e)),!isNaN(parseFloat(t))&&isFinite(t)&&D(Object.assign({target:{value:t}},e))}(e),autoComplete:"off",onKeyDown:e=>{let n=null;switch(e.key){case"ArrowDown":case"Enter":n=Je(t,i,!0,l),_();break;case"ArrowUp":n=Je(t,i,!1,l),_();break;default:F()}n&&n.focus()},placeholder:e.deviceAlias,onBlur:_})]}):(0,n.jsxs)(c.Fragment,{children:[(0,n.jsx)("label",Object.assign({className:q.borderAdjustementCloseShift},{children:null===(p=null==G?void 0:G.currentTimeline)||void 0===p?void 0:p.adjustment.toFixed(1)})),(0,n.jsx)("label",Object.assign({className:q.inputHourmeterFinal},{children:null===(y=null==G?void 0:G.currentTimeline)||void 0===y?void 0:y.finalHourmeter.toFixed(1)}))]})]}))},et=({currentTimeline:e,timeFinal:t})=>{var i,l;const a=(0,m.T)(),{}=We(),o=Ye({}),r=new Date(1e3*(null===(i=null==e?void 0:e.initialTime)||void 0===i?void 0:i.seconds)).getMinutes(),[d,u]=(0,c.useState)(((t>0?t:(new Date).getTime()/1e3)-(null===(l=null==e?void 0:e.initialTime)||void 0===l?void 0:l.seconds))/L);(0,c.useEffect)((()=>{var i;u(((t>0?t:(new Date).getTime()/1e3)-(null===(i=null==e?void 0:e.initialTime)||void 0===i?void 0:i.seconds))/L);const n=setInterval((()=>{var i;u(((t>0?t:(new Date).getTime()/1e3)-(null===(i=null==e?void 0:e.initialTime)||void 0===i?void 0:i.seconds))/L)}),5e3);return()=>{window.clearInterval(n)}}),[e]);const v=H(e);return(0,n.jsxs)("div",Object.assign({className:o.rootUnitState,style:{flex:d||0,background:v}},{children:[(0,n.jsx)(s.Z,{className:o.dotUnitState,onClick:()=>a((0,j.Sf)(e)),style:{flex:d||0,borderColor:H(e)},id:`state-${e.id?e.id:e.deviceId}`}),r?(0,n.jsx)("label",Object.assign({className:o.dotLabelHour},{children:`0${r}`.slice(-2)})):(0,n.jsx)(n.Fragment,{}),(0,n.jsx)(s.Z,{className:o.dotUnitStateCurrent,id:`stateManto-${e.id?e.id:e.deviceId}`,onClick:()=>a((0,j.MD)(e)),style:{background:v}})]}))},tt=({currentTimeline:e})=>{const[t]=(e=>{const[t]=(0,v.R)(),[i,n]=(0,c.useState)(0);return(0,c.useEffect)((()=>{var i;t.getHours()>=7&&t.getHours()<19?(t.setHours(7),t.setMinutes(0),t.setSeconds(0)):(t.setHours(19),t.setMinutes(0),t.setSeconds(0));const s=(new Date).getTime()/1e3,l=null===(i=null==e?void 0:e.initialTime)||void 0===i?void 0:i.seconds,a=l>s?l:s;return n((t.getTime()/1e3-a)/L),()=>{}}),[e]),[i]})(e),[i]=(e=>{const{}=We(),[t,i]=(0,c.useState)("#ccc");return(0,c.useEffect)((()=>{var t;(null===(t=null==e?void 0:e.initialEventState)||void 0===t?void 0:t.eventState)===$.EnumEventState.CHANGE_OF_SHIFT&&i(H(e)),i("#ccc")}),[e]),[t]})(e);return(0,n.jsx)("div",Object.assign({style:{flex:t,height:12,display:"flex",alignItems:"center"}},{children:(0,n.jsx)("div",{style:{width:"100%",background:i,height:1}})}))},it=({state:e,line:t,setState:i})=>{const l=(0,m.T)(),{currentTimeline:a}=(0,Ie.v9)(j.yV),o=Ye({}),r=(0,c.useRef)(),d=(0,c.useCallback)((()=>{l((0,j.Sf)(e))}),[e]);return(0,c.useEffect)((()=>{(null==a?void 0:a.id)===e.id&&l((0,j.Sf)(e))}),[e]),(0,n.jsx)(s.Z,{id:`state-${e.id?e.id:e.deviceId}`,className:o.dotUnitState,onClick:d,ref:r,style:{borderColor:H(e)}})},nt=({state:e})=>{var t;const[i,s]=(0,c.useState)(e),[l]=(e=>{const[t,i]=(0,c.useState)(0);return(0,c.useEffect)((()=>{var t,n;i((null==e?void 0:e.finalTime)?(null===(t=null==e?void 0:e.finalTime)||void 0===t?void 0:t.seconds)-(null===(n=null==e?void 0:e.initialTime)||void 0===n?void 0:n.seconds):0)}),[e]),[t]})(i);(0,c.useEffect)((()=>{s(e)}),[e]);const a=(0,c.useRef)(),o=new Date(1e3*(null===(t=null==i?void 0:i.initialTime)||void 0===t?void 0:t.seconds)).getMinutes(),r=Ye({});return(0,n.jsxs)("div",Object.assign({className:r.rootUnitState,style:{flex:l/L,zIndex:4,background:H(i)},ref:a},{children:[(0,n.jsx)(it,{state:i,line:a,setState:s}),o?(0,n.jsx)("label",Object.assign({className:r.dotLabelHour},{children:`0${o}`.slice(-2)})):(0,n.jsx)(n.Fragment,{})]}))},st=({states:e,currentTimeline:t,timeFinal:i})=>{const[l,a]=(0,c.useState)(t);if((0,c.useEffect)((()=>{a(t)}),[l,e]),!e)return(0,n.jsx)(n.Fragment,{});const o=e.at(-1);return(0,n.jsx)(s.Z,Object.assign({item:!0,style:{flex:1,marginTop:2,marginBottom:2}},{children:(0,n.jsxs)(Ce.T5,Object.assign({alignItems:"center"},{children:[null==e?void 0:e.map((e=>(null==e?void 0:e.id)===(null==o?void 0:o.id)?(0,n.jsx)(et,{currentTimeline:e,timeFinal:i},null==e?void 0:e.id):(0,n.jsx)(nt,{state:e},null==e?void 0:e.id))),(0,n.jsx)(tt,{currentTimeline:o})]}))}))},lt=({index:e,lastIndex:t,timeline:i,idInitial:l})=>{const[a,o]=(0,c.useState)(-1),[r]=Ke(i),d=Ye({indexTimeline:e});return(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"row",alignItems:"center",className:d.rootRowTimeline},{children:[(0,n.jsx)("label",Object.assign({style:{width:50,userSelect:"none"}},{children:r})),(0,n.jsx)(st,{setTimeFinal:o,timeFinal:a,states:i.historyShiftList,currentTimeline:i.currentTimeline},e),(0,n.jsx)(Qe,{states:i.historyShiftList,currentTimeline:i.currentTimeline,index:e,idInitial:l,lastIndex:t,timeFinal:a,setTimeFinal:o})]}),e)},at=(0,T.Z)((e=>(0,N.Z)({root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},muiAccordionDetails:{padding:0},muiAccordionSummary:{}}))),ot=({historyTimelineShift:e,title:t})=>{const i=at(),[l,a]=(0,c.useState)(t);return(0,n.jsx)("div",Object.assign({className:i.root},{children:(0,n.jsxs)(Ue.Z,Object.assign({expanded:l===t,onChange:(o=t,(e,t)=>{a(!!t&&o)})},{children:[(0,n.jsx)(Ve.Z,Object.assign({style:{zIndex:1},expandIcon:(0,n.jsx)(qe.Z,{}),"aria-controls":`${t}-content`,id:`${t}-header`,className:i.muiAccordionSummary},{children:(0,n.jsx)(xe.Z,Object.assign({className:i.heading},{children:t}))})),(0,n.jsx)(Be.Z,Object.assign({className:i.muiAccordionDetails},{children:(0,n.jsx)(s.Z,Object.assign({container:!0,style:{position:"relative",paddingTop:8,borderColor:"#000"}},{children:(null==e?void 0:e.length)>0&&l===t&&(null==e?void 0:e.map(((i,s)=>i.currentTimeline&&(0,n.jsx)(lt,{index:s,lastIndex:(null==e?void 0:e.length)-1,timeline:i,idInitial:t},`${i.deviceId}-${s}`))))}))}))]}))}));var o},rt=({shift:e})=>{const{stateShift:t,historyTimelineShift:i,UnitCurrentTimeline:l}=(0,m.C)(j.yV),a=(0,m.T)(),[o]=(({array:e,current:t,findIndex:i})=>{const[n,s]=(0,c.useState)([...e]);return(0,c.useEffect)((()=>{s(e);const n=i();let l=[];if(l=[...e],Array.isArray(t)&&Array.isArray(n))for(let e=0;e<t.length;e++)for(let i=0;i<n.length;i++)e==i&&(l[n[i]]=t[i]);Array.isArray(n)||n>-1&&(l[n]=t),s(l)}),[t]),[n]})({array:i,current:l,findIndex:()=>(()=>{let e=[];return Array.isArray(l)?l.forEach((t=>{const n=i.findIndex((e=>t.deviceId===e.deviceId));-1!==n&&Array.isArray(e)&&(console.log("i",n),e.push(n))})):e=i.findIndex((e=>e.deviceId===l.deviceId)),e})()});(0,c.useEffect)((()=>{o.length>1&&a((0,j.$S)(o))}),[o]);const{trucks:r,excavators:d,yellowMaquinary:u}=(e=>{const[t,i]=(0,c.useState)([]),[n,s]=(0,c.useState)([]),[l,a]=(0,c.useState)([]);return(0,c.useEffect)((()=>{const t=e.filter((e=>e.assetType===Me.EnumAssetType.TRUCK));i(t);const n=e.filter((e=>e.assetType===Me.EnumAssetType.EXCAVATOR));s(n);const l=e.filter((e=>e.assetType!=Me.EnumAssetType.EXCAVATOR&&e.assetType!=Me.EnumAssetType.TRUCK));a(l)}),[e]),{trucks:t,excavators:n,yellowMaquinary:l}})(i),{state:v}=_e(t);return(0,n.jsxs)(s.Z,Object.assign({container:!0,style:{position:"relative",paddingTop:8,borderColor:"#000"}},{children:[v&&(0,n.jsx)("div",{style:{position:"absolute",background:"#51515124",width:"100%",height:"100%",zIndex:999}}),r.length>0&&(0,n.jsx)(ot,{historyTimelineShift:r,title:"camiones"}),d.length>0&&(0,n.jsx)(ot,{historyTimelineShift:d,title:"excavadoras"}),u.length>0&&(0,n.jsx)(ot,{historyTimelineShift:u,title:"otra maquinaria"}),(0,n.jsx)(ze,{}),(0,n.jsx)($e,Object.assign({},{shift:e}))]}))},dt=({setForms:e})=>{const[t,i]=c.useState(),[l,a]=c.useState(),[o]=(0,h.l)(new Date),[r]=(0,h.l)(new Date((new Date).getTime()-3456e5)),[d]=(0,h.l)(new Date),[u,v,m,g]=(0,ne.M)({guard:be.EnumGuard.UNKNOWN_GUARD,shift:f.Shift.UNKNOWN_SHIFT,shiftDate:d}),{shiftDate:j}=u;return(0,c.useEffect)((()=>{g(Object.assign(Object.assign({},u),{shift:l,guard:t}))}),[t,l]),(0,c.useEffect)((()=>(e(u),()=>{})),[u]),(0,n.jsx)(c.Fragment,{children:(0,n.jsx)(He.Z,Object.assign({component:"form",sx:{mt:1}},{children:(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:2,justifyContent:"space-between"},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,xs:12,sm:12,md:6},{children:(0,n.jsx)(le.Z,{required:!0,placeholder:"Turno",iteams:[{value:f.Shift.DAY,tittle:"Dia"},{value:f.Shift.NIGHT,tittle:"Noche"}],selectValue:a})})),(0,n.jsx)(s.Z,Object.assign({item:!0,xs:12,sm:12,md:6},{children:(0,n.jsx)(le.Z,{required:!0,placeholder:"Guardia",iteams:[{value:be.EnumGuard.A,tittle:"A"},{value:be.EnumGuard.B,tittle:"B"},{value:be.EnumGuard.C,tittle:"C"}],selectValue:i})})),(0,n.jsx)(s.Z,Object.assign({item:!0,xs:12,sm:12,md:12},{children:(0,n.jsx)(M.Z,{style:{textAlign:"center"},variant:"outlined",onChange:v,value:j,disabled:!0,margin:"normal",required:!0,fullWidth:!0,id:"shiftDate",type:"date",name:"shiftDate",inputProps:{min:`${r}`,max:`${o}`},autoFocus:!0})}))]}))}))})},ct=()=>{const e=(0,m.T)(),{stateShift:t}=(0,m.C)(j.yV),[i,s]=(0,c.useState)(!1),[l,a]=(0,c.useState)(),[o]=X(l);return(0,c.useEffect)((()=>{window.localStorage.setItem("close_shift_units",JSON.stringify([]))}),[]),(0,n.jsxs)(c.Fragment,{children:[t===(null===pe.TimelinesShiftResponse||void 0===pe.TimelinesShiftResponse?void 0:pe.TimelinesShiftResponse.State.CLOSED)&&(0,n.jsx)(r.Z,Object.assign({color:"secondary",size:"small",variant:"contained",onClick:()=>{s(!0)}},{children:"INICIAR TURNO"})),(0,n.jsx)(b.a,Object.assign({open:i,handleClose:()=>{s(!1)},title:"Creación del turno para Horómetros",disabled:o,handleConfirm:()=>{const t=Object.assign(Object.assign({},l),{assetType:Me.EnumAssetType.UNKNOWN_ASSET_TYPE});e((0,j.Z3)(t)),localStorage.removeItem("close_shift_units"),s(!1)}},{children:(0,n.jsx)(dt,{setForms:a})}))]})};var ut=i(86842);const vt=new Date,mt=()=>{const e=(0,m.T)(),[t]=(0,v.R)(),{dateShiftSelect:i,shiftSelect:y,stateShift:S,statusCloseTimeline:E,statusGetTimeline:O,timelineError:T}=(0,m.C)(j.yV),{state:N}=_e(S),[I]=(0,g.r)(O),[A]=(0,g.r)(E),[C,Z]=(0,c.useState)(!1),w=new Date(vt.getTime()-26784e5),[D]=(0,h.l)(new Date(i));(0,c.useEffect)((()=>{e((0,j.tp)(t.getTime()))}),[t.getDate()]),(0,c.useEffect)((()=>{T.success&&A&&(localStorage.removeItem("close_shift_units"),location.reload())}),[A,T]);const F=t=>{e((0,j.Nx)(t))};return(0,c.useEffect)((()=>{t.getHours()>=7&&t.getHours()<19?e((0,j.Nx)(f.Shift.DAY)):e((0,j.Nx)(f.Shift.NIGHT))}),[]),(0,c.useEffect)((()=>{const t={shift:y,date:`${D}T00:00`};e((0,j.y1)(t))}),[D,y]),(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"row"},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,xs:12,style:{background:"#dbdbdb"}},{children:(0,n.jsx)(x.M,{startDate:w,days:31,marked:[{}],selectDate:new Date(i),getSelectedDay:t=>{e((0,j.tp)(t.getTime()))},color:"#024e8c"})})),(0,n.jsxs)(s.Z,Object.assign({item:!0,lg:12,md:12,xs:12},{children:[(0,n.jsxs)(s.Z,Object.assign({container:!0,item:!0,style:{marginBottom:16,marginTop:8,gap:4,position:"sticky",zIndex:6,top:50,background:`${u.Jx}`,borderTop:"2px ridge white",color:"white"},justifyContent:"space-between"},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsxs)(l.Z,Object.assign({row:!0,"aria-label":"shift",name:"shift",value:y,style:{marginRight:8}},{children:[(0,n.jsx)(a.Z,{value:f.Shift.DAY,control:(0,n.jsx)(o.Z,{style:{padding:0},size:"small",color:"primary"}),label:"Día",onClick:()=>F(f.Shift.DAY),labelPlacement:"start"}),(0,n.jsx)(a.Z,{value:f.Shift.NIGHT,control:(0,n.jsx)(o.Z,{style:{padding:0},size:"small",color:"primary"}),label:"Noche",onClick:()=>F(f.Shift.NIGHT),labelPlacement:"start"})]}))})),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(ye,{})})),(0,n.jsxs)(s.Z,Object.assign({container:!0,item:!0,style:{width:"auto"}},{children:[(0,n.jsx)(J,{stateShift:N}),N?(0,n.jsx)(ct,{}):(0,n.jsx)(r.Z,Object.assign({color:"secondary",disabled:N,style:{background:N?"grey":""},onClick:()=>{Z(!0)},size:"small",variant:"contained"},{children:"CERRAR TURNO"})),(0,n.jsx)(je,{})]}))]})),I?(0,n.jsx)(p.g,{}):(0,n.jsx)(rt,Object.assign({},{shift:y}))]})),(0,n.jsx)(b.a,{open:C,handleClose:()=>{Z(!1)},handleConfirm:()=>{return t=void 0,n=void 0,l=function*(){yield e((0,j.g1)({shiftDateString:new Date(i).toString(),shift:y}))},new((s=void 0)||(s=Promise))((function(e,i){function a(e){try{r(l.next(e))}catch(e){i(e)}}function o(e){try{r(l.throw(e))}catch(e){i(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(a,o)}r((l=l.apply(t,n||[])).next())}));var t,n,s,l},title:"¿Estás seguro de cerrar turno?",loading:A,children:(0,n.jsx)(d.Z,Object.assign({severity:"warning"},{children:"Una vez cerrado el turno no se podrá modificar"}))}),!!T.message&&(0,n.jsx)(ut.y,{error:T.message,success:T.success,callBack:()=>e((0,j.OL)())})]}))};var ht=i(49521);const gt=()=>(0,n.jsxs)("div",{children:[(0,n.jsx)(ht.h,{title:"Linea de tiempo"}),(0,n.jsx)("div",Object.assign({style:{marginTop:"48px"}},{children:(0,n.jsx)(mt,{})}))]}),ft=gt}}]);