"use strict";(self.webpackChunkdts_hytera=self.webpackChunkdts_hytera||[]).push([[633],{61242:(e,t,i)=>{i.d(t,{a:()=>u});var n=i(85893),s=i(41120),a=i(52663),o=i(66083),l=i(29525),r=i(66856),d=i(282);const c=(0,s.Z)({disabledPadding:{padding:0,textAlign:"center"}}),u=({open:e,handleClose:t,handleConfirm:i,title:s,children:u,maxWidth:v="lg",disabled:m=!1})=>{const h=c();return(0,n.jsxs)(a.Z,Object.assign({open:e,onClose:t,maxWidth:v},{children:[(0,n.jsx)(o.Z,Object.assign({className:h.disabledPadding},{children:s}),void 0),(0,n.jsx)(l.Z,{children:u},void 0),(0,n.jsxs)(r.Z,{children:[(0,n.jsx)(d.Z,Object.assign({size:"small",color:"primary",onClick:t},{children:"Cancel"}),void 0),i&&(0,n.jsx)(d.Z,Object.assign({disabled:m,variant:"outlined",size:"small",color:"secondary",onClick:i,autoFocus:!0},{children:"Confirm"}),void 0)]},void 0)]}),void 0)}},10646:(e,t,i)=>{i.d(t,{l:()=>n});const n=e=>[`${e.getFullYear()}-${`0${e.getMonth()+1}`.substr(-2)}-${`0${e.getDate()}`.substr(-2)}`]},88093:(e,t,i)=>{i.d(t,{R:()=>n});const n=()=>{var e=new Date;return e.getHours(),{dateShift:e.getHours()>=0&&e.getHours()<7?new Date(e.getTime()-864e5):e}}},9993:(e,t,i)=>{i.r(t),i.d(t,{HourmeterView:()=>Xe,default:()=>Qe});var n=i(85893),s=i(41749),a=i(10046),o=i(67294),l=i(88093),r=i(73855),d=i(10646),c=i(12207),u=i(74046),v=i(61242),m=i(60702),h=i(44562);const g=({error:e,index:t})=>{const[i,s]=o.useState(!0),[a,l]=o.useState({vertical:"bottom",horizontal:"right"}),{vertical:r,horizontal:d}=a,c=(e,t)=>{"clickaway"!==t&&s(!1)};return(0,n.jsx)(m.Z,Object.assign({anchorOrigin:{vertical:r,horizontal:d},open:i,onClose:c,style:{marginBottom:60*t+"px"}},{children:(0,n.jsx)(h.Z,Object.assign({style:{marginTop:".5rem"},onClose:c,severity:"error"},{children:(0,n.jsx)("strong",{children:e.message},void 0)}),void 0)}),void 0)},j=({error:e})=>{const[t,i]=o.useState({open:!0,vertical:"bottom",horizontal:"right"}),{vertical:s,horizontal:a,open:l}=t,r=()=>{i(Object.assign(Object.assign({},t),{open:!1}))};return(0,n.jsx)(m.Z,Object.assign({open:!0,anchorOrigin:{vertical:s,horizontal:a}},{children:(0,n.jsx)("div",{children:null==e?void 0:e.map(((e,t)=>(0,n.jsx)(g,{error:e,handleClose:r,index:t},e.deviceId)))},void 0)}),void 0)};var f=i(92284),x=i(73914),b=i(57850),p=i(59693);function O(e){return e.type||e.mode}const E=(0,b.Z)(),T=(0,x.Z)((e=>{const t="dark"===O(e.palette);return{root:{"& .MuiDataGrid-cell--editing":{backgroundColor:"rgb(255,115,115, 0.19)",color:"#1a3e72"},"& .Mui-error":{backgroundColor:`rgb(126,10,15, ${t?0:.1})`,color:t?"#ff4343":"#750f0f"},"& .super-app-theme--false":{backgroundColor:(i=e.palette.error.main,"dark"===O(e.palette)?(0,p._j)(i,.6):(0,p.$n)(i,.6)),"&:hover":{backgroundColor:(t=>"dark"===O(e.palette)?(0,p._j)(t,.5):(0,p.$n)(t,.5))(e.palette.error.main)}}}};var i}),{defaultTheme:E}),S=(0,b.Z)(),N=(0,x.Z)((e=>({root:{flexDirection:"column","& .ant-empty-img-1":{fill:"light"===e.palette.type?"#aeb8c2":"#262626"},"& .ant-empty-img-2":{fill:"light"===e.palette.type?"#f5f5f7":"#595959"},"& .ant-empty-img-3":{fill:"light"===e.palette.type?"#dce0e6":"#434343"},"& .ant-empty-img-4":{fill:"light"===e.palette.type?"#fff":"#1c1c1c"},"& .ant-empty-img-5":{fillOpacity:"light"===e.palette.type?"0.8":"0.08",fill:"light"===e.palette.type?"#f5f5f5":"#fff"}},label:{marginTop:e.spacing(1)}})),{defaultTheme:S});function y(){const e=N();return(0,n.jsxs)(f.nik,Object.assign({className:e.root},{children:[(0,n.jsx)("svg",Object.assign({width:"120",height:"100",viewBox:"0 0 184 152","aria-hidden":!0,focusable:"false"},{children:(0,n.jsxs)("g",Object.assign({fill:"none",fillRule:"evenodd"},{children:[(0,n.jsxs)("g",Object.assign({transform:"translate(24 31.67)"},{children:[(0,n.jsx)("ellipse",{className:"ant-empty-img-5",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"},void 0),(0,n.jsx)("path",{className:"ant-empty-img-1",d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z"},void 0),(0,n.jsx)("path",{className:"ant-empty-img-2",d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z"},void 0),(0,n.jsx)("path",{className:"ant-empty-img-3",d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z"},void 0)]}),void 0),(0,n.jsx)("path",{className:"ant-empty-img-3",d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z"},void 0),(0,n.jsxs)("g",Object.assign({className:"ant-empty-img-4",transform:"translate(149.65 15.383)"},{children:[(0,n.jsx)("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"},void 0),(0,n.jsx)("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"},void 0)]}),void 0)]}),void 0)}),void 0),(0,n.jsx)("div",Object.assign({className:e.label},{children:"Sin datos"}),void 0)]}),void 0)}var C,Z;!function(e){e[e.UNKNOWN_STATE_EVENT=0]="UNKNOWN_STATE_EVENT",e[e.MAINTENANCE=1]="MAINTENANCE",e[e["NO OPERATIONAL"]=2]="NO OPERATIONAL",e[e["OPERATIONAL DELAY"]=3]="OPERATIONAL DELAY",e[e.OPERATIONAL=4]="OPERATIONAL"}(C||(C={})),function(e){e[e.UNKNOWN_SHIFT=0]="UNKNOWN_SHIFT",e[e.NIGHT=1]="NIGHT",e[e.DAY=2]="DAY",e[e.BOTH=3]="BOTH"}(Z||(Z={}));var w=i(32759);const A=()=>{const{statusTimeslineExcavator:e,timeslineExcavator:t}=(0,r.C)(u.tH),{currentTimelineList:i}=t,[n,s]=(0,o.useState)([]);return(0,o.useEffect)((()=>{e===w.jR.DONE?s(null==i?void 0:i.map((e=>{var t,i,n,s,a,o,l,r;return Object.assign(Object.assign({},e),{id:e.deviceId,excavator:e.deviceAlias,status:C[e.state],hmtStart:null===(t=e.hystoryShiftList[0])||void 0===t?void 0:t.initialHourmeter.toFixed(2),hourmeterCurrent:null===(i=e.hystoryShiftList.at(-1))||void 0===i?void 0:i.initialHourmeter.toFixed(2),shift:Z[null===(n=e.currentTimeline)||void 0===n?void 0:n.shift],date:new Date(1e3*(null===(a=null===(s=e.currentTimeline)||void 0===s?void 0:s.shiftDate)||void 0===a?void 0:a.seconds)).toLocaleDateString(),adjustment:(null===(o=e.currentTimeline)||void 0===o?void 0:o.adjustment)?e.currentTimeline.adjustment:0,statusAdjustment:!!(null===(l=e.currentTimeline)||void 0===l?void 0:l.status)&&(null===(r=e.currentTimeline)||void 0===r?void 0:r.status)})}))):s([])}),[t,e]),{rows:n}};var k=i(868),L=i(17812),I=i(52303),H=i(80024),R=i(99050),M=i(85639),P=i(79192),D=i(49032);const V=["NONE",C[D.EnumEvent.MAINTENANCE],C[D.EnumEvent.NO_OPERATIONAL],C[D.EnumEvent.OPERATIONAL_DELAY],C[D.EnumEvent.OPERATIONAL]];function $(){const e=(0,r.T)(),[t,i]=o.useState(null),s=Boolean(t),a=(t="NONE")=>{i(null),e("NONE"===t?(0,u.V)({columnField:"status",operatorValue:"contains",value:""}):(0,u.V)({columnField:"status",operatorValue:"contains",value:t})),console.log(t)};return(0,n.jsxs)("div",{children:[(0,n.jsx)(L.Z,Object.assign({style:{padding:"0px",margin:"0px"},"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:e=>{i(e.currentTarget)}},{children:(0,n.jsx)(P.Z,{},void 0)}),void 0),(0,n.jsx)(R.Z,Object.assign({id:"long-menu",anchorEl:t,keepMounted:!0,open:s,onClose:()=>a("NONE"),PaperProps:{style:{maxHeight:216,width:"20ch"}}},{children:V.map((e=>(0,n.jsx)(M.Z,Object.assign({onClick:()=>a(e)},{children:e}),e)))}),void 0)]},void 0)}var _=i(59067),F=i(53375);const U=()=>{const{timeslineExcavator:e,objetHourmeter:t}=(0,r.C)(u.tH),{currentTimelineList:i}=e,s=(0,r.T)(),{dateShift:a}=(0,l.R)(),[c]=(0,d.l)(a),[v,m]=(0,o.useState)(!1),[h,g]=(0,o.useState)({}),[j,f]=(0,o.useState)(!1),x=i.some((e=>{var t;return!1===(null===(t=e.currentTimeline)||void 0===t?void 0:t.status)}))?"#808080":"#ec9f05";return(0,n.jsx)(k.ZP,Object.assign({title:"Close Shift"},{children:(0,n.jsx)("button",Object.assign({onClick:()=>{return i=void 0,n=void 0,o=function*(){if(v){s((0,u.lb)(!0)),m(!1),s((0,u.s_)(t)),yield s((0,u.Qc)()),f(!1);const e={shift:0,date:`${c}T00:00`};g({}),yield s((0,u.pW)(e))}else e.currentTimelineList.forEach((e=>{var t;h[e.deviceId]={hourmeterCurrent:{value:null===(t=e.currentTimeline)||void 0===t?void 0:t.initialHourmeter.toFixed(2),error:!1}}})),s((0,u.lb)(!1)),s((0,u.Pq)(h)),m(!0)},new((a=void 0)||(a=Promise))((function(e,t){function s(e){try{r(o.next(e))}catch(e){t(e)}}function l(e){try{r(o.throw(e))}catch(e){t(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(s,l)}r((o=o.apply(i,n||[])).next())}));var i,n,a,o},disabled:i.some((e=>{var t;return!1===(null===(t=e.currentTimeline)||void 0===t?void 0:t.status)})),style:{border:"none"}},{children:v?(0,n.jsx)(F.Z,{htmlColor:x},void 0):(0,n.jsx)(_.Z,{htmlColor:x},void 0)}),void 0)}),void 0)},z=(e,t,i,s)=>[Object.assign(Object.assign({},f.mf9),{width:70,renderHeader:e=>(0,n.jsx)(k.ZP,Object.assign({title:"Select all"},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex",padding:"0px",margin:"0px"}},{children:[(0,n.jsx)(f.KOw,Object.assign({},e),void 0),(0,n.jsx)($,{},void 0)]}),void 0)}),void 0)}),{field:"excavator",headerName:"Excavator"},{field:"status",headerName:"Status",width:150},{field:"hmtStart",headerName:"Hourmeter",editable:s,type:"number"},{field:"hourmeterCurrent",headerName:"hourmeter Current",editable:!s,type:"number",renderHeader:e=>(0,n.jsx)(U,{},void 0)},{field:"adjustment",headerName:"adjustment",type:"number"},{field:"Opciones",headerName:"Opc",minWidth:110,renderCell:({row:s})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.ZP,Object.assign({onClick:()=>{console.log(s),t(s),e(!0)},title:"Add timeline"},{children:(0,n.jsx)(L.Z,Object.assign({size:"small"},{children:(0,n.jsx)(H.Z,{color:"primary",fontSize:"small"},void 0)}),void 0)}),void 0),(0,n.jsx)(k.ZP,Object.assign({onClick:()=>{t(s),i(!0)},title:"View Timeline"},{children:(0,n.jsx)(L.Z,Object.assign({size:"small"},{children:(0,n.jsx)(I.Z,{htmlColor:"Green",fontSize:"small"},void 0)}),void 0)}),void 0)]},void 0)}],W=(e,t)=>{const[i,n]=(0,o.useState)([{field:e,sort:t}]);return{sortModel:i,handleModelGrid:e=>{0!=e.length?e[0].field!=i[0].field||e[0].sort!=i[0].sort?n(e):console.log("else"):"desc"==i[0].sort?n([Object.assign(Object.assign({},i[0]),{sort:"asc"})]):n([Object.assign(Object.assign({},i[0]),{sort:"desc"})])}}},B=({setOpen:e,setTimelineCurrent:t,setOpenTimeline:i})=>{const s=T(),{rows:a}=A(),l=(0,r.T)(),{statusTimeslineExcavator:d,filterDataGrid:c,isEditableRows:v,initialEditRowsModel:m}=(0,r.C)(u.tH),[h,g]=(0,o.useState)({}),{sortModel:j,handleModelGrid:x}=W("excavator","asc");return(0,o.useEffect)((()=>{d===w.jR.DONE&&(l((0,u.hV)()),l((0,u.OE)()))}),[a]),(0,o.useEffect)((()=>{g(m)}),[m]),(0,n.jsx)("div",Object.assign({style:{height:"1113px",overflowY:"scroll",display:"flex",flexDirection:"column"}},{children:(0,n.jsx)(f._$r,{className:s.root,rowHeight:30,rows:a,columns:z(e,t,i,v),density:"compact",components:{NoRowsOverlay:y},checkboxSelection:!0,disableSelectionOnClick:!0,onSelectionModelChange:e=>(e=>{const t=new Set(e),i=a.filter((e=>t.has(e.id.toString())));l((0,u.Xm)(i))})(e),disableColumnMenu:!0,sortModel:j,editRowsModel:h,onEditRowsModelChange:e=>(e=>{var t="";for(var[i,n]of Object.entries(e))Object.keys(n).length<=1&&Object.keys(n).forEach((e=>{t=e}));console.log("key",t);var s=Object.assign({},e);switch(t){case"hourmeterCurrent":console.log("updatedModel",s),g(Object.assign(Object.assign({},h),s)),l((0,u.Jo)(s));break;case"hmtStart":Object.keys(s).length>=2?(g({}),console.log("case modelxd",e),l((0,u.Yb)({}))):(Object.keys(s).forEach((e=>{if(s[e].hourmeterCurrent){var t=s[e].hourmeterCurrent.value>=0;s[e].hourmeterCurrent=Object.assign(Object.assign({},s[e].hourmeterCurrent),{error:!t})}})),g(s),l((0,u.Yb)(s)));break;default:console.log("case default")}})(e),filterModel:{items:[c]},getRowClassName:e=>`super-app-theme--${e.row.statusAdjustment}`},void 0)}),void 0)};var K=i(8286),G=i(66977);const Y=e=>{const[t,i]=(0,o.useState)(e);return[t,e=>{i(Object.assign(Object.assign({},t),{[e.target.name]:e.target.value}))},()=>{i(e)},i]};var q=i(41120),J=i(35117),X=i(64436),Q=i(96019),ee=i(67162),te=i(30553),ie=i(40074),ne=i(81395),se=i(89452),ae=i(18973),oe=i(95090);const le=({setEventState:e,event:t})=>{const[i,s,a,l]=Y({status:0}),{eventStateList:d,statusEventStateList:c}=(0,r.C)(ae.eG),u=(0,r.T)();return(0,o.useEffect)((()=>{if(t.toString()===D.EnumEvent.OPERATIONAL.toString()){if(c===oe.JD.DONE){const t=d[0];e(Object.assign(Object.assign({},t),{id:"",name:"",eventState:0,event:t.event}))}}else{const t=d.find((e=>e.eventState.toString()===i.status.toString()));e(t)}}),[i]),(0,o.useEffect)((()=>{u((0,se.Gy)(t))}),[t]),(0,o.useEffect)((()=>{e({id:"",name:"",eventState:0,event:{id:"",name:"",event:0}})}),[]),console.log("eventSateList",d),(0,o.useEffect)((()=>{if(t.toString()===D.EnumEvent.OPERATIONAL.toString()&&c===oe.JD.DONE){const t=d[0];console.log("eventSate",t),e(Object.assign(Object.assign({},t),{id:"",name:"",eventState:0,event:t.event}))}}),[]),(0,o.useEffect)((()=>{a()}),[t]),console.log("formsEventState",i),(0,n.jsxs)(X.Z,Object.assign({component:"fieldset"},{children:[(0,n.jsx)(Q.Z,Object.assign({component:"legend"},{children:C[t]}),void 0),(0,n.jsx)(ee.Z,Object.assign({defaultValue:"female","aria-label":"hourmeter",name:"customized-radios"},{children:d.map((e=>(0,n.jsx)(te.Z,{value:e.eventState,control:(0,n.jsx)(ie.Z,{checked:i.status===e.eventState.toString(),icon:(0,n.jsx)(ne.Z,{},void 0),checkedIcon:(0,n.jsx)(ne.Z,{},void 0),name:"status",onClick:()=>{},onChange:s,disabled:e.event.event.toString()===D.EnumEvent.OPERATIONAL.toString()},void 0),label:e.name},e.id)))}),void 0)]}),void 0)},re=(0,q.Z)((e=>(0,J.Z)({container:{display:"flex",flexDirection:"column",flexWrap:"wrap",fontFamily:"inherit"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),paddingBottom:"10px",width:100}}))),de=({value:e,label:t})=>{const i=re(),a=(0,r.T)(),l=new Date,d=`0${l.getHours()}`,u=`0${l.getMinutes()}`,[v,m]=(0,o.useState)({hoursStart:`${d.slice(-2)}:${u.slice(-2)}`,status:e,substatus:{id:"",name:"",eventState:D.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:D.EnumEvent.UNKNOWN_STATE_EVENT}}}),[h,g]=(0,o.useState)({id:"",name:"",eventState:D.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:D.EnumEvent.UNKNOWN_STATE_EVENT}});console.log(v),(0,o.useEffect)((()=>{a((0,c.gS)(Object.assign({},v)))}),[v]),(0,o.useEffect)((()=>()=>{a((0,c.XH)())}),[]),(0,o.useEffect)((()=>{m(Object.assign(Object.assign({},v),{substatus:h}))}),[h]);const{hoursStart:j}=v;return(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:1},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsx)("form",Object.assign({className:i.container,noValidate:!0},{children:(0,n.jsx)(K.Z,{id:"date",label:"HOUR START",type:"time",name:"hoursStart",value:j,onChange:e=>{m(Object.assign(Object.assign({},v),{[e.target.name]:e.target.value}))},className:i.textField,InputLabelProps:{shrink:!0,required:!0}},void 0)}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:6},{children:(0,n.jsx)(le,{setEventState:g,event:v.status},void 0)}),void 0)]}),void 0)};var ce=i(282),ue=i(67774);const ve=({rowsTimelines:e,setOpenEvent:t,setevent:i})=>{const[s,a]=(0,o.useState)(!0),[l,d]=(0,o.useState)(!0),[c,u]=(0,o.useState)(!0),v=(0,r.T)(),{eventList:m}=(0,r.C)(ae.yJ),[h,g]=o.useState(null);(0,o.useEffect)((()=>{f()&&(a(!1),d(!0),u(!1)),b()&&(a(!1),d(!1),u(!1)),j()&&(a(!0),d(!1),u(!1)),x()&&(a(!1),d(!1),u(!0)),0==b()&&0==j()&&0==x()&&0==f()&&(a(!0),d(!0),u(!0))}),[e]);const j=()=>0!==e.length&&e.every((e=>e.status===C[D.EnumEvent.NO_OPERATIONAL])),f=()=>0!==e.length&&e.every((e=>e.status===C[D.EnumEvent.OPERATIONAL])),x=()=>0!==e.length&&e.every((e=>e.status===C[D.EnumEvent.OPERATIONAL_DELAY])),b=()=>0!==e.length&&e.every((e=>e.status===C[D.EnumEvent.UNKNOWN_STATE_EVENT]));return(0,o.useEffect)((()=>{v((0,ue.TU)())}),[]),(0,n.jsxs)("div",{children:[(0,n.jsx)(ce.Z,Object.assign({"aria-controls":"simple-menu","aria-haspopup":"true",onClick:e=>{g(e.currentTarget)},color:"primary",variant:"contained",size:"small"},{children:"Go to"}),void 0),(0,n.jsx)(R.Z,Object.assign({id:"simple-menu",anchorEl:h,keepMounted:!0,open:Boolean(h),onClose:()=>{g(null)}},{children:m.map((e=>{var a=!1;return e.event===D.EnumEvent.OPERATIONAL_DELAY&&(a=c),e.event===D.EnumEvent.OPERATIONAL&&(a=l),e.event===D.EnumEvent.NO_OPERATIONAL&&(a=s),e.event===D.EnumEvent.MAINTENANCE&&(a=!0),(0,n.jsx)(M.Z,Object.assign({disabled:a,onClick:()=>(e=>{t(!0),i(e)})(e.event),color:"primary"},{children:e.name}),e.id)}))}),void 0)]},void 0)};const me=({dateStartString:e,hourmeterStart:t,startUpdateInitialHourmeterTimeline:i,startGetTimeline:s,resetHourmeterStart:a})=>{const o=(0,r.T)();return(0,n.jsx)(ce.Z,Object.assign({size:"small",disabled:null==t?void 0:t.isDisabled,onClick:()=>{return t=void 0,n=void 0,r=function*(){yield o(i());const t={shift:0,date:`${e}T00:00`};o(a()),yield o(s(t))},new((l=void 0)||(l=Promise))((function(e,i){function s(e){try{o(r.next(e))}catch(e){i(e)}}function a(e){try{o(r.throw(e))}catch(e){i(e)}}function o(t){var i;t.done?e(t.value):(i=t.value,i instanceof l?i:new l((function(e){e(i)}))).then(s,a)}o((r=r.apply(t,n||[])).next())}));var t,n,l,r},variant:"contained",color:"primary",startIcon:(0,n.jsx)(_.Z,{},void 0)},{children:"Initial Hourmeter"}),void 0)};var he=i(79998),ge=i(97480),je=i(71267),fe=i(69798);const xe=({shift:e,date:t})=>(0,n.jsxs)("div",{children:[(0,n.jsx)(je.Z,{icon:(0,n.jsx)(ge.Z,{},void 0),label:e,clickable:!0,color:"secondary",deleteIcon:(0,n.jsx)(ge.Z,{},void 0)},void 0),(0,n.jsx)(je.Z,{icon:(0,n.jsx)(fe.Z,{},void 0),label:t,clickable:!0,color:"secondary",deleteIcon:(0,n.jsx)(fe.Z,{},void 0)},void 0)]},void 0);const be=()=>{var e,t;const{rowsTimeline:i,timeslineExcavator:m,hourmeterStart:h}=(0,r.C)(u.tH),g=(0,r.T)(),{dateShift:j}=(0,l.R)(),{formValuesBtn:f}=(0,r.C)(c.k3),[x]=(0,d.l)(j),[b,p]=(0,o.useState)(!1),[O,E]=(0,o.useState)(D.EnumEvent.UNKNOWN_STATE_EVENT),{rows:T}=A(),[S,N]=(0,o.useState)(!1),[y,Z]=Y({columnField:"excavator",operatorValue:"contains",value:""}),{value:w}=y;return(0,o.useEffect)((()=>{g((0,u.V)(y))}),[w]),(0,o.useEffect)((()=>{var e,t;(null===(t=null===(e=f.substatus)||void 0===e?void 0:e.event)||void 0===t?void 0:t.id)?N(!1):N(!0)}),[f]),(0,n.jsxs)(s.Z,Object.assign({container:!0,justifyContent:"flex-start",spacing:1,style:{paddingBottom:"20px"},alignItems:"center"},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,style:{width:"20%"}},{children:(0,n.jsxs)(a.Z,Object.assign({sx:{display:"flex",alignItems:"flex-end"}},{children:[(0,n.jsx)(G.Z,{},void 0),(0,n.jsx)(K.Z,{id:"input-with-sx",label:"Search ",variant:"standard",name:"value",onChange:Z,fullWidth:!0},void 0)]}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(ve,{rowsTimelines:i,setevent:E,setOpenEvent:p},void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(me,{dateStartString:x,hourmeterStart:h,startUpdateInitialHourmeterTimeline:u.Im,startGetTimeline:u.pW,resetHourmeterStart:he.ZB},void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(xe,{shift:null===(e=T[0])||void 0===e?void 0:e.shift,date:null===(t=T[0])||void 0===t?void 0:t.date},void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:b,handleClose:()=>{p(!1)},handleConfirm:()=>{return e=void 0,t=void 0,n=function*(){yield g((0,u.vd)()),p(!1);const e={shift:0,date:`${x}T00:00`};yield g((0,u.pW)(e))},new((i=void 0)||(i=Promise))((function(s,a){function o(e){try{r(n.next(e))}catch(e){a(e)}}function l(e){try{r(n.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}));var e,t,i,n},title:`Excavator to ${C[O]}  `,disabled:S},{children:(0,n.jsx)(de,{value:O},void 0)}),void 0)]}),void 0)};var pe=i(94491);const Oe=(0,q.Z)((()=>(0,J.Z)({line:{width:"100%",minWidth:"100px",height:"1px",border:"0",backgroundColor:"rgba(191,128,11,1)",padding:"1px",margin:"5px"},container:{display:"flex",alignItems:"center"},timeline:{display:"flex",flexWrap:"wrap",flexDirection:"column",WebkitUserSelect:"none"},span:{display:"flex",alignSelf:"start",WebkitUserSelect:"none"}}))),Ee=({icon:e})=>{const t=Oe();return(0,n.jsxs)("div",Object.assign({className:t.container},{children:[e||(0,n.jsx)(pe.Z,{htmlColor:"#F2BB13"},void 0),(0,n.jsx)(s.Z,{className:t.line},void 0)]}),void 0)},Te=(0,o.createContext)({}),{Provider:Se}=Te,Ne=({children:e,data:t,setData:i})=>{const s=Oe();return(0,n.jsx)(Se,Object.assign({value:{data:t}},{children:(0,n.jsx)("div",Object.assign({className:s.timeline,onClick:()=>{i()}},{children:e}),void 0)}),void 0)};var ye=i(22318);const Ce=({title:e})=>{const t=Oe();return(0,n.jsx)("div",Object.assign({className:t.span},{children:(0,n.jsx)(ye.Z,Object.assign({variant:"button",display:"block",gutterBottom:!0},{children:e}),void 0)}),void 0)},Ze=({title:e,subTitle:t})=>{const{data:i}=(0,o.useContext)(Te);return(0,n.jsxs)(o.Fragment,{children:[(0,n.jsxs)(ye.Z,Object.assign({style:{fontSize:".7rem",fontWeight:700,padding:"0 2rem"},variant:"h6",component:"h6"},{children:[e||(null==i?void 0:i.title.toString().toLowerCase())," -"]}),void 0),(0,n.jsx)("span",Object.assign({style:{color:"rgba(0, 0, 0, 0.54)",padding:"0 2rem"}},{children:t}),void 0)]},void 0)};var we=i(10150);const Ae=(0,x.Z)((e=>(0,we.Z)({container:{display:"flex",flexDirection:"column",flexWrap:"wrap",fontFamily:"inherit"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),paddingBottom:"10px",width:100}}))),ke=()=>{var e,t,i;const s=Ae(),{updateTimeline:a}=(0,r.C)(u.tH),l=(0,r.T)(),d=new Date(1e3*(null===(e=a.initialTime)||void 0===e?void 0:e.seconds)),c=`0${d.getHours()}`,v=`0${d.getMinutes()}`,m=`${c.slice(-2)}:${v.slice(-2)}`,[h,g]=(0,o.useState)(Object.assign(Object.assign({},a),{initialHourmeter:null===(t=a.initialHourmeter)||void 0===t?void 0:t.toFixed(2)})),j=e=>{g(Object.assign(Object.assign({},h),{[e.target.name]:e.target.value}))},{initialHourmeter:f}=h;return(0,o.useEffect)((()=>(l((0,u.mP)(h)),()=>{})),[h]),(0,o.useEffect)((()=>()=>{l((0,u.mP)({})),g({})}),[]),(0,n.jsx)("div",{children:(0,n.jsxs)("form",Object.assign({className:s.container,noValidate:!0},{children:[(0,n.jsx)(K.Z,{id:"date",label:"HOUR",type:"time",name:"time",disabled:!0,defaultValue:m,onChange:j,className:s.textField,InputLabelProps:{shrink:!0,required:!0}},void 0),(0,n.jsx)(K.Z,{id:"date",label:"INITIAL HOURMETER",type:"number",name:"initialHourmeter",defaultValue:f,onChange:j,className:s.textField,InputLabelProps:{shrink:!0}},void 0),(0,n.jsx)(K.Z,{id:"date",label:"END HOURMETER ",type:"number",name:"initialHourmeter",disabled:!0,defaultValue:null===(i=a.finalHourmeter)||void 0===i?void 0:i.toFixed(2),className:s.textField,InputLabelProps:{shrink:!0}},void 0)]}),void 0)},void 0)};const Le=({setClose:e})=>{var t,i;const{statusTimeslineExcavator:a,currentTimeline:c,updateTimeline:m}=(0,r.C)(u.tH),h=(0,r.T)(),[g,j]=(0,o.useState)(!1),{dateShift:f}=(0,l.R)(),[x]=(0,d.l)(f),b=(0,o.useCallback)((()=>{j(!1),h((0,u.zX)({}))}),[]),p=(0,o.useCallback)((()=>{return t=void 0,i=void 0,s=function*(){yield h((0,u.NT)()),h((0,u.zX)({})),a===w.jR.DONE&&(j(!1),e(!1));const t={shift:0,date:`${x}T00:00`};yield h((0,u.pW)(t))},new((n=void 0)||(n=Promise))((function(e,a){function o(e){try{r(s.next(e))}catch(e){a(e)}}function l(e){try{r(s.throw(e))}catch(e){a(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,l)}r((s=s.apply(t,i||[])).next())}));var t,i,n,s}),[]);return(0,n.jsxs)(s.Z,Object.assign({container:!0},{children:[null==c?void 0:c.hystoryShiftList.map((e=>{var t,i,s,a,o,l,r;let d=new Date(1e3*(null===(t=e.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString();return(0,n.jsxs)(Ne,Object.assign({data:e,setData:()=>(e=>{h((0,u.zX)(e)),j(!0)})(e)},{children:[(0,n.jsx)(Ze,{title:(null===(s=null===(i=e.initialEventState)||void 0===i?void 0:i.event)||void 0===s?void 0:s.name)?null===(o=null===(a=e.initialEventState)||void 0===a?void 0:a.event)||void 0===o?void 0:o.name:"-",subTitle:(null===(l=e.initialEventState)||void 0===l?void 0:l.name)?null===(r=e.initialEventState)||void 0===r?void 0:r.name.toString().toLowerCase():"-"},void 0),(0,n.jsx)(Ee,{},void 0),(0,n.jsx)(Ce,{title:d.toLocaleString().split(" ")[1].substring(0,d.split(" ")[1].length-3)},void 0)]}),e.id+Math.random())})),(0,n.jsx)(v.a,Object.assign({open:g,handleClose:b,handleConfirm:p,title:`Update Timeline ${new Date(1e3*(null===(t=m.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString().split(" ")[1].substring(0,new Date(1e3*(null===(i=m.initialTime)||void 0===i?void 0:i.seconds)).toLocaleString().split(" ")[1].length-3)}`},{children:(0,n.jsx)(ke,{},void 0)}),void 0)]}),void 0)},Ie=(e,t)=>{const i=Number.parseFloat(e)+Number.parseFloat(t);return Number.parseFloat(i.toFixed(2))},He=({setstateform:e,isDisabled:t,setisManto:i,handleIsManto:s})=>{const{eventList:a}=(0,r.C)(ae.yJ),l=(0,r.T)(),[d,c]=(0,o.useState)({status:D.EnumEvent.UNKNOWN_STATE_EVENT,Substatus:{id:"",name:"",eventState:0,event:{id:"",name:"",event:0}}}),u=e=>{d.status!=D.EnumEvent.MAINTENANCE?c(Object.assign(Object.assign({},d),{[e.target.name]:e.target.value})):c(Object.assign(Object.assign({},d),{[e.target.name]:e.target.value}))},v=()=>{c(Object.assign(Object.assign({},d),{Substatus:{id:"",name:"",eventState:0,event:{id:"",name:"",event:0}}})),i(!1)};return(0,o.useEffect)((()=>{e(d)}),[d]),(0,o.useEffect)((()=>{l((0,ue.TU)())}),[]),(0,n.jsxs)(X.Z,Object.assign({component:"fieldset"},{children:[(0,n.jsx)(Q.Z,Object.assign({component:"legend"},{children:"choice"}),void 0),(0,n.jsx)(ee.Z,Object.assign({defaultValue:"female","aria-label":"hourmeter",name:"customized-radios"},{children:a.map((e=>e.event.toString()===D.EnumEvent.MAINTENANCE.toString()?(0,n.jsx)(te.Z,{value:e.event,control:(0,n.jsx)(ie.Z,{icon:(0,n.jsx)(ne.Z,{},void 0),checkedIcon:(0,n.jsx)(ne.Z,{},void 0),name:"status",onClick:()=>s(),onChange:u,checked:d.status.toString()===e.event.toString(),disabled:t.toString()===e.name.toString()},void 0),label:e.name},e.id):(0,n.jsx)(te.Z,{value:e.event,onClick:v,control:(0,n.jsx)(ie.Z,{icon:(0,n.jsx)(ne.Z,{},void 0),checkedIcon:(0,n.jsx)(ne.Z,{},void 0),name:"status",checked:d.status.toString()===e.event.toString(),disabled:t.toString()===e.name.toString(),onClick:v,onChange:u},void 0),label:e.name},e.id)))}),void 0)]}),void 0)},Re=({currentTimeline:e})=>{var t;const i=Ae(),a=(0,r.T)(),[l,u]=(0,o.useState)(0),[v,m]=(0,o.useState)(!1),h=new Date,g=`0${h.getHours()}`,j=`0${h.getMinutes()}`,[f,x]=(0,o.useState)({time:`${g.slice(-2)}:${j.slice(-2)}`,hourmeterEnd:0===(null==e?void 0:e.hystoryShiftList.length)?0:null===(t=null==e?void 0:e.hystoryShiftList)||void 0===t?void 0:t.at(-1).initialHourmeter.toFixed(1),htm:0,hourmeterCalculated:0,status:D.EnumEvent.UNKNOWN_STATE_EVENT,Substatus:{id:"",name:"",eventState:D.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:D.EnumEvent.UNKNOWN_STATE_EVENT}},currentTimeline:e}),[b]=(0,d.l)(new Date),p=null==e?void 0:e.status,{time:O,hourmeterEnd:E}=f,T=function(e,t){var i,n;if(0===(null==t?void 0:t.hystoryShiftList.length))return 0;{const a=null===(i=null==t?void 0:t.hystoryShiftList)||void 0===i?void 0:i.at(-1),o=new Date(e),l=new Date(1e3*(null===(n=null==a?void 0:a.initialTime)||void 0===n?void 0:n.seconds));console.log("CurrenteDate",o),console.log("hourmeterDate",l);var s=(o.getTime()-l.getTime())/1e3;return 1/60*Math.ceil(s/60)}}(`${b}T${O}`,e),[S,N]=(0,o.useState)({id:"",name:"",eventState:0,event:{id:"",name:"",event:0}}),[y,Z]=(0,o.useState)({}),w=e=>{f.status!=D.EnumEvent.MAINTENANCE?x(Object.assign(Object.assign({},f),{[e.target.name]:e.target.value})):x(Object.assign(Object.assign({},f),{[e.target.name]:e.target.value}))};return(0,o.useEffect)((()=>(a((0,c.$6)(f)),()=>{})),[f]),(0,o.useEffect)((()=>(u(Ie(E,T)),()=>{a((0,c.J$)())})),[]),(0,o.useEffect)((()=>{(null==e?void 0:e.status)===C[D.EnumEvent.NO_OPERATIONAL]?u(null==e?void 0:e.hourmeterCurrent):u(Ie(E,T)),f.status!=D.EnumEvent.MAINTENANCE&&x(Object.assign(Object.assign({},f),{htm:l}))}),[O]),(0,o.useEffect)((()=>{x(Object.assign(Object.assign({},f),{Substatus:Object.assign({},S)}))}),[S]),(0,o.useEffect)((()=>{x(Object.assign(Object.assign({},f),y))}),[y]),(0,n.jsxs)("div",{children:[(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:1},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:12},{children:(0,n.jsxs)("form",Object.assign({className:i.container,noValidate:!0},{children:[(0,n.jsx)(K.Z,{id:"date",label:"HOUR",type:"time",name:"time",value:O,onChange:w,className:i.textField,InputLabelProps:{shrink:!0,required:!0}},void 0),(0,n.jsx)(K.Z,{id:"date",label:"HOURMETER",type:"number",disabled:!0,name:"hourmeterCalculated",value:l,onChange:w,className:i.textField,InputLabelProps:{shrink:!0}},void 0),(p===C[D.EnumEvent.MAINTENANCE]||v)&&(0,n.jsx)(K.Z,{autoFocus:!0,id:"date",label:"HOURMETER Start",type:"number",name:"htm",defaultValue:l,onChange:w,className:i.textField,InputLabelProps:{shrink:!0,required:!0}},void 0)]}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:6,md:6,sm:6,xs:12},{children:(0,n.jsx)(He,{setstateform:Z,isDisabled:p,setisManto:m,handleIsManto:e=>{m(!0),x(Object.assign(Object.assign({},f),{htm:l,status:D.EnumEvent.MAINTENANCE,Substatus:{id:"",name:"",eventState:D.EnumEvent.UNKNOWN_STATE_EVENT,event:{id:"",name:"",event:D.EnumEvent.UNKNOWN_STATE_EVENT}}})),console.log("e.target.checked",e.target.checked)}},void 0)}),void 0)]}),void 0),(0,n.jsx)(s.Z,Object.assign({container:!0,spacing:2},{children:!!f.status&&(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,sm:12,xs:12},{children:(0,n.jsx)(le,{setEventState:N,event:f.status},void 0)}),void 0)}),void 0)]},void 0)};var Me=i(56731),Pe=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function o(e){try{r(n.next(e))}catch(e){a(e)}}function l(e){try{r(n.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}))};const De=()=>{const e=(0,r.T)(),{timelineErrorList:t,currentTimeline:i}=(0,r.C)(u.tH),{formValues:m}=(0,r.C)(c.k3),{dateShift:h}=(0,l.R)(),[g]=(0,d.l)(h),[f,x]=(0,o.useState)(Me.Shift.UNKNOWN_SHIFT),[b,p]=(0,o.useState)(!1),[O,E]=(0,o.useState)(!1),[T,S]=(0,o.useState)(!0),[N,y]=(0,o.useState)([]),C=(0,o.useCallback)((()=>{p(!1),S(!0),E(!1)}),[]);return(0,o.useEffect)((()=>{const t={shift:0,date:`${g}T00:00`};return e((0,u.pW)(t)),()=>{}}),[]),(0,o.useEffect)((()=>{m.status&&m.Substatus?S(!1):S(!0)}),[m]),(0,o.useEffect)((()=>{e((0,u.gc)(N))}),[N]),(0,n.jsxs)(a.Z,Object.assign({m:2,p:.5,style:{height:"100%"}},{children:[(0,n.jsx)(s.Z,{children:(0,n.jsx)(be,{},void 0)},void 0),(0,n.jsx)(s.Z,Object.assign({container:!0,style:{height:"100%"}},{children:(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,sm:12,xs:12},{children:(0,n.jsx)(B,{setOpen:p,setTimelineCurrent:y,setOpenTimeline:E},void 0)}),void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:b,handleClose:C,handleConfirm:()=>Pe(void 0,void 0,void 0,(function*(){yield e((0,u.SN)()),p(!1),S(!0),yield function(){return Pe(this,void 0,void 0,(function*(){const t={shift:f,date:`${g}T00:00`};yield e((0,u.pW)(t))}))}()})),title:`Excavator  ${N.deviceAlias}  `,disabled:T},{children:(0,n.jsx)(Re,{currentTimeline:i},void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:O,handleClose:C,title:`Timeline to  ${N.deviceAlias} `,disabled:T},{children:(0,n.jsx)(Le,{setClose:E},void 0)}),void 0),!(null==t?void 0:t.success)&&(0,n.jsx)(j,{error:null==t?void 0:t.errorsList},void 0)]}),void 0)},Ve=()=>{var e,t,i;const s=Ae(),{updateTimeline:a}=(0,r.C)(he.rf),l=(0,r.T)(),d=new Date(1e3*(null===(e=a.initialTime)||void 0===e?void 0:e.seconds)),c=`0${d.getHours()}`,u=`0${d.getMinutes()}`,v=`${c.slice(-2)}:${u.slice(-2)}`,[m,h]=(0,o.useState)(Object.assign(Object.assign({},a),{initialHourmeter:null===(t=a.initialHourmeter)||void 0===t?void 0:t.toFixed(2)})),g=e=>{h(Object.assign(Object.assign({},m),{[e.target.name]:e.target.value}))},{initialHourmeter:j}=m;return console.log("formUpadateTimeline",m),(0,o.useEffect)((()=>(l((0,he.Zp)(m)),()=>{})),[m]),(0,o.useEffect)((()=>()=>{l((0,he.Zp)({})),h({})}),[]),(0,n.jsx)("div",{children:(0,n.jsxs)("form",Object.assign({className:s.container,noValidate:!0},{children:[(0,n.jsx)(K.Z,{id:"date",label:"HOUR",type:"time",name:"time",disabled:!0,defaultValue:v,onChange:g,className:s.textField,InputLabelProps:{shrink:!0,required:!0}},void 0),(0,n.jsx)(K.Z,{id:"date",label:"INITIAL HOURMETER",type:"number",name:"initialHourmeter",defaultValue:j,onChange:g,className:s.textField,InputLabelProps:{shrink:!0}},void 0),(0,n.jsx)(K.Z,{id:"date",label:"END HOURMETER ",type:"number",name:"initialHourmeter",disabled:!0,defaultValue:null===(i=a.finalHourmeter)||void 0===i?void 0:i.toFixed(2),className:s.textField,InputLabelProps:{shrink:!0}},void 0)]}),void 0)},void 0)};const $e=({setClose:e})=>{var t,i;const{status:a,currentTimeline:c,updateTimeline:u}=(0,r.C)(he.rf),m=(0,r.T)(),[h,g]=(0,o.useState)(!1),{dateShift:j}=(0,l.R)(),[f]=(0,d.l)(j),x=(0,o.useCallback)((()=>{g(!1),m((0,he.Uy)({}))}),[]),b=(0,o.useCallback)((()=>{return t=void 0,i=void 0,s=function*(){yield m((0,he.ft)()),m((0,he.Uy)({})),"done"===a&&(g(!1),e(!1));const t={shift:0,date:`${f}T00:00`};yield m((0,he.mA)(t))},new((n=void 0)||(n=Promise))((function(e,a){function o(e){try{r(s.next(e))}catch(e){a(e)}}function l(e){try{r(s.throw(e))}catch(e){a(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,l)}r((s=s.apply(t,i||[])).next())}));var t,i,n,s}),[]);return(0,n.jsxs)(s.Z,Object.assign({container:!0},{children:[null==c?void 0:c.hystoryShiftList.map((e=>{var t,i,s,a,o,l,r;let d=new Date(1e3*(null===(t=e.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString();return(0,n.jsxs)(Ne,Object.assign({data:e,setData:()=>(e=>{m((0,he.Uy)(e)),g(!0)})(e)},{children:[(0,n.jsx)(Ze,{title:(null===(s=null===(i=e.initialEventState)||void 0===i?void 0:i.event)||void 0===s?void 0:s.name)?null===(o=null===(a=e.initialEventState)||void 0===a?void 0:a.event)||void 0===o?void 0:o.name:"-",subTitle:(null===(l=e.initialEventState)||void 0===l?void 0:l.name)?null===(r=e.initialEventState)||void 0===r?void 0:r.name.toString().toLowerCase():"-"},void 0),(0,n.jsx)(Ee,{},void 0),(0,n.jsx)(Ce,{title:d.toLocaleString().split(" ")[1].substring(0,d.split(" ")[1].length-3)},void 0)]}),e.id+Math.random())})),(0,n.jsx)(v.a,Object.assign({open:h,handleClose:x,handleConfirm:b,title:`Update Timeline ${new Date(1e3*(null===(t=u.initialTime)||void 0===t?void 0:t.seconds)).toLocaleString().split(" ")[1].substring(0,new Date(1e3*(null===(i=u.initialTime)||void 0===i?void 0:i.seconds)).toLocaleString().split(" ")[1].length-3)}`},{children:(0,n.jsx)(Ve,{},void 0)}),void 0)]}),void 0)},_e=()=>{const{timesline:e,status:t}=(0,r.C)(he.rf),{currentTimelineList:i}=e,[n,s]=(0,o.useState)([]);return(0,o.useEffect)((()=>{s("done"===t?null==i?void 0:i.map((e=>{var t,i,n,s,a,o,l,r;return Object.assign(Object.assign({},e),{id:e.deviceId,truck:e.deviceAlias,status:C[e.state],hmtStart:null===(t=e.hystoryShiftList[0])||void 0===t?void 0:t.initialHourmeter.toFixed(2),hourmeterCurrent:null===(i=e.hystoryShiftList.at(-1))||void 0===i?void 0:i.initialHourmeter.toFixed(2),shift:Z[null===(n=e.currentTimeline)||void 0===n?void 0:n.shift],date:new Date(1e3*(null===(a=null===(s=e.currentTimeline)||void 0===s?void 0:s.shiftDate)||void 0===a?void 0:a.seconds)).toLocaleDateString(),adjustment:(null===(o=e.currentTimeline)||void 0===o?void 0:o.adjustment)?e.currentTimeline.adjustment:0,statusAdjustment:!!(null===(l=e.currentTimeline)||void 0===l?void 0:l.status)&&(null===(r=e.currentTimeline)||void 0===r?void 0:r.status)})})):[])}),[e,t]),{rows:n}};const Fe=()=>{var e,t;const{rowsTimeline:i,hourmeterStart:u}=(0,r.C)(he.rf),{formValuesBtn:m}=(0,r.C)(c.k3),h=(0,r.T)(),{dateShift:g}=(0,l.R)(),{rows:j}=_e(),[f]=(0,d.l)(g),[x,b]=(0,o.useState)(!1),[p,O]=(0,o.useState)(D.EnumEvent.UNKNOWN_STATE_EVENT),[E,T]=(0,o.useState)(!1),[S,N]=Y({columnField:"truck",operatorValue:"contains",value:""}),{value:y}=S;return(0,o.useEffect)((()=>{h((0,he.V)(S))}),[y]),(0,o.useEffect)((()=>{var e,t;(null===(t=null===(e=m.substatus)||void 0===e?void 0:e.event)||void 0===t?void 0:t.id)?T(!1):T(!0)}),[m]),(0,n.jsxs)(s.Z,Object.assign({container:!0,spacing:1,justifyContent:"flex-start",style:{paddingBottom:"20px"},alignItems:"center"},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,style:{width:"20%"}},{children:(0,n.jsxs)(a.Z,Object.assign({sx:{display:"flex",alignItems:"flex-end"}},{children:[(0,n.jsx)(G.Z,{},void 0),(0,n.jsx)(K.Z,{id:"input-with-sx",label:"Search ",variant:"standard",name:"value",onChange:N,fullWidth:!0},void 0)]}),void 0)}),void 0),(0,n.jsx)(s.Z,{item:!0},void 0),(0,n.jsx)(ve,{rowsTimelines:i,setevent:O,setOpenEvent:b},void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(me,{dateStartString:f,hourmeterStart:u,startUpdateInitialHourmeterTimeline:he.cs,startGetTimeline:he.mA,resetHourmeterStart:he.ZB},void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(xe,{shift:null===(e=j[0])||void 0===e?void 0:e.shift,date:null===(t=j[0])||void 0===t?void 0:t.date},void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:x,handleClose:()=>{b(!1)},handleConfirm:()=>{return e=void 0,t=void 0,n=function*(){yield h((0,he._C)()),b(!1);const e={shift:0,date:`${f}T00:00`};yield h((0,he.mA)(e))},new((i=void 0)||(i=Promise))((function(s,a){function o(e){try{r(n.next(e))}catch(e){a(e)}}function l(e){try{r(n.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}));var e,t,i,n},title:`Truck to ${C[p]}  `,disabled:E},{children:(0,n.jsx)(de,{value:p},void 0)}),void 0)]}),void 0)},Ue=["NONE",C[D.EnumEvent.MAINTENANCE],C[D.EnumEvent.NO_OPERATIONAL],C[D.EnumEvent.OPERATIONAL_DELAY],C[D.EnumEvent.OPERATIONAL]];function ze(){const e=(0,r.T)(),[t,i]=o.useState(null),s=Boolean(t),a=(t="NONE")=>{i(null),e("NONE"===t?(0,he.V)({columnField:"status",operatorValue:"contains",value:""}):(0,he.V)({columnField:"status",operatorValue:"contains",value:t})),console.log(t)};return(0,n.jsxs)("div",{children:[(0,n.jsx)(L.Z,Object.assign({style:{padding:"0px",margin:"0px"},"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:e=>{i(e.currentTarget)}},{children:(0,n.jsx)(P.Z,{},void 0)}),void 0),(0,n.jsx)(R.Z,Object.assign({id:"long-menu",anchorEl:t,keepMounted:!0,open:s,onClose:()=>a("NONE"),PaperProps:{style:{maxHeight:216,width:"20ch"}}},{children:Ue.map((e=>(0,n.jsx)(M.Z,Object.assign({onClick:()=>a(e)},{children:e}),e)))}),void 0)]},void 0)}const We=()=>{const{timesline:e,objetHourmeter:t}=(0,r.C)(he.rf),{currentTimelineList:i}=e,[s,a]=(0,o.useState)(!1),c=(0,r.T)(),[u,v]=(0,o.useState)({}),{dateShift:m}=(0,l.R)(),[h]=(0,d.l)(m);console.log("timesline",e);const g=i.some((e=>{var t;return!1===(null===(t=e.currentTimeline)||void 0===t?void 0:t.status)}))?"#808080":"#ec9f05";return(0,n.jsx)(k.ZP,Object.assign({title:"Close Shift"},{children:(0,n.jsxs)("button",Object.assign({onClick:()=>{return i=void 0,n=void 0,l=function*(){if(s){c((0,he.zA)(!0)),a(!1),c((0,he.S2)(t)),yield c((0,he.nx)());const e={shift:0,date:`${h}T00:00`};c((0,he.dy)()),v({}),yield c((0,he.mA)(e))}else e.currentTimelineList.forEach((e=>{var t;u[e.deviceId]={hourmeterCurrent:{value:null===(t=e.currentTimeline)||void 0===t?void 0:t.initialHourmeter.toFixed(2),error:!1}}})),c((0,he.zA)(!1)),c((0,he.x)(u)),a(!0)},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{r(l.next(e))}catch(e){t(e)}}function a(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(s,a)}r((l=l.apply(i,n||[])).next())}));var i,n,o,l},disabled:i.some((e=>{var t;return!1===(null===(t=e.currentTimeline)||void 0===t?void 0:t.status)})),style:{border:"none"}},{children:[s?(0,n.jsx)(F.Z,{htmlColor:g},void 0):(0,n.jsx)(_.Z,{htmlColor:g},void 0)," "]}),void 0)}),void 0)},Be=(e,t,i,s)=>[Object.assign(Object.assign({},f.mf9),{width:70,renderHeader:e=>(0,n.jsx)(k.ZP,Object.assign({title:"Select all"},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex",padding:"0px",margin:"0px"}},{children:[(0,n.jsx)(f.KOw,Object.assign({},e),void 0),(0,n.jsx)(ze,{},void 0)]}),void 0)}),void 0)}),{field:"truck",headerName:"Truck"},{field:"status",headerName:"Status",width:170},{field:"hmtStart",headerName:"Hourmeter",editable:s,type:"number"},{field:"hourmeterCurrent",headerName:"hourmeter Current",editable:!s,type:"number",renderHeader:e=>(0,n.jsx)(We,{},void 0)},{field:"adjustment",headerName:"adjustment",type:"number"},{field:"Opciones",headerName:"Opc",minWidth:110,renderCell:({row:s})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.ZP,Object.assign({onClick:()=>{console.log(s),t(s),e(!0)},title:"Add timeline"},{children:(0,n.jsx)(L.Z,Object.assign({size:"small"},{children:(0,n.jsx)(H.Z,{color:"primary",fontSize:"small"},void 0)}),void 0)}),void 0),(0,n.jsx)(k.ZP,Object.assign({onClick:()=>{t(s),i(!0)},title:"View Timeline"},{children:(0,n.jsx)(L.Z,Object.assign({size:"small"},{children:(0,n.jsx)(I.Z,{htmlColor:"Green",fontSize:"small"},void 0)}),void 0)}),void 0)]},void 0)}],Ke=o.memo((({setOpen:e,setTimelineCurrent:t,setOpenTimeline:i})=>{const s=T(),a=(0,r.T)(),{status:l,filterDataGrid:d,selectModel:c,initialEditRowsModel:u,statusUpdateInitialHourmeterTimeline:v,isEditableRows:m}=(0,r.C)(he.rf),{rows:h}=_e(),[g,j]=(0,o.useState)({}),[x,b]=(0,o.useState)(!0),[p,O]=(0,o.useState)({}),[E,S]=o.useState([]),{sortModel:N,handleModelGrid:C}=W("truck","asc");return(0,o.useEffect)((()=>{j({})}),[v]),(0,o.useEffect)((()=>{b("done"!==l&&"failed"!==l)}),[l]),(0,o.useEffect)((()=>{"done"===l&&S(c)}),[c]),(0,o.useEffect)((()=>{"done"===l&&(a((0,he.Cb)()),a((0,he.B6)([])))}),[h]),(0,o.useEffect)((()=>()=>{a((0,he.gI)())}),[]),(0,o.useEffect)((()=>{j(u)}),[u]),(0,n.jsx)("div",Object.assign({style:{height:"1150px",overflowY:"scroll",display:"flex",flexDirection:"column"}},{children:(0,n.jsx)(f._$r,{className:s.root,rowHeight:30,rows:h,columns:Be(e,t,i,m),density:"compact",components:{NoRowsOverlay:y},checkboxSelection:!0,disableSelectionOnClick:!0,sortModel:N,loading:x,onSelectionModelChange:e=>(e=>{const t=new Set(e),i=h.filter((e=>t.has(e.id.toString())));a((0,he.Xm)(i))})(e),disableColumnMenu:!0,editRowsModel:g,onEditRowsModelChange:e=>(e=>{var t="";for(var[i,n]of Object.entries(e))Object.keys(n).length<=1&&Object.keys(n).forEach((e=>{t=e}));var s=Object.assign({},e);switch(t){case"hourmeterCurrent":console.log("updatedModel",s),j(Object.assign(Object.assign({},g),s)),a((0,he.t8)(s));break;case"hmtStart":Object.keys(s).length>=2?(j({}),console.log("case modelxd",e),a((0,he.ZB)())):(Object.keys(s).forEach((e=>{if(s[e].hourmeterCurrent){var t=s[e].hourmeterCurrent.value>=10;s[e].hourmeterCurrent=Object.assign(Object.assign({},s[e].hourmeterCurrent),{error:!t})}})),j(s),a((0,he.SZ)(s)));break;default:console.log("case default")}})(e),filterModel:{items:[d]},getRowClassName:e=>`super-app-theme--${e.row.statusAdjustment}`},void 0)}),void 0)}));var Ge=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function o(e){try{r(n.next(e))}catch(e){a(e)}}function l(e){try{r(n.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}))};const Ye=()=>{const e=(0,r.T)(),{status:t,timelineErrorList:i,currentTimeline:u}=(0,r.C)(he.rf),{formValues:m}=(0,r.C)(c.k3),{dateShift:h}=(0,l.R)(),[g]=(0,d.l)(h),[f,x]=(0,o.useState)(Me.Shift.UNKNOWN_SHIFT),[b,p]=(0,o.useState)(!1),[O,E]=(0,o.useState)(!1),[T,S]=(0,o.useState)(!0),[N,y]=(0,o.useState)([]),C=(0,o.useCallback)((()=>{p(!1),S(!0),E(!1)}),[]);return(0,o.useEffect)((()=>{const t={shift:0,date:`${g}T00:00`};return e((0,he.mA)(t)),()=>{e((0,he.gI)())}}),[]),(0,o.useEffect)((()=>{var e,t;m.status&&(null===(t=null===(e=m.Substatus)||void 0===e?void 0:e.event)||void 0===t?void 0:t.id)?S(!1):S(!0)}),[m.status,m.Substatus]),(0,o.useEffect)((()=>{e((0,he.jO)(N))}),[N]),(0,n.jsxs)(a.Z,Object.assign({m:2,p:.5,style:{height:"100%"}},{children:[(0,n.jsx)(s.Z,{children:(0,n.jsx)(Fe,{},void 0)},void 0),(0,n.jsx)(s.Z,Object.assign({container:!0,style:{height:"100%"}},{children:(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,sm:12,xs:12},{children:(0,n.jsx)(Ke,{setOpen:p,setTimelineCurrent:y,setOpenTimeline:E},void 0)}),void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:b,handleClose:C,handleConfirm:()=>Ge(void 0,void 0,void 0,(function*(){yield e((0,he.Sp)()),p(!1),S(!0),yield function(){return Ge(this,void 0,void 0,(function*(){const t={shift:f,date:`${g}T00:00`};yield e((0,he.mA)(t))}))}()})),title:`Truck  ${N.truck}  `,disabled:T},{children:(0,n.jsx)(Re,{currentTimeline:u},void 0)}),void 0),(0,n.jsx)(v.a,Object.assign({open:O,handleClose:C,title:`Timeline to  ${N.truck} `,disabled:T},{children:(0,n.jsx)($e,{setClose:E},void 0)}),void 0),"done"===t&&!(null==i?void 0:i.success)&&(0,n.jsx)(j,{error:null==i?void 0:i.errorsList},void 0)]}),void 0)},qe=()=>(0,n.jsx)("div",{children:(0,n.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:7},{children:(0,n.jsx)(Ye,{},void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0,lg:5},{children:(0,n.jsx)(De,{},void 0)}),void 0)]}),void 0)},void 0);var Je=i(16281);const Xe=()=>(0,n.jsxs)("div",{children:[(0,n.jsx)(Je.h,{title:"Hourmeter",notificationPannel:!0},void 0),(0,n.jsx)(qe,{},void 0)]},void 0),Qe=Xe},16281:(e,t,i)=>{i.d(t,{h:()=>E});var n=i(85893),s=i(45258),a=i(28358),o=i(282),l=i(22318),r=i(43471),d=i(5977),c=i(55517),u=i(17812),v=i(96617),m=i(73637),h=i(79895),g=i(16575),j=i(51972),f=i(67294),x=i(73855),b=i(45855);const p=({title:e,content:t})=>(0,n.jsxs)("div",{children:[(0,n.jsxs)(l.Z,Object.assign({variant:"subtitle1"},{children:[(0,n.jsx)(g.Z,{style:{fontSize:"14px",marginRight:"4px"}},void 0),e]}),void 0),(0,n.jsx)(l.Z,Object.assign({variant:"body1"},{children:t}),void 0),(0,n.jsx)(c.Z,{},void 0)]},void 0),O=({})=>{var e,t,i;const[s,a]=(0,f.useState)(null),[o,r]=(0,f.useState)(!1),{notificationsHeader:d}=(0,x.C)(b.Af),c=(0,x.T)();(0,f.useEffect)((()=>{c((0,b.pK)())}),[]);const g=o&&Boolean(s)?"transition-popper":void 0;return console.log("notificationsHeader.notificationsList",d.notificationsList),(0,n.jsxs)("div",Object.assign({style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",width:"8%",marginRight:"4px"}},{children:[(0,n.jsx)(u.Z,Object.assign({color:(null===(e=d.notificationsList)||void 0===e?void 0:e.length)>0?"primary":"inherit",onClick:e=>{a(e.currentTarget),r((e=>!e))},size:"small"},{children:(0,n.jsxs)("div",Object.assign({style:{margin:"4px"}},{children:[(0,n.jsx)(l.Z,Object.assign({variant:"subtitle2",style:{color:"white",zIndex:1,position:"absolute",justifyContent:"right",marginLeft:"18px"}},{children:(null===(t=d.notificationsList)||void 0===t?void 0:t.length)>0?null===(i=d.notificationsList)||void 0===i?void 0:i.length:""}),void 0),(0,n.jsx)(j.Z,{},void 0)]}),void 0)}),void 0),(0,n.jsx)("div",Object.assign({style:{zIndex:1}},{children:(0,n.jsx)(v.Z,Object.assign({id:g,open:o,anchorEl:s,transition:!0,style:{zIndex:3}},{children:({TransitionProps:e})=>{var t,i,s;return(0,n.jsx)(m.Z,Object.assign({},e,{timeout:350},{children:(0,n.jsxs)(h.Z,Object.assign({elevation:3,style:{width:"300px",height:(null===(t=d.notificationsList)||void 0===t?void 0:t.length)>10?"87vh":"100%",padding:"8px",overflow:"scroll"}},{children:[(!d.notificationsList||0===(null===(i=d.notificationsList)||void 0===i?void 0:i.length))&&(0,n.jsx)(n.Fragment,{children:"Not Have a new Notification"},void 0),null===(s=d.notificationsList)||void 0===s?void 0:s.map(((e,t)=>(0,n.jsx)(p,{title:e.title,content:e.message},t)))]}),void 0)}),void 0)}}),void 0)}),void 0)]}),void 0)},E=({title:e,positionContainer:t,notificationPannel:i})=>{const c=t||"sticky",u=(0,d.k6)();return(0,n.jsx)(s.Z,Object.assign({position:c,color:"secondary",style:{display:"flex"},elevation:0},{children:(0,n.jsxs)("div",Object.assign({style:{display:"flex"}},{children:[(0,n.jsxs)(a.Z,Object.assign({variant:"dense",style:{width:"90%"}},{children:[(0,n.jsx)(o.Z,{size:"small",startIcon:(0,n.jsx)(r.Z,{color:"action",style:{color:"#fff"}},void 0),onClick:()=>{u.goBack()}},void 0),(0,n.jsx)(l.Z,Object.assign({variant:"h6"},{children:e}),void 0)]}),void 0),i&&(0,n.jsx)(O,{},void 0)]}),void 0)}),void 0)}}}]);