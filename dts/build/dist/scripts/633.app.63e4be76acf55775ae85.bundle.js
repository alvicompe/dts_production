(self.webpackChunkdts_hytera=self.webpackChunkdts_hytera||[]).push([[633],{63663:(e,t,i)=>{"use strict";i.d(t,{F2:()=>s,xu:()=>u.I,zx:()=>d,iz:()=>j,T5:()=>h,P4:()=>g,hU:()=>v,Mi:()=>x,IB:()=>a.C});var n=i(85893),o=i(8286),l=i(96588);const s=e=>(0,n.jsx)(l.ZP,Object.assign({},Object.assign({},e.propsAutocomplete),{renderInput:e=>(0,n.jsx)(o.Z,Object.assign({},e,{label:"Seleccione una opción",variant:"outlined"}),void 0)}),void 0);var a=i(45287),r=i(282);const d=e=>(0,n.jsx)(r.Z,Object.assign({},Object.assign({},e.propsButton),{children:e.label}),void 0);var c=i(17812);const v=e=>(0,n.jsx)(c.Z,Object.assign({},Object.assign({},e),{children:e.children}),void 0);var u=i(47463),m=i(41749);const h=e=>(0,n.jsx)(m.Z,Object.assign({},Object.assign({},e),{container:!0},{children:e.children}),void 0),g=e=>(0,n.jsx)(m.Z,Object.assign({},Object.assign({},e),{item:!0},{children:e.children}),void 0);var f=i(55517);const j=e=>(0,n.jsx)(f.Z,Object.assign({},Object.assign({},e)),void 0);var b=i(82285);const x=e=>(0,n.jsx)(b.Z,Object.assign({},Object.assign({},e),{children:(0,n.jsx)(m.Z,{children:e.children},void 0)}),void 0)},45287:(e,t,i)=>{"use strict";i.d(t,{C:()=>s});var n=i(85893),o=i(64436),l=i(8286);const s=e=>{const{propsTextField:t,propsForm:i}=e;return(0,n.jsx)(o.Z,Object.assign({},Object.assign({},i),{children:(0,n.jsx)(l.Z,Object.assign({},Object.assign({},t)),void 0)}),void 0)}},47463:(e,t,i)=>{"use strict";i.d(t,{I:()=>l});var n=i(85893),o=i(10046);const l=({children:e,height:t,width:i})=>(0,n.jsx)(o.Z,Object.assign({height:t,width:i},{children:e}),void 0)},2834:(e,t,i)=>{"use strict";i.d(t,{d:()=>s});var n=i(85893),o=i(282),l=i(95477);const s=e=>{var{loading:t,text:i}=e,s=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,["loading","text"]);return(0,n.jsx)(o.Z,Object.assign({},s,{disabled:t},{children:t?(0,n.jsx)(l.Z,{style:{width:"20px",height:"20px"}},void 0):i}),void 0)}},85335:(e,t,i)=>{"use strict";i.d(t,{Z:()=>v});var n=i(85893),o=i(67294),l=i(41120),s=i(35117),a=i(85639),r=i(64436),d=i(26209);const c=(0,l.Z)((e=>(0,s.Z)({formControl:{margin:e.spacing(1),minWidth:"100%"},selectEmpty:{marginTop:e.spacing(2)}})));function v(e){var{placeholder:t,iteams:i,selectValue:l,value:s}=e,v=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,["placeholder","iteams","selectValue","value"]);const u=c(),[m,h]=o.useState("");return(0,o.useEffect)((()=>{h(s||"")}),[s]),(0,o.useEffect)((()=>{l(m)}),[m]),(0,n.jsx)("div",{children:(0,n.jsx)(r.Z,Object.assign({className:u.formControl},{children:(0,n.jsxs)(d.Z,Object.assign({},v,{value:m,onChange:e=>{h(e.target.value)},displayEmpty:!0,className:u.selectEmpty,inputProps:{"aria-label":"Without label"}},{children:[(0,n.jsx)(a.Z,Object.assign({value:"",disabled:!0},{children:t}),void 0),null==i?void 0:i.map((e=>(0,n.jsx)(a.Z,Object.assign({value:null==e?void 0:e.value},{children:null==e?void 0:e.tittle}),e.value)))]}),void 0)}),void 0)},void 0)}},15635:(e,t,i)=>{"use strict";i.d(t,{r:()=>l});var n=i(67294),o=i(95090);const l=e=>{const[t,i]=(0,n.useState)(!1);return(0,n.useEffect)((()=>(e===o.JD.DONE||e===o.JD.UNKNOWN||e===o.JD.ERROR?i(!1):i(!0),()=>{i(!1)})),[e]),[t]}},42627:(e,t,i)=>{"use strict";i.r(t),i.d(t,{HourmeterView:()=>l,default:()=>s});var n=i(85893),o=i(49521);const l=()=>(0,n.jsxs)("div",{children:[(0,n.jsx)(o.h,{title:"Hourmeter"},void 0),(0,n.jsx)("div",{style:{marginTop:"60px"}},void 0)]},void 0),s=l},99167:(e,t,i)=>{"use strict";i.r(t),i.d(t,{HourmeterView:()=>$e,default:()=>We});var n=i(85893),o=i(71267),l=i(13258),s=i(41749),a=i(67162),r=i(30553),d=i(40074),c=i(282),v=i(67294),u=i(88093),m=i(73855),h=i(56731),g=i(93068),f=i(43856),j=i(38062),b=i(29829),x=i(85639),p=i(24837),E=i(52387),O=i(81605),S=i(93584),T=i(95090),y=i(78479),N=i(49032),I=i(67774),A=i(97700);const Z=43200,C=e=>{new Date;const[t]=(0,u.R)();t.getHours()>=7&&t.getHours()<19?(t.setHours(7),t.setSeconds(0),t.setMinutes(0),t.setMilliseconds(0)):(t.setHours(19),t.setSeconds(0),t.setMinutes(0),t.setMilliseconds(0));const i=((new Date).getTime()-t.getTime())/1e3;return{flex:i/Z||0,time:i}},w=e=>{if(e&&e.initialEventState&&e.initialEventState.event)switch(e.initialEventState.event.event){case N.EnumEvent.MAINTENANCE:return"#FF0000";case N.EnumEvent.OPERATIONAL:return"#069B15";case N.EnumEvent.NO_OPERATIONAL:return"#F1C012";case N.EnumEvent.OPERATIONAL_DELAY:return"#0000FF"}return"#fff"},D=e=>{switch(e){case N.EnumEvent.MAINTENANCE:return"#FF0000";case N.EnumEvent.OPERATIONAL:return"#069B15";case N.EnumEvent.NO_OPERATIONAL:return"#F1C012";case N.EnumEvent.OPERATIONAL_DELAY:return"#0000FF"}},L=e=>`${`0${e.getHours()}`.slice(-2)}:${`0${e.getMinutes()}`.slice(-2)}`;var H=i(41120),P=i(35117),F=i(89452),R=i(8286),k=i(62822),z=i(50998),M=i(95757),_=i(78721),$=i(17684),W=i(10646);const U=()=>{const[e]=(0,u.R)(),[t]=(0,W.l)(e),i=`${t}T00:00`;return[{shift:h.Shift.UNKNOWN_SHIFT,date:i}]},V=e=>{const{historyTimelineShift:t}=(0,m.C)(g.yV),[i]=(0,W.l)(new Date),[n]=(0,W.l)(new Date((new Date).getTime()-864e5)),[o,l]=(0,v.useState)(i);return(0,v.useEffect)((()=>{var o,s,a;(null===(o=t[0])||void 0===o?void 0:o.shift)===h.Shift.NIGHT&&new Date(1e3*(null===(a=null===(s=t[0])||void 0===s?void 0:s.shiftDate)||void 0===a?void 0:a.seconds)).toLocaleDateString()===(new Date).toLocaleDateString()?l(i):parseInt(e.split(":")[0])>=19&&parseInt(e.split(":")[0])<=23?l(n):l(i)}),[e]),[o]};const G=({handlePopoverClose:e,eventSelect:t})=>{var i,o,l;const{unitSelectList:a}=(0,m.C)(g.yV),[r]=U(),d=(0,m.T)(),[u,h]=(0,v.useState)(L(new Date)),[f]=V(u),[j,b]=(0,v.useState)("");(0,v.useEffect)((()=>{var e,t;const i=1===a.length?null===(t=null===(e=a[0])||void 0===e?void 0:e.initialHourmeter)||void 0===t?void 0:t.toFixed(2):"";b(i)}),[a]);const[x,p]=(0,v.useState)(),{eventStateList:E,statusEventStateList:O}=(0,m.C)(A.eG),S=1===a.length&&(null===(l=null===(o=null===(i=a[0])||void 0===i?void 0:i.initialEventState)||void 0===o?void 0:o.event)||void 0===l?void 0:l.event)===N.EnumEvent.MAINTENANCE;return O===T.JD.LOADING?(0,n.jsx)(n.Fragment,{children:"CARGANDO..."},void 0):(0,n.jsxs)(s.Z,{children:[(0,n.jsx)(R.Z,{label:"Entrada",type:"time",value:u,autoFocus:!0,name:"timeStart",size:"small",InputLabelProps:{shrink:!0,required:!0},onChange:e=>h(e.target.value)},void 0),S&&(0,n.jsx)(R.Z,{label:"H. salida",type:"number",name:"initialHourmeter",size:"small",value:j,style:{maxWidth:100},onChange:e=>{var t;return b(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value)},InputLabelProps:{shrink:!0}},void 0),t&&t.event!==N.EnumEvent.OPERATIONAL&&(0,n.jsx)(k.Z,{children:E.map(((e,t)=>(0,n.jsx)(z.Z,Object.assign({selected:(null==x?void 0:x.id)===e.id,dense:!0,button:!0,onClick:()=>p(e),disableGutters:!0},{children:(0,n.jsx)(M.Z,{secondary:e.name},void 0)}),t)))},void 0),(0,n.jsxs)(s.Z,Object.assign({container:!0},{children:[(0,n.jsx)(c.Z,Object.assign({onClick:e,color:"primary",variant:"outlined",size:"small"},{children:"CANCELAR"}),void 0),(0,n.jsx)(c.Z,Object.assign({disabled:!(null==x?void 0:x.id)&&t&&t.event!==N.EnumEvent.OPERATIONAL&&a.length>0,onClick:()=>{return i=void 0,n=void 0,l=function*(){var i;let n=x;t.event===N.EnumEvent.OPERATIONAL&&(n={eventState:_.EnumEventState.UNKNOWN_STATE,id:"",name:"",event:t}),n&&n.event?(S?yield(0,$.tV)({htm:j,Substatus:n,status:null===(i=null==n?void 0:n.event)||void 0===i?void 0:i.event,currentTimeline:a[0],date:f,time:u}):yield d((0,g.hd)({event:n.event,eventState:n,dateShift:f,hourStart:u})),e(),d((0,g.mA)(r))):alert("Seleccione un subestado")},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{r(l.next(e))}catch(e){t(e)}}function a(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(s,a)}r((l=l.apply(i,n||[])).next())}));var i,n,o,l},color:"secondary",variant:"contained",size:"small"},{children:"CONFIRMAR"}),void 0)]}),void 0)]},void 0)};const Y=(0,H.Z)((e=>(0,P.Z)({popover:{},paper:{padding:e.spacing(1),zIndex:5}}))),B=({list:e,setOpen:t,setSelected:i,selected:o})=>{const[l,s]=(0,v.useState)(e),a={id:"",name:"NINGUNO",event:N.EnumEvent.UNKNOWN_STATE_EVENT};return(0,v.useEffect)((()=>{const t=[...e];t.unshift(a),s(t)}),[e]),(0,n.jsx)(b.Z,Object.assign({id:"split-button-menu"},{children:l.map(((e,l)=>(0,n.jsx)(x.Z,Object.assign({disabled:e.event===N.EnumEvent.MAINTENANCE,selected:e===o,onClick:n=>((e,n)=>{i(n),t(!1)})(0,e)},{children:e.name}),l)))}),void 0)},J=()=>{var e,t,i;const{unitSelectList:o}=(0,m.C)(g.yV),l=o.map((e=>Object.assign(Object.assign({},e),{eventState:e.initialEventState}))),[s]=(e=>{const[t,i]=(0,v.useState)(!0),[n,o]=(0,v.useState)(!0),[l,s]=(0,v.useState)(!0);(0,v.useEffect)((()=>{r()&&(i(!1),o(!0),s(!1)),c()&&(i(!1),o(!1),s(!1)),a()&&(i(!0),o(!1),s(!1)),d()&&(i(!1),o(!1),s(!0)),0==c()&&0==a()&&0==d()&&0==r()&&(i(!0),o(!0),s(!0))}),[e]);const a=()=>0!==e.length&&e.every((e=>{var t,i;return(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===N.EnumEvent.NO_OPERATIONAL})),r=()=>0!==e.length&&e.every((e=>{var t,i;return(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===N.EnumEvent.OPERATIONAL})),d=()=>0!==e.length&&e.every((e=>{var t,i;return(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===N.EnumEvent.OPERATIONAL_DELAY})),c=()=>0!==e.length&&e.every((e=>{var t,i;return void 0===(null===(i=null===(t=e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)}));return[e=>{var i=!1;return e===N.EnumEvent.OPERATIONAL_DELAY&&(i=l),e===N.EnumEvent.OPERATIONAL&&(i=n),e===N.EnumEvent.NO_OPERATIONAL&&(i=t),e===N.EnumEvent.MAINTENANCE&&(i=!0),i}]})(l),a=Y(),[r,d]=(0,y._)("MOVE_SELECT_EVENT",!1),[u,h]=(0,v.useState)(),{eventList:f,statusEventList:j}=(0,m.C)(A.yJ),{historyTimelineShift:b}=(0,m.C)(g.yV),x=(0,m.T)(),Z=(0,v.useRef)(),[C,w]=(0,v.useState)(!1),[L,H]=(0,v.useState)(null),P=()=>{H(null),w(!1)},R=(e,t)=>{return i=void 0,n=void 0,l=function*(){H(e.currentTarget),yield x((0,F.Gy)(t));const i=f.find((e=>e.event===t));d(i)},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{r(l.next(e))}catch(e){t(e)}}function a(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(s,a)}r((l=l.apply(i,n||[])).next())}));var i,n,o,l};(0,v.useEffect)((()=>{x((0,g.Rt)()),null==b||b.map((e=>{var t,i;(null===(i=null===(t=null==e?void 0:e.eventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===(null==u?void 0:u.event)&&x((0,g.WZ)(e))}))}),[u]),(0,v.useEffect)((()=>{x((0,I.TU)())}),[]);const k=j===T.JD.DONE?null===(e=null==f?void 0:f.find((e=>e.event.toString()===N.EnumEvent.NO_OPERATIONAL.toString())))||void 0===e?void 0:e.name:null,z=j===T.JD.DONE?null===(t=null==f?void 0:f.find((e=>e.event.toString()===N.EnumEvent.OPERATIONAL.toString())))||void 0===t?void 0:t.name:null,M=j===T.JD.DONE?null===(i=null==f?void 0:f.find((e=>e.event.toString()===N.EnumEvent.OPERATIONAL_DELAY.toString())))||void 0===i?void 0:i.name:null,_=Boolean(L);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.Z,Object.assign({variant:"contained",color:"primary",ref:Z,size:"small","aria-owns":_?"mouse-over-popover":void 0,"aria-label":"split button"},{children:[(0,n.jsx)(c.Z,Object.assign({style:{padding:4,margin:0,color:"#fff",fontSize:10,background:r?D(N.EnumEvent.NO_OPERATIONAL):"grey"},size:"small",onClick:r?e=>R(e,N.EnumEvent.NO_OPERATIONAL):void 0},{children:k}),void 0),(0,n.jsx)(c.Z,Object.assign({style:{padding:4,margin:0,color:"#fff",fontSize:10,background:r?D(N.EnumEvent.OPERATIONAL):"grey"},size:"small",onClick:r?e=>R(e,N.EnumEvent.OPERATIONAL):void 0},{children:z}),void 0),(0,n.jsx)(c.Z,Object.assign({style:{padding:4,margin:0,color:"#fff",fontSize:10,background:r?D(N.EnumEvent.OPERATIONAL_DELAY):"grey"},size:"small",onClick:r?e=>R(e,N.EnumEvent.OPERATIONAL_DELAY):void 0},{children:M}),void 0),(0,n.jsx)(c.Z,Object.assign({color:"primary",size:"small","aria-controls":"split-button-menu","aria-expanded":"true","aria-label":"select merge strategy","aria-haspopup":"menu",onClick:()=>{w((e=>!e))},style:{padding:0,margin:0,color:"#fff",background:S.sb}},{children:(0,n.jsx)(O.Z,{fontSize:"small"},void 0)}),void 0)]}),void 0),(0,n.jsx)(E.ZP,Object.assign({open:C,anchorEl:Z.current,role:void 0,id:"mouse-list-popover",className:a.popover,classes:{paper:a.paper},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:P},{children:(0,n.jsx)(B,{setOpen:w,list:j===T.JD.DONE?f:[],selected:u,setSelected:h},void 0)}),void 0),(0,n.jsx)(E.ZP,Object.assign({id:"mouse-over-popover",className:a.popover,classes:{paper:a.paper},open:_,anchorEl:L,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},onClose:P},{children:(0,n.jsx)(G,{eventSelect:r,handlePopoverClose:P},void 0)}),void 0)]},void 0)};var K=i(39704),q=i(46067),X=i(89449),Q=i(63663),ee=i(81449);const te=()=>{const[e,t]=(0,v.useState)({flex:0,time:0}),[i]=(0,u.R)();return(0,v.useEffect)((()=>{i.getHours()>=7&&i.getHours()<19?t(C(h.Shift.DAY)):t(C(h.Shift.NIGHT)),setInterval((()=>{i.getHours()>=7&&i.getHours()<19?t(C(h.Shift.DAY)):t(C(h.Shift.NIGHT))}),5e3)}),[]),{currentLine:e}},ie=(0,H.Z)((()=>({borderLeft:{borderLeftColor:"gray",borderLeftWidth:1,borderLeftStyle:"dashed",width:80,paddingLeft:4},inputHourmeterFinal:{borderColor:e=>e.error?"orange":"#ccc",borderRadius:2,width:80,paddingLeft:4},borderAdjustement:{borderLeftColor:"gray",borderLeftWidth:1,borderLeftStyle:"dashed",color:e=>e.errorAjustment?"red":"grey",textAlign:"center",width:80}}))),ne=(e,t,i)=>{if(e<0)return null;let n;const o=i?`input_close_${e===t?0:e+1}`:`input_close_${0===e?t:e-1}`;return n=document.getElementById(o),n&&n.disabled&&(n=null),!n&&e<t&&0!==e?ne(i?e+1:e-1,t,i):n},oe=({currentTimeline:e,index:t,lastIndex:i,timeFinal:o,setTimeFinal:a})=>{var r,d,c,u,h,f,j,b,x,p;const{}=te(),E=(0,m.T)(),{unitSelectList:O,historyTimelineShift:S}=(0,m.C)(g.yV),{error:T,textInput:I,onChangeText:A,onKeyDown:Z}=(({currentState:e,setTimeFinal:t,timeFinal:i})=>{const[n,o]=(0,y._)("close_shift_units",[]),[l,s]=(0,v.useState)(null),[a,r]=(0,v.useState)(""),[d,c]=(0,v.useState)(!1);(0,v.useEffect)((()=>{const i=n.find((t=>t.deviceId===e.deviceId));i&&(r(0===i.hourmeter?"":`${i.hourmeter}`),t(i.time))}),[]);return{error:d,textInput:a,setTextInput:r,timeFinal:i,setTimeFinal:t,onChangeText:i=>{r(i.target.value),t(i.target.value?(new Date).getTime()/1e3:-1),clearTimeout(l);const n=setTimeout((()=>(t=>{var i;const n=localStorage.getItem("close_shift_units"),l=n?JSON.parse(n):[],s=l.findIndex((t=>t.deviceId===e.deviceId)),a=t,r=(new Date).getTime()/1e3,d={deviceId:e.deviceId,hourmeter:a>0?a:0,time:a>0?r:0},c=[...l];-1===s?c.push(d):c[s]=d,null===(i=null==e?void 0:e.initialTime)||void 0===i||i.seconds,o(c)})(Number(i.target.value))),500);s(n)},onKeyDown:()=>{clearTimeout(l)}}})({currentState:e,setTimeFinal:a,timeFinal:o}),C=((e,t)=>{var i,n,o,l,s,a;if((null===(n=null===(i=e.initialEventState)||void 0===i?void 0:i.event)||void 0===n?void 0:n.event)!==N.EnumEvent.NO_OPERATIONAL&&(null===(l=null===(o=e.initialEventState)||void 0===o?void 0:o.event)||void 0===l?void 0:l.event)!==N.EnumEvent.MAINTENANCE){if(-1===t){const t=((new Date).getTime()/1e3-(null===(s=null==e?void 0:e.initialTime)||void 0===s?void 0:s.seconds))/3600;return(e.initialHourmeter+t).toFixed(2)}const i=((t||(new Date).getTime()/1e3)-(null===(a=null==e?void 0:e.initialTime)||void 0===a?void 0:a.seconds))/3600;return(e.initialHourmeter+i).toFixed(2)}return e.initialHourmeter.toFixed(2)})(e,Number(o)),w=Number(I)>0?Number(I)-Number(C):0,D=ie({error:T,errorAjustment:w>=.3||w<=-.3}),L=(0,v.useCallback)((()=>O.some((t=>t.deviceId===e.deviceId))),[O]),H=S.find((t=>t.deviceId===e.deviceId));(0,v.useEffect)((()=>{var t,i;(null===(i=null===(t=e.initialEventState)||void 0===t?void 0:t.event)||void 0===i?void 0:i.event)===N.EnumEvent.MAINTENANCE?A({target:{value:e.initialHourmeter}}):A({target:{value:""}})}),[null===(d=null===(r=e.initialEventState)||void 0===r?void 0:r.event)||void 0===d?void 0:d.event]);const P=null===(c=null==e?void 0:e.deviceAlias)||void 0===c?void 0:c.split("-"),F=1===P.length?P[0]:`${P[0]}${P[1].slice(-2)}`;return(0,n.jsxs)(s.Z,Object.assign({style:{width:400,display:"flex",textAlign:"center"}},{children:[(0,n.jsxs)("label",Object.assign({style:{width:30,userSelect:"none",flex:2}},{children:[(0,n.jsx)(l.Z,{onClick:()=>{E((0,g.WZ)(e))},checked:L(),style:{padding:0,flex:1},size:"small"},void 0),F]}),void 0),(0,n.jsx)("label",Object.assign({className:D.borderLeft},{children:null===(f=null===(h=null===(u=H.historyShiftList)||void 0===u?void 0:u.at(-1))||void 0===h?void 0:h.initialHourmeter)||void 0===f?void 0:f.toFixed(2)}),void 0),(0,n.jsx)("label",Object.assign({className:D.borderLeft},{children:C}),void 0),(0,n.jsx)("label",Object.assign({className:D.borderAdjustement},{children:I?w.toFixed(2):"...."}),void 0),(0,n.jsx)("input",{id:`input_close_${t}`,className:D.inputHourmeterFinal,disabled:(null===(b=null===(j=e.initialEventState)||void 0===j?void 0:j.event)||void 0===b?void 0:b.event)===N.EnumEvent.MAINTENANCE,value:(null===(p=null===(x=e.initialEventState)||void 0===x?void 0:x.event)||void 0===p?void 0:p.event)===N.EnumEvent.MAINTENANCE?e.initialHourmeter.toFixed(2):I,pattern:"^[0-9]",onChange:A,onKeyDown:n=>{let o=null;switch(n.key){case"ArrowDown":o=ne(t,i,!0),A({target:{value:I}});break;case"ArrowUp":o=ne(t,i,!1),A({target:{value:I}});break;case"Enter":o=ne(t,i,!0),E((0,g.tj)({hourmeter:n.value,deviceId:e.deviceId})),A({target:{value:I}});break;default:Z()}o&&o.focus()}},void 0)]}),void 0)};var le=i(96617),se=i(79895),ae=i(73914),re=i(15635),de=i(19238),ce=i(28428),ve=i(2834),ue=function(e,t,i,n){return new(i||(i=Promise))((function(o,l){function s(e){try{r(n.next(e))}catch(e){l(e)}}function a(e){try{r(n.throw(e))}catch(e){l(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}r((n=n.apply(e,t||[])).next())}))};const me=(0,ae.Z)((()=>({root:{minWidth:150,padding:4,borderWidth:2,borderStyle:"solid"}}))),he=e=>{var t;const i=new Date(1e3*(null===(t=null==e?void 0:e.initialTime)||void 0===t?void 0:t.seconds)),n=(null==e?void 0:e.finalTime)?new Date(1e3*(null==e?void 0:e.finalTime.seconds)):new Date;return{timeInitial:i,timeFinal:n,hourInitial:L(i),hourFinal:L(n)}},ge=({timeline:e})=>{var t,i,l,a,r,d,c,u;const h=w(e),[f]=U(),{statusUpdateTimeline:j}=(0,m.C)(g.yV),{historyTimelineShift:b,statusDelete:x}=(0,m.C)(g.yV),[p]=(0,re.r)(j),[E]=(0,re.r)(x),O=(0,K.I0)(),S=me(),T=(0,v.useRef)(),{hourInitial:y,hourFinal:I}=he(e),[A,Z]=(0,v.useState)(y),[C,D]=(0,v.useState)(null===(t=null==e?void 0:e.initialHourmeter)||void 0===t?void 0:t.toFixed(1)),[L,H]=(0,v.useState)(!1),[P,F]=(0,v.useState)(!0);(0,v.useEffect)((()=>{var t,i,n,o;const l=b.find((t=>t.deviceId===e.deviceId));H(!1),F(!0),(null===(i=null===(t=null==l?void 0:l.historyShiftList)||void 0===t?void 0:t.at(-1))||void 0===i?void 0:i.id)===(null==e?void 0:e.id)&&(H(!0),F(!0)),(null===(o=null===(n=null==l?void 0:l.historyShiftList)||void 0===n?void 0:n.at(0))||void 0===o?void 0:o.id)===(null==e?void 0:e.id)&&(H(!1),F(!1))}),[e]),(0,v.useEffect)((()=>{var t;const{hourInitial:i}=he(e);Z(i),D(null===(t=null==e?void 0:e.initialHourmeter)||void 0===t?void 0:t.toFixed(1)),T.current&&setTimeout((()=>{T.current.focus()}),100)}),[e]);const k=(null==e?void 0:e.finalHourmeter)-(null==e?void 0:e.initialHourmeter),z=()=>ue(void 0,void 0,void 0,(function*(){var t;const[i,n]=A.split(":"),[o,l]=y.split(":"),s=Number(i)-Number(o);if(0==1e3*(60*(Number(n)-Number(l))+60*s*60)||!e.id)return;const a={};a.id=e.id,a.deviceId=e.deviceId,a.deviceAlias=e.deviceAlias,a.initialHourmeter=e.initialHourmeter,a.finalHourmeter=e.finalHourmeter,a.initialState=e.initialState,a.finalState=e.finalState,a.date=(0,de.v)(new Date),a.time=A,e.finalTime&&(a.finalTime={seconds:null===(t=e.finalTime)||void 0===t?void 0:t.seconds}),a.shiftDate={seconds:e.shiftDate.seconds},a.shift=e.shift,console.log(a),yield O((0,g.ft)(a)),O((0,g.mA)(f))}));return(0,n.jsx)(se.Z,Object.assign({elevation:4,className:S.root,style:{borderColor:h}},{children:(0,n.jsxs)(Q.T5,Object.assign({alignItems:"center",justifyContent:"center",direction:"row",style:{gap:4,alignItems:"stretch"}},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"column",style:{height:"100%"}},{children:[(0,n.jsx)(Q.P4,{children:(0,n.jsx)(o.Z,{size:"small",label:null==e?void 0:e.deviceAlias},void 0)},void 0),(0,n.jsx)(Q.P4,{children:(0,n.jsx)(o.Z,{style:{background:h,color:"#fff"},size:"small",label:(0,n.jsx)("span",Object.assign({style:{fontSize:9}},{children:null===(l=null===(i=null==e?void 0:e.initialEventState)||void 0===i?void 0:i.event)||void 0===l?void 0:l.name}),void 0)},void 0)},void 0),(null===(a=e.initialEventState)||void 0===a?void 0:a.name)&&(0,n.jsx)(Q.P4,{children:(0,n.jsx)(o.Z,{style:{maxWidth:150,borderWidth:2,borderStyle:"solid",borderColor:h},size:"small",label:(0,n.jsx)("span",Object.assign({style:{fontSize:9}},{children:null===(r=e.initialEventState)||void 0===r?void 0:r.name}),void 0)},void 0)},void 0),(0,n.jsx)(Q.P4,{children:(0,n.jsx)(o.Z,{size:"small",label:k>=0?`${k.toFixed(1)}h`:"..."},void 0)},void 0),(0,n.jsx)(Q.P4,{children:(0,n.jsx)(o.Z,{size:"small",label:new Date(1e3*(null===(d=null==e?void 0:e.initialTime)||void 0===d?void 0:d.seconds)).toLocaleDateString()},void 0)},void 0)]}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"column"},{children:[(0,n.jsx)(R.Z,{label:"Entrada",type:"time",disabled:!P,value:A,autoFocus:!0,onKeyDown:e=>ue(void 0,void 0,void 0,(function*(){"Enter"===e.key&&z()})),name:"timeStart",size:"small",inputRef:T,InputLabelProps:{shrink:!0,required:!0},onChange:e=>Z(e.target.value)},void 0),(0,n.jsx)(R.Z,{label:"Salida",type:"time",name:"timeEnd",size:"small",disabled:!0,value:I},void 0)]}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"column"},{children:[(0,n.jsx)(R.Z,{label:"H. inicial",type:"number",name:"initialHourmeter",size:"small",disabled:(null===(u=null===(c=null==e?void 0:e.initialEventState)||void 0===c?void 0:c.event)||void 0===u?void 0:u.event.toString())!=N.EnumEvent.MAINTENANCE.toString(),value:C,style:{maxWidth:100},onChange:e=>D(e.target.value),InputLabelProps:{shrink:!0}},void 0),(0,n.jsx)(R.Z,{label:"H. final ",name:"initialHourmeter",size:"small",disabled:!0,style:{maxWidth:100},value:e.finalHourmeter?e.finalHourmeter.toFixed(1):"...",InputLabelProps:{shrink:!0}},void 0)]}),void 0)}),void 0),P&&(0,n.jsx)(ve.d,{size:"small",variant:"contained",color:"secondary",onClick:z,text:"GUARDAR",loading:p},void 0),L&&(0,n.jsx)(ve.d,{size:"small",variant:"contained",onClick:()=>ue(void 0,void 0,void 0,(function*(){const t={};t.id=e.id,t.deviceId=e.deviceId,yield O((0,g.a8)(t)),O((0,g.mA)(f))})),style:{background:"rgb(154, 0, 54)",color:"white"},startIcon:(0,n.jsx)(ce.Z,{},void 0),loading:!1,text:"Borrar"},void 0)]}),void 0)}),void 0)};var fe=i(10046),je=i(85335);const be=({timeline:e})=>{var t,i;w(e);const[l]=U(),a=new Date,r=`0${a.getHours()}`,d=`0${a.getMinutes()}`,u=(0,K.I0)(),h=me(),f=(0,v.useRef)(),[j,b]=(0,v.useState)(`${r.slice(-2)}:${d.slice(-2)}`),[x]=V(j),{eventStateList:p,statusEventStateList:E}=(0,m.C)(A.eG),[O]=function(e,t){const[i,n]=(0,v.useState)(0);return(0,v.useEffect)((()=>{var i;const o=new Date;o.setHours(Number.parseInt(e.split(":")[0])),o.setMinutes(Number.parseInt(e.split(":")[1]));const l=new Date(1e3*(null===(i=null==t?void 0:t.initialTime)||void 0===i?void 0:i.seconds));var s=(o.getTime()-l.getTime())/1e3;let a=1/60*Math.ceil(s/60);const r=Number.parseFloat(t.initialHourmeter)+Number.parseFloat(a);return n(Number.parseFloat(r.toFixed(2))),()=>{n(0)}}),[e]),[i]}(j,e),[S,T]=(0,v.useState)("");(0,v.useEffect)((()=>{setTimeout((()=>{T(O)}),100)}),[O]),(0,v.useEffect)((()=>{u((0,F.Gy)(N.EnumEvent.MAINTENANCE))}),[]);const[y,I]=v.useState();return console.log("selectValue",p),(0,n.jsx)(fe.Z,Object.assign({component:"form",onSubmit:t=>{return i=void 0,n=void 0,s=function*(){var i;t.preventDefault();const n={},o=p.find((e=>e.eventState===y));n.deviceId=null==e?void 0:e.deviceId,n.deviceAlias=null==e?void 0:e.deviceAlias,n.assetType=null==e?void 0:e.assetType,n.initialHourmeter=S,n.initialState=N.EnumEvent.MAINTENANCE,n.initialEventState=o,n.date=x,n.time=j,n.shiftDate={seconds:null===(i=null==e?void 0:e.shiftDate)||void 0===i?void 0:i.seconds},n.shift=null==e?void 0:e.shift,n.eventState=o,yield u((0,g.qZ)(n)),u((0,g.mA)(l))},new((o=void 0)||(o=Promise))((function(e,t){function l(e){try{r(s.next(e))}catch(e){t(e)}}function a(e){try{r(s.throw(e))}catch(e){t(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(l,a)}r((s=s.apply(i,n||[])).next())}));var i,n,o,s}},{children:(0,n.jsx)(se.Z,Object.assign({elevation:4,className:h.root,style:{borderColor:D(N.EnumEvent.MAINTENANCE)}},{children:(0,n.jsxs)(Q.T5,Object.assign({alignItems:"center",justifyContent:"center",direction:"row",style:{gap:4,alignItems:"stretch"}},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"column",style:{height:"100%"}},{children:[(0,n.jsx)(Q.P4,{children:(0,n.jsx)(o.Z,{size:"small",label:null==e?void 0:e.deviceAlias},void 0)},void 0),(0,n.jsx)(Q.P4,{children:(0,n.jsx)(o.Z,{style:{background:D(N.EnumEvent.MAINTENANCE),color:"#fff"},size:"small",label:(0,n.jsx)("span",Object.assign({style:{fontSize:9}},{children:null===(i=null===(t=p[0])||void 0===t?void 0:t.event)||void 0===i?void 0:i.name}),void 0)},void 0)},void 0),(0,n.jsx)(je.Z,{required:!0,value:"",placeholder:"Estado",iteams:p.map((e=>({value:e.eventState,tittle:e.name}))),selectValue:I},void 0)]}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsx)(s.Z,Object.assign({container:!0,direction:"column"},{children:(0,n.jsx)(R.Z,{required:!0,label:"Entrada",type:"time",value:j,autoFocus:!0,name:"timeStart",size:"small",inputRef:f,InputLabelProps:{shrink:!0,required:!0},onChange:e=>b(e.target.value)},void 0)}),void 0)}),void 0),(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"column"},{children:[(0,n.jsx)(R.Z,{required:!0,label:"H. inicial",type:"number",name:"initialHourmeter",size:"small",value:S,style:{maxWidth:100},onChange:e=>T(e.target.value),InputLabelProps:{shrink:!0}},void 0),(0,n.jsx)(R.Z,{label:"H. final ",name:"initialHourmeter",size:"small",disabled:!0,style:{maxWidth:100},value:(null==e?void 0:e.finalHourmeter)?null==e?void 0:e.finalHourmeter.toFixed(1):"...",InputLabelProps:{shrink:!0}},void 0)]}),void 0)}),void 0),(0,n.jsx)(c.Z,Object.assign({size:"small",type:"submit",variant:"contained",color:"secondary"},{children:"GUARDAR"}),void 0)]}),void 0)}),void 0)}),void 0)},xe=(0,H.Z)({layoutPopper:{position:"absolute",top:0,bottom:0,right:0,left:0,zIndex:3},arrowPopper:{width:11,height:4,background:e=>e.color,transform:"translateX(-7px) rotate(40deg)"},rootPopper:{zIndex:5,marginTop:8,marginLeft:6}}),pe=()=>{var e,t;const i=(0,m.T)(),{currentTimeline:o,currentMantoTimeline:l}=(0,m.C)(g.yV),[s,a]=(0,v.useState)(null);(0,v.useEffect)((()=>{if(o){const e=document.getElementById(`state-${(null==o?void 0:o.id)?null==o?void 0:o.id:null==o?void 0:o.deviceId}`);e&&a(e),o&&i((0,g.Gf)())}}),[o]),(0,v.useEffect)((()=>{if(l){const e=document.getElementById(`stateManto-${(null==l?void 0:l.id)?null==l?void 0:l.id:null==l?void 0:l.deviceId}`);e&&a(e),l&&i((0,g.IE)())}}),[l]);const r=o?w(o):"#fff",d=xe({color:r});return s&&(o||l)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(le.Z,Object.assign({open:!!o||!!l,className:d.rootPopper,anchorEl:s,placement:"right-start"},{children:[l&&(null===(t=null===(e=l.initialEventState)||void 0===e?void 0:e.event)||void 0===t?void 0:t.event)!==N.EnumEvent.MAINTENANCE&&(0,n.jsxs)(v.Fragment,{children:[(0,n.jsx)("div",{className:d.arrowPopper},void 0),(0,n.jsx)(be,{timeline:l},void 0)]},void 0),o&&(0,n.jsxs)(v.Fragment,{children:[(0,n.jsx)("div",{className:d.arrowPopper},void 0),(0,n.jsx)(ge,{timeline:o},void 0)]},void 0)]}),void 0),(0,n.jsx)("div",{onClick:()=>{i((0,g.IE)()),i((0,g.Gf)())},className:d.layoutPopper},void 0)]},void 0):(0,n.jsx)(n.Fragment,{},void 0)},Ee=(0,H.Z)((()=>({root:{position:"absolute",display:"flex",bottom:0,right:400,left:50,top:-4},itemHour:{flex:1,borderRightColor:"grey",borderRightWidth:1,borderRightStyle:"dashed",position:"relative"},labelItemHour:{color:"rgb(131 126 126)",position:"absolute",left:-19,top:-8,userSelect:"none"},rootTimeline:{position:"absolute",right:0,height:"100%",left:0,display:"flex",zIndex:0},beforeTimeline:{height:0},afterTimeline:{height:0,borderRightColor:"#ccc",borderRightWidth:1,borderRightStyle:"dashed"},line:{width:1,background:S.Jx,height:"100%"},rootLine:{paddingTop:8,height:"100%"}}))),Oe=({shift:e})=>{const{currentLine:t}=te(),i=Ee(),o=(e=>e===h.Shift.DAY?[7,8,9,10,11,12,13,14,15,16,17,18]:[19,20,21,22,23,0,1,2,3,4,5,6])(e),l=(0,v.useMemo)((()=>o.map(((e,t)=>(0,n.jsx)("div",Object.assign({className:i.itemHour},{children:(0,n.jsxs)("label",Object.assign({className:i.labelItemHour},{children:[`0${e}`.slice(-2),":00"]}),void 0)}),t)))),[o]);return(0,n.jsxs)(s.Z,Object.assign({className:i.root},{children:[l,(0,n.jsxs)("div",Object.assign({className:i.rootTimeline},{children:[(0,n.jsx)("div",{className:i.beforeTimeline,style:{flex:t.flex}},void 0),(0,n.jsx)("div",Object.assign({className:i.rootLine},{children:(0,n.jsx)("div",{className:i.line},void 0)}),void 0),(0,n.jsx)("div",{className:i.afterTimeline,style:{flex:1-t.flex}},void 0)]}),void 0)]}),void 0)},Se=(0,H.Z)((()=>({rootUnitState:{height:2,position:"relative"},dotUnitState:{width:12,height:12,borderRadius:6,background:"#fff",position:"absolute",borderColor:"#6d6c6c",borderWidth:2,borderStyle:"solid",top:-5,left:-4,zIndex:5,cursor:"pointer"},dotUnitStateCurrent:{width:12,height:12,borderRadius:6,position:"absolute",top:-5,right:-5,zIndex:4,cursor:"pointer"},dotLabelHour:{fontSize:9,position:"absolute",left:-4,bottom:-15,userSelect:"none"},rootRowTimeline:{background:e=>e.indexTimeline%2!=0?"#cccccc52":"#fff","&:hover, &:focus":{backgroundColor:"#ccc"}}}))),Te=({state:e,line:t,setState:i})=>{var o,l;const a=(0,m.T)(),{currentTimeline:r}=(0,K.v9)(g.yV),d=Se({}),[c,u]=(0,v.useState)(!1),h=(0,v.useRef)(),f=(null===(o=null==e?void 0:e.finalTime)||void 0===o?void 0:o.seconds)-(null===(l=null==e?void 0:e.initialTime)||void 0===l?void 0:l.seconds),j=(0,v.useCallback)((()=>{a((0,g.Sf)(e))}),[e]);return(0,v.useEffect)((()=>{(null==r?void 0:r.id)===e.id&&a((0,g.Sf)(e))}),[e]),(0,v.useCallback)((n=>{var o,l;if(!c||!h.current||!t.current)return;const s=(t.current.clientWidth-(n.clientX-t.current.offsetLeft-32))*f/t.current.clientWidth;if(console.log("TIMEEEE",s,f),i){const t=new q.Timeline,n=new Date(1e3*((null===(o=null==e?void 0:e.initialTime)||void 0===o?void 0:o.seconds)-(f-s))),a=new Date(1e3*(null===(l=null==e?void 0:e.finalTime)||void 0===l?void 0:l.seconds));t.setInitialTime((0,X.X)(n.toString())),t.setFinalTime((0,X.X)(a.toString())),console.log("initialTime",t.toObject()),i(t.toObject())}}),[c,t,e]),(0,v.useCallback)((e=>{e.target===h.current&&u(!0)}),[h]),(0,n.jsx)(s.Z,{id:`state-${e.id?e.id:e.deviceId}`,className:d.dotUnitState,onMouseEnter:j,ref:h,style:{borderColor:w(e)}},void 0)},ye=({state:e})=>{var t;const[i,o]=(0,v.useState)(e);(0,v.useEffect)((()=>{o(e)}),[e]);const l=(0,v.useRef)(),s=new Date(1e3*(null===(t=null==i?void 0:i.initialTime)||void 0===t?void 0:t.seconds)).getMinutes(),a=Se({}),r=(e=>{var t,i;return(null==e?void 0:e.finalTime)?(null===(t=null==e?void 0:e.finalTime)||void 0===t?void 0:t.seconds)-(null===(i=null==e?void 0:e.initialTime)||void 0===i?void 0:i.seconds):0})(i)/Z;return(0,n.jsxs)("div",Object.assign({className:a.rootUnitState,style:{flex:r,zIndex:4,background:w(i)},ref:l},{children:[(0,n.jsx)(Te,{state:i,line:l,setState:o},void 0),s?(0,n.jsx)("label",Object.assign({className:a.dotLabelHour},{children:`0${s}`.slice(-2)}),void 0):(0,n.jsx)(n.Fragment,{},void 0)]}),void 0)},Ne=({currentTimeline:e,timeFinal:t})=>{var i,o;const{}=te(),l=Se({}),[a]=(0,ee.v)(),r=new Date(1e3*(null===(i=null==e?void 0:e.initialTime)||void 0===i?void 0:i.seconds)).getMinutes(),[d,c]=(0,v.useState)(((t>0?t:(new Date).getTime()/1e3)-(null===(o=null==e?void 0:e.initialTime)||void 0===o?void 0:o.seconds))/Z);(0,v.useEffect)((()=>{var i;c(((t>0?t:(new Date).getTime()/1e3)-(null===(i=null==e?void 0:e.initialTime)||void 0===i?void 0:i.seconds))/Z);const n=setInterval((()=>{var i;c(((t>0?t:(new Date).getTime()/1e3)-(null===(i=null==e?void 0:e.initialTime)||void 0===i?void 0:i.seconds))/Z)}),5e3);return()=>{window.clearInterval(n)}}),[e]);const u=w(e),h=(0,m.T)();return(0,n.jsxs)("div",Object.assign({className:l.rootUnitState,style:{flex:d||0,background:u}},{children:[(0,n.jsx)(s.Z,{className:l.dotUnitState,onMouseEnter:()=>h((0,g.Sf)(e)),style:{flex:d||0,borderColor:w(e)},id:`state-${e.id?e.id:e.deviceId}`},void 0),r?(0,n.jsx)("label",Object.assign({className:l.dotLabelHour},{children:`0${r}`.slice(-2)}),void 0):(0,n.jsx)(n.Fragment,{},void 0),(0,n.jsx)(s.Z,{className:l.dotUnitStateCurrent,id:`stateManto-${e.id?e.id:e.deviceId}`,onMouseEnter:()=>h((0,g.MD)(e)),style:{background:u}},void 0)]}),void 0)},Ie=e=>{var t;const{}=te();return(null===(t=e.initialEventState)||void 0===t?void 0:t.eventState)===_.EnumEventState.CHANGE_OF_SHIFT?w(e):"#ccc"},Ae=e=>{var t;const[i]=(0,u.R)();i.getHours()>=7&&i.getHours()<19?(i.setHours(7),i.setMinutes(0),i.setSeconds(0)):(i.setHours(19),i.setMinutes(0),i.setSeconds(0));const n=(new Date).getTime()/1e3,o=null===(t=null==e?void 0:e.initialTime)||void 0===t?void 0:t.seconds,l=o>n?o:n;return(i.getTime()/1e3-l)/Z},Ze=({currentTimeline:e})=>(0,n.jsx)("div",Object.assign({style:{flex:Ae(e),height:12,display:"flex",alignItems:"center"}},{children:(0,n.jsx)("div",{style:{width:"100%",background:Ie(e),height:1}},void 0)}),void 0),Ce=({states:e,currentTimeline:t,timeFinal:i})=>{const[o,l]=(0,v.useState)(t);return(0,v.useEffect)((()=>(l(t),()=>{})),[o,e]),e?(0,n.jsx)(s.Z,Object.assign({item:!0,style:{flex:1,marginTop:2,marginBottom:2}},{children:(0,n.jsxs)(Q.T5,Object.assign({alignItems:"center"},{children:[null==e?void 0:e.map(((e,t)=>(null==e?void 0:e.id)!==(null==o?void 0:o.id)&&(0,n.jsx)(ye,{state:e},t))),(0,n.jsx)(Ne,{currentTimeline:o,timeFinal:i},void 0),(0,n.jsx)(Ze,{currentTimeline:o},void 0)]}),void 0)}),void 0):(0,n.jsx)(n.Fragment,{},void 0)},we=({index:e,lastIndex:t,timeline:i})=>{var o;const[l,a]=(0,v.useState)(-1),r=null===(o=null==i?void 0:i.deviceAlias)||void 0===o?void 0:o.split("-"),d=1===r.length?r[0]:`${r[0]}${r[1].slice(-2)}`,c=Se({indexTimeline:e});return(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"row",alignItems:"center",className:c.rootRowTimeline},{children:[(0,n.jsx)("label",Object.assign({style:{width:50,userSelect:"none"}},{children:d}),void 0),(0,n.jsx)(Ce,{setTimeFinal:a,timeFinal:l,states:i.historyShiftList,currentTimeline:i.currentTimeline},e),(0,n.jsx)(oe,{states:i.historyShiftList,currentTimeline:i.currentTimeline,index:e,lastIndex:t,timeFinal:l,setTimeFinal:a},void 0)]}),e)},De=({shift:e})=>{const t=(0,m.T)(),{historyTimelineShift:i,statusGetTimeline:o,statusCreateTimeline:l}=(0,m.C)(g.yV),[a]=U();return(0,v.useEffect)((()=>(t((0,g.mA)(a)),()=>{})),[]),(0,n.jsxs)(s.Z,Object.assign({container:!0,style:{position:"relative",paddingTop:8,borderColor:"#000"}},{children:[(null==i?void 0:i.length)>0&&(null==i?void 0:i.map(((e,t)=>e.currentTimeline&&(0,n.jsx)(we,{index:t,lastIndex:(null==i?void 0:i.length)-1,timeline:e},`${e.deviceId}-${t}`)))),(0,n.jsx)(pe,{},void 0),(0,n.jsx)(Oe,Object.assign({},{shift:e}),void 0)]}),void 0)};var Le=i(34250),He=i(60702),Pe=i(44562);const Fe=({error:e,index:t})=>{const[i,o]=v.useState(!0),[l,s]=v.useState({vertical:"bottom",horizontal:"right"}),{vertical:a,horizontal:r}=l,d=(e,t)=>{"clickaway"!==t&&o(!1)};return(0,n.jsx)(He.Z,Object.assign({anchorOrigin:{vertical:a,horizontal:r},open:i,onClose:d,style:{marginBottom:60*t+"px"}},{children:(0,n.jsx)(Pe.Z,Object.assign({style:{marginTop:".5rem"},onClose:d,severity:"error"},{children:(0,n.jsx)("strong",{children:e.message},void 0)}),void 0)}),void 0)},Re=({error:e})=>{const[t,i]=v.useState({open:!0,vertical:"bottom",horizontal:"right"}),{vertical:o,horizontal:l,open:s}=t,a=()=>{i(Object.assign(Object.assign({},t),{open:!1}))};return(0,n.jsx)(He.Z,Object.assign({open:!0,anchorOrigin:{vertical:o,horizontal:l}},{children:(0,n.jsx)("div",{children:null==e?void 0:e.map(((e,t)=>(0,n.jsx)(Fe,{error:e,handleClose:a,index:t},e.deviceId)))},void 0)}),void 0)};const ke=new Date,ze=()=>{const e=(0,m.T)();return(0,n.jsx)(o.Z,{avatar:(0,n.jsx)(l.Z,{onClick:()=>{e((0,g.IT)())},size:"small"},void 0),label:"Todos"},void 0)},Me=()=>{const[e]=(0,u.R)(),{dateShiftSelect:t,shiftSelect:i,timelineErrorList:o}=(0,m.C)(g.yV),l=(0,m.T)(),b=new Date(ke.getTime()-26784e5),[x]=(0,W.l)(new Date(t));(0,v.useEffect)((()=>{l((0,g.tp)(e.getTime()))}),[e.getDate()]);const p=e=>{l((0,g.Nx)(e))};return(0,v.useEffect)((()=>{e.getHours()>=7&&e.getHours()<19?l((0,g.Nx)(h.Shift.DAY)):l((0,g.Nx)(h.Shift.NIGHT))}),[]),(0,n.jsxs)(s.Z,Object.assign({container:!0,direction:"row"},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0,lg:12,md:12,xs:12,style:{background:"#dbdbdb"}},{children:(0,n.jsx)(j.M,{startDate:b,days:31,marked:[{}],selectDate:new Date(t),getSelectedDay:e=>{l((0,g.tp)(e.getTime()))},color:"#024e8c"},void 0)}),void 0),(0,n.jsxs)(s.Z,Object.assign({item:!0,lg:12,md:12,xs:12},{children:[(0,n.jsxs)(s.Z,Object.assign({container:!0,style:{marginBottom:16,marginTop:8,gap:4,position:"sticky",zIndex:6,top:50,background:"rgb(255,255,255)"},justifyContent:"space-between"},{children:[(0,n.jsx)(s.Z,Object.assign({item:!0},{children:(0,n.jsxs)(a.Z,Object.assign({row:!0,"aria-label":"shift",name:"shift",value:i,style:{marginRight:8}},{children:[(0,n.jsx)(r.Z,{value:h.Shift.DAY,control:(0,n.jsx)(d.Z,{style:{padding:0},size:"small",color:"primary"},void 0),label:"Día",onClick:()=>p(h.Shift.DAY),labelPlacement:"start"},void 0),(0,n.jsx)(r.Z,{value:h.Shift.NIGHT,control:(0,n.jsx)(d.Z,{style:{padding:0},size:"small",color:"primary"},void 0),label:"Noche",onClick:()=>p(h.Shift.NIGHT),labelPlacement:"start"},void 0)]}),void 0)}),void 0),(0,n.jsxs)(s.Z,Object.assign({item:!0},{children:[(0,n.jsx)(J,{},void 0),(0,n.jsx)(ze,{},void 0),(0,n.jsx)(c.Z,Object.assign({color:"secondary",size:"small",variant:"outlined",onClick:()=>{return e=void 0,n=void 0,s=function*(){yield l((0,g.nx)({shiftDateString:new Date(t).toString(),shift:i})),localStorage.removeItem("close_shift_units"),location.reload()},new((o=void 0)||(o=Promise))((function(t,i){function l(e){try{r(s.next(e))}catch(e){i(e)}}function a(e){try{r(s.throw(e))}catch(e){i(e)}}function r(e){var i;e.done?t(e.value):(i=e.value,i instanceof o?i:new o((function(e){e(i)}))).then(l,a)}r((s=s.apply(e,n||[])).next())}));var e,n,o,s}},{children:"CERRAR TURNO"}),void 0)]}),void 0)]}),void 0),(0,n.jsx)(De,Object.assign({},{shift:i}),void 0)]}),void 0),(0,n.jsx)(Le.Z,{visible:!0,actionClick:function(){const e={dateStart:`${x}T00:00`,dateEnd:`${x}T00:00`};l((0,g.Uc)(e))},Icon:f.Z,disabled:!1,color:"secondary",right:70},void 0),!(null==o?void 0:o.success)&&(0,n.jsx)(Re,{error:null==o?void 0:o.errorsList},void 0)]}),void 0)};var _e=i(49521);const $e=()=>(0,n.jsxs)("div",{children:[(0,n.jsx)(_e.h,{title:"Linea de tiempo"},void 0),(0,n.jsx)("div",Object.assign({style:{marginTop:"48px"}},{children:(0,n.jsx)(Me,{},void 0)}),void 0)]},void 0),We=$e}}]);