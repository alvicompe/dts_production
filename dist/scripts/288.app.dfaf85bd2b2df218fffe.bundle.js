(self.webpackChunkdts_hytera=self.webpackChunkdts_hytera||[]).push([[288],{2499:(e,t,o)=>{e.exports=o.p+"502f3c0279e3828ba93c298f50ed71d7.png"},7126:(e,t,o)=>{e.exports=o.p+"89f059a2790e391b484a369a3b9f92fb.png"},6593:(e,t,o)=>{e.exports=o.p+"ab5c4ca57e81aaf21cb330668efbde4f.svg"},4686:(e,t,o)=>{e.exports=o.p+"36756eca8dc098cf7103be69319d1de6.svg"},5413:(e,t,o)=>{e.exports=o.p+"f7bda309f804ba7abdd57c3272cae75b.svg"},6046:(e,t,o)=>{e.exports=o.p+"6349bce6aa562fa9a965484651c725c9.svg"},9091:(e,t,o)=>{e.exports=o.p+"20557549695e4a02b8f5e299c9687642.png"},5288:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Y});var s=o(5893),r=o(868),a=o(1749),i=o(7294),c=o(3534),n=o(998),l=o(5757),d=o(9895),p=o(2318),u=o(3681),y=o(6037),g=o(2822),f=o(5517),_=o(573),m=o(3765),v=o(1120),x=o(6320),b=o(4880),h=o(3584),S=o(5090);const j=o(4686),L=o(6046),C=o(5413),k=(0,v.Z)((e=>({nested:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1),paddingTop:e.spacing(.5),paddingBottom:e.spacing(1)}}))),O=({data:e,selected:t,setSelected:o})=>{const c=k(),[v,O]=(0,i.useState)(!1),[I,E]=(0,i.useState)(""),[F,A]=(0,i.useState)(!1),w=t&&t.deviceId===e.deviceId,{datetime:Z}=e.sensor;return(0,i.useEffect)((()=>{const e=()=>{const e=new Date(Z);e.setHours(e.getHours());const{stringValue:t,value:o}=(0,x.dj)(e);E(t),A(o>=b.qi)};e();const t=setInterval((()=>{e()}),5e3);return()=>{clearInterval(t)}}),[Z]),(0,i.useEffect)((()=>(O(!0),setTimeout((()=>{O(!1)}),2e3),()=>{})),[e.sensor.datetime]),(0,s.jsxs)(d.Z,Object.assign({elevation:4,style:{marginBottom:8}},{children:[(0,s.jsxs)(n.Z,Object.assign({button:!0,selected:w,onClick:()=>{t&&e.deviceId===t.deviceId?o(null):o(e)}},{children:[(0,s.jsx)(l.Z,{primary:e.deviceAlias,secondary:"[num] trucks"},void 0),(0,s.jsxs)(a.Z,Object.assign({container:!0,style:{width:"2rem"}},{children:[(0,s.jsx)(_.Z,{style:{color:F?h.J$:h.sb},fontSize:"small"},void 0),(0,s.jsx)(p.Z,Object.assign({style:{fontSize:8,color:"rgba(0, 0, 0, 0.54)"}},{children:F?"Sin conex":S.l[e.state]}),void 0)]}),void 0)]}),void 0),v&&(0,s.jsx)(u.Z,{color:"primary"},void 0),(0,s.jsx)(y.Z,Object.assign({in:w,timeout:"auto",unmountOnExit:!0,className:c.nested},{children:(0,s.jsxs)(g.Z,Object.assign({dense:!0,disablePadding:!0},{children:[(0,s.jsx)(n.Z,Object.assign({style:{padding:4},dense:!0},{children:(0,s.jsx)(l.Z,{primary:(0,s.jsx)(r.ZP,Object.assign({title:`Última comunicación, i. real: ${e.realInterval} seg`,"aria-label":"add"},{children:(0,s.jsxs)("div",Object.assign({style:{display:"flex"}},{children:[(0,s.jsx)(m.Z,{color:"action",fontSize:"small"},void 0),(0,s.jsx)(p.Z,Object.assign({variant:"body1",style:{marginLeft:4},color:"initial"},{children:I}),void 0)]}),void 0)}),void 0)},void 0)}),void 0),(0,s.jsx)(f.Z,{},void 0),(0,s.jsxs)(n.Z,Object.assign({style:{padding:4},dense:!0},{children:[(0,s.jsx)("img",{width:24,src:j},void 0),(0,s.jsx)(l.Z,{style:{marginLeft:4},primary:"[num] inactivos"},void 0)]}),void 0),(0,s.jsxs)(n.Z,Object.assign({style:{padding:4},dense:!0},{children:[(0,s.jsx)("img",{width:24,src:L},void 0),(0,s.jsx)(l.Z,{style:{marginLeft:4},primary:"[num] tránsito"},void 0)]}),void 0),(0,s.jsxs)(n.Z,Object.assign({style:{padding:4},dense:!0},{children:[(0,s.jsx)("img",{width:24,src:C},void 0),(0,s.jsx)(l.Z,{style:{marginLeft:4},primary:"[num] cola"},void 0)]}),void 0)]}),void 0)}),void 0)]}),void 0)};var I=o(2285);const E=o(6593),F=(0,v.Z)((e=>({root:{width:150,paddingRight:8,paddingLeft:8,backgroundColor:"#fbfeffbf",boxShadow:"0px 0px 10px #b5aeae",overflowY:"scroll",height:"100vh",position:"absolute",left:0,zIndex:3},root_noFixed:{width:150,paddingRight:8,paddingLeft:8,backgroundColor:"#fbfeffbf",overflowY:"scroll",height:"100vh",zIndex:3},nested:{paddingLeft:e.spacing(1),paddingTop:e.spacing(.5),paddingBottom:e.spacing(1)}}))),A=({excavators:e,setSelectedEM:t,selectedExcavatorMap:o,selected:r,setSelected:i,isNewAssigment:c,setSelectedAssigment:d})=>{const p=F();return(0,s.jsxs)(g.Z,Object.assign({className:c?p.root_noFixed:p.root,disablePadding:!0},{children:[(0,s.jsxs)(n.Z,Object.assign({dense:!0},{children:[(0,s.jsx)("div",Object.assign({style:{marginRight:8}},{children:(0,s.jsx)("img",{alt:"Placa",width:32,src:E},void 0)}),void 0),(0,s.jsx)(l.Z,{primary:"Excavators"},void 0)]}),void 0),(0,s.jsx)(I.Z,Object.assign({direction:"left",in:!!o,mountOnEnter:!0,unmountOnExit:!0},{children:(0,s.jsx)(a.Z,Object.assign({container:!0},{children:o&&(0,s.jsx)(O,Object.assign({},{data:o,selected:o,setSelected:t,setSelectedAssigment:()=>{}}),void 0)}),void 0)}),void 0),e.map(((e,t)=>!(o&&o.deviceId===e.deviceId)&&(0,s.jsx)(O,Object.assign({},{key:t,data:e,selected:r,setSelected:i,setSelectedAssigment:d}),void 0)))]}),void 0)};var w=o(7970),Z=o(7348);const $=({data:e,map:t,pin:o,setSelectExcavator:r,setSelectTruck:a})=>{const{deviceId:c,sensor:n,deviceAlias:l,id:d}=e,{latitude:p,longitude:u,direction:y}=n,g=t.getSource(c),f={geometry:{type:"Point",coordinates:[u,p]},type:"Feature",properties:{rotate:y-360,pin:o&&o.deviceId===e.deviceId}},_=!`${l}`.includes("EX-"),m=`${l}`.includes("CM-");return(0,i.useEffect)((()=>{if(`${l}`.includes("EX-")){const e=`excavator_feature_${c}`,o={type:"FeatureCollection",crs:{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},features:[{geometry:{type:"Point",coordinates:[u,p]},type:"Feature",properties:{}}]};t.getSource(e)?t.getSource(e).setData(o):t.addSource(e,{type:"geojson",cluster:!0,data:(0,Z._X)([u,p])}),t.getLayer(e)||t.addLayer({id:e,type:"circle",source:e,paint:{"circle-color":"#00809d","circle-radius":4,"circle-stroke-width":25,"circle-stroke-color":"rgba(0, 128, 157,0.54)"}})}}),[n]),(0,i.useEffect)((()=>{if(g){if(g._data&&g._data.geometry&&Array.isArray(g._data.geometry.coordinates)){f.geometry.coordinates=[u,p],g.setData(f);const e=`${c}_pin_point`,o=t.getSource(e);if(o){const e=(0,Z.X3)([u,p]);o.setData(e)}}}else t.getSource(c)||(t.addSource(`${c}`,{type:"geojson",data:f}),t.addLayer({id:`${c}`,type:"symbol",source:`${c}`,layout:{"icon-image":m?"pickup_nav":_?"truck_nav":"excavator_nav","icon-size":.08,"icon-ignore-placement":!0,"icon-allow-overlap":!0,"icon-rotate":["get","rotate"]}}),t.on("click",`${c}`,(function(t){console.log("dataclick",e),e.deviceAlias.includes("EX")?(r(void 0),setTimeout((()=>{r(e)}),500)):(a(void 0),setTimeout((()=>{a(e)}),500))})),t.on("mouseenter",`${c}`,(function(){t.getCanvas().style.cursor="pointer"})),t.on("mouseleave",`${c}`,(function(){t.getCanvas().style.cursor=""})))}),[e.sensor.latitude,e.sensor.longitude,e.sensor.direction]),(0,s.jsx)(s.Fragment,{},void 0)};var P=o(4376);const T=({map:e,id:t,color:o,points:r,opacity:a,direction:c,iconImage:n})=>{const l={type:"FeatureCollection",crs:{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},features:[{geometry:{type:"Point",coordinates:r},type:"Feature",properties:{}}]};return(0,i.useEffect)((()=>{const s=`${t}_point`,a=e.getSource(s);if(e&&!a)e.getSource(t)&&(e.removeLayer(t+""),e.removeSource(t+"")),setTimeout((()=>{const a={geometry:{type:"Point",coordinates:r},type:"Feature",properties:{rotate:c-360,fuel1:"Hydro"}};e.getSource(s)||e.addSource(s,{type:"geojson",cluster:!0,clusterMaxZoom:14,clusterRadius:50,data:(0,Z._X)(r)}),e.getLayer(s)||e.addLayer({id:s,type:"circle",source:s,filter:["!has","point_count"],paint:{"circle-color":o,"circle-radius":20,"circle-stroke-width":15,"circle-stroke-color":"rgba(243, 93, 93, .4)"}}),e.getSource(t)||e.addSource(t+"",{type:"geojson",data:a}),e.getLayer(t)||e.addLayer({id:t+"",type:"symbol",source:t+"",layout:{"icon-image":n,"icon-size":.08,"icon-ignore-placement":!0,"icon-allow-overlap":!0,"icon-rotate":["get","rotate"]}})}),1e3);else if(a._data&&a._data.features[0].geometry&&Array.isArray(a._data.features[0].geometry.coordinates)){const e=a._data.features[0].geometry.coordinates,t=r,o=(0,P.TuJ)([e,t]),s=Math.floor((0,P.kE)(o,{units:"meters"})),c=[];for(var i=0;i<s;i++){const e=(0,P.$1t)(o,i,{units:"meters"});c.push(e.geometry.coordinates)}a.setData(l)}return()=>{}}),[e,r]),(0,s.jsx)(s.Fragment,{},void 0)};var R=o(6158),M=o.n(R);const z=({map:e,padCells:t,stockCells:o,dmeCells:r,polygons:a,polygons_actives:c,geofences:n,routes:l,setIsPaintPolygons:d,curves:p})=>((0,i.useEffect)((()=>{if(e&&c.length>0){const t=[],o=c.map((e=>{console.log("p.centroid",e.centroid);const{latitude:o,longitude:s}=e.centroid;return t.push({type:"Feature",geometry:{type:"Point",coordinates:[s,o]},properties:{name:`${e.name}${e.material?`-${e.material.type}`:""}`}}),{type:"Feature",properties:{color:e.color,out_color:"blue",opacity:1,opacity_border:1},geometry:{type:"Polygon",coordinates:[e.points]}}}));e.getSource("polygons_actives_2d")||e.addSource("polygons_actives_2d",{type:"geojson",data:{type:"FeatureCollection",features:o}}),e.getSource("centroid_actives")||e.addSource("centroid_actives",{type:"geojson",data:{type:"FeatureCollection",features:t}}),setTimeout((()=>{e.getLayer("polygons_actives_2d_layer")||e.addLayer({id:"polygons_actives_2d_layer",type:"fill",source:"polygons_actives_2d",layout:{},paint:{"fill-color":["get","color"],"fill-outline-color":["get","out_color"],"fill-opacity":1}}),e.getLayer("polygons_lineborder_actives_2d_layer")||e.addLayer({id:"polygons_lineborder_actives_2d_layer",type:"line",source:"polygons_actives_2d",paint:{"line-color":["get","out_color"],"line-width":2,"line-opacity":1},filter:["==","$type","Polygon"]}),e.getLayer("centroid_plygons_actives_layer")||e.addLayer({id:"centroid_plygons_actives_layer",type:"symbol",source:"centroid_actives",layout:{"text-field":["get","name"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#00296b","text-halo-color":"#f8f7ff","text-halo-width":2}})}),200)}}),[e,c]),(0,i.useEffect)((()=>{if(a.length>0&&l.length>0){const t=[],o=[];a.forEach((e=>{const{latitude:s,longitude:r}=e.centroid;o.push({type:"Feature",geometry:{type:"Point",coordinates:[r,s]},properties:{name:`${e.name}${e.material?`-${e.material.type}`:""}`}}),t.push({type:"Feature",properties:{color:"orange",out_color:"grey",opacity:.1,name:e.name,opacity_border:0},geometry:{type:"Polygon",coordinates:[e.points]}})})),l.forEach((e=>{t.push({type:"Feature",properties:{color:e.color,out_color:"red",opacity:.9,opacity_border:0},geometry:{type:"LineString",coordinates:e.points}})})),e.getSource("polygons_routes_2d")||e.addSource("polygons_routes_2d",{type:"geojson",data:{type:"FeatureCollection",features:t}}),e.getLayer("polygons_2d_layer")||e.addLayer({id:"polygons_2d_layer",type:"fill",source:"polygons_routes_2d",layout:{},paint:{"fill-color":["get","color"],"fill-opacity":["get","opacity"]},filter:["==","$type","Polygon"]}),e.getSource("centroid_no_actives")||e.addSource("centroid_no_actives",{type:"geojson",data:{type:"FeatureCollection",features:o}}),setTimeout((()=>{e.getLayer("routes_2d_layer")||e.addLayer({id:"routes_2d_layer",type:"line",source:"polygons_routes_2d",paint:{"line-width":6,"line-color":["get","color"],"line-opacity":.5},layout:{"line-join":"round","line-cap":"round"},filter:["==","$type","LineString"]}),d(!0)}),500)}return()=>{console.log("destruyendo")}}),[a,l]),(0,i.useEffect)((()=>{if(p.length>0){const t=p.map((e=>({type:"Feature",properties:{color:e.color,out_color:"red",opacity:.9,opacity_border:0},geometry:{type:"LineString",coordinates:e.points}})));e.getSource("curves_nivels_2d")||e.addSource("curves_nivels_2d",{type:"geojson",data:{type:"FeatureCollection",features:t}}),e.getLayer("curves_nivels_2d_layer")||e.addLayer({id:"curves_nivels_2d_layer",type:"line",source:"curves_nivels_2d",paint:{"line-width":1,"line-color":"#E6966E","line-opacity":.81},layout:{"line-join":"round","line-cap":"round"}})}return()=>{}}),[p]),(0,i.useEffect)((()=>{if(e&&n.length>0){const t=n.map((e=>({type:"Feature",properties:{color:e.color,out_color:"blue",opacity:.2,opacity_border:1},geometry:{type:"Polygon",coordinates:[e.points]}})));e.getSource("polygons_geofences_2d")||e.addSource("polygons_geofences_2d",{type:"geojson",data:{type:"FeatureCollection",features:t}}),e.getLayer("polygons_geofences_2d")||e.addLayer({id:"polygons_geofences_2d_layer",type:"fill",source:"polygons_geofences_2d",layout:{},paint:{"fill-color":["get","color"],"fill-outline-color":["get","out_color"],"fill-opacity":["get","opacity"]}})}}),[e,n]),(0,i.useEffect)((()=>{if(e&&t.length>0){const o=[],s=t.map((e=>{const{longitude:t,latitude:s}=e.centroid;return o.push({type:"Feature",geometry:{type:"Point",coordinates:[t,s]},properties:{name:`${e.name}`}}),{type:"Feature",properties:{color:"#80b918",out_color:"#43aa8b",opacity:.8,opacity_border:1},geometry:{type:"Polygon",coordinates:[e.points]}}}));e.getSource("polygons_cells_2d")||e.addSource("polygons_cells_2d",{type:"geojson",data:{type:"FeatureCollection",features:s}}),e.getSource("centroid_actives_pad")||e.addSource("centroid_actives_pad",{type:"geojson",data:{type:"FeatureCollection",features:o}}),setTimeout((()=>{e.getLayer("polygons_cells_2d_layer")||e.addLayer({id:"polygons_cells_2d_layer",type:"fill",source:"polygons_cells_2d",layout:{},paint:{"fill-color":["get","color"],"fill-outline-color":["get","out_color"],"fill-opacity":["get","opacity"]}}),e.getLayer("centroid_pad_layer")||e.addLayer({id:"centroid_pad_layer",type:"symbol",source:"centroid_actives_pad",layout:{"text-field":["get","name"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#00296b","text-halo-color":"#f8f7ff","text-halo-width":2}})}),100)}}),[e,t]),(0,i.useEffect)((()=>{if(e&&r.length>0){const t=[],o=r.map((e=>{const{longitude:o,latitude:s}=e.centroid,r=(0,P.MqI)({type:"Feature",properties:{color:e.color,out_color:"#43aa8b",opacity:.8,opacity_border:1},geometry:{type:"Polygon",coordinates:[e.points]}},{properties:{name:`${e.name}`}});return t.push(r),{type:"Feature",properties:{color:e.color,out_color:"#43aa8b",opacity:.8,opacity_border:1},geometry:{type:"Polygon",coordinates:[e.points]}}}));e.getSource("polygons_dmecells_2d")||e.addSource("polygons_dmecells_2d",{type:"geojson",data:{type:"FeatureCollection",features:o}}),e.getSource("centroid_actives_dme")||e.addSource("centroid_actives_dme",{type:"geojson",data:{type:"FeatureCollection",features:t}}),setTimeout((()=>{e.getLayer("polygons_dmecells_2d_layer")||e.addLayer({id:"polygons_dmecells_2d_layer",type:"fill",source:"polygons_dmecells_2d",layout:{},paint:{"fill-color":["get","color"],"fill-outline-color":["get","out_color"],"fill-opacity":["get","opacity"]}}),e.getLayer("centroid_dme_layer")||e.addLayer({id:"centroid_dme_layer",type:"symbol",source:"centroid_actives_dme",layout:{"text-field":["get","name"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#00296b","text-halo-color":"#f8f7ff","text-halo-width":2}})}),100),new(M().Popup)({closeOnClick:!1}).setLngLat([-78.20710343466789,-7.614410281492642]).setHTML("<h1>Hello World!</h1>").addTo(e)}}),[e,r]),(0,i.useEffect)((()=>{if(e&&o.length>0){const t=[],s=o.map((e=>{const{longitude:o,latitude:s}=e.centroid,r=(0,P.beQ)({type:"Feature",properties:{color:e.color,out_color:"#43aa8b",opacity:.8,opacity_border:1},geometry:{type:"Polygon",coordinates:[e.points]}},{properties:{name:`${e.name}`}});return t.push(r),{type:"Feature",properties:{color:e.color,out_color:"#43aa8b",opacity:.8,opacity_border:1},geometry:{type:"Polygon",coordinates:[e.points]}}}));e.getSource("polygons_stockcells_2d")||e.addSource("polygons_stockcells_2d",{type:"geojson",data:{type:"FeatureCollection",features:s}}),e.getSource("centroid_actives_stock")||e.addSource("centroid_actives_stock",{type:"geojson",data:{type:"FeatureCollection",features:t}}),setTimeout((()=>{e.getLayer("polygons_stockcells_2d_layer")||e.addLayer({id:"polygons_stockcells_2d_layer",type:"fill",source:"polygons_stockcells_2d",layout:{},paint:{"fill-color":["get","color"],"fill-outline-color":["get","out_color"],"fill-opacity":["get","opacity"]}}),e.getLayer("centroid_stock_layer")||e.addLayer({id:"centroid_stock_layer",type:"symbol",source:"centroid_actives_stock",layout:{"text-field":["get","name"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#00296b","text-halo-color":"#f8f7ff","text-halo-width":2}})}),100)}}),[e,o]),(0,s.jsx)(s.Fragment,{},void 0));var D=o(8479);const N=(e,t,o,s,r,a)=>{const i=t.map((e=>{if(!e.sensor)return{type:"Feature",geometry:{type:"Point",coordinates:[0,0]},properties:{name:"",rotation:-180,offsetdate:[0,0]}};const{latitude:t,longitude:o,direction:s}=e.sensor,a=e.deviceAlias.split("-");return{type:"Feature",geometry:{type:"Point",coordinates:[o,t]},properties:{name:`${a.length>1&&""!==a[1].trim()?`${a[0].substr(0,1)}${a[1].substr(-2)}`:e.deviceAlias}`,rotation:-180+s,offsetdate:[0,r]}}})),c=e.getSource(o);c?c.setData({type:"FeatureCollection",features:i}):(e.addSource(o,{type:"geojson",data:{type:"FeatureCollection",features:i}}),e.addLayer({id:s,type:"symbol",source:o,layout:{"text-field":["get","name"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":a,"text-rotate":["get","rotation"],"text-offset":["get","offsetdate"]},paint:{"text-color":"#fff","text-halo-color":"#00296b","text-halo-width":4}}))};var U=o(94),B=o(4845);const X=(0,i.createContext)(null),H=(e,t)=>{const{sensor:o}=e;o&&o.latitude&&o.longitude&&t((t=>{const o=t.findIndex((t=>e.deviceId===t.deviceId));return o>=0?t[o]=Object.assign({},e):t.push(e),JSON.parse(JSON.stringify(t))}))};function J(e){const{children:t,open:o,value:a}=e;return(0,s.jsx)(r.ZP,Object.assign({arrow:!0,color:"#075fcc",open:o,enterTouchDelay:0,placement:"bottom",title:a},{children:t}),void 0)}const V=({gpsTruck:e,gpsExcavator:t,benchs:r,padCells:n,dmeCells:l,stockCells:d,curves:p,geofences:u,polygons_actives:y,polygons:g,routes:f})=>{const _=(0,i.useRef)(null),m=(0,i.useRef)(null),[v,x]=(0,i.useState)(-78.196),[b,h]=(0,D._)("bearing_map_dispatch",0),[S,j]=(0,i.useState)(-7.6163),[L,C]=(0,i.useState)(14.81),[k,O]=(0,i.useState)(!1),[I,E]=(0,i.useState)(!1),[F,Z]=(0,i.useState)([]),[P,R]=(0,i.useState)([]),[M,V]=(0,i.useState)(),[q,Y]=(0,D._)("keys_highlights_units",[]),[G,K]=(0,i.useState)([]),[W,Q]=(0,i.useState)(P[0]),[ee,te]=(0,i.useState)(),[oe,se]=(0,i.useState)(),[re,ae]=(0,i.useState)(-1);(0,i.useEffect)((()=>{(e=>{(0,U.r)().then((t=>{e(t)})).catch((t=>{e([]),console.log(t)}))})(Z)}),[]),(0,i.useEffect)((()=>{I&&(m.current.loadImage(o(9091),(function(e,t){if(e)throw e;m.current.addImage("truck_nav",t)})),m.current.loadImage(o(2499),(function(e,t){if(console.log("error",e),e)throw e;m.current.addImage("excavator_nav",t)})),m.current.loadImage(o(7126),(function(e,t){if(console.log("error",e),e)throw e;m.current.addImage("pickup_nav",t)})))}),[I]),(0,i.useEffect)((()=>{const e=F.filter((e=>q.findIndex((t=>t===e.deviceId))>=0));K(e)}),[F,q]),(0,i.useEffect)((()=>{e&&(H(e,Z),M&&M.deviceId===e.deviceId&&V(e),oe&&oe.deviceId===e.deviceId&&se(e),K((t=>{const o=t.findIndex((t=>t.deviceId===e.deviceId));return o>=0&&(t[o]=e),JSON.parse(JSON.stringify(t))})))}),[e]),(0,i.useEffect)((()=>{t&&H(t,R)}),[t]),(0,i.useEffect)((()=>{I&&k&&N(m.current,F,"ID_SOURCE_ALIAS_TRUCKS","ID_LAYER_ALIAS_TRUCKS",-2.1,12)}),[F,I,k]),(0,i.useEffect)((()=>{k&&N(m.current,P,"ID_SOURCE_ALIAS_EXCAVATORS","ID_LAYER_ALIAS_EXCAVATORS",-3.2,12)}),[P,k]);const ie=!!re&&-1!==re,ce=!ie&&I&&G.map(((e,t)=>(0,s.jsx)(T,{id:e.deviceId,points:[e.sensor.longitude,e.sensor.latitude],opacity:1,color:"orange",direction:e.sensor.direction,map:m.current,iconImage:e.deviceAlias.includes("CM-")?"pickup_nav":"truck_nav"},t))),ne=!ie&&k&&I&&F.concat(P).map(((e,t)=>e.sensor?(0,s.jsx)($,{setSelectExcavator:te,setSelectTruck:se,data:e,map:m.current,pin:M},t):null)),le=!ie&&I&&(0,s.jsx)(z,Object.assign({},{polygons_actives:y,polygons:g,curves:p,routes:f,geofences:u,padCells:n,dmeCells:l,stockCells:d,setIsPaintPolygons:O},{map:m.current}),void 0);return(0,s.jsx)(X.Provider,Object.assign({value:m.current},{children:(0,s.jsxs)("div",Object.assign({style:{display:"flex",width:"100%",height:"100vh",position:"relative",overflowY:"scroll"}},{children:[(0,s.jsx)(a.Z,Object.assign({container:!0,style:{maxWidth:"33%",position:"fixed",top:0,zIndex:1,left:"33%"}},{children:(0,s.jsx)(B.Z,{defaultValue:0,ValueLabelComponent:J,getAriaValueText:function(e){return`${e}º`},"aria-labelledby":"discrete-slider-small-steps",valueLabelDisplay:"auto",step:5,marks:!0,min:0,value:b,max:360,onChange:(e,t)=>{h(Number(t))}},void 0)}),void 0),(0,s.jsx)(A,Object.assign({},{excavators:P,selectedExcavatorMap:ee,setSelectedEM:te,selected:W,setSelected:Q,isNewAssigment:ie,setSelectedAssigment:ae}),void 0),(0,s.jsx)(c.Z,Object.assign({map:m,dragRotate:!1,style:"mapbox://styles/dispatchgat/ckqqsfc2y46bo17sf1y29zwnj",mapContainer:_,bearing:Number(b),pitch:15},{lat:S,lng:v,zoom:L,setLat:j,setLng:x,setZoom:C,setLoad:E}),"map2"),ce,ne,le,!ie&&(0,s.jsx)(w.q,Object.assign({trucks:F},{selectedTruckMap:oe,setSelectedTM:se},{excavator:W,highlights:q,setHighlights:Y,pinHook:[M,V],map:m.current}),void 0)]}),void 0)}),void 0)};var q=o(3513);const Y=()=>(0,s.jsx)(q.a.Consumer,{children:e=>(0,s.jsx)(V,{gpsExcavator:e.streamExcavator,gpsTruck:e.streamTruck,benchs:e.benchs,polygons:e.polygons,routes:e.routes,curves:e.curves,polygons_actives:e.polygons_actives,geofences:e.geofences,padCells:e.padCells,dmeCells:e.dmeCells,stockCells:e.stockCells},void 0)},void 0)}}]);